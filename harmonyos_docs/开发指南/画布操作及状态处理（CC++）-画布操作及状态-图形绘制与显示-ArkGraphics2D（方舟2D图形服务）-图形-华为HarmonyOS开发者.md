<h1 _ngcontent-edo-c119="" class="doc-title ng-star-inserted" title="画布操作及状态处理（C/C++）"> 画布操作及状态处理（C/C++） </h1>

<div _ngcontent-edo-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="场景介绍">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="场景介绍" tips="复制节点链接"></i></h2>          <p>创建或获取Canvas画布之后，可以基于画布进一步地进行图形操作和状态处理。画布操作属于可选操作，开发者可以根据场景需要进行。需要先进行画布操作，再进行后续绘制，只有这样画布操作才有效果。</p>     <p>常见的画布操作如下：</p>     <ul>      <li>       <p>裁剪。</p></li>      <li>       <p>矩阵变换，如平移、缩放、旋转等。</p></li>      <li>       <p>状态保存与恢复。</p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="裁剪操作">裁剪操作<i class="anchor-icon anchor-icon-link" anchorid="裁剪操作" tips="复制节点链接"></i></h2>          <p>裁剪是图形处理中的常见操作，裁剪针对的是画布本身，可以用于限制绘图区域，只在指定的区域内容进行绘制。需要先进行裁剪操作，再进行绘制，才会有对应效果。</p>     <p>当前支持的裁剪操作主要如下：</p>     <ul>      <li>       <p>裁剪矩形。</p></li>      <li>       <p>裁剪圆角矩形。</p></li>      <li>       <p>裁剪自定义路径。</p></li>      <li>       <p>裁剪一个区域。</p></li>     </ul>    </div>    <div class="tiledSection">     <h3 id="接口说明" class="firsth2">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明" tips="复制节点链接"></i></h3>          <p>裁剪操作常用接口如下表所示，详细的使用和参数说明请见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-drawing-canvas-h" target="_blank">drawing_canvas.h</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.1" valign="top" width="50%">接口</th>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.2" valign="top" width="50%">描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">void OH_Drawing_CanvasClipRect (OH_Drawing_Canvas *, const OH_Drawing_Rect *, OH_Drawing_CanvasClipOp clipOp, bool doAntiAlias)</td>         <td class="cellrowborder" valign="top" width="50%">用于裁剪一个矩形。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">void OH_Drawing_CanvasClipRoundRect (OH_Drawing_Canvas *, const OH_Drawing_RoundRect *, OH_Drawing_CanvasClipOp clipOp, bool doAntiAlias)</td>         <td class="cellrowborder" valign="top" width="50%">用于裁剪一个圆角矩形。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">void OH_Drawing_CanvasClipPath (OH_Drawing_Canvas *, const OH_Drawing_Path *, OH_Drawing_CanvasClipOp clipOp, bool doAntiAlias)</td>         <td class="cellrowborder" valign="top" width="50%">用于裁剪一个自定义路径。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_Drawing_ErrorCode OH_Drawing_CanvasClipRegion (OH_Drawing_Canvas *canvas, const OH_Drawing_Region *region, OH_Drawing_CanvasClipOp clipOp)</td>         <td class="cellrowborder" valign="top" width="50%">用于裁剪一个区域。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="开发示例">开发示例<i class="anchor-icon anchor-icon-link" anchorid="开发示例" tips="复制节点链接"></i></h3>          <p>此处以在画布上裁剪矩形为例给出示例和效果图，其他裁剪操作的逻辑基本相同，注意调用对应的接口并确保要裁剪的数据类型对应准确即可，此处不再一一展开。详细的使用和参数说明请见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-drawing-canvas-h" target="_blank">drawing_canvas.h</a>。</p>     <p>使用OH_Drawing_CanvasClipRect接口裁剪矩形。有以下四个入参：</p>     <ul>      <li>       <p>第一个参数是画布Canvas，裁剪操作将在这个画布上进行。请确保已创建或获取得到画布Canvas，具体可见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/canvas-get-result-draw-c">画布的获取与绘制结果的显示（C/C++）</a>。</p></li>      <li>       <p>第二个参数是要裁剪的矩形区域。</p></li>      <li>       <p>第三个参数是裁剪的操作类型，包括交集（INTERSECT）和差集（DIFFERENCE）。</p></li>      <li>       <p>第四个参数表示是否需要进行抗锯齿处理。</p></li>     </ul>     <div _ngcontent-edo-c106="" class="highlight-div"><div _ngcontent-edo-c106="" class="highlight-div-header"><div _ngcontent-edo-c106="" class="highlight-div-header-left"><div _ngcontent-edo-c106="" class="handle-button expand-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edo-c106="" class="highlight-div-header-right"><div _ngcontent-edo-c106="" class="handle-button ai-button"></div><div _ngcontent-edo-c106="" class="handle-button line-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edo-c106="" class="handle-button theme-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edo-c106="" class="handle-button copy-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edo-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-php" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 创建画刷对象</span></li><li>OH_Drawing_Brush *brush = <span class="hljs-title function_ invoke__">OH_Drawing_BrushCreate</span>();</li><li><span class="hljs-comment">// 设置画刷填充颜色为蓝色</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_BrushSetColor</span>(brush, <span class="hljs-number">0xff0000ff</span>);</li><li><span class="hljs-comment">// 在画布中设置画刷</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_CanvasAttachBrush</span>(canvas, brush);</li><li>OH_Drawing_Rect *rect = <span class="hljs-title function_ invoke__">OH_Drawing_RectCreate</span>(<span class="hljs-number">400</span>, <span class="hljs-number">400</span>, <span class="hljs-number">1200</span>, <span class="hljs-number">1200</span>);</li><li><span class="hljs-comment">// 裁剪矩形区域</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_CanvasClipRect</span>(canvas, rect, <span class="hljs-title class_">OH_Drawing_CanvasClipOp</span>::<span class="hljs-variable constant_">INTERSECT</span>, <span class="hljs-literal">true</span>);</li><li>OH_Drawing_Point *point = <span class="hljs-title function_ invoke__">OH_Drawing_PointCreate</span>(<span class="hljs-number">600</span>, <span class="hljs-number">600</span>);</li><li><span class="hljs-comment">// 绘制圆形</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_CanvasDrawCircle</span>(canvas, point, <span class="hljs-number">600</span>);</li><li><span class="hljs-comment">// 去除画布中的画刷</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_CanvasDetachBrush</span>(canvas);</li><li><span class="hljs-comment">// 销毁画刷对象并收回其占的内存</span></li><li><span class="hljs-title function_ invoke__">OH_Drawing_BrushDestroy</span>(brush);</li></ol></pre></div></div>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.4.6.1.3.1.1" valign="top" width="50%">原始图</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.6.1.3.1.2" valign="top" width="50%">裁剪后的图</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%"><span><img originheight="599" originwidth="602" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114400.33663700991404436361095797151775:50001231000000:2800:CD329B4EE054A3BAE2111C2732C142973183B89098F6FB4E535E73CFEF4504A6.jpg" width="436" height="433.8272425249169"></span></td>         <td class="cellrowborder" valign="top" width="50%"><span><img originheight="596" originwidth="605" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114400.42290587145685734275094696927397:50001231000000:2800:DB0349EF61DBD687E78EB1CCA8CA639C8D5EB54097DE74015C9A5C3EE3AB3F48.jpg" width="436" height="429.5140495867769"></span></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="矩阵变换操作">矩阵变换操作<i class="anchor-icon anchor-icon-link" anchorid="矩阵变换操作" tips="复制节点链接"></i></h2>          <p>矩阵变换也是常见的画布操作，是一种坐标系的转换，用于进行图形的变化。</p>     <p>当前支持的矩阵变换主要如下：</p>     <ul>      <li>       <p>平移</p></li>      <li>       <p>缩放</p></li>      <li>       <p>旋转</p></li>     </ul>    </div>    <div class="tiledSection">     <h3 id="接口说明-1" class="firsth2">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明-1" tips="复制节点链接"></i></h3>          <p>矩阵变换操作常用接口如下表所示，详细的使用和参数说明请见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-drawing-matrix-h" target="_blank">drawing_matrix.h</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.3.1.3.1.1" valign="top" width="50%">接口</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.3.1.3.1.2" valign="top" width="50%">描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">void OH_Drawing_CanvasTranslate (OH_Drawing_Canvas *, float dx, float dy)</td>         <td class="cellrowborder" valign="top" width="50%">用于平移画布一段距离。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">void OH_Drawing_CanvasScale (OH_Drawing_Canvas *, float sx, float sy)</td>         <td class="cellrowborder" valign="top" width="50%">用于画布缩放。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">void OH_Drawing_CanvasRotate (OH_Drawing_Canvas *, float degrees, float px, float py)</td>         <td class="cellrowborder" valign="top" width="50%">用于画布旋转一定的角度，正数表示顺时针旋转，负数反之。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">void OH_Drawing_CanvasSkew (OH_Drawing_Canvas *, float sx, float sy)</td>         <td class="cellrowborder" valign="top" width="50%">用于画布倾斜变换。等同于将当前画布矩阵左乘（premultiply）倾斜变换矩阵，并应用到画布上。其中倾斜变换矩阵为：|1 sx 0| |sy 1 0| |0 0 1|。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="平移">平移<i class="anchor-icon anchor-icon-link" anchorid="平移" tips="复制节点链接"></i></h3>          <p>使用OH_Drawing_MatrixCreateTranslation()接口实现画布平移。接口接受2个参数，分别为水平方向和垂直方向的平移量，单位为px。</p>     <p>简单示例和示意图如下所示：</p>     <div _ngcontent-edo-c106="" class="highlight-div"><div _ngcontent-edo-c106="" class="highlight-div-header"><div _ngcontent-edo-c106="" class="highlight-div-header-left"><div _ngcontent-edo-c106="" class="handle-button expand-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edo-c106="" class="highlight-div-header-right"><div _ngcontent-edo-c106="" class="handle-button ai-button"></div><div _ngcontent-edo-c106="" class="handle-button line-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edo-c106="" class="handle-button theme-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edo-c106="" class="handle-button copy-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edo-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 创建画刷对象</span></li><li>OH_Drawing_Brush* brush = <span class="hljs-built_in">OH_Drawing_BrushCreate</span>();</li><li><span class="hljs-comment">// 设置填充颜色</span></li><li><span class="hljs-built_in">OH_Drawing_BrushSetColor</span>(brush, <span class="hljs-built_in">OH_Drawing_ColorSetArgb</span>(<span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>));</li><li><span class="hljs-comment">// 设置画布中的画刷</span></li><li><span class="hljs-built_in">OH_Drawing_CanvasAttachBrush</span>(canvas, brush);</li><li><span class="hljs-comment">// 创建在水平和垂直方向分别平移300px的矩阵对象</span></li><li>OH_Drawing_Matrix *matrix = <span class="hljs-built_in">OH_Drawing_MatrixCreateTranslation</span>(<span class="hljs-number">300</span>, <span class="hljs-number">300</span>);</li><li><span class="hljs-comment">// 对Canvas进行矩阵变换</span></li><li><span class="hljs-built_in">OH_Drawing_CanvasConcatMatrix</span>(canvas, matrix);</li><li><span class="hljs-comment">// 绘制矩形</span></li><li>OH_Drawing_Rect *rect = <span class="hljs-built_in">OH_Drawing_RectCreate</span>(<span class="hljs-number">200</span>, <span class="hljs-number">300</span>, <span class="hljs-number">700</span>, <span class="hljs-number">600</span>);</li><li><span class="hljs-built_in">OH_Drawing_CanvasDrawRect</span>(canvas, rect);</li><li><span class="hljs-comment">// 去除画布中的画刷</span></li><li><span class="hljs-built_in">OH_Drawing_CanvasDetachBrush</span>(canvas);</li><li><span class="hljs-built_in">OH_Drawing_RectDestroy</span>(rect);</li><li><span class="hljs-built_in">OH_Drawing_MatrixDestroy</span>(matrix);</li></ol></pre></div></div>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.7.5.1.3.1.1" valign="top" width="50%">原始图</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.5.1.3.1.2" valign="top" width="50%">平移后的效果图</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%"><span><img originheight="331" originwidth="357" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114401.48448868715858734129978895679078:50001231000000:2800:BF484DEA9C7FE8FE53173F7220E27BC7B6BD01B8DD67C74806606B47978C0482.png" width="357" height="331"></span></td>         <td class="cellrowborder" valign="top" width="50%"><span><img originheight="332" originwidth="370" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114401.42916261395985300061545828321043:50001231000000:2800:455EE97ADF953E37C5FE3A402118888D8868B31EF88A08B7D34682D866778570.png" width="370" height="332"></span></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="旋转">旋转<i class="anchor-icon anchor-icon-link" anchorid="旋转" tips="复制节点链接"></i></h3>          <p>使用OH_Drawing_MatrixCreateRotation()接口实现画布旋转，接口接受3个参数，分别为：旋转角度、旋转中心的x坐标和y坐标。</p>     <p>简单示例和示意图如下所示：</p>     <div _ngcontent-edo-c106="" class="highlight-div"><div _ngcontent-edo-c106="" class="highlight-div-header"><div _ngcontent-edo-c106="" class="highlight-div-header-left"><div _ngcontent-edo-c106="" class="handle-button expand-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edo-c106="" class="highlight-div-header-right"><div _ngcontent-edo-c106="" class="handle-button ai-button"></div><div _ngcontent-edo-c106="" class="handle-button line-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edo-c106="" class="handle-button theme-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edo-c106="" class="handle-button copy-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edo-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 创建画刷对象</span></li><li>OH_Drawing_Brush* brush = <span class="hljs-built_in">OH_Drawing_BrushCreate</span>();</li><li><span class="hljs-comment">// 设置填充颜色</span></li><li><span class="hljs-built_in">OH_Drawing_BrushSetColor</span>(brush, <span class="hljs-built_in">OH_Drawing_ColorSetArgb</span>(<span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>));</li><li><span class="hljs-comment">// 设置画布中的画刷</span></li><li><span class="hljs-built_in">OH_Drawing_CanvasAttachBrush</span>(canvas, brush);</li><li><span class="hljs-comment">// 创建旋转的矩阵对象，三个参数分别是旋转角度和旋转中心坐标</span></li><li>OH_Drawing_Matrix* matrix = <span class="hljs-built_in">OH_Drawing_MatrixCreateRotation</span>(<span class="hljs-number">45</span>, <span class="hljs-number">200</span>, <span class="hljs-number">300</span>);</li><li><span class="hljs-comment">// 对Canvas进行矩阵变换</span></li><li><span class="hljs-built_in">OH_Drawing_CanvasConcatMatrix</span>(canvas, matrix);</li><li><span class="hljs-comment">// 绘制矩形</span></li><li>OH_Drawing_Rect *rect = <span class="hljs-built_in">OH_Drawing_RectCreate</span>(<span class="hljs-number">200</span>, <span class="hljs-number">300</span>, <span class="hljs-number">700</span>, <span class="hljs-number">600</span>);</li><li><span class="hljs-built_in">OH_Drawing_CanvasDrawRect</span>(canvas, rect);</li><li><span class="hljs-comment">// 去除画布中的画刷</span></li><li><span class="hljs-built_in">OH_Drawing_CanvasDetachBrush</span>(canvas);</li><li><span class="hljs-built_in">OH_Drawing_RectDestroy</span>(rect);</li><li><span class="hljs-built_in">OH_Drawing_MatrixDestroy</span>(matrix);</li></ol></pre></div></div>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.5.1.3.1.1" valign="top" width="50%">原始图</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.5.1.3.1.2" valign="top" width="50%">旋转后的效果图</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%"><span><img originheight="287" originwidth="357" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114401.77429096331857599202821861237618:50001231000000:2800:51C9CAFBD9A1AE3AC65A3E637CF861C2435EE475556DBFC197A6963A1835D17A.png" width="357" height="287"></span></td>         <td class="cellrowborder" valign="top" width="50%"><span><img originheight="286" originwidth="364" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114401.37439106401448879315826112130380:50001231000000:2800:08E220BEF557EE129938AB40914C2C204A83530B9704043E0F21C13E617B6654.png" width="364" height="286"></span></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="缩放">缩放<i class="anchor-icon anchor-icon-link" anchorid="缩放" tips="复制节点链接"></i></h3>          <p>使用OH_Drawing_MatrixCreateScale()接口进行画布缩放，接口接受4个参数，分别为沿x轴和y轴的缩放因子、旋转中心的x轴和y轴坐标。</p>     <p>简单示例和示意图如下所示：</p>     <div _ngcontent-edo-c106="" class="highlight-div"><div _ngcontent-edo-c106="" class="highlight-div-header"><div _ngcontent-edo-c106="" class="highlight-div-header-left"><div _ngcontent-edo-c106="" class="handle-button expand-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edo-c106="" class="highlight-div-header-right"><div _ngcontent-edo-c106="" class="handle-button ai-button"></div><div _ngcontent-edo-c106="" class="handle-button line-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edo-c106="" class="handle-button theme-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edo-c106="" class="handle-button copy-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edo-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 创建画刷对象</span></li><li>OH_Drawing_Brush* brush = <span class="hljs-built_in">OH_Drawing_BrushCreate</span>();</li><li><span class="hljs-comment">// 设置填充颜色</span></li><li><span class="hljs-built_in">OH_Drawing_BrushSetColor</span>(brush, <span class="hljs-built_in">OH_Drawing_ColorSetArgb</span>(<span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>));</li><li><span class="hljs-comment">// 设置画布中的画刷</span></li><li><span class="hljs-built_in">OH_Drawing_CanvasAttachBrush</span>(canvas, brush);</li><li><span class="hljs-comment">// 创建缩放的矩阵对象，4个参数分别是旋转中心坐标和水平垂直方向的缩放因子</span></li><li>OH_Drawing_Matrix* matrix = <span class="hljs-built_in">OH_Drawing_MatrixCreateScale</span>(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">200</span>, <span class="hljs-number">300</span>);</li><li><span class="hljs-comment">// 对Canvas进行矩阵变换</span></li><li><span class="hljs-built_in">OH_Drawing_CanvasConcatMatrix</span>(canvas, matrix);</li><li><span class="hljs-comment">// 绘制矩形</span></li><li>OH_Drawing_Rect *rect = <span class="hljs-built_in">OH_Drawing_RectCreate</span>(<span class="hljs-number">200</span>, <span class="hljs-number">300</span>, <span class="hljs-number">700</span>, <span class="hljs-number">600</span>);</li><li><span class="hljs-built_in">OH_Drawing_CanvasDrawRect</span>(canvas, rect);</li><li><span class="hljs-comment">// 去除画布中的画刷</span></li><li><span class="hljs-built_in">OH_Drawing_CanvasDetachBrush</span>(canvas);</li><li><span class="hljs-built_in">OH_Drawing_RectDestroy</span>(rect);</li></ol></pre></div></div>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.5.1.3.1.1" valign="top" width="50%">原始图</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.5.1.3.1.2" valign="top" width="50%">放大后的效果图</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%"><span><img originheight="319" originwidth="360" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114401.21456025689128942195468718632021:50001231000000:2800:E55F58A5F8DB7040C5CC4417CEA2FCD532A856FC806E4A051C6FFE499108DFF6.png" width="360" height="319"></span></td>         <td class="cellrowborder" valign="top" width="50%"><span><img originheight="316" originwidth="364" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114401.12376030833485975901079049624549:50001231000000:2800:1DCD2F74CF04B92C25A8EBB8FF1C726FFCF4964A33CAC75D981B8694464CC5F8.png" width="364" height="316"></span></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="画布状态保存与恢复">画布状态保存与恢复<i class="anchor-icon anchor-icon-link" anchorid="画布状态保存与恢复" tips="复制节点链接"></i></h2>          <p>保存操作用于保存当前画布的状态到一个栈顶，恢复操作用于恢复保存在栈顶的画布状态，恢复操作一旦执行，保存和恢复操作中间一系列平移、缩放、剪裁等操作都会被清除。</p>    </div>    <div class="tiledSection">     <h3 id="接口说明-2" class="firsth2">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明-2" tips="复制节点链接"></i></h3>          <p>画布状态保存与恢复使用的接口如下表所示，详细的使用和参数说明请见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-drawing-canvas-h" target="_blank">drawing_canvas.h</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.11.3.1.3.1.1" valign="top" width="50%">接口</th>         <th align="left" class="cellrowborder" id="mcps1.3.11.3.1.3.1.2" valign="top" width="50%">描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">void OH_Drawing_CanvasSave (OH_Drawing_Canvas *)</td>         <td class="cellrowborder" valign="top" width="50%">用于保存当前画布的状态（画布矩阵）到一个栈顶。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">void OH_Drawing_CanvasRestore (OH_Drawing_Canvas *)</td>         <td class="cellrowborder" valign="top" width="50%">用于恢复保存在栈顶的画布状态（画布矩阵）。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">void OH_Drawing_CanvasRestoreToCount (OH_Drawing_Canvas *, uint32_t saveCount)</td>         <td class="cellrowborder" valign="top" width="50%">用于恢复到指定数量的画布状态（画布矩阵）。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="开发示例-1">开发示例<i class="anchor-icon anchor-icon-link" anchorid="开发示例-1" tips="复制节点链接"></i></h3>          <div _ngcontent-edo-c106="" class="highlight-div"><div _ngcontent-edo-c106="" class="highlight-div-header"><div _ngcontent-edo-c106="" class="highlight-div-header-left"><div _ngcontent-edo-c106="" class="handle-button expand-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-edo-c106="" class="highlight-div-header-right"><div _ngcontent-edo-c106="" class="handle-button ai-button"></div><div _ngcontent-edo-c106="" class="handle-button line-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-edo-c106="" class="handle-button theme-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-edo-c106="" class="handle-button copy-button"><div _ngcontent-edo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-edo-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 创建画笔对象</span></li><li>OH_Drawing_Pen* pen = <span class="hljs-built_in">OH_Drawing_PenCreate</span>();</li><li><span class="hljs-comment">// 设置画笔描边颜色</span></li><li><span class="hljs-built_in">OH_Drawing_PenSetColor</span>(pen, <span class="hljs-built_in">OH_Drawing_ColorSetArgb</span>(<span class="hljs-number">0xFF</span>, <span class="hljs-number">0xFF</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>));</li><li><span class="hljs-comment">// 设置画笔线宽</span></li><li><span class="hljs-built_in">OH_Drawing_PenSetWidth</span>(pen, <span class="hljs-number">20</span>);</li><li><span class="hljs-comment">// 在画布中设置画笔</span></li><li><span class="hljs-built_in">OH_Drawing_CanvasAttachPen</span>(canvas, pen);</li><li><span class="hljs-comment">// 保存当前画布状态，当前是不存在放大等操作的，这个原始状态会被保存下来</span></li><li><span class="hljs-built_in">OH_Drawing_CanvasSave</span>(canvas);</li><li>OH_Drawing_Matrix *matrix = <span class="hljs-built_in">OH_Drawing_MatrixCreateScale</span>(<span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>, <span class="hljs-number">2</span>);</li><li><span class="hljs-comment">// 放大画布</span></li><li><span class="hljs-built_in">OH_Drawing_CanvasConcatMatrix</span>(canvas, matrix);</li><li>OH_Drawing_Point* point = <span class="hljs-built_in">OH_Drawing_PointCreate</span>(<span class="hljs-number">300</span>, <span class="hljs-number">300</span>);</li><li><span class="hljs-comment">// 绘制圆形，因为执行过放大操作，所以此时绘制的是大圆</span></li><li><span class="hljs-built_in">OH_Drawing_CanvasDrawCircle</span>(canvas, point, <span class="hljs-number">200</span>);</li><li><span class="hljs-comment">// 恢复操作，将恢复到没有放大的原始状态</span></li><li><span class="hljs-built_in">OH_Drawing_CanvasRestore</span>(canvas);</li><li><span class="hljs-comment">// 绘制圆形，因为已经恢复没有放大的原始状态，所以此时绘制的小圆</span></li><li><span class="hljs-built_in">OH_Drawing_CanvasDrawCircle</span>(canvas, point, <span class="hljs-number">200</span>);</li><li><span class="hljs-comment">// 去除画布中的画笔</span></li><li><span class="hljs-built_in">OH_Drawing_CanvasDetachPen</span>(canvas);</li><li><span class="hljs-comment">// 销毁画笔对象并收回其占的内存</span></li><li><span class="hljs-built_in">OH_Drawing_PenDestroy</span>(pen);</li><li><span class="hljs-built_in">OH_Drawing_PointDestroy</span>(point);</li><li><span class="hljs-built_in">OH_Drawing_MatrixDestroy</span>(matrix);</li></ol></pre></div></div>     <p><span><img originheight="478" originwidth="503" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114401.97741162400063395547363278162344:50001231000000:2800:7979FCEAC1EB5E20F5619C8C56BE6E0DCED8A1113A2D81560280A2273490B020.png" width="503" height="478"></span></p>    </div>    <div class="tiledSection">     <h2 id="示例代码">示例代码<i class="anchor-icon anchor-icon-link" anchorid="示例代码" tips="复制节点链接"></i></h2>          <ul>      <li><a href="https://gitcode.com/HarmonyOS_Samples/DocsSample_Graphics/tree/master/ArkGraphics2D/Drawing/NDKAPIDrawing" target="_blank">图形绘制（C/C++）</a></li>     </ul>    </div>   </div>   <div></div></div>