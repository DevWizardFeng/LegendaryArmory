<h1 _ngcontent-bqo-c119="" class="doc-title ng-star-inserted" title="短信服务"> 短信服务 </h1>

<div _ngcontent-bqo-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="场景介绍">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="场景介绍" tips="复制节点链接"></i></h2>          <p>短信服务模块提供了管理短信的一些基础能力，包括创建/发送短信、获取/设置发送短信的默认SIM卡槽ID、获取/设置短信服务中心地址，以及检查当前设备是否具备短信发送和接收能力等。</p>     <p>常见的应用场景举例如下：</p>     <ul>      <li>从网页拉起：       <ul>        <li>用户在网页上浏览，看到“发送短信”按钮，点击后会拉起短信应用，预先填写收件人号码、发送内容。</li>       </ul></li>      <li>从应用拉起：       <ul>        <li>移动应用中，用户点击“发送短信”按钮时，应用调用系统功能，拉起短信应用，预先填写收件人号码、发送内容。</li>       </ul></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="基本概念">基本概念<i class="anchor-icon anchor-icon-link" anchorid="基本概念" tips="复制节点链接"></i></h2>          <ul>      <li>       <p>短信服务</p>       <p>即SMS（Short Messaging Service），是一种存储和转发服务。用户的移动电话可以通过它进行相互收发短信，内容以文本、数字或二进制非文本数据为主。发送方的信息通过短信服务中心进行储存并转发给接收方。</p></li>      <li>       <p>短信服务中心</p>       <p>即SMSC（Short Message Service Center），负责在基站和移动设备间中继、储存或转发短消息。移动设备到短信服务中心的协议能传输来自移动设备或朝向移动设备的短消息，协议内容遵从GSM 03.40协议。</p></li>      <li>       <p>协议数据单元</p>       <p>即PDU（Protocol Data Unit），PDU模式收发短信可以使用3种编码：7-bit、8-bit和UCS-2编码。7-bit编码用于发送普通的ASCII字符，8-bit编码通常用于发送数据短信，UCS-2编码用于发送Unicode字符。</p></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="约束与限制">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="约束与限制" tips="复制节点链接"></i></h2>          <ol>      <li>仅支持在标准系统上运行。</li>      <li>需授予发送短信权限且插入SIM卡才可成功发送短信。</li>     </ol>    </div>    <div class="tiledSection">     <h2 id="接口说明">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明" tips="复制节点链接"></i></h2>          <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>为了保证应用的运行效率，大部分API调用都是异步的，对于异步调用的API均提供了callback和Promise两种方式，以下示例采用callback回调方式，其他调用方式请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-sms" target="_blank">API</a>文档。</p>      </div></div></div>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.4.3.1.3.1.1" valign="top" width="50%">接口名</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.3.1.3.1.2" valign="top" width="50%">描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">sendShortMessage(options: SendMessageOptions, callback: AsyncCallback&lt;void&gt;): void</td>         <td class="cellrowborder" valign="top" width="50%">发送文本或数据SMS消息。需要配置ohos.permission.SEND_MESSAGES权限，该权限仅系统应用可申请。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">createMessage(pdu: Array&lt;number&gt;, specification: string, callback: AsyncCallback&lt;ShortMessage&gt;): void</td>         <td class="cellrowborder" valign="top" width="50%">基于协议数据单元（PDU）和指定的SMS协议创建SMS消息实例。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">getDefaultSmsSlotId(callback: AsyncCallback&lt;number&gt;): void</td>         <td class="cellrowborder" valign="top" width="50%">获取用于发送短信的默认SIM卡。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="应用内跳转到短信编辑界面">应用内跳转到短信编辑界面<i class="anchor-icon anchor-icon-link" anchorid="应用内跳转到短信编辑界面" tips="复制节点链接"></i></h2>          <p>发送短信的接口需要系统权限才可调用，三方应用如果有发送短信需求，需要在应用内实现跳转到短信编辑的功能，并且需要携带编辑内容和收件人号码，可以通过调用元能力startAbility接口指定号码并跳转到发送短信页面的方式实现。</p>     <div _ngcontent-bqo-c106="" class="highlight-div"><div _ngcontent-bqo-c106="" class="highlight-div-header"><div _ngcontent-bqo-c106="" class="highlight-div-header-left"><div _ngcontent-bqo-c106="" class="handle-button expand-button"><div _ngcontent-bqo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bqo-c106="" class="highlight-div-header-right"><div _ngcontent-bqo-c106="" class="handle-button ai-button"></div><div _ngcontent-bqo-c106="" class="handle-button line-button"><div _ngcontent-bqo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bqo-c106="" class="handle-button theme-button"><div _ngcontent-bqo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bqo-c106="" class="handle-button copy-button"><div _ngcontent-bqo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bqo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 示例代码</span></li><li><span class="hljs-keyword">import</span> { common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">MMS_BUNDLE_NAME</span> = <span class="hljs-string">"com.ohos.mms"</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">MMS_ABILITY_NAME</span> = <span class="hljs-string">"com.ohos.mms.MainAbility"</span>;</li><li><span class="hljs-keyword">const</span> <span class="hljs-variable constant_">MMS_ENTITIES</span> = <span class="hljs-string">"entity.system.home"</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Contact</span> {</li><li>    <span class="hljs-attr">contactsName</span>: <span class="hljs-built_in">string</span>;</li><li>    <span class="hljs-attr">telephone</span>: <span class="hljs-built_in">number</span>;</li><li>
</li><li>    <span class="hljs-title function_">constructor</span>(<span class="hljs-params">contactsName: <span class="hljs-built_in">string</span>, telephone: <span class="hljs-built_in">number</span></span>) {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">contactsName</span> = contactsName;</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">telephone</span> = telephone;</li><li>    }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">JumpMessage</span> {</li><li>    <span class="hljs-keyword">private</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>
</li><li>    <span class="hljs-title function_">startMMSAbilityExplicit</span>(<span class="hljs-params"></span>) {</li><li>        <span class="hljs-comment">// 这里完善联系人和号码；姓名主要是通过手机号来查询实际联系人名称，因此这种方式还是以手机号码为主。</span></li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">params</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">Object</span>&gt; = [<span class="hljs-keyword">new</span> <span class="hljs-title class_">Contact</span>(<span class="hljs-string">"张三"</span>, 133XXXXXXXX)];</li><li>
</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>            <span class="hljs-attr">bundleName</span>: <span class="hljs-string">"com.ohos.mms"</span>,</li><li>            <span class="hljs-attr">abilityName</span>: <span class="hljs-string">"com.ohos.mms.MainAbility"</span>,</li><li>            <span class="hljs-attr">parameters</span>: {</li><li>                <span class="hljs-attr">contactObjects</span>: <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(params),</li><li>                <span class="hljs-attr">pageFlag</span>: <span class="hljs-string">"conversation"</span>,</li><li>                <span class="hljs-comment">// 这里填写短信内容。</span></li><li>                <span class="hljs-attr">content</span>: <span class="hljs-string">"我是短信具体内容"</span></li><li>            }</li><li>        };</li><li>
</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-title function_">startAbilityForResult</span>(want).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Success"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>        }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"error"</span>);</li><li>        });</li><li>    }</li><li>
</li><li>    <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>        <span class="hljs-title class_">Row</span>() {</li><li>            <span class="hljs-title class_">Column</span>() {</li><li>                <span class="hljs-title class_">Button</span>(<span class="hljs-string">'发送短信'</span>)</li><li>                  .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>                      <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">startMMSAbilityExplicit</span>();</li><li>                  })</li><li>            }</li><li>            .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>        }</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="sms方式跳转到短信编辑界面">sms方式跳转到短信编辑界面<i class="anchor-icon anchor-icon-link" anchorid="sms方式跳转到短信编辑界面" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="使用场景" class="firsth2">使用场景<i class="anchor-icon anchor-icon-link" anchorid="使用场景" tips="复制节点链接"></i></h3>          <p>通过sms短信协议，可以创建指向短信收件人的超链接，方便用户通过网页或应用中的超链接直接跳转到短信应用。同时，支持在sms:的相关字段中定义短信的收件人、发送内容等，节省用户编辑短信的时间。</p>    </div>    <div class="tiledSection">     <h3 id="sms协议格式">sms协议格式<i class="anchor-icon anchor-icon-link" anchorid="sms协议格式" tips="复制节点链接"></i></h3>          <p>sms协议标准格式如下：</p>     <div _ngcontent-bqo-c106="" class="highlight-div"><div _ngcontent-bqo-c106="" class="highlight-div-header"><div _ngcontent-bqo-c106="" class="highlight-div-header-left"><div _ngcontent-bqo-c106="" class="handle-button expand-button"><div _ngcontent-bqo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bqo-c106="" class="highlight-div-header-right"><div _ngcontent-bqo-c106="" class="handle-button ai-button"></div><div _ngcontent-bqo-c106="" class="handle-button line-button"><div _ngcontent-bqo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bqo-c106="" class="handle-button theme-button"><div _ngcontent-bqo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bqo-c106="" class="handle-button copy-button"><div _ngcontent-bqo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bqo-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">sms</span>:<span class="hljs-number">106</span><span class="hljs-title class_">XXXXXXXXXX</span>?<span class="hljs-title class_">body</span>=<span class="hljs-variable">发送短信内容</span></li></ol></pre></div></div>     <ul>      <li>sms:：sms scheme，必填。</li>      <li>106XXXXXXXXXX：收件人号码，选填。如果存在多个地址，用英文逗号分隔。</li>      <li>?：短信内容声明开始符号。如果带短信内容参数，则必填。</li>      <li>body-value：发送内容参数，选填。</li>     </ul>    </div>    <div class="tiledSection">     <h3 id="拉起方开发步骤">拉起方开发步骤<i class="anchor-icon anchor-icon-link" anchorid="拉起方开发步骤" tips="复制节点链接"></i></h3>          <p><strong>从网页拉起</strong></p>     <p>网页中的超链接需要满足sms协议。示例如下：</p>     <div _ngcontent-bqo-c106="" class="highlight-div"><div _ngcontent-bqo-c106="" class="highlight-div-header"><div _ngcontent-bqo-c106="" class="highlight-div-header-left"><div _ngcontent-bqo-c106="" class="handle-button expand-button"><div _ngcontent-bqo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bqo-c106="" class="highlight-div-header-right"><div _ngcontent-bqo-c106="" class="handle-button ai-button"></div><div _ngcontent-bqo-c106="" class="handle-button line-button"><div _ngcontent-bqo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bqo-c106="" class="handle-button theme-button"><div _ngcontent-bqo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bqo-c106="" class="handle-button copy-button"><div _ngcontent-bqo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bqo-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-perl" data-highlighted="yes"><ol class="linenums"><li>&lt;a href=<span class="hljs-string">"sms:106XXXXXXXXXX?body=%E5%8F%91%E9%80%81%E7%9F%AD%E4%BF%A1%E5%86%85%E5%AE%B9"</span>&gt;发送短信&lt;/a&gt;</li></ol></pre></div></div>     <p>实际开发时，需要将收件人号码替换为真实的号码，短信内容可以根据需要进行配置。</p>     <p><strong>从应用拉起</strong></p>     <p>保证sms字符串传入uri参数即可，在应用中page页面可通过 this.getUIContext().getHostContext() 获取context，在ability中可通过this.context获取context。</p>     <div _ngcontent-bqo-c106="" class="highlight-div"><div _ngcontent-bqo-c106="" class="highlight-div-header"><div _ngcontent-bqo-c106="" class="highlight-div-header-left"><div _ngcontent-bqo-c106="" class="handle-button expand-button"><div _ngcontent-bqo-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bqo-c106="" class="highlight-div-header-right"><div _ngcontent-bqo-c106="" class="handle-button ai-button"></div><div _ngcontent-bqo-c106="" class="handle-button line-button"><div _ngcontent-bqo-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bqo-c106="" class="handle-button theme-button"><div _ngcontent-bqo-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bqo-c106="" class="handle-button copy-button"><div _ngcontent-bqo-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bqo-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 示例代码</span></li><li><span class="hljs-keyword">import</span> { common, <span class="hljs-title class_">Want</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'发送短信'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-keyword">let</span> context = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>          <span class="hljs-keyword">let</span> exampleUrl = <span class="hljs-string">"sms:106XXXXXXXXXX?body=%E5%8F%91%E9%80%81%E7%9F%AD%E4%BF%A1%E5%86%85%E5%AE%B9"</span>;</li><li>        </li><li>          <span class="hljs-keyword">let</span> <span class="hljs-attr">want</span>: <span class="hljs-title class_">Want</span> = {</li><li>              <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.ohos.mms'</span>,</li><li>              <span class="hljs-attr">action</span>: <span class="hljs-string">'ohos.want.action.viewData'</span>,</li><li>              <span class="hljs-attr">uri</span>:exampleUrl,</li><li>            }</li><li>        </li><li>          context.<span class="hljs-title function_">startAbility</span>(want).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">data</span>) =&gt;</span> {</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Success"</span> + <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">stringify</span>(data));</li><li>          }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">() =&gt;</span> {</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">"error"</span>);</li><li>          });</li><li>
</li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>