<h1 _ngcontent-tuu-c119="" class="doc-title ng-star-inserted" title="硬件架构抽象"> 硬件架构抽象 </h1>

<div _ngcontent-tuu-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>AscendC基于硬件抽象架构进行编程， 屏蔽不同硬件之间的差异。</p> <div class="fignone" id="zh-cn_topic_0000002119124401__fig1095152043812"><a name="ZH-CN_TOPIC_0000002446152712__zh-cn_topic_0000002119124401__fig1095152043812"></a><a name="zh-cn_topic_0000002119124401__fig1095152043812"></a><span class="figcap"><b>图1 </b>硬件架构抽象</span><br><span><img height="383.04" originheight="619" originwidth="842" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114305.49286360270658814996598944683525:50001231000000:2800:CFC5AED97403012E3F5BFA923B3B623A5AD07E62C760367DEFCDA03CBCB96D5B.png" title="点击放大" width="526.6800000000001"></span></div> <p>AI Core中包含<strong>计算单元、存储单元、搬运单元</strong>等核心组件。</p> <ul><li>计算单元包括了三种基础计算资源：Cube计算单元、Vector计算单元和Scalar计算单元。</li><li>存储单元包括内部存储和外部存储：<ul><li>AI Core的内部存储，统称为Local Memory，对应的数据类型为LocalTensor。由于不同芯片间硬件资源不固定，可以为UB、L1、L0A、L0B等。</li><li>AI Core能够访问的外部存储称之为Global Memory，对应的数据类型为GlobalTensor。</li></ul> </li><li>DMA(Direct Memory Access)搬运单元：负责在Global Memory和Local Memory之间搬运数据。</li></ul> <p>AI Core内部核心组件及组件功能详细说明如下表。</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><caption><b>表1 </b>AI Core内部核心组件</caption><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.6.2.4.1.1" valign="top" width="14.000000000000002%"><p>组件分类</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.2.4.1.2" valign="top" width="24%"><p>组件名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.2.4.1.3" valign="top" width="62%"><p>组件功能</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" rowspan="3" valign="top" width="14.000000000000002%"><p>计算单元</p> </td> <td class="cellrowborder" valign="top" width="24%"><p>Scalar</p> </td> <td class="cellrowborder" valign="top" width="62%"><p>执行地址计算、循环控制等标量计算工作，并把向量计算、矩阵计算、数据搬运、同步指令发射给对应单元执行。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>Vector</p> </td> <td class="cellrowborder" valign="top"><p>负责执行向量运算。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>Cube</p> </td> <td class="cellrowborder" valign="top"><p>负责执行矩阵运算。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="14.000000000000002%"><p>存储单元</p> </td> <td class="cellrowborder" valign="top" width="24%"><p>Local Memory</p> </td> <td class="cellrowborder" valign="top" width="62%"><p>AI Core的内部存储。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="14.000000000000002%"><p>搬运单元</p> </td> <td class="cellrowborder" valign="top" width="24%"><p>DMA(Direct Memory Access)</p> </td> <td class="cellrowborder" valign="top" width="62%"><p>负责在Global Memory和Local Memory之间搬运数据，包含搬运单元MTE2（Memory Transfer Engine，数据搬入单元），MTE3（数据搬出单元）等。</p> </td> </tr>  </tbody></table></div> </div> <p>开发者在理解硬件架构的抽象时，需要重点关注如下<strong>异步指令流、同步信号流</strong>、<strong>计算数据流</strong>三个过程：</p> <ul><li>AI Core内部的异步并行计算过程：Scalar计算单元读取指令序列，并把向量计算、矩阵计算、数据搬运指令发射给对应单元的指令队列，向量计算单元、矩阵计算单元、数据搬运单元异步的并行执行接收到的指令。该过程可以参考<a href="/consumer/cn/doc/harmonyos-guides/cannkit-hardware-architecture-abstraction#zh-cn_topic_0000002119124401__fig1095152043812">图1</a>中蓝色箭头所示的指令流。</li><li>不同的指令间有可能存在依赖关系，为了保证不同指令队列间的指令按照正确的逻辑关系执行，Scalar计算单元也会给对应单元下发同步指令。各单元之间的同步过程可以参考<a href="/consumer/cn/doc/harmonyos-guides/cannkit-hardware-architecture-abstraction#zh-cn_topic_0000002119124401__fig1095152043812">图1</a>中的绿色箭头所示的同步信号流。</li><li>AI Core内部数据处理的基本过程：DMA搬入单元把数据搬运到Local Memory，Vector/Cube计算单元完成数据计算，并把计算结果写回Local Memory，DMA搬出单元把处理好的数据搬运回Global Memory。该过程可以参考<a href="/consumer/cn/doc/harmonyos-guides/cannkit-hardware-architecture-abstraction#zh-cn_topic_0000002119124401__fig1095152043812">图1</a>中的红色箭头所示的数据流。</li></ul> </div> <div></div></div>