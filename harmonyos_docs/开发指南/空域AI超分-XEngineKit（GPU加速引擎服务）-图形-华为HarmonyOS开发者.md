<h1 _ngcontent-loi-c119="" class="doc-title ng-star-inserted" title="空域AI超分"> 空域AI超分 </h1>

<div _ngcontent-loi-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>XEngine Kit提供空域AI超分能力，基于单帧图像使用AI推理生成滤波参数进行超采样，通过GPU、NPU协同工作，实现比空域GPU超分更好的画质，建议超分倍率在1.5倍以下时使用。</p> <div class="tiledSection"><h2 id="section1311530595">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="section1311530595" tips="复制节点链接"></i></h2><ul><li>支持的设备类型：Phone，从5.1.0(18)版本开始新增支持Tablet、PC/2in1、TV设备。</li><li>可通过以下方式查询相关扩展特性是否支持：<p>对于OpenGL ES，使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/xengine-kit-xengine#ga76f9695fa41c6664e949cdba586699c0" target="_blank">HMS_XEG_GetString</a>扩展特性查询接口进行查询，如查询结果包含<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/xengine-kit-xengine#gabfb0310a26f6ad57006c4fb74eb7e226" target="_blank">XEG_NEURAL_UPSCALE_EXTENSION_NAME</a>，则表示支持该特性，若查询结果未包含，则表示不支持该特性。</p> </li></ul> </div> <div class="tiledSection"><h2 id="section1890013261807">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section1890013261807" tips="复制节点链接"></i></h2><p>以下接口为OpenGL ES空域AI超分设置接口，如需使用更丰富的设置和查询接口，具体API说明详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/xengine-kit-xengine" target="_blank">接口文档</a>。</p> </div>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.4.1.3.1.1" valign="top" width="50%"><p>接口名</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.4.1.3.1.2" valign="top" width="50%"><p>描述</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%"><p>const GLubyte * HMS_XEG_GetString (GLenum name)</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>XEngine OpenGL ES扩展特性查询接口。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>GL_APICALL void GL_APIENTRY HMS_XEG_NeuralUpscaleParameter (GLenum pname, GLvoid * param)</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>设置空域AI超分输入参数。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>GL_APICALL void GL_APIENTRY HMS_XEG_RenderNeuralUpscale (GLuint inputTexture)</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>执行空域AI超分渲染命令。</p> </td> </tr>  </tbody></table></div> </div> <div class="tiledSection"><h2 id="section6132437143913">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section6132437143913" tips="复制节点链接"></i></h2></div> <p>本章以OpenGL ES图像API集成为例，说明XEngine集成操作过程。</p> <div class="tiledSection"><h3 id="section121331377397" class="firsth2">配置项目<i class="anchor-icon anchor-icon-link" anchorid="section121331377397" tips="复制节点链接"></i></h3><p>编译HAP时，Native层so编译需要依赖NDK中的libxengine.so。</p> <ul><li>头文件引用<div _ngcontent-loi-c106="" class="highlight-div"><div _ngcontent-loi-c106="" class="highlight-div-header"><div _ngcontent-loi-c106="" class="highlight-div-header-left"><div _ngcontent-loi-c106="" class="handle-button expand-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-loi-c106="" class="highlight-div-header-right"><div _ngcontent-loi-c106="" class="handle-button ai-button"></div><div _ngcontent-loi-c106="" class="handle-button line-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-loi-c106="" class="handle-button theme-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-loi-c106="" class="handle-button copy-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-loi-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstring&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cstdlib&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;EGL/egl.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;EGL/eglext.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;GLES2/gl2.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;GLES2/gl2ext.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;xengine/xeg_gles_extension.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;xengine/xeg_gles_neural_upscale.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;native_buffer/native_buffer.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;native_window/external_window.h&gt;</span></span></li></ol></pre></div></div> </li><li>编写CMakeLists.txt<div class="p">CMakeLists.txt部分示例代码如下，完整示例代码请参见<a href="https://gitcode.com/harmonyos_samples/xengine-samplecode-gles-demo-cpp" target="_blank">Demo（GPU加速引擎-GLES）</a>。<div _ngcontent-loi-c106="" class="highlight-div"><div _ngcontent-loi-c106="" class="highlight-div-header"><div _ngcontent-loi-c106="" class="highlight-div-header-left"><div _ngcontent-loi-c106="" class="handle-button expand-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-loi-c106="" class="highlight-div-header-right"><div _ngcontent-loi-c106="" class="handle-button ai-button"></div><div _ngcontent-loi-c106="" class="handle-button line-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-loi-c106="" class="handle-button theme-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-loi-c106="" class="handle-button copy-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-loi-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">find_library</span>(</li><li>    # Sets the name of the path variable.</li><li>    native-buffer-lib</li><li>    # Specifies the name of the NDK library that you want CMake to locate.</li><li>    native_buffer</li><li>)</li><li><span class="hljs-built_in">find_library</span>(</li><li>    # Sets the name of the path variable.</li><li>    native-window-lib</li><li>    # Specifies the name of the NDK library that you want CMake to locate.</li><li>    native_window</li><li>)</li><li><span class="hljs-built_in">find_library</span>(</li><li>    # Sets the name of the path variable.</li><li>    xengine-lib</li><li>    # Specifies the name of the NDK library that you want CMake to locate.</li><li>    xengine</li><li>)</li><li><span class="hljs-built_in">find_library</span>(</li><li>    # Sets the name of the path variable.</li><li>    EGL-lib</li><li>    # Specifies the name of the NDK library that you want CMake to locate.</li><li>    EGL</li><li>)</li><li><span class="hljs-built_in">find_library</span>(</li><li>    # Sets the name of the path variable.</li><li>    GLES-lib</li><li>    # Specifies the name of the NDK library that you want CMake to locate.</li><li>    GLESv3</li><li>)</li><li>
</li><li><span class="hljs-built_in">target_link_libraries</span>(nativerender PUBLIC</li><li>${EGL-lib} ${GLES-lib} ${xengine-lib} ${native-window-lib} ${native-buffer-lib})</li></ol></pre></div></div> </div> </li></ul> </div> <div class="tiledSection"><h3 id="section16380037114718">集成XEngine空域AI超分（OpenGL ES）<i class="anchor-icon anchor-icon-link" anchorid="section16380037114718" tips="复制节点链接"></i></h3><p>Native层实现使用OpenGL ES和XEngine图形API搭建图像渲染管线并集成空域AI超分，渲染结果通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-components-xcomponent" target="_blank">XComponent</a>组件显示到屏幕。</p> <p>本节阐述OpenGL ES图形API的空域AI超分的使用，详细代码请参见<a href="https://gitcode.com/harmonyos_samples/xengine-samplecode-gles-demo-cpp" target="_blank">Demo（GPU加速引擎-GLES）</a>。</p> <p>在调用XEngine Kit能力前，需要先通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/syscap#判断-api-是否可以使用" target="_blank">Syscap</a>查询您的目标设备是否支持SystemCapability.Graphic.XEngine系统能力。</p> <ol><li><span>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/xengine-kit-xengine#ga76f9695fa41c6664e949cdba586699c0" target="_blank">HMS_XEG_GetString</a>接口，获取XEngine支持的扩展信息，只有在支持<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/xengine-kit-xengine#gabfb0310a26f6ad57006c4fb74eb7e226" target="_blank">XEG_NEURAL_UPSCALE_EXTENSION_NAME</a>扩展时才可以使用空域AI超分的相关接口。</span><p></p><div _ngcontent-loi-c106="" class="highlight-div"><div _ngcontent-loi-c106="" class="highlight-div-header"><div _ngcontent-loi-c106="" class="highlight-div-header-left"><div _ngcontent-loi-c106="" class="handle-button expand-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-loi-c106="" class="highlight-div-header-right"><div _ngcontent-loi-c106="" class="handle-button ai-button"></div><div _ngcontent-loi-c106="" class="handle-button line-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-loi-c106="" class="handle-button theme-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-loi-c106="" class="handle-button copy-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-loi-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 查询XEngine支持的GLES扩展信息</span></li><li><span class="hljs-type">const</span> <span class="hljs-type">char</span>* extensions = (<span class="hljs-type">const</span> <span class="hljs-type">char</span>*)<span class="hljs-built_in">HMS_XEG_GetString</span>(XEG_EXTENSIONS);</li><li><span class="hljs-comment">// 检查是否支持空域AI超分</span></li><li><span class="hljs-keyword">if</span> (!<span class="hljs-built_in">strstr</span>(extensions, XEG_NEURAL_UPSCALE_EXTENSION_NAME)) {</li><li>    <span class="hljs-built_in">exit</span>(<span class="hljs-number">1</span>); <span class="hljs-comment">// return error</span></li><li>}</li></ol></pre></div></div> <p></p></li><li><span>创建输入纹理，并关联一个OH_NativeBuffer。</span><p></p><div _ngcontent-loi-c106="" class="highlight-div"><div _ngcontent-loi-c106="" class="highlight-div-header"><div _ngcontent-loi-c106="" class="highlight-div-header-left"><div _ngcontent-loi-c106="" class="handle-button expand-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-loi-c106="" class="highlight-div-header-right"><div _ngcontent-loi-c106="" class="handle-button ai-button"></div><div _ngcontent-loi-c106="" class="handle-button line-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-loi-c106="" class="handle-button theme-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-loi-c106="" class="handle-button copy-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-loi-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-comment">// 渲染宽高和送显宽高均为用户自定义参数，这里以将800*600的分辨率进行1.5倍超分到1200*900的分辨率为例</span></span></li><li><span class=""><span class="hljs-type">uint32_t</span> renderWidth = <span class="hljs-number">800</span>;</span></li><li><span class=""><span class="hljs-type">uint32_t</span> renderHeight = <span class="hljs-number">600</span>;</span></li><li><span class=""><span class="hljs-type">uint32_t</span> displayWidth = <span class="hljs-number">1200</span>;</span></li><li><span class=""><span class="hljs-type">uint32_t</span> displayHeight = <span class="hljs-number">900</span>;</span></li><li><span class="hljs-comment">// 获取函数指针</span></li><li>PFNEGLCREATEIMAGEKHRPROC fp_eglCreateImageKHR = <span class="hljs-built_in">reinterpret_cast</span>&lt;PFNEGLCREATEIMAGEKHRPROC&gt;(<span class="hljs-built_in">eglGetProcAddress</span>(<span class="hljs-string">"eglCreateImageKHR"</span>));</li><li>PFNEGLDESTROYIMAGEKHRPROC fp_eglDestroyImageKHR = <span class="hljs-built_in">reinterpret_cast</span>&lt;PFNEGLDESTROYIMAGEKHRPROC&gt;(<span class="hljs-built_in">eglGetProcAddress</span>(<span class="hljs-string">"eglDestroyImageKHR"</span>));</li><li>PFNGLEGLIMAGETARGETTEXTURE2DOESPROC fp_glEGLImageTargetTexture2DOES = <span class="hljs-built_in">reinterpret_cast</span>&lt;PFNGLEGLIMAGETARGETTEXTURE2DOESPROC&gt;(<span class="hljs-built_in">eglGetProcAddress</span>(<span class="hljs-string">"glEGLImageTargetTexture2DOES"</span>));</li><li><span class="hljs-comment">// 创建OH_NativeBuffer</span></li><li>OH_NativeBuffer_Config config = {};</li><li>config<span class="">.</span>width <span class="">=</span> renderWidth<span class="">;</span></li><li>config<span class="">.</span>height <span class="">=</span> renderHeight<span class="">;</span></li><li>config.usage = NATIVEBUFFER_USAGE_CPU_READ | NATIVEBUFFER_USAGE_CPU_READ_OFTEN | NATIVEBUFFER_USAGE_HW_TEXTURE | NATIVEBUFFER_USAGE_HW_RENDER| NATIVEBUFFER_USAGE_ALIGNMENT_512;</li><li>config<span class="">.</span>format <span class="">=</span> NATIVEBUFFER_PIXEL_FMT_RGBA_8888<span class="">;</span></li><li>OH_NativeBuffer<span class="">*</span> bufferHandle <span class="">=</span> <span class="hljs-built_in">OH_NativeBuffer_Alloc</span><span class="">(</span><span class="">&amp;</span>config<span class="">);</span></li><li><span class="hljs-keyword">if</span> <span class="">(</span>bufferHandle <span class="">==</span> <span class="hljs-literal">nullptr</span><span class="">)</span> <span class="">{</span></li><li>    <span class="hljs-comment">// 创建失败，用户可自定义错误处理</span></li><li><span class="">}</span></li><li>OHNativeWindowBuffer <span class="">*</span>nativeWindowBuffer <span class="">=</span> <span class="hljs-built_in">OH_NativeWindow_CreateNativeWindowBufferFromNativeBuffer</span><span class="">(</span>bufferHandle<span class="">);</span></li><li>EGLImageKHR eglImage = <span class="hljs-built_in">fp_eglCreateImageKHR</span>(<span class="hljs-built_in">eglGetCurrentDisplay</span>(), EGL_NO_CONTEXT, EGL_NATIVE_BUFFER_OHOS, <span class="hljs-built_in">static_cast</span>&lt;EGLClientBuffer&gt;(nativeWindowBuffer), <span class="hljs-literal">nullptr</span><span class="">);</span></li><li><span class="hljs-comment">// 创建超分输入纹理</span></li><li>GLuint textureID<span class="">;</span> </li><li><span class="hljs-built_in">glGenTextures</span>(<span class="hljs-number">1</span>, &amp;textureID)<span class="">;</span></li><li><span class="hljs-built_in">glBindTexture</span>(GL_TEXTURE_2D<span class="">,</span> textureID<span class="">);</span></li><li><span class="hljs-comment">// 设置纹理环绕和过滤参数</span></li><li><span class="hljs-built_in">glTexParameteri</span><span class="">(</span>GL_TEXTURE_2D<span class="">,</span> GL_TEXTURE_WRAP_S<span class="">,</span> GL_REPEAT<span class="">);</span></li><li><span class="hljs-built_in">glTexParameteri</span><span class="">(</span>GL_TEXTURE_2D<span class="">,</span> GL_TEXTURE_WRAP_T<span class="">,</span> GL_REPEAT<span class="">);</span></li><li><span class="hljs-built_in">glTexParameteri</span><span class="">(</span>GL_TEXTURE_2D<span class="">,</span> GL_TEXTURE_MIN_FILTER<span class="">,</span> GL_NEAREST<span class="">);</span></li><li><span class="hljs-built_in">glTexParameteri</span><span class="">(</span>GL_TEXTURE_2D<span class="">,</span> GL_TEXTURE_MAG_FILTER<span class="">,</span> GL_NEAREST<span class="">);</span></li><li><span class="hljs-comment">// 关联超分输入纹理和eglImage</span></li><li><span class="hljs-built_in">fp_glEGLImageTargetTexture2DOES</span>(GL_TEXTURE_2D, eglImage);</li></ol></pre></div></div> <p></p></li><li><span>在超分输入纹理上进行渲染。</span><p></p><div _ngcontent-loi-c106="" class="highlight-div"><div _ngcontent-loi-c106="" class="highlight-div-header"><div _ngcontent-loi-c106="" class="highlight-div-header-left"><div _ngcontent-loi-c106="" class="handle-button expand-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-loi-c106="" class="highlight-div-header-right"><div _ngcontent-loi-c106="" class="handle-button ai-button"></div><div _ngcontent-loi-c106="" class="handle-button line-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-loi-c106="" class="handle-button theme-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-loi-c106="" class="handle-button copy-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-loi-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li>GLuint fboID = <span class="hljs-number">0</span>;</li><li><span class="hljs-built_in">glGenFramebuffers</span>(<span class="hljs-number">1</span>, &amp;fboID);</li><li><span class="hljs-built_in">glBindFramebuffer</span>(GL_FRAMEBUFFER, fboID);</li><li><span class="hljs-built_in">glFramebufferTexture2D</span>(GL_FRAMEBUFFER, GL_COLOR_ATTACHMENT0, GL_TEXTURE_2D, textureID, <span class="hljs-number">0</span>);</li><li><span class="hljs-keyword">if</span> (<span class="hljs-built_in">glCheckFramebufferStatus</span>(GL_FRAMEBUFFER) != GL_FRAMEBUFFER_COMPLETE) {</li><li>    <span class="hljs-comment">// 创建framebuffer失败，用户可自定义错误处理</span></li><li>}</li><li><span class="hljs-built_in">glViewport</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, renderWidth, renderHeight);</li></ol></pre></div></div> <p></p></li><li><span>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/xengine-kit-xengine#ga2be7ef2eeb3593dacbee27a18b437f03" target="_blank">HMS_XEG_NeuralUpscaleParameter</a>接口，设置空域AI超分的输入参数。</span><p></p><div _ngcontent-loi-c106="" class="highlight-div"><div _ngcontent-loi-c106="" class="highlight-div-header"><div _ngcontent-loi-c106="" class="highlight-div-header-left"><div _ngcontent-loi-c106="" class="handle-button expand-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-loi-c106="" class="highlight-div-header-right"><div _ngcontent-loi-c106="" class="handle-button ai-button"></div><div _ngcontent-loi-c106="" class="handle-button line-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-loi-c106="" class="handle-button theme-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-loi-c106="" class="handle-button copy-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-loi-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// sharpness为用户自定义超分锐化参数，此处以参数为0.3f为例</span></li><li><span class="hljs-type">float</span> sharpness = <span class="hljs-number">0.3f</span>;</li><li><span class="hljs-built_in">HMS_XEG_NeuralUpscaleParameter</span>(XEG_NEURAL_UPSCALE_SHARPNESS, &amp;sharpness);</li><li><span class="hljs-comment">// inputScissor为超分输入纹理的裁剪窗口参数</span></li><li>GLuint inputScissor[<span class="hljs-number">4</span>] = {<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, renderWidth, renderHeight};</li><li><span class="hljs-built_in">HMS_XEG_NeuralUpscaleParameter</span>(XEG_NEURAL_UPSCALE_SCISSOR, inputScissor);</li><li><span class="hljs-comment">// 设置超分输入纹理对应的OH_NativeBuffer句柄</span></li><li><span class="hljs-built_in">HMS_XEG_NeuralUpscaleParameter</span>(XEG_NEURAL_UPSCALE_INPUT_HANDLE, bufferHandle);</li></ol></pre></div></div> <p></p></li><li><span>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/xengine-kit-xengine#ga4116ee476cb0e0c3a3897f89d9c48d09" target="_blank">HMS_XEG_RenderNeuralUpscale</a>接口执行空域AI超分。</span><p></p><div _ngcontent-loi-c106="" class="highlight-div"><div _ngcontent-loi-c106="" class="highlight-div-header"><div _ngcontent-loi-c106="" class="highlight-div-header-left"><div _ngcontent-loi-c106="" class="handle-button expand-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-loi-c106="" class="highlight-div-header-right"><div _ngcontent-loi-c106="" class="handle-button ai-button"></div><div _ngcontent-loi-c106="" class="handle-button line-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-loi-c106="" class="handle-button theme-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-loi-c106="" class="handle-button copy-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-loi-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 绑定绘制超分结果的帧缓冲，此处使用默认帧缓冲，也可使用用户自定义帧缓冲</span></li><li><span class="hljs-built_in">glBindFramebuffer</span>(GL_FRAMEBUFFER, <span class="hljs-number">0</span>);</li><li><span class="hljs-built_in">glViewport</span>(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, displayWidth, displayHeight);</li><li><span class="hljs-comment">// 执行空域AI超分</span></li><li><span class="hljs-built_in">HMS_XEG_RenderNeuralUpscale</span>(textureID);</li></ol></pre></div></div> <p></p></li><li><span>不需要进行超分渲染时，销毁相关资源。</span><p></p><div _ngcontent-loi-c106="" class="highlight-div"><div _ngcontent-loi-c106="" class="highlight-div-header"><div _ngcontent-loi-c106="" class="highlight-div-header-left"><div _ngcontent-loi-c106="" class="handle-button expand-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-loi-c106="" class="highlight-div-header-right"><div _ngcontent-loi-c106="" class="handle-button ai-button"></div><div _ngcontent-loi-c106="" class="handle-button line-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-loi-c106="" class="handle-button theme-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-loi-c106="" class="handle-button copy-button"><div _ngcontent-loi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-loi-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">glDeleteFramebuffers</span>(<span class="hljs-number">1</span>, &amp;fboID);</li><li><span class="hljs-built_in">glDeleteTextures</span>(<span class="hljs-number">1</span>, &amp;textureID);</li><li><span class="hljs-keyword">if</span> (eglImage != <span class="hljs-literal">nullptr</span>) {</li><li>   <span class="hljs-built_in">fp_eglDestroyImageKHR</span>(<span class="hljs-built_in">eglGetCurrentDisplay</span>(), eglImage);</li><li>}</li><li><span class="hljs-keyword">if</span> (nativeWindowBuffer != <span class="hljs-literal">nullptr</span>) {</li><li>   <span class="hljs-built_in">OH_NativeWindow_DestroyNativeWindowBuffer</span>(nativeWindowBuffer);</li><li>}</li><li><span class="hljs-keyword">if</span> (bufferHandle != <span class="hljs-literal">nullptr</span>) {</li><li>   <span class="hljs-built_in">OH_NativeBuffer_Unreference</span>(bufferHandle);</li><li>}</li></ol></pre></div></div> <p></p></li></ol> </div> </div> <div></div></div>