<h1 _ngcontent-wot-c119="" class="doc-title ng-star-inserted" title="签名/验签介绍及算法规格"> 签名/验签介绍及算法规格 </h1>

<div _ngcontent-wot-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>为实现数据完整性保护和防抵赖，可使用生成/导入的密钥，对数据进行签名验签操作。</p>    <div class="tiledSection">     <h2 id="支持的算法">支持的算法<i class="anchor-icon anchor-icon-link" anchorid="支持的算法" tips="复制节点链接"></i></h2>          <p>以下为密钥签名/验签支持的规格说明。</p>     <p><strong>手机、平板、PC/2in1设备、TV、智能穿戴规格</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.2.4.1.4.1.1" valign="top" width="33.33333333333333%">算法/摘要算法/填充模式</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.4.1.4.1.2" valign="top" width="33.33333333333333%">备注</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.4.1.4.1.3" valign="top" width="33.33333333333333%">API级别</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">          <p>RSA/SHA256/PKCS1_V1_5</p>          <p>RSA/SHA384/PKCS1_V1_5</p>          <p>RSA/SHA512/PKCS1_V1_5</p>          <p>RSA/SHA256/PSS</p>          <p>RSA/SHA384/PSS</p>          <p>RSA/SHA512/PSS</p></td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">对于PSS模式，salt长度支持设置为摘要长度和最大长度（最大长度=密钥长度-摘要长度-2），对应枚举值详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-huks#huksrsapsssaltlentype10" target="_blank">HuksRsaPssSaltLenType</a>。</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">8+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA/NoDigest/PKCS1_V1_5</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">NoDigest需要指定TAG HuksKeyDigest.HUKS_DIGEST_NONE。由业务对明文做哈希，再将哈希后的数据传入，哈希后的数据长度必须满足RSA签名验签支持的摘要算法规格。</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA/NoDigest/NoPadding</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">NoDigest需要指定TAG HuksKeyDigest.HUKS_DIGEST_NONE。明文长度必须等于密钥长度。</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">20+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">          <p>ECC/SHA256</p>          <p>ECC/SHA384</p>          <p>ECC/SHA512</p></td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">          <p>签名是ASN1格式。</p>          <p>ECC算法支持的椭圆曲线函数包括：P-256、P-384、P-521。</p></td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">8+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">ED25519/NoDigest</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">NoDigest需要指定TAG HuksKeyDigest.HUKS_DIGEST_NONE。</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">8+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">SM2/SM3</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">签名是ASN1格式。</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">9+</td>        </tr>             </tbody></table></div>     </div>     <p><strong>轻量级智能穿戴规格</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.2.6.1.4.1.1" valign="top" width="33.33333333333333%">算法/摘要算法/填充模式</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.6.1.4.1.2" valign="top" width="33.33333333333333%">备注</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.6.1.4.1.3" valign="top" width="33.33333333333333%">API级别</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA/SHA256/PKCS1_V1_5</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">-</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">12+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA/SHA256/PSS</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">-</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">12+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA/SHA1/ISO_IEC_9796_2</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">数据最小长度=密钥长度-21字节</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">12+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA/NoDigest/NoPadding</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">NoDigest需要指定TAG HuksKeyDigest.HUKS_DIGEST_NONE。明文长度必须等于密钥长度。</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">20+</td>        </tr>             </tbody></table></div>     </div>     <p><strong>智能穿戴设备规格</strong></p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.2.8.1.4.1.1" valign="top" width="33.33333333333333%">算法/摘要算法/填充模式</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.8.1.4.1.2" valign="top" width="33.33333333333333%">备注</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.8.1.4.1.3" valign="top" width="33.33333333333333%">API级别</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA/SHA1/ISO_IEC_9796_2</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">只支持密钥长度1024~2048（含1024和2048，且必须是8的整数倍），数据最小长度=密钥长度-21字节。</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">16+</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="携带认证信息的签名类型">携带认证信息的签名类型<i class="anchor-icon anchor-icon-link" anchorid="携带认证信息的签名类型" tips="复制节点链接"></i></h2>          <p>适用场景：当使用含有数字盾密码认证的密钥进行签名时，可以选择携带认证信息的签名类型，会在原始数据之前附加41字节认证信息后，再进行签名操作。认证信息会附加在签名前一起返回。验签时需将同样认证信息附加在原始数据前，再执行验签操作。从前到后依次为：</p>     <p>认证信息格式：4字节的版本号、4字节的用户认证类型、32字节的匿名化AuthId和1字节的是否校验数据哈希。</p>     <p>注意事项：AuthId包含匿名化处理过的身份信息，使用该接口时，开发者需在其隐私政策中对此匿名化数据的使用目的、存留策略和销毁方式进行说明。</p>     <p>使用方法：在签名的参数集中加上参数HUKS_TAG_KEY_SECURE_SIGN_TYPE，此参数的值请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-huks#hukssecuresigntype9" target="_blank">HuksSecureSignType</a>。</p>    </div>   </div>   <div></div></div>