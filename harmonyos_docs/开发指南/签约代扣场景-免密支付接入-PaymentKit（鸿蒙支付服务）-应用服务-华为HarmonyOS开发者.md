<h1 _ngcontent-dul-c119="" class="doc-title ng-star-inserted" title="签约代扣场景"> 签约代扣场景 </h1>

<div _ngcontent-dul-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section1880231055910">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section1880231055910" tips="复制节点链接"></i></h2>          <p>从4.1.0(11)版本开始，新增支持签约代扣场景。</p>     <p><span style="color: rgb(38,38,38);">用户在商户APP应用/元服务开通会员一段时间后，想要每个月自动续费而不用自己每个月都重新开通，商户可提供自动续费选项，用户主动选择开启，商户通过请求预签约接口发起签约，待签约生效后，商家可以按照协议中的时间，会员到期后直接发起免密代扣请求完成扣款续费，无需用户每个月都进行开通会员操作。</span></p>     <p>支持商户模型：直连商户、平台类商户、服务商</p>     <p>华为支付签约页面展示：</p>     <div class="tablenoborder">      <div class="tbBox"><table style="border-style: none;" class="layoutFixed idpTab">               <tbody><tr>         <td align="center" class="nocellnorowborder" style="border: none;" valign="top" width="33.5%">          <p><span><img height="425.6" originheight="1026" originwidth="494" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114559.16980853139464260918739643853701:50001231000000:2800:4A4AA1ADA6DDF9637F62F3F41E6AE6277BF838BD79432C41351D1E61842E6627.png" title="点击放大" width="204.91310000000001"></span></p></td>         <td align="center" class="nocellnorowborder" style="border: none;" valign="top" width="33.5%">          <p><span><img height="425.6" originheight="1026" originwidth="494" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114559.79288153749762421415445523833830:50001231000000:2800:372EE39221B75B92C2DE6F9424CE41B97E617C088C282D37F97345EF4E729FEC.png" title="点击放大" width="204.91310000000001"></span></p></td>         <td class="cell-norowborder" style="border: none;" valign="top" width="33%">&nbsp;&nbsp;</td>        </tr>        <tr>         <td align="center" class="row-nocellborder" style="border: none;" valign="top" width="33.5%">          <p>签约确认页面</p></td>         <td align="center" class="row-nocellborder" style="border: none;" valign="top" width="33.5%">          <p>签约结果展示页面</p></td>         <td class="cellrowborder" style="border: none;" valign="top" width="33%">&nbsp;&nbsp;</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section1818915573916">业务流程<i class="anchor-icon anchor-icon-link" anchorid="section1818915573916" tips="复制节点链接"></i></h2>          <p>开发者通过接入Payment Kit 签约代扣能力，在获取用户签约授权的前提下，可以向用户的华为支付账户发起支付扣款，无需用户输入支付密码就可以优先使用签约的支付方式完成扣款。具体接入流程如下：</p>     <p><span><img originheight="624" originwidth="856" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114559.25910330034430677938908780420208:50001231000000:2800:6E7CDAC9FDB8542E7366DDFBD2FF3680033EF09E4B539E04979CCCD6C3F87DD4.png" width="856" height="624"></span></p>     <ol>      <li>商户客户端请求商户服务端创建签约订单。</li>      <li>商户服务端按照商户模型调用Payment Kit服务端<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-withhold-presign" target="_blank">直连商户预签约</a>或<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-partner-withhold-presign" target="_blank">服务商预签约</a>接口。</li>      <li>Payment Kit服务端返回预签约号（preSignNo）给商户服务端。</li>      <li>商户服务端构建<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section01944104716" target="_blank">contractStr</a>参数返回给商户客户端。</li>      <li>商户客户端通过contractStr调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-paymentservice#section176908331459" target="_blank">requestContract</a>接口拉起Payment Kit签约收银台。</li>      <li>Payment Kit客户端通过签约收银台展示签约相关信息。</li>      <li>用户在Payment Kit客户端签约收银台完成签约操作。</li>      <li>Payment Kit服务端处理签约。</li>      <li>Payment Kit服务端受理签约成功后返回签约结果信息给Payment Kit客户端。</li>      <li>Payment Kit客户端展示签约结果页。</li>      <li>用户关闭签约结果页后Payment Kit客户端会返回商户客户端。</li>      <li>签约完成后Payment Kit服务器会调用商户服务端调用预签约接口时传递的回调接口返回签约结果信息给商户服务器。</li>      <li>商户服务器收到签约结果回调响应后，使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-rest-overview#section17670192215175" target="_blank">SM2验签方式</a>对签约结果进行验签。</li>      <li>签约完成后，商户服务器后续可以调用Payment Kit服务端<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-withhold-apply" target="_blank">直连商户申请免密代扣</a>/<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-partner-withhold-apply" target="_blank">服务商申请免密代扣</a>接口来完成扣款服务。</li>      <li>商户服务器调用Payment Kit服务端申请免密代扣接口后，Payment Kit服务端同步返回代扣申请结果。</li>      <li>Payment Kit服务端处理代扣扣款成功后，会调用商户服务器请求代扣接口时传递回调接口返回扣款结果信息给商户服务器。</li>      <li>商户服务器收到扣款结果回调响应后，使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-rest-overview#section17670192215175" target="_blank">SM2验签方式</a>对扣款结果进行验签。</li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section5906121818412">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section5906121818412" tips="复制节点链接"></i></h2>          <p>接口返回值有两种返回形式：Promise和AsyncCallback。Promise和AsyncCallback只是返回方式不一样，功能相同。具体API说明详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-paymentservice" target="_blank">接口文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.1" valign="top" width="50%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.2" valign="top" width="50%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">          <p>requestContract(context: common.UIAbilityContext, contractStr: string): Promise&lt;void&gt;；</p></td>         <td class="cellrowborder" rowspan="2" valign="top" width="50%">          <p>拉起Payment Kit签约收银台。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top">          <p>requestContract(context: common.UIAbilityContext, contractStr: string, callback: AsyncCallback&lt;void&gt;): void;</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section5117133402914">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section5117133402914" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="section9187179113620" class="firsth2">预签约（服务器开发）<i class="anchor-icon anchor-icon-link" anchorid="section9187179113620" tips="复制节点链接"></i></h3>          <ol>      <li>开发者按照商户模型调用预<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-withhold-presign" target="_blank">直连商户预签约</a>或<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-partner-withhold-presign" target="_blank">服务商预签约</a>接口获取preSignNo构建签约信息参数<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section01944104716" target="_blank">contractStr</a>。       <p>为保证支付订单的安全性和可靠性需要对请求body和请求头PayMercAuth对象内的入参排序拼接进行签名。可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-rest-overview#section174821258151218" target="_blank">签名规则</a>。</p>       <p>以下为开放API接口请求及<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section01944104716" target="_blank">contractStr</a>构建<a href="https://gitcode.com/HarmonyOS_Samples/paymentkit-sample-code-serverdemo-java" target="_blank">示例代码</a>片段：</p>       <div _ngcontent-dul-c106="" class="highlight-div"><div _ngcontent-dul-c106="" class="highlight-div-header"><div _ngcontent-dul-c106="" class="highlight-div-header-left"><div _ngcontent-dul-c106="" class="handle-button expand-button"><div _ngcontent-dul-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dul-c106="" class="highlight-div-header-right"><div _ngcontent-dul-c106="" class="handle-button ai-button"></div><div _ngcontent-dul-c106="" class="handle-button line-button"><div _ngcontent-dul-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dul-c106="" class="handle-button theme-button"><div _ngcontent-dul-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dul-c106="" class="handle-button copy-button"><div _ngcontent-dul-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dul-c106="" class="highlight-scroll-div"><pre class="java prettyprint linenums hljs language-java" hw-language="java" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-keyword">import</span> </span>com.huawei.petalpay.paymentservice.apiservice.client.model.BaseGwRspWithSign;</li><li><span class=""><span class="hljs-keyword">import</span> </span>com.huawei.petalpay.paymentservice.apiservice.client.model.PreSignRequestV2;</li><li><span class=""><span class="hljs-keyword">import</span> </span>com.huawei.petalpay.paymentservice.apiservice.client.model.PreSignResponse;</li><li><span class=""><span class="hljs-keyword">import</span> </span>com.huawei.petalpay.paymentservice.core.client.DefaultPetalPayClient;</li><li><span class=""><span class="hljs-keyword">import</span> </span>com.huawei.petalpay.paymentservice.core.client.PetalPayClient;</li><li><span class=""><span class="hljs-keyword">import</span> </span>com.huawei.petalpay.paymentservice.example.common.CommonResponse;</li><li><span class=""><span class="hljs-keyword">import</span> </span>com.huawei.petalpay.paymentservice.example.common.MercConfigUtil;</li><li>
</li><li><span class=""><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> </span><span class="hljs-title class_">MercApiController</span> {</li><li>    <span class=""><span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> </span><span class="hljs-type">PetalPayClient</span> <span class=""><span class="hljs-variable">payClient</span> </span><span class="hljs-operator">=</span> <span class=""><span class="hljs-keyword">new</span> </span><span class="hljs-title class_">DefaultPetalPayClient</span>(MercConfigUtil.getMercConfig());</li><li>    <span class=""><span class="hljs-comment">/**</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">     * </span></span><span class=""><span class="hljs-comment">预签约接口调用</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment">     </span><span class=""><span class="hljs-comment">*/</span></span></li><li>    <span class=""><span class="hljs-keyword">public</span> </span>CommonResponse <span class=""><span class="hljs-title function_">contractPreSignAppV2</span></span><span class="hljs-params">()</span> {</li><li>        <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">组装对象</span></span></li><li>        <span class="hljs-type">PreSignRequestV2</span> <span class="hljs-variable">preSignReq</span> <span class="hljs-operator">=</span> getPreSignRequestV2();</li><li>        <span class="hljs-type">PreSignResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> <span class=""><span class="hljs-literal">null</span></span>;</li><li>        <span class=""><span class="hljs-keyword">try</span> </span>{</li><li>            response = <span class="">payClient</span>.execute(<span class=""><span class="hljs-string">"POST"</span></span>, <span class=""><span class="hljs-string">"/api/v2/contract/presign/app"</span></span>, PreSignResponse.<span class="">class</span>, preSignReq);</li><li>        } <span class=""><span class="hljs-keyword">catch</span> </span>(Exception e) {</li><li>            <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">todo </span></span><span class=""><span class="hljs-comment">异常处理</span></span></li><li>            <span class="">log</span>.error(<span class=""><span class="hljs-string">"request error "</span></span>, e);</li><li>            <span class=""><span class="hljs-keyword">return</span> </span>CommonResponse.buildErrorRsp(e.getMessage());</li><li>        }</li><li>        <span class=""><span class="hljs-keyword">if</span> </span>(!validResponse(response)) {</li><li>            <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">todo </span></span><span class=""><span class="hljs-comment">异常处理</span></span></li><li>            <span class="">log</span>.error(<span class=""><span class="hljs-string">"response is invalid "</span></span>, response);</li><li>            <span class=""><span class="hljs-keyword">return</span> </span>CommonResponse.buildFailRsp(response);</li><li>        }</li><li>        <span class=""><span class="hljs-keyword">return</span> </span>CommonResponse.buildSuccessRsp(<span class="">payClient</span>.buildContractStr(response.getPreSignNo()));</li><li>    }</li><li>    <span class=""><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-type">boolean</span> </span><span class=""><span class="hljs-title function_">validResponse</span></span><span class="hljs-params">(BaseGwRspWithSign rsp)</span> {</li><li>        <span class=""><span class="hljs-keyword">return</span> </span>rsp != <span class=""><span class="hljs-literal">null</span> </span>&amp;&amp; <span class=""><span class="hljs-string">"000000"</span></span>.equals(rsp.getResultCode());</li><li>    }</li><li>    <span class=""><span class="hljs-comment">/**</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment"></span><span class=""><span class="hljs-comment">     * </span></span><span class=""><span class="hljs-comment">预签约接口请求参数组装，商户请根据业务自行实现</span></span><span class="hljs-comment"></span></li><li><span class="hljs-comment">     </span><span class=""><span class="hljs-comment">*/</span></span></li><li>    <span class=""><span class="hljs-keyword">private</span> </span>PreSignRequestV2 <span class=""><span class="hljs-title function_">getPreSignRequestV2</span></span><span class="hljs-params">()</span> {</li><li>        <span class=""><span class="hljs-keyword">return</span> </span>PreSignRequestV2.builder().appId(MercConfigUtil.<span class="">APP_ID</span>) <span class=""><span class="hljs-comment">// appId</span></span><span class=""><span class="hljs-comment">，需要配置为与商户绑定的正确的</span></span><span class=""><span class="hljs-comment">appId</span></span></li><li>            .mercContractCode(<span class=""><span class="hljs-string">"pay-example-"</span> </span>+ System.currentTimeMillis()) <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">签约协议号，每次请求都要变，请将</span></span><span class=""><span class="hljs-comment">pay-example-</span></span><span class=""><span class="hljs-comment">修改为商户自己的订单前缀</span></span></li><li>            .mercNo(MercConfigUtil.<span class="">MERC_NO</span>) <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">商户号</span></span></li><li>            .planId(<span class=""><span class="hljs-string">"100"</span></span>) <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">协议模板</span></span><span class=""><span class="hljs-comment">ID</span></span><span class=""><span class="hljs-comment">，该模板</span></span><span class=""><span class="hljs-comment">ID</span></span><span class=""><span class="hljs-comment">是商户在向华为支付提交代扣权限申请时由华为支付生成。请填写正确的协议模板</span></span><span class=""><span class="hljs-comment">ID</span></span><span class=""><span class="hljs-comment">。</span></span></li><li>            .callbackUrl(<span class=""><span class="hljs-string">"https://www.xxxxxx.com/hw/sign/callback"</span></span>) <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">回调通知地址，通知</span></span><span class=""><span class="hljs-comment">URL</span></span><span class=""><span class="hljs-comment">必须为直接可访问的</span></span><span class=""><span class="hljs-comment">URL</span></span><span class=""><span class="hljs-comment">，要求为</span></span><span class=""><span class="hljs-comment">https</span></span><span class=""><span class="hljs-comment">地址。最大长度为</span></span><span class=""><span class="hljs-comment">512</span></span><span class=""><span class="hljs-comment">。请替换为格式正确的结果通知回调地址。</span></span></li><li>            .build();</li><li>    }</li><li>}</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h3 id="section19371156173617">拉起华为支付签约收银台（端侧开发）<i class="anchor-icon anchor-icon-link" anchorid="section19371156173617" tips="复制节点链接"></i></h3>          <p>商户客户端使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-model#section01944104716" target="_blank">contractStr</a>作为参数调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-paymentservice#section176908331459" target="_blank">requestContract</a>接口拉起Payment Kit签约收银台。</p>     <p>当接口通过.then()方法返回时，则表示当前订单支付成功，通过.catch()方法返回表示订单支付失败。当此次请求有异常时，可通过<strong>error.code</strong>获取错误码，错误码相关信息请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-error-code" target="_blank">错误码</a>。示例代码如下：</p>     <div _ngcontent-dul-c106="" class="highlight-div"><div _ngcontent-dul-c106="" class="highlight-div-header"><div _ngcontent-dul-c106="" class="highlight-div-header-left"><div _ngcontent-dul-c106="" class="handle-button expand-button"><div _ngcontent-dul-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dul-c106="" class="highlight-div-header-right"><div _ngcontent-dul-c106="" class="handle-button ai-button"></div><div _ngcontent-dul-c106="" class="handle-button line-button"><div _ngcontent-dul-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dul-c106="" class="handle-button theme-button"><div _ngcontent-dul-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dul-c106="" class="handle-button copy-button"><div _ngcontent-dul-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dul-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { paymentService } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PaymentKit'</span>;</li><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li>  <span class="hljs-title function_">requestContractPromise</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// use your own contractStr </span></li><li>    <span class="hljs-keyword">const</span> contractStr = <span class="hljs-string">'{"appId":"***","preSignNo":"***"}'</span>;</li><li>    paymentService.<span class="hljs-title function_">requestContract</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>, contractStr)</li><li>      .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-comment">// succeeded in signing</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'succeeded in signing'</span>);</li><li>      })</li><li>      .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-comment">// failed to sign</span></li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`failed to sign, error.code: <span class="hljs-subst">${error.code}</span>, error.message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>      });</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'requestContractPromise'</span>)</li><li>        .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'50%'</span>)</li><li>        .<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">requestContractPromise</span>();</li><li>        })</li><li>      }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ul>        <li>如果用户没有提前登录，系统会自动拉起华为账号登录页面让用户登录。</li>        <li>签约成功，不建议以客户端返回作为用户的签约结果，需以服务器接收到的结果通知或者查询API返回为准。</li>       </ul>      </div></div></div>    </div>    <div class="tiledSection">     <h3 id="section6767324125513">签约结果回调通知（服务器开发）<i class="anchor-icon anchor-icon-link" anchorid="section6767324125513" tips="复制节点链接"></i></h3>          <p>支付成功后华为支付服务器会调用开发者提供的回调接口，将签约信息返回给开发者服务器，回调详细信息按商户模式请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-withhold-sign-notify" target="_blank">签约结果回调通知</a>。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>回调接口是开发者调用预签约时的入参字段callbackUrl或签约模板配置的回调地址。</p>      </div></div></div>     <p>为保证信息合法性，商户服务器需要对返回的支付信息进行<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-rest-overview#section17670192215175" target="_blank">SM2验签</a>，验签注意事项：</p>     <ol>      <li>需直接使用通知的完整内容进行验签。</li>      <li>验签前需要对返回数据进行排序拼接，sign字段是签名值，排序拼接后的待验签内容需要排除sign字段。</li>      <li>验签公钥使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/payment-certificates-config#section14253153941510">华为支付证书</a>。</li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section2207214587">延伸和拓展<i class="anchor-icon anchor-icon-link" anchorid="section2207214587" tips="复制节点链接"></i></h2>          <p>当开发者完成上述能力之后还可以调用以下API接口完成订单相关操作。</p>    </div>    <div class="tiledSection">     <h3 id="section1786313431519" class="firsth2">直连商户<i class="anchor-icon anchor-icon-link" anchorid="section1786313431519" tips="复制节点链接"></i></h3>          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-withhold-apply" target="_blank">申请免密代扣</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-sign-query" target="_blank">查询签约订单</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-withhold-query" target="_blank">查询代扣订单</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-withhold-unsign" target="_blank">申请解约</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-withhold-refunds" target="_blank">申请退款</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-withhold-query-refunds" target="_blank">查询退款订单</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-query-trade-bill" target="_blank">查询对账单</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-query-settle-bill" target="_blank">查询结算账单</a>。</p>    </div>    <div class="tiledSection">     <h3 id="section5784111717610">服务商<i class="anchor-icon anchor-icon-link" anchorid="section5784111717610" tips="复制节点链接"></i></h3>          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-partner-withhold-apply" target="_blank">申请免密代扣</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-partner-sign-query" target="_blank">查询签约订单</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-partner-withhold-query" target="_blank">查询代扣订单</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-partner-withhold-unsign" target="_blank">申请解约</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-partner-withhold-refunds" target="_blank">申请退款</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-partner-withhold-query-refunds" target="_blank">查询退款订单</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-partner-agent-query-trade-bill" target="_blank">查询对账单</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/payment-partner-agent-query-settle-bill" target="_blank">查询结算账单</a>。</p>    </div>   </div>   <div></div></div>