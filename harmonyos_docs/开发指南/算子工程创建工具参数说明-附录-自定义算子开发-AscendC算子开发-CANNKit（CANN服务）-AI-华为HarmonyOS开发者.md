<h1 _ngcontent-hju-c119="" class="doc-title ng-star-inserted" title="算子工程创建工具参数说明"> 算子工程创建工具参数说明 </h1>

<div _ngcontent-hju-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section330714515306">工具概述<i class="anchor-icon anchor-icon-link" anchorid="section330714515306" tips="复制节点链接"></i></h2><p>完成算子分析和原型定义后，可使用msOpGen工具生成自定义算子工程，并进行编译部署。</p> </div> <div class="tiledSection"><h2 id="section2675165215384">命令汇总<i class="anchor-icon anchor-icon-link" anchorid="section2675165215384" tips="复制节点链接"></i></h2><p>执行如下命令，参数说明请参见表1。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>开发者按照输入的配置参数生成算子模板后，建议在运行前确认算子工程代码的安全性。</p> </div></div></div> <div _ngcontent-hju-c106="" class="highlight-div"><div _ngcontent-hju-c106="" class="highlight-div-header"><div _ngcontent-hju-c106="" class="highlight-div-header-left"><div _ngcontent-hju-c106="" class="handle-button expand-button"><div _ngcontent-hju-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hju-c106="" class="highlight-div-header-right"><div _ngcontent-hju-c106="" class="handle-button ai-button"></div><div _ngcontent-hju-c106="" class="handle-button line-button"><div _ngcontent-hju-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hju-c106="" class="handle-button theme-button"><div _ngcontent-hju-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hju-c106="" class="handle-button copy-button"><div _ngcontent-hju-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hju-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li>msopgen gen -i {*.json} -f {framework type} -c {Compute Resource} -lan cpp -out {Output Path}</li></ol></pre></div></div>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><caption><b>表1 </b>创建算子工程参数说明</caption><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.2.5.2.4.1.1" valign="top" width="17.191719171917192%"><p>参数名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.5.2.4.1.2" valign="top" width="74.91749174917491%"><p>参数描述</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.5.2.4.1.3" valign="top" width="7.890789078907891%"><p>是否必选</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="17.191719171917192%"><p>gen</p> </td> <td class="cellrowborder" valign="top" width="74.91749174917491%"><p>用于生成算子开发交付件。</p> </td> <td class="cellrowborder" valign="top" width="7.890789078907891%"><p>是</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="17.191719171917192%"><p>-i，--input</p> </td> <td class="cellrowborder" valign="top" width="74.91749174917491%"><p>算子原型定义文件（.json）路径，可配置为绝对路径或者相对路径。工具执行开发者需要有此路径的可读权限。</p> </td> <td class="cellrowborder" valign="top" width="7.890789078907891%"><p>是</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="17.191719171917192%"><p>-f，--framework</p> </td> <td class="cellrowborder" valign="top" width="74.91749174917491%"><p>框架类型。</p> <ul><li>默认为TensorFlow框架，默认值：tf或者tensorflow</li><li>ONNX框架，参数值：onnx</li></ul> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>所有参数值大小写不敏感。</p> </div></div></div> </td> <td class="cellrowborder" valign="top" width="7.890789078907891%"><p>否</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="17.191719171917192%"><p>-c，--compute_unit</p> </td> <td class="cellrowborder" valign="top" width="74.91749174917491%"><ul><li>算子使用的计算资源。<p>配置格式为：ai_core-<em>{soc version}</em>，ai_core与<em>{soc version}</em>之间用中划线“-”连接。</p> <p>请根据实际Kirin AI处理器版本进行选择。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>AI处理器的型号<em>&lt;soc_version&gt;</em>请通过在运行环境上通过命令行获取：</p> <p>hdc -t {target} shell param get ohos.boot.chiptype。</p> <p>target：设备的SN码，可以通过hdc list targets获取当前环境上所有设备的SN码。</p> <p>当前支持的AI处理器型号为Kirin9020/KirinX90。</p> </div></div></div> </li></ul> </td> <td class="cellrowborder" valign="top" width="7.890789078907891%"><p>是</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="17.191719171917192%"><p>-out，--output</p> </td> <td class="cellrowborder" valign="top" width="74.91749174917491%"><p>生成文件所在路径，可配置为绝对路径或者相对路径，并且工具执行开发者具有可读写权限。</p> <p>若不配置，则默认生成在执行命令的当前路径。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>若开发者指定的输出目录中存在与模板工程重名的文件，输出目录中的文件将会被模板工程的文件覆盖。</p> </div></div></div> </td> <td class="cellrowborder" valign="top" width="7.890789078907891%"><p>否</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="17.191719171917192%"><p>-m，--mode</p> </td> <td class="cellrowborder" valign="top" width="74.91749174917491%"><p>生成交付件模式。</p> <ul><li>0：创建新的算子工程，若指定的路径下已存在算子工程，则会报错退出。</li><li>1：在已有的算子工程中追加算子。</li></ul> <p>默认值：0。</p> </td> <td class="cellrowborder" valign="top" width="7.890789078907891%"><p>否</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="17.191719171917192%"><p>-op，--operator</p> </td> <td class="cellrowborder" valign="top" width="74.91749174917491%"><p>配置算子的类型，如：Conv2DTik。</p> <p>若不配置此参数，当算子原型定义文件中存在多个算子时，工具会提示开发者选择算子。</p> </td> <td class="cellrowborder" valign="top" width="7.890789078907891%"><p>否</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="17.191719171917192%"><p>-lan，--language</p> </td> <td class="cellrowborder" valign="top" width="74.91749174917491%"><p>算子编码语言。</p> <ul><li>cpp：基于AscendC编程框架，使用C/C++编程语言进行开发。</li></ul> <p>默认值：cpp。</p> </td> <td class="cellrowborder" valign="top" width="7.890789078907891%"><p>否</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="17.191719171917192%"><p>-h，--help</p> </td> <td class="cellrowborder" valign="top" width="74.91749174917491%"><p>输出帮助信息。</p> </td> <td class="cellrowborder" valign="top" width="7.890789078907891%"><p>否</p> </td> </tr>  </tbody></table></div> </div>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><caption><b>表2 </b>json文件配置参数说明</caption><thead><tr><th align="left" class="cellrowborder" colspan="2" id="mcps1.3.2.6.2.6.1.1" valign="top"><p>配置字段</p> <p></p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.6.2.6.1.2" valign="top"><p>类型</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.6.2.6.1.3" valign="top"><p>含义</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.6.2.6.1.4" valign="top"><p>是否必选</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="12.21%"><p>op</p> </td> <td class="cellrowborder" valign="top" width="12.86%"><p>-</p> </td> <td class="cellrowborder" valign="top" width="8.83%"><p>string</p> </td> <td class="cellrowborder" valign="top" width="59.150000000000006%"><p>算子的Operator Type。</p> </td> <td class="cellrowborder" valign="top" width="6.950000000000001%"><p>是</p> </td> </tr> <tr><td class="cellrowborder" rowspan="5" valign="top" width="12.21%"><p>input_desc</p> </td> <td class="cellrowborder" valign="top" width="12.86%"><p>-</p> </td> <td class="cellrowborder" valign="top" width="8.83%"><p>list</p> </td> <td class="cellrowborder" valign="top" width="59.150000000000006%"><p>输入参数描述。</p> </td> <td class="cellrowborder" rowspan="5" valign="top" width="6.950000000000001%"><p>否</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>name</p> </td> <td class="cellrowborder" valign="top"><p>string</p> </td> <td class="cellrowborder" valign="top"><p>算子输入参数的名称。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>param_type</p> </td> <td class="cellrowborder" valign="top"><p>string</p> </td> <td class="cellrowborder" valign="top"><p>参数类型：</p> <ul><li>required</li><li>optional</li><li>dynamic</li></ul> <p>未配置默认为required。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>format</p> </td> <td class="cellrowborder" valign="top"><p>list</p> </td> <td class="cellrowborder" valign="top"><p>针对类型为tensor的参数，配置为tensor支持的数据排布格式。</p> <p>包含如下取值：</p> <p>ND、NHWC、NCHW、HWCN、NC1HWC0、FRACTAL_Z等。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>format与type需一一对应。若仅填充其中一项的唯一值，msOpGen工具将会以未填充项的唯一输入值为准自动补充至已填充项的长度。例如开发者配置为format:["ND"] /type:["fp16","float","int32"]，msOpGen工具将会以format的唯一输入值（"ND"）为准自动补充至type参数的长度，自动补充后的配置为format:["ND","ND","ND"]/type:["fp16","float","int32"]。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>type</p> </td> <td class="cellrowborder" valign="top"><p>list</p> </td> <td class="cellrowborder" valign="top"><p>算子参数的类型。</p> <p>取值范围：float、half、float16 (fp16)、float32 (fp32)、int8、int16、int32、int64、uint8、uint16、uint32、uint64、qint8、qint16、qint32、quint8、quint16、bool、double、string、resource、complex64、complex128、bf16、numbertype、realnumbertype、quantizedtype、all、BasicType、IndexNumberType等。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>Kirin9020与KirinX90暂不支持float类型作为输入。</p> </div></div></div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul><li>不同计算操作支持的数据类型不同，详细请参见。</li><li>format与type需一一对应。若仅填充其中一项的唯一值，msOpGen工具将会以未填充项的唯一输入值为准自动补充至已填充项的长度。例如开发者配置为format:["ND"] /type:["fp16","float","int32"]，msOpGen工具将会以format的唯一输入值（"ND"）为准自动补充至type参数的长度，自动补充后的配置为format:["ND","ND","ND"]/type:["fp16","float","int32"]。</li></ul> </div></div></div> </td> </tr> <tr><td class="cellrowborder" rowspan="5" valign="top" width="12.21%"><p>output_desc</p> </td> <td class="cellrowborder" valign="top" width="12.86%"><p>-</p> </td> <td class="cellrowborder" valign="top" width="8.83%"><p>list</p> </td> <td class="cellrowborder" valign="top" width="59.150000000000006%"><p>输入参数描述。</p> </td> <td class="cellrowborder" rowspan="5" valign="top" width="6.950000000000001%"><p>是</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>name</p> </td> <td class="cellrowborder" valign="top"><p>string</p> </td> <td class="cellrowborder" valign="top"><p>算子输入参数的名称。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>param_type</p> </td> <td class="cellrowborder" valign="top"><p>string</p> </td> <td class="cellrowborder" valign="top"><p>参数类型：</p> <ul><li>required</li><li>optional</li><li>dynamic</li></ul> <p>未配置默认为required。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>format</p> </td> <td class="cellrowborder" valign="top"><p>list</p> </td> <td class="cellrowborder" valign="top"><p>针对类型为tensor的参数，配置为tensor支持的数据排布格式。</p> <p>包含如下取值：</p> <p>ND、NHWC、NCHW、HWCN、NC1HWC0、FRACTAL_Z等。</p> <p>说明</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>format与type需一一对应。若仅填充其中一项的唯一值，msOpGen工具将会以未填充项的唯一输入值为准自动补充至已填充项的长度。例如开发者配置为format:["ND"] /type:["fp16","float","int32"]，msOpGen工具将会以format的唯一输入值（"ND"）为准自动补充至type参数的长度，自动补充后的配置为format:["ND","ND","ND"]/type:["fp16","float","int32"]。</p> </div></div></div> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>type</p> </td> <td class="cellrowborder" valign="top"><p>list</p> </td> <td class="cellrowborder" valign="top"><p>算子参数的类型。</p> <p>取值范围：float、half、float16 (fp16)、float32 (fp32)、int8、int16、int32、int64、uint8、uint16、uint32、uint64、qint8、qint16、qint32、quint8、quint16、bool、double、string、resource、complex64、complex128、bf16、numbertype、realnumbertype、quantizedtype、all、BasicType、IndexNumberType等。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>Kirin9020与KirinX90暂不支持float类型作为输入。</p> </div></div></div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul><li>不同计算操作支持的数据类型不同，详细请参见。</li><li>format与type需一一对应。若仅填充其中一项的唯一值，msOpGen工具将会以未填充项的唯一输入值为准自动补充至已填充项的长度。例如开发者配置为format:["ND"] /type:["fp16","float","int32"]，msOpGen工具将会以format的唯一输入值（"ND"）为准自动补充至type参数的长度，自动补充后的配置为format:["ND","ND","ND"]/type:["fp16","float","int32"]。</li></ul> </div></div></div> </td> </tr> <tr><td class="cellrowborder" rowspan="5" valign="top" width="12.21%"><p>attr</p> </td> <td class="cellrowborder" valign="top" width="12.86%"><p>-</p> </td> <td class="cellrowborder" valign="top" width="8.83%"><p>list</p> </td> <td class="cellrowborder" valign="top" width="59.150000000000006%"><p>属性描述。</p> </td> <td class="cellrowborder" rowspan="5" valign="top" width="6.950000000000001%"><p>否</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>name</p> </td> <td class="cellrowborder" valign="top"><p>string</p> </td> <td class="cellrowborder" valign="top"><p>算子属性参数的名称。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>param_type</p> </td> <td class="cellrowborder" valign="top"><p>string</p> </td> <td class="cellrowborder" valign="top"><p>参数类型：</p> <ul><li>required</li><li>optional</li></ul> <p>未配置默认为required。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>type</p> </td> <td class="cellrowborder" valign="top"><p>string</p> </td> <td class="cellrowborder" valign="top"><p>算子参数的类型。</p> <p>包含如下取值：</p> <p>int、bool、float、string、list_int、list_float、list_bool，其他请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-opattrdef">OpAttrDef</a>进行修改。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>default_value</p> </td> <td class="cellrowborder" valign="top"><p>-</p> </td> <td class="cellrowborder" valign="top"><p>默认值。</p> </td> </tr>  </tbody></table></div> </div> </div> <p></p> </div> <div></div></div>