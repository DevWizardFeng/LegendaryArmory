<h1 _ngcontent-dnr-c119="" class="doc-title ng-star-inserted" title="算子工程编译"> 算子工程编译 </h1>

<div _ngcontent-dnr-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>算子kernel侧和host侧实现开发完成后，需要对算子工程进行编译，将自定义算子部署到omg工具中，详细的编译操作包括：</p> <ul><li>编译AscendC算子kernel侧代码实现文件*.cpp，分为源码发布和二进制发布两种方式。<ul><li><strong>源码发布：</strong>不对算子kernel侧实现进行编译，保留算子kernel源码文件*.cpp。该方式可以支持模型的离线编译场景。</li><li><strong>二进制发布：</strong>对算子kernel侧实现进行编译，生成描述算子相关信息的json文件*.json和算子二进制文件*.o。算子调用时，如果需要直接调用算子二进制，则使用该编译方式，当前暂不支持该方式进行部署。</li></ul> </li><li>编译AscendC算子host侧代码实现文件*.cpp、*.h。<ul><li>将原型定义和shape推导实现编译成算子原型定义动态库libcustom_op.so，并生成算子原型对外接口op_proto.h。</li><li>将算子信息库定义编译成信息库定义文件*.json。</li></ul> </li></ul> <p>上述编译过程示意图如下。</p> <div class="fignone"><span class="figcap"><b>图1 </b>算子工程编译示意图</span></div> <p><span><img originheight="442" originwidth="773" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114310.77603702145104197927930497959234:50001231000000:2800:161F4A99E0E8F5CC7D686D617F2A6E0A984D3882AA6F86F2690F56A04812649A.png" width="773" height="442"></span></p> <div class="tiledSection"><h2 id="section4742mcpsimp">编译步骤<i class="anchor-icon anchor-icon-link" anchorid="section4742mcpsimp" tips="复制节点链接"></i></h2><ol><li><span>完成工程编译相关配置。</span><p></p><div class="p">修改工程目录下的<strong>CMakePresets.json </strong>cacheVariables的配置项。<strong>CMakePresets.json</strong>文件内容如下。<div _ngcontent-dnr-c106="" class="highlight-div"><div _ngcontent-dnr-c106="" class="highlight-div-header"><div _ngcontent-dnr-c106="" class="highlight-div-header-left"><div _ngcontent-dnr-c106="" class="handle-button expand-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dnr-c106="" class="highlight-div-header-right"><div _ngcontent-dnr-c106="" class="handle-button ai-button"></div><div _ngcontent-dnr-c106="" class="handle-button line-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dnr-c106="" class="handle-button theme-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dnr-c106="" class="handle-button copy-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dnr-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>    <span class="hljs-attr">"version"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"cmakeMinimumRequired"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"major"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"minor"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">19</span><span class="hljs-punctuation">,</span></li><li>        <span class="hljs-attr">"patch"</span><span class="hljs-punctuation">:</span> <span class="hljs-number">0</span></li><li>    <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-attr">"configurePresets"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>        <span class="hljs-punctuation">{</span></li><li>            <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"default"</span><span class="hljs-punctuation">,</span></li><li>            <span class="hljs-attr">"displayName"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Default Config"</span><span class="hljs-punctuation">,</span></li><li>            <span class="hljs-attr">"description"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Default build using Unix Makefiles generator"</span><span class="hljs-punctuation">,</span></li><li>            <span class="hljs-attr">"generator"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Unix Makefiles"</span><span class="hljs-punctuation">,</span></li><li>            <span class="hljs-attr">"binaryDir"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"${sourceDir}/build_out"</span><span class="hljs-punctuation">,</span></li><li>            <span class="hljs-attr">"cacheVariables"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>                <span class="hljs-attr">"CMAKE_BUILD_TYPE"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>                    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"STRING"</span><span class="hljs-punctuation">,</span></li><li>                    <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Release"</span></li><li>                <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>                <span class="hljs-attr">"ASCEND_COMPUTE_UNIT"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>                    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"STRING"</span><span class="hljs-punctuation">,</span></li><li>                    <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"kirin9020"</span></li><li>                <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>                <span class="hljs-attr">"vendor_name"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>                    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"STRING"</span><span class="hljs-punctuation">,</span></li><li>                    <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"customize"</span></li><li>                <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>                <span class="hljs-attr">"ASCEND_PYTHON_EXECUTABLE"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>                    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"STRING"</span><span class="hljs-punctuation">,</span></li><li>                    <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"python3"</span></li><li>                <span class="hljs-punctuation">}</span><span class="hljs-punctuation">,</span></li><li>                <span class="hljs-attr">"CMAKE_INSTALL_PREFIX"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>                    <span class="hljs-attr">"type"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"PATH"</span><span class="hljs-punctuation">,</span></li><li>                    <span class="hljs-attr">"value"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"${sourceDir}/build_out"</span></li><li>                <span class="hljs-punctuation">}</span></li><li>            <span class="hljs-punctuation">}</span></li><li>        <span class="hljs-punctuation">}</span></li><li>    <span class="hljs-punctuation">]</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div> </div>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><caption><b>表1 </b>需要开发者配置的常用参数列表</caption><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.6.2.1.2.2.2.4.1.1" valign="top" width="28.999999999999996%"><p>参数名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.2.1.2.2.2.4.1.2" valign="top" width="41%"><p>参数描述</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.2.1.2.2.2.4.1.3" valign="top" width="30%"><p>默认值</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="28.999999999999996%"><p>CMAKE_BUILD_TYPE</p> </td> <td class="cellrowborder" valign="top" width="41%"><p>编译模式选项，可配置为：</p> <ul><li>“Release”，Release版本，不包含调试信息，编译最终发布的版本。</li><li>“Debug”，“Debug”版本，包含调试信息，便于开发者开发和调试。</li></ul> </td> <td class="cellrowborder" valign="top" width="30%"><p>Release</p> </td> </tr>  </tbody></table></div> </div> <p></p></li><li><span>在算子工程目录下执行如下命令，进行算子工程编译。</span><p></p><div _ngcontent-dnr-c106="" class="highlight-div"><div _ngcontent-dnr-c106="" class="highlight-div-header"><div _ngcontent-dnr-c106="" class="highlight-div-header-left"><div _ngcontent-dnr-c106="" class="handle-button expand-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dnr-c106="" class="highlight-div-header-right"><div _ngcontent-dnr-c106="" class="handle-button ai-button"></div><div _ngcontent-dnr-c106="" class="handle-button line-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dnr-c106="" class="handle-button theme-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dnr-c106="" class="handle-button copy-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dnr-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-bash" data-highlighted="yes"><ol class="linenums"><li><strong class="shell">./build.sh</strong></li></ol></pre></div></div> <p>编译成功后，会在当前目录下创建build_out目录，并将build_out目录下生成的自定义算子交付件安装到tools_omg中。</p> <p>如果想单独编译算子kernel，可以在算子工程下执行如下命令：</p> <div _ngcontent-dnr-c106="" class="highlight-div"><div _ngcontent-dnr-c106="" class="highlight-div-header"><div _ngcontent-dnr-c106="" class="highlight-div-header-left"><div _ngcontent-dnr-c106="" class="handle-button expand-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dnr-c106="" class="highlight-div-header-right"><div _ngcontent-dnr-c106="" class="handle-button ai-button"></div><div _ngcontent-dnr-c106="" class="handle-button line-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dnr-c106="" class="handle-button theme-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dnr-c106="" class="handle-button copy-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dnr-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-bash" data-highlighted="yes"><ol class="linenums"><li><strong>./build_devices.sh</strong></li></ol></pre></div></div> <p>开发者如果需要该编译过程日志存盘，可以使用环境变量ASCENDC_BUILD_LOG_DIR来控制存储路径。</p> <div _ngcontent-dnr-c106="" class="highlight-div"><div _ngcontent-dnr-c106="" class="highlight-div-header"><div _ngcontent-dnr-c106="" class="highlight-div-header-left"><div _ngcontent-dnr-c106="" class="handle-button expand-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dnr-c106="" class="highlight-div-header-right"><div _ngcontent-dnr-c106="" class="handle-button ai-button"></div><div _ngcontent-dnr-c106="" class="handle-button line-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dnr-c106="" class="handle-button theme-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dnr-c106="" class="handle-button copy-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dnr-c106="" class="highlight-scroll-div"><pre class="shell prettyprint linenums hljs language-shell" hw-language="shell" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta prompt_"># </span><span class="language-bash">如希望编译日志存储在/home/build_log/，则可以按照如下设置，默认不打开日志存储</span> </li><li>export ASCENDC_BUILD_LOG_DIR=/home/build_log/</li></ol></pre></div></div> <p></p></li></ol> </div> <div class="tiledSection"><h2 id="section4830mcpsimp">支持自定义编译选项<i class="anchor-icon anchor-icon-link" anchorid="section4830mcpsimp" tips="复制节点链接"></i></h2><p>在算子工程中，如果开发者想对算子kernel侧代码增加一些自定义的编译选项，可以参考如下内容进行编译选项的定制。</p> <p>修改算子工程op_kernel目录下的CMakeLists.txt，使用add_ops_compile_options来增加编译选项，方法如下。</p> <div _ngcontent-dnr-c106="" class="highlight-div"><div _ngcontent-dnr-c106="" class="highlight-div-header"><div _ngcontent-dnr-c106="" class="highlight-div-header-left"><div _ngcontent-dnr-c106="" class="handle-button expand-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dnr-c106="" class="highlight-div-header-right"><div _ngcontent-dnr-c106="" class="handle-button ai-button"></div><div _ngcontent-dnr-c106="" class="handle-button line-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dnr-c106="" class="handle-button theme-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dnr-c106="" class="handle-button copy-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dnr-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">add_ops_compile_options</span>(<em>OpType </em>COMPUTE_UNIT<em> soc_version1</em> <em>soc_version2</em> ... OPTIONS <em>option1 option2</em> ...)</li></ol></pre></div></div>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><caption><b>表2 </b>具体参数介绍</caption><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.7.5.2.4.1.1" valign="top" width="33%"><p>参数名称</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.5.2.4.1.2" valign="top" width="13%"><p>可选/必选</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.7.5.2.4.1.3" valign="top" width="54%"><p>参数描述</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="33%"><p>OpType（算子类型）</p> </td> <td class="cellrowborder" valign="top" width="13%"><p>必选</p> </td> <td class="cellrowborder" valign="top" width="54%"><p>第一个参数应传入算子类型，如果需要对算子工程中的所有算子生效，需要配置为ALL。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="33%"><p>COMPUTE_UNIT</p> </td> <td class="cellrowborder" valign="top" width="13%"><p>可选</p> </td> <td class="cellrowborder" valign="top" width="54%"><p>标识编译选项在哪些AI处理器型号上生效，多个型号之间通过空格间隔。不配置时表示对所有AI处理器型号生效。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>COMPUTE_UNIT具体配置如下。</p> <ul><li>kirin9020</li><li>kirinx90</li></ul> </div></div></div> </td> </tr> <tr><td class="cellrowborder" valign="top" width="33%"><p>OPTIONS</p> </td> <td class="cellrowborder" valign="top" width="13%"><p>必选</p> </td> <td class="cellrowborder" valign="top" width="54%"><p>自定义的编译选项。多个编译选项之间通过空格间隔。</p> <ul><li>增加-D编译选项，用于在编译时定义宏。<div _ngcontent-dnr-c106="" class="highlight-div"><div _ngcontent-dnr-c106="" class="highlight-div-header"><div _ngcontent-dnr-c106="" class="highlight-div-header-left"><div _ngcontent-dnr-c106="" class="handle-button expand-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dnr-c106="" class="highlight-div-header-right"><div _ngcontent-dnr-c106="" class="handle-button ai-button"></div><div _ngcontent-dnr-c106="" class="handle-button line-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dnr-c106="" class="handle-button theme-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dnr-c106="" class="handle-button copy-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dnr-c106="" class="highlight-scroll-div"><pre class="cmake prettyprint linenums hljs language-undefined" hw-language="cmake" data-highlighted="yes"><ol class="linenums"><li>OPTIONS -Dname=definition</li></ol></pre></div></div> </li></ul> <ul><li>增加-g -O0等调试用编译选项。</li><li>增加AscendC框架提供的调试用编译选项-DASCENDC_DUMP、-DASCENDC_DEBUG<ul><li>-DASCENDC_DUMP用于控制Dump开关，默认开关打开，开发者调用printf/DumpTensor/assert后会有信息打印；设置为0后，表示开关关闭。<div _ngcontent-dnr-c106="" class="highlight-div"><div _ngcontent-dnr-c106="" class="highlight-div-header"><div _ngcontent-dnr-c106="" class="highlight-div-header-left"><div _ngcontent-dnr-c106="" class="handle-button expand-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dnr-c106="" class="highlight-div-header-right"><div _ngcontent-dnr-c106="" class="handle-button ai-button"></div><div _ngcontent-dnr-c106="" class="handle-button line-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dnr-c106="" class="handle-button theme-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dnr-c106="" class="handle-button copy-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dnr-c106="" class="highlight-scroll-div"><pre class="cmake prettyprint linenums hljs language-undefined" hw-language="cmake" data-highlighted="yes"><ol class="linenums"><li>OPTIONS -DASCENDC_DUMP=0</li></ol></pre></div></div> </li></ul> <ul><li>-DASCENDC_DEBUG用于控制AscendC API的调测开关，默认开关关闭；增加该编译选项后，表示开关打开，此时接口内部的assert校验生效，校验不通过会有assert日志打屏。开启该功能会对算子实际运行的性能带来一定影响，通常在调测阶段使用。<div _ngcontent-dnr-c106="" class="highlight-div"><div _ngcontent-dnr-c106="" class="highlight-div-header"><div _ngcontent-dnr-c106="" class="highlight-div-header-left"><div _ngcontent-dnr-c106="" class="handle-button expand-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dnr-c106="" class="highlight-div-header-right"><div _ngcontent-dnr-c106="" class="handle-button ai-button"></div><div _ngcontent-dnr-c106="" class="handle-button line-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dnr-c106="" class="handle-button theme-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dnr-c106="" class="handle-button copy-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dnr-c106="" class="highlight-scroll-div"><pre class="cmake prettyprint linenums hljs language-undefined" hw-language="cmake" data-highlighted="yes"><ol class="linenums"><li>OPTIONS -DASCENDC_DEBUG</li></ol></pre></div></div> <p>当前-DASCENDC_DEBUG功能支持的产品型号为：Kirin9020/KirinX90。</p> </li></ul> <ul><li id="zh-cn_topic_0000002119124453_li1753112716212">--tiling_key，设置该选项后，只编译指定的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-tiling-implementation-on-the-host#section125815192611">TilingKey</a>相关的kernel代码，用于加速编译过程。若不指定TilingKey编译，则默认编译所有的TilingKey。配置多个TilingKey时，TilingKey之间不能有空格。示例如下，其中1、2为tiling_key。<div _ngcontent-dnr-c106="" class="highlight-div"><div _ngcontent-dnr-c106="" class="highlight-div-header"><div _ngcontent-dnr-c106="" class="highlight-div-header-left"><div _ngcontent-dnr-c106="" class="handle-button expand-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dnr-c106="" class="highlight-div-header-right"><div _ngcontent-dnr-c106="" class="handle-button ai-button"></div><div _ngcontent-dnr-c106="" class="handle-button line-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dnr-c106="" class="handle-button theme-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dnr-c106="" class="handle-button copy-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dnr-c106="" class="highlight-scroll-div"><pre class="cmake prettyprint linenums hljs language-ini" hw-language="cmake" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">--tiling_key</span>=<span class="hljs-number">1</span>,<span class="hljs-number">2</span></li></ol></pre></div></div> </li></ul> </li></ul> </td> </tr>  </tbody></table></div> </div> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><ul><li>编译选项是基于“算子类型+AI处理器型号系列”进行配置的，也就是说不同的“算子类型+AI处理器型号系列”可以配置不同的编译选项。<div _ngcontent-dnr-c106="" class="highlight-div"><div _ngcontent-dnr-c106="" class="highlight-div-header"><div _ngcontent-dnr-c106="" class="highlight-div-header-left"><div _ngcontent-dnr-c106="" class="handle-button expand-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dnr-c106="" class="highlight-div-header-right"><div _ngcontent-dnr-c106="" class="handle-button ai-button"></div><div _ngcontent-dnr-c106="" class="handle-button line-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dnr-c106="" class="handle-button theme-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dnr-c106="" class="handle-button copy-button"><div _ngcontent-dnr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dnr-c106="" class="highlight-scroll-div"><pre class="cmake prettyprint linenums hljs language-scss" hw-language="cmake" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">add_ops_compile_options</span>(AddCustom COMPUTE_UNIT kirin9020 ... OPTIONS -DNEW_MACRO1=xx) </li><li><span class="hljs-built_in">add_ops_compile_options</span>(AddCustom COMPUTE_UNIT kirin9020 ... OPTIONS -DNEW_MACRO2=xx) </li><li><span class="hljs-built_in">add_ops_compile_options</span>(AddCustom COMPUTE_UNIT kirin9020 ... OPTIONS -DNEW_MACRO3=xx)</li></ol></pre></div></div> </li></ul> <ul><li>对相同算子类型+AI处理器型号系列，做多次编译选项配置，以后配置的为准。</li></ul> <ul><li>对ALL生效的编译选项和对单一算子生效的编译选项如果没有冲突，同时生效，如果有冲突，以单一算子的编译选项为准。</li></ul> </div></div></div> </div> </div> <div></div></div>