<h1 _ngcontent-dpf-c119="" class="doc-title ng-star-inserted" title="管理网络连接(C/C++)"> 管理网络连接(C/C++) </h1>

<div _ngcontent-dpf-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="场景介绍">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="场景介绍" tips="复制节点链接"></i></h2>          <p>NetConnection模块提供了常用网络信息查询的能力。</p>    </div>    <div class="tiledSection">     <h2 id="接口说明">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明" tips="复制节点链接"></i></h2>          <p>NetConnection常用接口如下表所示，详细的接口说明请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-net-connection-h" target="_blank">net_connection.h</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.2.3.1.3.1.1" valign="top" width="50%">接口名</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.3.1.3.1.2" valign="top" width="50%">描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">OH_NetConn_HasDefaultNet(int32_t *hasDefaultNet)</td>         <td class="cellrowborder" valign="top" width="50%">检查默认数据网络是否被激活，判断设备是否有网络连接，以便在应用程序中采取相应的措施。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_NetConn_GetDefaultNet(NetConn_NetHandle *netHandle)</td>         <td class="cellrowborder" valign="top" width="50%">获得默认激活的数据网络。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_NetConn_IsDefaultNetMetered(int32_t *isMetered)</td>         <td class="cellrowborder" valign="top" width="50%">检查当前网络上的数据流量使用是否被计量。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_NetConn_GetConnectionProperties(NetConn_NetHandle *netHandle, NetConn_ConnectionProperties *prop)</td>         <td class="cellrowborder" valign="top" width="50%">获取netHandle对应的网络的连接信息。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_NetConn_GetNetCapabilities (NetConn_NetHandle *netHandle, NetConn_NetCapabilities *netCapacities)</td>         <td class="cellrowborder" valign="top" width="50%">获取netHandle对应的网络的能力信息。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_NetConn_GetDefaultHttpProxy (NetConn_HttpProxy *httpProxy)</td>         <td class="cellrowborder" valign="top" width="50%">获取网络默认的代理配置信息。 如果设置了全局代理，则会返回全局代理配置信息。如果进程已经绑定到指定netHandle对应的网络，则返回网络句柄对应网络的代理配置信息。在其它情况下，将返回默认网络的代理配置信息。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_NetConn_GetAddrInfo (char *host, char *serv, struct addrinfo *hint, struct addrinfo **res, int32_t netId)</td>         <td class="cellrowborder" valign="top" width="50%">通过netId获取DNS结果。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_NetConn_FreeDnsResult(struct addrinfo *res)</td>         <td class="cellrowborder" valign="top" width="50%">释放DNS结果内存。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_NetConn_GetAllNets(NetConn_NetHandleList *netHandleList)</td>         <td class="cellrowborder" valign="top" width="50%">获取所有处于连接状态的网络列表。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OHOS_NetConn_RegisterDnsResolver(OH_NetConn_CustomDnsResolver resolver)</td>         <td class="cellrowborder" valign="top" width="50%">          <p>注册自定义dns解析器。</p>          <p><strong>弃用：</strong> 从API version 13开始废弃。</p>          <p><strong>替代：</strong> 推荐使用OH_NetConn_RegisterDnsResolver。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OHOS_NetConn_UnregisterDnsResolver(void)</td>         <td class="cellrowborder" valign="top" width="50%">          <p>取消注册自定义dns解析器。</p>          <p><strong>弃用：</strong> 从API version 13开始废弃。</p>          <p><strong>替代：</strong> 推荐使用OH_NetConn_UnregisterDnsResolver。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_NetConn_RegisterDnsResolver(OH_NetConn_CustomDnsResolver resolver)</td>         <td class="cellrowborder" valign="top" width="50%">注册自定义dns解析器。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_NetConn_UnregisterDnsResolver(void)</td>         <td class="cellrowborder" valign="top" width="50%">取消注册自定义dns解析器。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_NetConn_SetPacUrl(const char *pacUrl)</td>         <td class="cellrowborder" valign="top" width="50%">设置系统级代理自动配置(PAC)脚本地址。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_NetConn_GetPacUrl(char *pacUrl)</td>         <td class="cellrowborder" valign="top" width="50%">获取系统级代理自动配置(PAC)脚本地址。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_NetConn_QueryProbeResult(char *destination, int32_t duration, NetConn_ProbeResultInfo *probeResultInfo)</td>         <td class="cellrowborder" valign="top" width="50%">查询探测结果。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_NetConn_QueryTraceRoute(char *destination, NetConn_TraceRouteOption *option, NetConn_TraceRouteInfo *traceRouteInfo)</td>         <td class="cellrowborder" valign="top" width="50%">查询跟踪路由。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="网络管理接口开发示例">网络管理接口开发示例<i class="anchor-icon anchor-icon-link" anchorid="网络管理接口开发示例" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="开发步骤" class="firsth2">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="开发步骤" tips="复制节点链接"></i></h3>          <p>使用本文档涉及接口获取网络相关信息时，需先创建Native C++工程，在源文件中将相关接口封装，再在ArkTs层对封装的接口进行调用，使用hilog或者console.info等手段选择打印在控制台或者生成设备日志。</p>     <p>本文以实现获取默认激活的数据网络为例，给出具体的开发指导。</p>     <p>其他接口开发请参考：<a href="https://gitcode.com/openharmony/applications_app_samples/tree/master/code/DocsSample/NetWork_Kit/NetWorkKit_NetManager/NetConnection_Exploitation_case" target="_blank">完整示例代码</a>。</p>    </div>    <div class="tiledSection">     <h3 id="添加开发依赖">添加开发依赖<i class="anchor-icon anchor-icon-link" anchorid="添加开发依赖" tips="复制节点链接"></i></h3>          <p><strong>添加动态链接库</strong></p>     <p>CMakeLists.txt中添加以下lib:</p>     <div _ngcontent-dpf-c106="" class="highlight-div"><div _ngcontent-dpf-c106="" class="highlight-div-header"><div _ngcontent-dpf-c106="" class="highlight-div-header-left"><div _ngcontent-dpf-c106="" class="handle-button expand-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dpf-c106="" class="highlight-div-header-right"><div _ngcontent-dpf-c106="" class="handle-button ai-button"></div><div _ngcontent-dpf-c106="" class="handle-button line-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dpf-c106="" class="handle-button theme-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dpf-c106="" class="handle-button copy-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dpf-c106="" class="highlight-scroll-div"><pre class="txt prettyprint linenums hljs language-plaintext" hw-language="txt" data-highlighted="yes"><ol class="linenums"><li>libace_napi.z.so</li><li>libnet_connection.so</li></ol></pre></div></div>     <p><strong>头文件</strong></p>     <div _ngcontent-dpf-c106="" class="highlight-div"><div _ngcontent-dpf-c106="" class="highlight-div-header"><div _ngcontent-dpf-c106="" class="highlight-div-header-left"><div _ngcontent-dpf-c106="" class="handle-button expand-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dpf-c106="" class="highlight-div-header-right"><div _ngcontent-dpf-c106="" class="handle-button ai-button"></div><div _ngcontent-dpf-c106="" class="handle-button line-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dpf-c106="" class="handle-button theme-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dpf-c106="" class="handle-button copy-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dpf-c106="" class="highlight-scroll-div"><pre class="c prettyprint linenums hljs language-c" hw-language="c" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"napi/native_api.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"network/netmanager/net_connection.h"</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"network/netmanager/net_connection_type.h"</span></span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="构建工程">构建工程<i class="anchor-icon anchor-icon-link" anchorid="构建工程" tips="复制节点链接"></i></h3>          <ol>      <li>       <p>在源文件中编写调用该API的代码，并将结果封装成一个napi_value类型的值返回给Node.js环境。</p>       <div _ngcontent-dpf-c106="" class="highlight-div"><div _ngcontent-dpf-c106="" class="highlight-div-header"><div _ngcontent-dpf-c106="" class="highlight-div-header-left"><div _ngcontent-dpf-c106="" class="handle-button expand-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dpf-c106="" class="highlight-div-header-right"><div _ngcontent-dpf-c106="" class="handle-button ai-button"></div><div _ngcontent-dpf-c106="" class="handle-button line-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dpf-c106="" class="handle-button theme-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dpf-c106="" class="handle-button copy-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dpf-c106="" class="highlight-scroll-div"><pre class="C prettyprint linenums hljs language-C" hw-language="C" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Get the execution results of the default network connection.</span></li><li><span class="hljs-type">static</span> napi_value <span class="hljs-title function_">GetDefaultNet</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span></li><li>{</li><li>    <span class="hljs-type">size_t</span> argc = <span class="hljs-number">1</span>;</li><li>    napi_value args[<span class="hljs-number">1</span>] = {nullptr};</li><li>    napi_get_cb_info(env, info, &amp;argc, args, nullptr, nullptr);</li><li>    <span class="hljs-type">int32_t</span> param;</li><li>    napi_get_value_int32(env, args[<span class="hljs-number">0</span>], &amp;param);</li><li>
</li><li>    NetConn_NetHandle netHandle;</li><li>    <span class="hljs-keyword">if</span> (param== <span class="hljs-number">0</span>) {</li><li>        param= OH_NetConn_GetDefaultNet(<span class="hljs-literal">NULL</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>        param= OH_NetConn_GetDefaultNet(&amp;netHandle);</li><li>    }</li><li>    </li><li>    napi_value result;</li><li>    napi_create_int32(env, param, &amp;result);</li><li>    <span class="hljs-keyword">return</span> result;</li><li>}</li><li>
</li><li><span class="hljs-comment">// Get the ID of the default network connection.</span></li><li><span class="hljs-type">static</span> napi_value <span class="hljs-title function_">NetId</span><span class="hljs-params">(napi_env env, napi_callback_info info)</span> {</li><li>    <span class="hljs-type">int32_t</span> defaultNetId;</li><li>
</li><li>    NetConn_NetHandle netHandle;</li><li>    OH_NetConn_GetDefaultNet(&amp;netHandle);</li><li>    defaultNetId = netHandle.netId; <span class="hljs-comment">// Get the default netId</span></li><li>
</li><li>    napi_value result;</li><li>    napi_create_int32(env, defaultNetId, &amp;result);</li><li>
</li><li>    <span class="hljs-keyword">return</span> result;</li><li>}</li></ol></pre></div></div>       <p>简要说明：这两个函数用于获取系统默认网络连接的相关信息。其中，GetDefaultNet是接收ArkTs端传入的测试参数，返回调用接口后对应的返回值，param可以自行调整；如果返回值为0，代表获取成功，401代表参数错误，201代表没有权限；而NetId函数则用于获取默认网络连接的ID。这些信息可以用于进一步的网络操作。</p></li>      <li>       <p>将通过napi封装好的napi_value类型对象初始化导出，通过外部函数接口，将以上两个函数暴露给JavaScript使用。</p>       <div _ngcontent-dpf-c106="" class="highlight-div"><div _ngcontent-dpf-c106="" class="highlight-div-header"><div _ngcontent-dpf-c106="" class="highlight-div-header-left"><div _ngcontent-dpf-c106="" class="handle-button expand-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dpf-c106="" class="highlight-div-header-right"><div _ngcontent-dpf-c106="" class="handle-button ai-button"></div><div _ngcontent-dpf-c106="" class="handle-button line-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dpf-c106="" class="handle-button theme-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dpf-c106="" class="handle-button copy-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dpf-c106="" class="highlight-scroll-div"><pre class="C prettyprint linenums hljs language-C" hw-language="C" data-highlighted="yes"><ol class="linenums"><li>EXTERN_C_START</li><li><span class="hljs-type">static</span> napi_value <span class="hljs-title function_">Init</span><span class="hljs-params">(napi_env env, napi_value exports)</span></li><li>{</li><li>    <span class="hljs-comment">// Information used to describe an exported attribute. Two properties are defined here: `GetDefaultNet` and `NetId`.</span></li><li>    napi_property_descriptor desc[] = {</li><li>        {<span class="hljs-string">"GetDefaultNet"</span>, nullptr, GetDefaultNet, nullptr, nullptr, nullptr, napi_default, nullptr},</li><li>        {<span class="hljs-string">"NetId"</span>, nullptr, NetId, nullptr, nullptr, nullptr, napi_default, nullptr}};</li><li>    napi_define_properties(env, exports, <span class="hljs-keyword">sizeof</span>(desc) / <span class="hljs-keyword">sizeof</span>(desc[<span class="hljs-number">0</span>]), desc);</li><li>    <span class="hljs-keyword">return</span> exports;</li><li>}</li><li>EXTERN_C_END</li></ol></pre></div></div></li>      <li>       <p>将上一步中初始化成功的对象通过RegisterEntryModule函数，使用napi_module_register函数将模块注册到Node.js中。</p>       <div _ngcontent-dpf-c106="" class="highlight-div"><div _ngcontent-dpf-c106="" class="highlight-div-header"><div _ngcontent-dpf-c106="" class="highlight-div-header-left"><div _ngcontent-dpf-c106="" class="handle-button expand-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dpf-c106="" class="highlight-div-header-right"><div _ngcontent-dpf-c106="" class="handle-button ai-button"></div><div _ngcontent-dpf-c106="" class="handle-button line-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dpf-c106="" class="handle-button theme-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dpf-c106="" class="handle-button copy-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dpf-c106="" class="highlight-scroll-div"><pre class="C prettyprint linenums hljs language-C" hw-language="C" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-type">static</span> napi_module demoModule = {</li><li>    .nm_version = <span class="hljs-number">1</span>,</li><li>    .nm_flags = <span class="hljs-number">0</span>,</li><li>    .nm_filename = nullptr,</li><li>    .nm_register_func = Init,</li><li>    .nm_modname = <span class="hljs-string">"entry"</span>,</li><li>    .nm_priv = ((<span class="hljs-type">void</span>*)<span class="hljs-number">0</span>),</li><li>    .reserved = { <span class="hljs-number">0</span> },</li><li>};</li><li>
</li><li><span class="hljs-keyword">extern</span> <span class="hljs-string">"C"</span> __attribute__((constructor)) <span class="hljs-type">void</span> <span class="hljs-title function_">RegisterEntryModule</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></li><li>{</li><li>    napi_module_register(&amp;demoModule);</li><li>}</li></ol></pre></div></div></li>      <li>       <p>在工程的index.d.ts文件中定义两个函数的类型。</p>       <ul>        <li>GetDefaultNet函数接受一个数字参数code，返回一个数字类型的值。</li>        <li>NetId函数不接受参数，返回一个数字类型的值。</li>       </ul>       <div _ngcontent-dpf-c106="" class="highlight-div"><div _ngcontent-dpf-c106="" class="highlight-div-header"><div _ngcontent-dpf-c106="" class="highlight-div-header-left"><div _ngcontent-dpf-c106="" class="handle-button expand-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dpf-c106="" class="highlight-div-header-right"><div _ngcontent-dpf-c106="" class="handle-button ai-button"></div><div _ngcontent-dpf-c106="" class="handle-button line-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dpf-c106="" class="handle-button theme-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dpf-c106="" class="handle-button copy-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dpf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">GetDefaultNet</span>: <span class="hljs-function">(<span class="hljs-params">code: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">number</span>;</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title class_">NetId</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">number</span>;</li></ol></pre></div></div></li>      <li>       <p>在index.ets文件中对上述封装好的接口进行调用。</p>       <div _ngcontent-dpf-c106="" class="highlight-div"><div _ngcontent-dpf-c106="" class="highlight-div-header"><div _ngcontent-dpf-c106="" class="highlight-div-header-left"><div _ngcontent-dpf-c106="" class="handle-button expand-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dpf-c106="" class="highlight-div-header-right"><div _ngcontent-dpf-c106="" class="handle-button ai-button"></div><div _ngcontent-dpf-c106="" class="handle-button line-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dpf-c106="" class="handle-button theme-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dpf-c106="" class="handle-button copy-button"><div _ngcontent-dpf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dpf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> testNetManager <span class="hljs-keyword">from</span> <span class="hljs-string">'libentry.so'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">50</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'GetDefaultNet'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">GetDefaultNet</span>();</li><li>        })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'CodeNumber'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function"><span class="hljs-params">event</span> =&gt;</span>{</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title class_">CodeNumber</span>();</li><li>        })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>
</li><li>  <span class="hljs-title class_">GetDefaultNet</span>() {</li><li>    <span class="hljs-keyword">let</span> netid = testNetManager.<span class="hljs-title class_">NetId</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"The defaultNetId is ["</span> + netid + <span class="hljs-string">"]"</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title class_">CodeNumber</span>() {</li><li>    <span class="hljs-keyword">let</span> testParam = <span class="hljs-number">0</span>;</li><li>    <span class="hljs-keyword">let</span> codeNumber = testNetManager.<span class="hljs-title class_">GetDefaultNet</span>(testParam);</li><li>    <span class="hljs-keyword">if</span> (codeNumber === <span class="hljs-number">0</span>) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Test success. ["</span> + codeNumber + <span class="hljs-string">"]"</span>);</li><li>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (codeNumber === <span class="hljs-number">201</span>) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Missing permissions. ["</span> + codeNumber + <span class="hljs-string">"]"</span>);</li><li>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (codeNumber === <span class="hljs-number">401</span>) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"Parameter error. ["</span> + codeNumber + <span class="hljs-string">"]"</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div></li>      <li>       <p>配置CMakeLists.txt，本模块需要用到的共享库是libnet_connection.so，在工程自动生成的CMakeLists.txt中的target_link_libraries中添加此共享库。</p>       <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">         <p>如图所示，在add_library中的entry是工程自动生成的modename。若要做修改，需和步骤3中.nm_modname保持一致。</p>        </div></div></div>       <p><span><img originheight="316" originwidth="1230" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115038.57221657249974951796891950546474:50001231000000:2800:476EC3BCA1192F974A4F21347D17F63EA2727D89DEB2A0DCFFF58C33C6E6A9CC.png" width="920" height="236.35772357723576"></span></p></li>     </ol>     <p>经过以上步骤，整个工程的搭建已经完成，接下来就可以连接设备运行工程进行日志查看了。</p>    </div>    <div class="tiledSection">     <h2 id="测试步骤">测试步骤<i class="anchor-icon anchor-icon-link" anchorid="测试步骤" tips="复制节点链接"></i></h2>          <ol>      <li>       <p>连接设备，使用DevEco Studio打开搭建好的工程。</p></li>      <li>       <p>运行工程，设备上会弹出以下所示图片。</p>       <ul>        <li>点击GetDefaultNet时获取的是默认网络ID。</li>        <li>点击codeNumber时获取的是接口返回的响应状态码。</li>       </ul>       <p><span><img originheight="164" originwidth="247" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115038.13967847610342079480981950038944:50001231000000:2800:11D5744CAC709009F47574D0CC7FFB6D22D7B99663A50D38C2BD69E2BFB9861D.png" class="notEnlarge" width="247" height="164"></span></p></li>      <li>       <p>点击GetDefaultNet按钮，控制台会打印日志。</p>       <p><span><img originheight="241" originwidth="1607" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115039.12276915827006830594586044213541:50001231000000:2800:DCF9220748609EE54BE64DCCC1251ED19849A6838B9BB5CD322A0FE5C747F1DE.png" width="920" height="137.97137523335408"></span></p></li>      <li>       <p>点击codeNumber按钮，控制台会打印相应的响应状态码。</p>       <p><span><img originheight="233" originwidth="1603" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115039.53808511296897342790730011522344:50001231000000:2800:97F293D7587DCA18D43C5511DF4377934D1791861C3A4F660C990757C28AA505.png" width="920" height="133.72426699937617"></span></p></li>     </ol>    </div>   </div>   <div></div></div>