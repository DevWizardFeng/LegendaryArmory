<h1 _ngcontent-rcr-c119="" class="doc-title ng-star-inserted" title="管理群组关键资产(ArkTS)"> 管理群组关键资产(ArkTS) </h1>

<div _ngcontent-rcr-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>以下为管理群组关键资产使用示例，请先查看开发指导：</p> <ul><li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/asset-js-add">新增关键资产(ArkTS)</a></li><li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/asset-js-remove">删除关键资产(ArkTS)</a></li><li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/asset-js-update">更新关键资产(ArkTS)</a></li><li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/asset-js-query">查询关键资产(ArkTS)</a></li></ul>  <div class="tiledSection"><h2 id="前置条件">前置条件<i class="anchor-icon anchor-icon-link" anchorid="前置条件" tips="复制节点链接"></i></h2><p>在应用配置文件app.json5中，配置群组ID，如：demo_group_id。群组支持配置多个群组ID。</p> <div _ngcontent-rcr-c106="" class="highlight-div"><div _ngcontent-rcr-c106="" class="highlight-div-header"><div _ngcontent-rcr-c106="" class="highlight-div-header-left"><div _ngcontent-rcr-c106="" class="handle-button expand-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rcr-c106="" class="highlight-div-header-right"><div _ngcontent-rcr-c106="" class="handle-button ai-button"></div><div _ngcontent-rcr-c106="" class="handle-button line-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rcr-c106="" class="handle-button theme-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rcr-c106="" class="handle-button copy-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rcr-c106="" class="highlight-scroll-div"><pre class="json5 prettyprint linenums hljs language-perl" hw-language="json5" data-highlighted="yes"><ol class="linenums"><li>{</li><li>  <span class="hljs-string">"app"</span>: {</li><li>    <span class="hljs-regexp">//</span> 其他配置项此处省略。</li><li>    <span class="hljs-string">"assetAccessGroups"</span>: [</li><li>      <span class="hljs-string">"demo_group_id"</span>,</li><li>      <span class="hljs-regexp">//</span> <span class="hljs-string">"another_group_id"</span>,</li><li>      <span class="hljs-regexp">//</span> ...</li><li>    ]</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="新增群组关键资产">新增群组关键资产<i class="anchor-icon anchor-icon-link" anchorid="新增群组关键资产" tips="复制节点链接"></i></h2><p>在群组中新增密码为demo_pwd、别名为demo_alias、附属信息为demo_label的关键资产。</p> <div _ngcontent-rcr-c106="" class="highlight-div"><div _ngcontent-rcr-c106="" class="highlight-div-header"><div _ngcontent-rcr-c106="" class="highlight-div-header-left"><div _ngcontent-rcr-c106="" class="handle-button expand-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rcr-c106="" class="highlight-div-header-right"><div _ngcontent-rcr-c106="" class="handle-button ai-button"></div><div _ngcontent-rcr-c106="" class="handle-button line-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rcr-c106="" class="handle-button theme-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rcr-c106="" class="handle-button copy-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rcr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { asset } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AssetStoreKit'</span>;</li><li><span class="hljs-keyword">import</span> { util } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">stringToArray</span>(<span class="hljs-params">str: <span class="hljs-built_in">string</span></span>): <span class="hljs-title class_">Uint8Array</span> {</li><li>  <span class="hljs-keyword">let</span> textEncoder = <span class="hljs-keyword">new</span> util.<span class="hljs-title class_">TextEncoder</span>();</li><li>  <span class="hljs-keyword">return</span> textEncoder.<span class="hljs-title function_">encodeInto</span>(str);</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">attr</span>: asset.<span class="hljs-property">AssetMap</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();</li><li>attr.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">SECRET</span>, <span class="hljs-title function_">stringToArray</span>(<span class="hljs-string">'demo_pwd'</span>));</li><li>attr.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">ALIAS</span>, <span class="hljs-title function_">stringToArray</span>(<span class="hljs-string">'demo_alias'</span>));</li><li>attr.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">DATA_LABEL_NORMAL_1</span>, <span class="hljs-title function_">stringToArray</span>(<span class="hljs-string">'demo_label'</span>));</li><li>attr.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">GROUP_ID</span>, <span class="hljs-title function_">stringToArray</span>(<span class="hljs-string">'demo_group_id'</span>));</li><li><span class="hljs-keyword">try</span> {</li><li>  asset.<span class="hljs-title function_">add</span>(attr).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Succeeded in adding Asset to the group.`</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to add Asset to the group. Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>  })</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to add Asset to the group. Code is <span class="hljs-subst">${err?.code}</span>, message is <span class="hljs-subst">${err?.message}</span>`</span>);</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="删除群组关键资产">删除群组关键资产<i class="anchor-icon anchor-icon-link" anchorid="删除群组关键资产" tips="复制节点链接"></i></h2><p>在群组中删除别名为demo_alias的关键资产。</p> <div _ngcontent-rcr-c106="" class="highlight-div"><div _ngcontent-rcr-c106="" class="highlight-div-header"><div _ngcontent-rcr-c106="" class="highlight-div-header-left"><div _ngcontent-rcr-c106="" class="handle-button expand-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rcr-c106="" class="highlight-div-header-right"><div _ngcontent-rcr-c106="" class="handle-button ai-button"></div><div _ngcontent-rcr-c106="" class="handle-button line-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rcr-c106="" class="handle-button theme-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rcr-c106="" class="handle-button copy-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rcr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { asset } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AssetStoreKit'</span>;</li><li><span class="hljs-keyword">import</span> { util } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">stringToArray</span>(<span class="hljs-params">str: <span class="hljs-built_in">string</span></span>): <span class="hljs-title class_">Uint8Array</span> {</li><li>  <span class="hljs-keyword">let</span> textEncoder = <span class="hljs-keyword">new</span> util.<span class="hljs-title class_">TextEncoder</span>();</li><li>  <span class="hljs-keyword">return</span> textEncoder.<span class="hljs-title function_">encodeInto</span>(str);</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">query</span>: asset.<span class="hljs-property">AssetMap</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();</li><li>query.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">ALIAS</span>, <span class="hljs-title function_">stringToArray</span>(<span class="hljs-string">'demo_alias'</span>)); <span class="hljs-comment">// 此处指定别名删除单条群组关键资产，也可不指定别名删除多条群组关键资产</span></li><li>query.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">GROUP_ID</span>, <span class="hljs-title function_">stringToArray</span>(<span class="hljs-string">'demo_group_id'</span>));</li><li><span class="hljs-keyword">try</span> {</li><li>  asset.<span class="hljs-title function_">remove</span>(query).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Succeeded removing in Asset from the group.`</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to remove Asset from the group. Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to remove Asset from the group. Code is <span class="hljs-subst">${err?.code}</span>, message is <span class="hljs-subst">${err?.message}</span>`</span>);</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="更新群组关键资产">更新群组关键资产<i class="anchor-icon anchor-icon-link" anchorid="更新群组关键资产" tips="复制节点链接"></i></h2><p>在群组中更新别名为demo_alias的关键资产，明文更新为demo_pwd_new，附属属性更新为demo_label_new。</p> <div _ngcontent-rcr-c106="" class="highlight-div"><div _ngcontent-rcr-c106="" class="highlight-div-header"><div _ngcontent-rcr-c106="" class="highlight-div-header-left"><div _ngcontent-rcr-c106="" class="handle-button expand-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rcr-c106="" class="highlight-div-header-right"><div _ngcontent-rcr-c106="" class="handle-button ai-button"></div><div _ngcontent-rcr-c106="" class="handle-button line-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rcr-c106="" class="handle-button theme-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rcr-c106="" class="handle-button copy-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rcr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { asset } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AssetStoreKit'</span>;</li><li><span class="hljs-keyword">import</span> { util } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">stringToArray</span>(<span class="hljs-params">str: <span class="hljs-built_in">string</span></span>): <span class="hljs-title class_">Uint8Array</span> {</li><li>  <span class="hljs-keyword">let</span> textEncoder = <span class="hljs-keyword">new</span> util.<span class="hljs-title class_">TextEncoder</span>();</li><li>  <span class="hljs-keyword">return</span> textEncoder.<span class="hljs-title function_">encodeInto</span>(str);</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">query</span>: asset.<span class="hljs-property">AssetMap</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();</li><li>query.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">ALIAS</span>, <span class="hljs-title function_">stringToArray</span>(<span class="hljs-string">'demo_alias'</span>));</li><li>query.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">GROUP_ID</span>, <span class="hljs-title function_">stringToArray</span>(<span class="hljs-string">'demo_group_id'</span>));</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">attrsToUpdate</span>: asset.<span class="hljs-property">AssetMap</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();</li><li>attrsToUpdate.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">SECRET</span>, <span class="hljs-title function_">stringToArray</span>(<span class="hljs-string">'demo_pwd_new'</span>));</li><li>attrsToUpdate.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">DATA_LABEL_NORMAL_1</span>, <span class="hljs-title function_">stringToArray</span>(<span class="hljs-string">'demo_label_new'</span>));</li><li><span class="hljs-keyword">try</span> {</li><li>  asset.<span class="hljs-title function_">update</span>(query, attrsToUpdate).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Succeeded in updating Asset in the group.`</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to update Asset in the group. Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to update Asset in the group. Code is <span class="hljs-subst">${err?.code}</span>, message is <span class="hljs-subst">${err?.message}</span>`</span>);</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="查询单条群组关键资产明文">查询单条群组关键资产明文<i class="anchor-icon anchor-icon-link" anchorid="查询单条群组关键资产明文" tips="复制节点链接"></i></h2><p>在群组中查询别名为demo_alias的关键资产明文。</p> <div _ngcontent-rcr-c106="" class="highlight-div"><div _ngcontent-rcr-c106="" class="highlight-div-header"><div _ngcontent-rcr-c106="" class="highlight-div-header-left"><div _ngcontent-rcr-c106="" class="handle-button expand-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rcr-c106="" class="highlight-div-header-right"><div _ngcontent-rcr-c106="" class="handle-button ai-button"></div><div _ngcontent-rcr-c106="" class="handle-button line-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rcr-c106="" class="handle-button theme-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rcr-c106="" class="handle-button copy-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rcr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { asset } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AssetStoreKit'</span>;</li><li><span class="hljs-keyword">import</span> { util } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">stringToArray</span>(<span class="hljs-params">str: <span class="hljs-built_in">string</span></span>): <span class="hljs-title class_">Uint8Array</span> {</li><li>  <span class="hljs-keyword">let</span> textEncoder = <span class="hljs-keyword">new</span> util.<span class="hljs-title class_">TextEncoder</span>();</li><li>  <span class="hljs-keyword">return</span> textEncoder.<span class="hljs-title function_">encodeInto</span>(str);</li><li>}</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">arrayToString</span>(<span class="hljs-params">arr: <span class="hljs-built_in">Uint8Array</span></span>): <span class="hljs-built_in">string</span> {</li><li>  <span class="hljs-keyword">let</span> textDecoder = util.<span class="hljs-property">TextDecoder</span>.<span class="hljs-title function_">create</span>(<span class="hljs-string">"utf-8"</span>, { <span class="hljs-attr">ignoreBOM</span>: <span class="hljs-literal">true</span> });</li><li>  <span class="hljs-keyword">let</span> str = textDecoder.<span class="hljs-title function_">decodeToString</span>(arr, { <span class="hljs-attr">stream</span>: <span class="hljs-literal">false</span> })</li><li>  <span class="hljs-keyword">return</span> str;</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">query</span>: asset.<span class="hljs-property">AssetMap</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();</li><li>query.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">ALIAS</span>, <span class="hljs-title function_">stringToArray</span>(<span class="hljs-string">'demo_alias'</span>)); <span class="hljs-comment">// 指定了群组关键资产别名，最多查询到一条满足条件的群组关键资产。</span></li><li>query.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">RETURN_TYPE</span>, asset.<span class="hljs-property">ReturnType</span>.<span class="hljs-property">ALL</span>); <span class="hljs-comment">// 此处表示需要返回群组关键资产的所有信息，即属性+明文。</span></li><li>query.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">GROUP_ID</span>, <span class="hljs-title function_">stringToArray</span>(<span class="hljs-string">'demo_group_id'</span>));</li><li><span class="hljs-keyword">try</span> {</li><li>  asset.<span class="hljs-title function_">query</span>(query).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res: <span class="hljs-built_in">Array</span>&lt;asset.AssetMap&gt;</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; res.<span class="hljs-property">length</span>; i++) {</li><li>      <span class="hljs-comment">// 解析secret。</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">secret</span>: <span class="hljs-title class_">Uint8Array</span> = res[i].<span class="hljs-title function_">get</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">SECRET</span>) <span class="hljs-keyword">as</span> <span class="hljs-title class_">Uint8Array</span>;</li><li>      <span class="hljs-comment">// 将Uint8Array转换为string类型。</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">secretStr</span>: <span class="hljs-built_in">string</span> = <span class="hljs-title function_">arrayToString</span>(secret);</li><li>    }</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to query Asset. Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to query Asset. Code is <span class="hljs-subst">${err?.code}</span>, message is <span class="hljs-subst">${err?.message}</span>`</span>);</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection"><h2 id="查询单条群组关键资产属性">查询单条群组关键资产属性<i class="anchor-icon anchor-icon-link" anchorid="查询单条群组关键资产属性" tips="复制节点链接"></i></h2><p>在群组中查询别名为demo_alias的关键资产属性。</p> <div _ngcontent-rcr-c106="" class="highlight-div"><div _ngcontent-rcr-c106="" class="highlight-div-header"><div _ngcontent-rcr-c106="" class="highlight-div-header-left"><div _ngcontent-rcr-c106="" class="handle-button expand-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-rcr-c106="" class="highlight-div-header-right"><div _ngcontent-rcr-c106="" class="handle-button ai-button"></div><div _ngcontent-rcr-c106="" class="handle-button line-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-rcr-c106="" class="handle-button theme-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-rcr-c106="" class="handle-button copy-button"><div _ngcontent-rcr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-rcr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { asset } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AssetStoreKit'</span>;</li><li><span class="hljs-keyword">import</span> { util } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">stringToArray</span>(<span class="hljs-params">str: <span class="hljs-built_in">string</span></span>): <span class="hljs-title class_">Uint8Array</span> {</li><li>  <span class="hljs-keyword">let</span> textEncoder = <span class="hljs-keyword">new</span> util.<span class="hljs-title class_">TextEncoder</span>();</li><li>  <span class="hljs-keyword">return</span> textEncoder.<span class="hljs-title function_">encodeInto</span>(str);</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">query</span>: asset.<span class="hljs-property">AssetMap</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>();</li><li>query.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">ALIAS</span>, <span class="hljs-title function_">stringToArray</span>(<span class="hljs-string">'demo_alias'</span>)); <span class="hljs-comment">// 指定了群组关键资产别名，最多查询到一条满足条件的群组关键资产。</span></li><li>query.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">RETURN_TYPE</span>, asset.<span class="hljs-property">ReturnType</span>.<span class="hljs-property">ATTRIBUTES</span>); <span class="hljs-comment">// 此处表示仅返回群组关键资产属性，不包含群组关键资产明文。</span></li><li>query.<span class="hljs-title function_">set</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">GROUP_ID</span>, <span class="hljs-title function_">stringToArray</span>(<span class="hljs-string">'demo_group_id'</span>));</li><li><span class="hljs-keyword">try</span> {</li><li>  asset.<span class="hljs-title function_">query</span>(query).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">res: <span class="hljs-built_in">Array</span>&lt;asset.AssetMap&gt;</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; res.<span class="hljs-property">length</span>; i++) {</li><li>      <span class="hljs-comment">// 解析属性。</span></li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">accessibility</span>: <span class="hljs-built_in">number</span> = res[i].<span class="hljs-title function_">get</span>(asset.<span class="hljs-property">Tag</span>.<span class="hljs-property">ACCESSIBILITY</span>) <span class="hljs-keyword">as</span> <span class="hljs-built_in">number</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Succeeded in getting accessibility, which is: <span class="hljs-subst">${accessibility}</span>.`</span>);</li><li>    }</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to query Asset from the group. Code is <span class="hljs-subst">${err.code}</span>, message is <span class="hljs-subst">${err.message}</span>`</span>);</li><li>  });</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`Failed to query Asset from the group. Code is <span class="hljs-subst">${err?.code}</span>, message is <span class="hljs-subst">${err?.message}</span>`</span>);</li><li>}</li></ol></pre></div></div> </div> </div> <div></div></div>