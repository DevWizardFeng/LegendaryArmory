<h1 _ngcontent-dhu-c119="" class="doc-title ng-star-inserted" title="粒子动画"> 粒子动画 </h1>

<div _ngcontent-dhu-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-particle-animation" target="_blank">粒子动画</a>是通过在限定区域内随机生成大量粒子的运动，进而组合成的动画效果，通过Particle组件来实现。动画的基本构成元素为单个粒子，这些粒子可以表现为圆点或图片等形式。开发者能够通过对粒子在颜色、透明度、大小、速度、加速度、自旋角度等多个维度上的动态变化做动画，以营造特定的氛围，例如模拟下雪场景时，飘舞的雪花实际上是由一个个雪花粒子的动画效果所构成。</p>    <p>粒子动画的简单实现如下所示。</p>    <div _ngcontent-dhu-c106="" class="highlight-div"><div _ngcontent-dhu-c106="" class="highlight-div-header"><div _ngcontent-dhu-c106="" class="highlight-div-header-left"><div _ngcontent-dhu-c106="" class="handle-button expand-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dhu-c106="" class="highlight-div-header-right"><div _ngcontent-dhu-c106="" class="handle-button ai-button"></div><div _ngcontent-dhu-c106="" class="handle-button line-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dhu-c106="" class="handle-button theme-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dhu-c106="" class="handle-button copy-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dhu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">ParticleExample</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Stack</span>() {</li><li>      <span class="hljs-title class_">Text</span>()</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-number">300</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">300</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'rgb(240, 250, 255)'</span>)</li><li>      <span class="hljs-title class_">Particle</span>({ <span class="hljs-attr">particles</span>: [</li><li>        {</li><li>          <span class="hljs-attr">emitter</span>: {</li><li>            <span class="hljs-attr">particle</span>: {</li><li>              <span class="hljs-attr">type</span>: <span class="hljs-title class_">ParticleType</span>.<span class="hljs-property">POINT</span>, <span class="hljs-comment">// 粒子类型</span></li><li>              <span class="hljs-attr">config</span>: {</li><li>                <span class="hljs-attr">radius</span>: <span class="hljs-number">5</span> <span class="hljs-comment">// 圆点半径</span></li><li>              },</li><li>              <span class="hljs-attr">count</span>: <span class="hljs-number">100</span>, <span class="hljs-comment">// 粒子总数</span></li><li>            },</li><li>          },</li><li>          <span class="hljs-attr">color</span>:{</li><li>            <span class="hljs-attr">range</span>:[<span class="hljs-string">'rgb(39, 135, 217)'</span>,<span class="hljs-string">'rgb(0, 74, 175)'</span>],<span class="hljs-comment">//初始颜色范围</span></li><li>          },</li><li>        },</li><li>      ]</li><li>      }).<span class="hljs-title function_">width</span>(<span class="hljs-number">250</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">250</span>)</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">"100%"</span>).<span class="hljs-title function_">align</span>(<span class="hljs-title class_">Alignment</span>.<span class="hljs-property">Center</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    <p><span><img originheight="223" originwidth="223" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114841.05108108220677723253316575348065:50001231000000:2800:DC3207F81C8C50D97D93B05771337F2D30D55CBCC28A2A8787058AC4D93367BD.gif" class="notEnlarge" width="223" height="223"></span></p>    <div class="tiledSection">     <h2 id="实现粒子发射器">实现粒子发射器<i class="anchor-icon anchor-icon-link" anchorid="实现粒子发射器" tips="复制节点链接"></i></h2>          <p>粒子发射器（Particle Emitter）主要定义粒子的初始属性（如类型、位置和颜色），控制粒子的生成速率，以及管理粒子的生命周期。可通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-particle-animation#emitter12" target="_blank">emitter</a>方法调整粒子发射器的位置、发射速率和发射窗口的大小，实现发射器位置的动态更新。</p>     <div _ngcontent-dhu-c106="" class="highlight-div"><div _ngcontent-dhu-c106="" class="highlight-div-header"><div _ngcontent-dhu-c106="" class="highlight-div-header-left"><div _ngcontent-dhu-c106="" class="handle-button expand-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dhu-c106="" class="highlight-div-header-right"><div _ngcontent-dhu-c106="" class="handle-button ai-button"></div><div _ngcontent-dhu-c106="" class="handle-button line-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dhu-c106="" class="handle-button theme-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dhu-c106="" class="handle-button copy-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dhu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// ...</span></li><li><span class="hljs-meta">@State</span> <span class="hljs-attr">emitterProperties</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">EmitterProperty</span>&gt; = [</li><li>  {</li><li>    <span class="hljs-attr">index</span>: <span class="hljs-number">0</span>,</li><li>    <span class="hljs-attr">emitRate</span>: <span class="hljs-number">100</span>,</li><li>    <span class="hljs-attr">position</span>: { <span class="hljs-attr">x</span>: <span class="hljs-number">60</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">80</span> },</li><li>    <span class="hljs-attr">size</span>: { <span class="hljs-attr">width</span>: <span class="hljs-number">200</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">200</span> }</li><li>  }</li><li>]</li><li>
</li><li><span class="hljs-title class_">Particle</span>(...).<span class="hljs-title function_">width</span>(<span class="hljs-number">300</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">300</span>).<span class="hljs-title function_">emitter</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">emitterProperties</span>) <span class="hljs-comment">// 动态调整粒子发射器的位置</span></li><li><span class="hljs-comment">// ...</span></li></ol></pre></div></div>     <p><span><img originheight="223" originwidth="223" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114841.00488650007232455463934210192181:50001231000000:2800:E7F38BC2B00AFFE596044498724717C4727FAE798D65D3732915A6F316A627E9.gif" class="notEnlarge" width="223" height="223"></span></p>    </div>    <div class="tiledSection">     <h2 id="设置粒子颜色">设置粒子颜色<i class="anchor-icon anchor-icon-link" anchorid="设置粒子颜色" tips="复制节点链接"></i></h2>          <p>可以通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-particle-animation#particlecolorpropertyoptions" target="_blank">range</a>来确定粒子的初始颜色范围，而<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-particle-animation#particlecolorpropertyoptions" target="_blank">distributionType</a>则用于指定粒子初始颜色随机值的分布方式，具体可选择均匀分布或者高斯（正态）分布。</p>     <div _ngcontent-dhu-c106="" class="highlight-div"><div _ngcontent-dhu-c106="" class="highlight-div-header"><div _ngcontent-dhu-c106="" class="highlight-div-header-left"><div _ngcontent-dhu-c106="" class="handle-button expand-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dhu-c106="" class="highlight-div-header-right"><div _ngcontent-dhu-c106="" class="handle-button ai-button"></div><div _ngcontent-dhu-c106="" class="handle-button line-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dhu-c106="" class="handle-button theme-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dhu-c106="" class="handle-button copy-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dhu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// ...</span></li><li><span class="hljs-attr">color</span>: {</li><li>  <span class="hljs-attr">range</span>: [<span class="hljs-string">'rgb(39, 135, 217)'</span>,<span class="hljs-string">'rgb(0, 74, 175)'</span>], <span class="hljs-comment">// 初始颜色范围</span></li><li>  <span class="hljs-attr">distributionType</span>: <span class="hljs-title class_">DistributionType</span>.<span class="hljs-property">GAUSSIAN</span> <span class="hljs-comment">// 初始颜色随机值分布</span></li><li>},</li><li><span class="hljs-comment">// ...</span></li></ol></pre></div></div>     <p><span><img originheight="223" originwidth="223" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114841.07427062075387778871203393840640:50001231000000:2800:24F2558A8B3C3F412EF0246ECC11AE3F6783B05E28BD438B3E45303741BFCAC4.gif" class="notEnlarge" width="223" height="223"></span></p>    </div>    <div class="tiledSection">     <h2 id="粒子的生命周期">粒子的生命周期<i class="anchor-icon anchor-icon-link" anchorid="粒子的生命周期" tips="复制节点链接"></i></h2>          <p>粒子的生命周期（Lifecycle）是粒子从生成至消亡的整个过程，用于确定粒子的存活时间长度。粒子的生命周期可通过设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-particle-animation#emitteroptions" target="_blank">lifetime</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-particle-animation#emitteroptions" target="_blank">lifetimeRange</a>来指定。</p>     <div _ngcontent-dhu-c106="" class="highlight-div"><div _ngcontent-dhu-c106="" class="highlight-div-header"><div _ngcontent-dhu-c106="" class="highlight-div-header-left"><div _ngcontent-dhu-c106="" class="handle-button expand-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dhu-c106="" class="highlight-div-header-right"><div _ngcontent-dhu-c106="" class="handle-button ai-button"></div><div _ngcontent-dhu-c106="" class="handle-button line-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dhu-c106="" class="handle-button theme-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dhu-c106="" class="handle-button copy-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dhu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// ...</span></li><li><span class="hljs-attr">emitter</span>: {</li><li>  <span class="hljs-attr">particle</span>: {</li><li>    <span class="hljs-comment">// ...</span></li><li>    <span class="hljs-attr">lifetime</span>: <span class="hljs-number">300</span>, <span class="hljs-comment">// 粒子生命周期，单位ms</span></li><li>    <span class="hljs-attr">lifetimeRange</span>: <span class="hljs-number">100</span> <span class="hljs-comment">// 粒子生命周期取值范围，单位ms</span></li><li>  },</li><li>  <span class="hljs-attr">emitRate</span>: <span class="hljs-number">10</span>, <span class="hljs-comment">// 每秒发射粒子数</span></li><li>  <span class="hljs-attr">position</span>: [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>],</li><li>  <span class="hljs-attr">shape</span>: <span class="hljs-title class_">ParticleEmitterShape</span>.<span class="hljs-property">RECTANGLE</span> <span class="hljs-comment">// 发射器形状</span></li><li>},</li><li><span class="hljs-attr">color</span>: {</li><li>  <span class="hljs-attr">range</span>: [<span class="hljs-string">'rgb(39, 135, 217)'</span>,<span class="hljs-string">'rgb(0, 74, 175)'</span>], <span class="hljs-comment">// 初始颜色范围</span></li><li>},</li><li><span class="hljs-comment">// ...</span></li></ol></pre></div></div>     <p><span><img originheight="223" originwidth="223" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114841.68731418255886629382302312914827:50001231000000:2800:9D9A9BE9EE7B159F4967EF795ED253A027623C72E4B5A9C768E5E623BC94FB82.gif" class="notEnlarge" width="223" height="223"></span></p>    </div>    <div class="tiledSection">     <h2 id="设置粒子扰动场">设置粒子扰动场<i class="anchor-icon anchor-icon-link" anchorid="设置粒子扰动场" tips="复制节点链接"></i></h2>          <p>扰动场（Disturbance Field）是一种影响粒子运动的机制。通过在粒子所在的空间区域内施加特定的力，扰动场能够改变粒子的轨迹和行为，进而实现更为复杂和自然的动画效果。扰动场的配置可以通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-particle-animation#disturbancefields12" target="_blank">disturbanceFields</a>方法来完成。</p>     <div _ngcontent-dhu-c106="" class="highlight-div"><div _ngcontent-dhu-c106="" class="highlight-div-header"><div _ngcontent-dhu-c106="" class="highlight-div-header-left"><div _ngcontent-dhu-c106="" class="handle-button expand-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-dhu-c106="" class="highlight-div-header-right"><div _ngcontent-dhu-c106="" class="handle-button ai-button"></div><div _ngcontent-dhu-c106="" class="handle-button line-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-dhu-c106="" class="handle-button theme-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-dhu-c106="" class="handle-button copy-button"><div _ngcontent-dhu-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-dhu-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// ...</span></li><li><span class="hljs-title class_">Particle</span>({ <span class="hljs-attr">particles</span>: [</li><li>  {</li><li>    <span class="hljs-attr">emitter</span>: <span class="hljs-comment">// ...</span></li><li>    <span class="hljs-attr">color</span>: <span class="hljs-comment">// ...</span></li><li>    <span class="hljs-attr">scale</span>: {</li><li>      <span class="hljs-attr">range</span>: [<span class="hljs-number">0.0</span>, <span class="hljs-number">0.0</span>],</li><li>      <span class="hljs-attr">updater</span>: {</li><li>        <span class="hljs-attr">type</span>: <span class="hljs-title class_">ParticleUpdater</span>.<span class="hljs-property">CURVE</span>,</li><li>        <span class="hljs-attr">config</span>: [</li><li>          {</li><li>            <span class="hljs-attr">from</span>: <span class="hljs-number">0.0</span>,</li><li>            <span class="hljs-attr">to</span>: <span class="hljs-number">0.5</span>,</li><li>            <span class="hljs-attr">startMillis</span>: <span class="hljs-number">0</span>,</li><li>            <span class="hljs-attr">endMillis</span>: <span class="hljs-number">3000</span>,</li><li>            <span class="hljs-attr">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-property">EaseIn</span></li><li>          }</li><li>        ]</li><li>      }</li><li>    },</li><li>    <span class="hljs-attr">acceleration</span>: { <span class="hljs-comment">//加速度的配置，从大小和方向两个维度变化，speed表示加速度大小，angle表示加速度方向</span></li><li>      <span class="hljs-attr">speed</span>: {</li><li>        <span class="hljs-attr">range</span>: [<span class="hljs-number">3</span>, <span class="hljs-number">9</span>],</li><li>        <span class="hljs-attr">updater</span>: {</li><li>          <span class="hljs-attr">type</span>: <span class="hljs-title class_">ParticleUpdater</span>.<span class="hljs-property">RANDOM</span>,</li><li>          <span class="hljs-attr">config</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">20</span>]</li><li>        }</li><li>      },</li><li>      <span class="hljs-attr">angle</span>: {</li><li>        <span class="hljs-attr">range</span>: [<span class="hljs-number">90</span>, <span class="hljs-number">90</span>]</li><li>      }</li><li>    }</li><li>
</li><li>  }</li><li>]</li><li>}).<span class="hljs-title function_">width</span>(<span class="hljs-number">300</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">300</span>).<span class="hljs-title function_">disturbanceFields</span>([{</li><li>  <span class="hljs-attr">strength</span>: <span class="hljs-number">10</span>,</li><li>  <span class="hljs-attr">shape</span>: <span class="hljs-title class_">DisturbanceFieldShape</span>.<span class="hljs-property">RECT</span>,</li><li>  <span class="hljs-attr">size</span>: { <span class="hljs-attr">width</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">100</span> },</li><li>  <span class="hljs-attr">position</span>: { <span class="hljs-attr">x</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">100</span> },</li><li>  <span class="hljs-attr">feather</span>: <span class="hljs-number">15</span>,</li><li>  <span class="hljs-attr">noiseScale</span>: <span class="hljs-number">10</span>,</li><li>  <span class="hljs-attr">noiseFrequency</span>: <span class="hljs-number">15</span>,</li><li>  <span class="hljs-attr">noiseAmplitude</span>: <span class="hljs-number">5</span></li><li>}])</li><li><span class="hljs-comment">// ...</span></li></ol></pre></div></div>     <p><span><img originheight="223" originwidth="223" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114841.84961247237254389721589966755698:50001231000000:2800:0D4CDF3C9EE44D983585BBA0BD82D6AB0CB1968458F75F27F54B495FA20690C9.gif" class="notEnlarge" width="223" height="223"></span></p>    </div>   </div>   <div></div></div>