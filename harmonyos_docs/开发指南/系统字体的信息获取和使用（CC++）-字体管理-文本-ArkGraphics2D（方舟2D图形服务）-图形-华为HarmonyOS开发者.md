<h1 _ngcontent-frl-c119="" class="doc-title ng-star-inserted" title="系统字体的信息获取和使用（C/C++）"> 系统字体的信息获取和使用（C/C++） </h1>

<div _ngcontent-frl-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="场景介绍">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="场景介绍" tips="复制节点链接"></i></h2>          <p>系统字体是指操作系统预设的字体，用于在没有指定自定义字体时显示文本，确保文本的可读性和一致性。默认的系统字体为“HarmonyOS Sans”。</p>     <p><strong>使用系统字体</strong>的情况通常是在应用未注册自定义字体，或在没有显式指定文本样式时，系统会使用默认的系统字体。另外，系统字体有多种，开发者可以先获取系统字体的配置信息，并根据信息中的字体家族名来进行系统字体的切换和使用。</p>     <p><strong>禁用系统字体</strong>的情况通常发生在开发者希望确保应用中仅使用自定义字体，而不受操作系统默认字体影响的场景。当自定义字体不存在时，不禁用系统字体，系统则会自动回退到默认字体。通过禁用系统字体，开发者可以在任何场景避免字体回退为系统默认字体，确保文本渲染符合设计预期，从而统一应用的视觉风格。</p>    </div>    <div class="tiledSection">     <h2 id="接口说明">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明" tips="复制节点链接"></i></h2>          <p>以下是系统字体相关的常用接口和结构体，详细接口说明请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-drawing" target="_blank">Drawing</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.2.3.1.3.1.1" valign="top" width="50%">接口名</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.3.1.3.1.2" valign="top" width="50%">描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">OH_Drawing_FontConfigInfo* OH_Drawing_GetSystemFontConfigInfo(OH_Drawing_FontConfigInfoErrorCode*)</td>         <td class="cellrowborder" valign="top" width="50%">获取系统字体配置信息，返回系统字体配置信息结构体OH_Drawing_FontConfigInfo。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">void OH_Drawing_DestroySystemFontConfigInfo(OH_Drawing_FontConfigInfo*)</td>         <td class="cellrowborder" valign="top" width="50%">释放系统字体配置信息占用的内存。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_Drawing_FontCollection* OH_Drawing_CreateSharedFontCollection(void)</td>         <td class="cellrowborder" valign="top" width="50%">创建可共享的字体集对象OH_Drawing_FontCollection。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_Drawing_TextStyle* OH_Drawing_CreateTextStyle(void)</td>         <td class="cellrowborder" valign="top" width="50%">创建指向OH_Drawing_TextStyle对象的指针，用于设置文本样式。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_Drawing_SetTextStyleFontFamilies (OH_Drawing_TextStyle *, int, const char *fontFamilies[])</td>         <td class="cellrowborder" valign="top" width="50%">设置指定文本样式的字体家族类型。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">void OH_Drawing_DisableFontCollectionSystemFont(OH_Drawing_FontCollection* fontCollection)</td>         <td class="cellrowborder" valign="top" width="50%">禁用系统字体。</td>        </tr>             </tbody></table></div>     </div>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.2.4.1.3.1.1" valign="top" width="50%">结构体名</th>         <th align="left" class="cellrowborder" id="mcps1.3.2.4.1.3.1.2" valign="top" width="50%">描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">OH_Drawing_FontConfigInfo</td>         <td class="cellrowborder" valign="top" width="50%">系统字体配置信息结构体。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_Drawing_FontGenericInfo</td>         <td class="cellrowborder" valign="top" width="50%">系统所支持的通用字体集信息结构体。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">OH_Drawing_FontFallbackGroup</td>         <td class="cellrowborder" valign="top" width="50%">备用字体集信息结构体。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="获取系统字体信息">获取系统字体信息<i class="anchor-icon anchor-icon-link" anchorid="获取系统字体信息" tips="复制节点链接"></i></h2>          <ol>      <li>       <p>在工程的src/main/cpp/CMakeLists.txt文件中添加以下lib。</p>       <div _ngcontent-frl-c106="" class="highlight-div"><div _ngcontent-frl-c106="" class="highlight-div-header"><div _ngcontent-frl-c106="" class="highlight-div-header-left"><div _ngcontent-frl-c106="" class="handle-button expand-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-frl-c106="" class="highlight-div-header-right"><div _ngcontent-frl-c106="" class="handle-button ai-button"></div><div _ngcontent-frl-c106="" class="handle-button line-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-frl-c106="" class="handle-button theme-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-frl-c106="" class="handle-button copy-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-frl-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-undefined" data-highlighted="yes"><ol class="linenums"><li>libnative_drawing.so</li></ol></pre></div></div></li>      <li>       <p>导入依赖的相关头文件。</p>       <div _ngcontent-frl-c106="" class="highlight-div"><div _ngcontent-frl-c106="" class="highlight-div-header"><div _ngcontent-frl-c106="" class="highlight-div-header-left"><div _ngcontent-frl-c106="" class="handle-button expand-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-frl-c106="" class="highlight-div-header-right"><div _ngcontent-frl-c106="" class="handle-button ai-button"></div><div _ngcontent-frl-c106="" class="handle-button line-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-frl-c106="" class="handle-button theme-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-frl-c106="" class="handle-button copy-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-frl-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;native_drawing/drawing_font_collection.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;native_drawing/drawing_text_typography.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;native_drawing/drawing_register_font.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;hilog/log.h&gt;</span></span></li></ol></pre></div></div></li>      <li>       <p>获取系统字体的配置信息，可以通过返回的状态码确定获取信息是否成功，状态码的包含的具体情况和对应含义可见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-drawing-text-typography-h#oh_drawing_fontconfiginfoerrorcode" target="_blank">OH_Drawing_FontConfigInfoErrorCode</a>。</p>       <div _ngcontent-frl-c106="" class="highlight-div"><div _ngcontent-frl-c106="" class="highlight-div-header"><div _ngcontent-frl-c106="" class="highlight-div-header-left"><div _ngcontent-frl-c106="" class="handle-button expand-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-frl-c106="" class="highlight-div-header-right"><div _ngcontent-frl-c106="" class="handle-button ai-button"></div><div _ngcontent-frl-c106="" class="handle-button line-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-frl-c106="" class="handle-button theme-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-frl-c106="" class="handle-button copy-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-frl-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">OH_Drawing_FontConfigInfoErrorCode</span> <span class="hljs-variable">fontConfigInfoErrorCode</span>;  <span class="hljs-comment">// 用于接收错误代码</span></li><li><span class="hljs-variable">OH_Drawing_FontConfigInfo</span>* <span class="hljs-variable">fontConfigInfo</span> = <span class="hljs-title function_">OH_Drawing_GetSystemFontConfigInfo</span>(&amp;<span class="hljs-title class_">fontConfigInfoErrorCode</span>);</li><li><span class="hljs-keyword">if</span>(<span class="hljs-variable">fontConfigInfoErrorCode</span> != <span class="hljs-variable">SUCCESS_FONT_CONFIG_INFO</span>) {</li><li>    <span class="hljs-title function_">OH_LOG_Print</span>(<span class="hljs-variable">LOG_APP</span>, <span class="hljs-variable">LOG_ERROR</span>, <span class="hljs-variable">LOG_DOMAIN</span>, <span class="hljs-string">"DrawingSample"</span>, <span class="hljs-string">"获取系统信息失败，错误代码为： %{public}d"</span>, <span class="hljs-variable">fontConfigInfoErrorCode</span>);</li><li>}</li></ol></pre></div></div></li>      <li>       <p>系统字体的配置信息<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-drawing-oh-drawing-fontconfiginfo" target="_blank">OH_Drawing_FontConfigInfo</a>包含以下几类信息：</p>       <ul>        <li>         <p>系统字体文件路径数量。</p></li>        <li>         <p>通用字体集列表数量。</p></li>        <li>         <p>备用字体集列表数量。</p></li>        <li>         <p>系统字体文件路径列表。</p></li>        <li>         <p>通用字体集列表，具体信息可见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-drawing-oh-drawing-fontgenericinfo" target="_blank">OH_Drawing_FontGenericInfo</a>结构体。</p></li>        <li>         <p>备用字体集列表，具体信息可见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/capi-drawing-oh-drawing-fontfallbackgroup" target="_blank">OH_Drawing_FontFallbackGroup</a>结构体。</p></li>       </ul>       <p>以下示例展示系统字体的一些具体配置信息的获取：</p>       <div _ngcontent-frl-c106="" class="highlight-div"><div _ngcontent-frl-c106="" class="highlight-div-header"><div _ngcontent-frl-c106="" class="highlight-div-header-left"><div _ngcontent-frl-c106="" class="handle-button expand-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-frl-c106="" class="highlight-div-header-right"><div _ngcontent-frl-c106="" class="handle-button ai-button"></div><div _ngcontent-frl-c106="" class="handle-button line-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-frl-c106="" class="handle-button theme-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-frl-c106="" class="handle-button copy-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-frl-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 获取系统字体配置信息示例</span></li><li><span class="hljs-keyword">if</span> (<span class="hljs-variable">fontConfigInfo</span> != <span class="hljs-variable">nullptr</span>) {</li><li>    <span class="hljs-comment">// 获取字体文件路径数量，打印日志</span></li><li>    <span class="hljs-variable">size_t</span> <span class="hljs-variable">fontDirCount</span> = <span class="hljs-variable">fontConfigInfo</span>-&gt;<span class="hljs-title class_">fontDirSize</span>;</li><li>    <span class="hljs-title function_">OH_LOG_Print</span>(<span class="hljs-variable">LOG_APP</span>, <span class="hljs-variable">LOG_INFO</span>, <span class="hljs-variable">LOG_DOMAIN</span>, <span class="hljs-string">"DrawingSample"</span>, <span class="hljs-string">"字体文件路径数量为: %{public}zu\n"</span>, <span class="hljs-variable">fontDirCount</span>);</li><li>    <span class="hljs-comment">// 遍历字体文件路径列表，打印日志</span></li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-variable">size_t</span> <span class="hljs-variable">i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">i</span> &lt; <span class="hljs-title class_">fontDirCount</span>; ++<span class="hljs-title class_">i</span>) {</li><li>        <span class="hljs-title function_">OH_LOG_Print</span>(<span class="hljs-variable">LOG_APP</span>, <span class="hljs-variable">LOG_INFO</span>, <span class="hljs-variable">LOG_DOMAIN</span>, <span class="hljs-string">"DrawingSample"</span>, <span class="hljs-string">"字体文件路径为: %{public}s\n"</span>, <span class="hljs-variable">fontConfigInfo</span>-&gt;<span class="hljs-title class_">fontDirSet</span>[<span class="hljs-title class_">i</span>]);</li><li>    }</li><li>    <span class="hljs-comment">// 获取通用字体集数量，打印日志</span></li><li>    <span class="hljs-variable">size_t</span> <span class="hljs-variable">genericCount</span> = <span class="hljs-variable">fontConfigInfo</span>-&gt;<span class="hljs-title class_">fontGenericInfoSize</span>;</li><li>    <span class="hljs-title function_">OH_LOG_Print</span>(<span class="hljs-variable">LOG_APP</span>, <span class="hljs-variable">LOG_INFO</span>, <span class="hljs-variable">LOG_DOMAIN</span>, <span class="hljs-string">"DrawingSample"</span>, <span class="hljs-string">"通用字体集数量为: %{public}zu\n"</span>, <span class="hljs-variable">genericCount</span>);</li><li>    <span class="hljs-comment">// 遍历获取每个通用字体集中的字体家族名（例如 HarmonyOS Sans），打印日志</span></li><li>    <span class="hljs-keyword">for</span>(<span class="hljs-variable">size_t</span> <span class="hljs-variable">i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">i</span> &lt; <span class="hljs-title class_">genericCount</span>; ++<span class="hljs-title class_">i</span>) {</li><li>        <span class="hljs-variable">OH_Drawing_FontGenericInfo</span>&amp; <span class="hljs-variable">genericInfo</span> = <span class="hljs-variable">fontConfigInfo</span>-&gt;<span class="hljs-title class_">fontGenericInfoSet</span>[<span class="hljs-title class_">i</span>];</li><li>        <span class="hljs-title function_">OH_LOG_Print</span>(<span class="hljs-variable">LOG_APP</span>, <span class="hljs-variable">LOG_INFO</span>, <span class="hljs-variable">LOG_DOMAIN</span>, <span class="hljs-string">"DrawingSample"</span>, <span class="hljs-string">"获取第%{public}zu个通用字体集中的字体家族名为: %{public}s"</span>, <span class="hljs-variable">i</span>, <span class="hljs-variable">genericInfo</span>.<span class="hljs-variable">familyName</span>);</li><li>    }</li><li>}</li></ol></pre></div></div>       <p>以下打印的示例为应用设备系统对应的部分系统字体配置信息情况，不同设备系统配置信息可能不同，此处仅示意。</p>       <p><span><img originheight="176" originwidth="1041" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114411.23386180516989568893002253721444:50001231000000:2800:CA7A682F9FC27FC001061539C61D64238B273ED821BC4F29B92391C35E098B7F.png" width="920" height="155.54274735830933"></span></p></li>      <li>       <p>如若后续不再需要系统字体的系统配置信息时，则释放其占用的内存。</p>       <div _ngcontent-frl-c106="" class="highlight-div"><div _ngcontent-frl-c106="" class="highlight-div-header"><div _ngcontent-frl-c106="" class="highlight-div-header-left"><div _ngcontent-frl-c106="" class="handle-button expand-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-frl-c106="" class="highlight-div-header-right"><div _ngcontent-frl-c106="" class="handle-button ai-button"></div><div _ngcontent-frl-c106="" class="handle-button line-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-frl-c106="" class="handle-button theme-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-frl-c106="" class="handle-button copy-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-frl-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">OH_Drawing_DestroySystemFontConfigInfo</span>(fontConfigInfo);</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="使用或切换系统字体">使用或切换系统字体<i class="anchor-icon anchor-icon-link" anchorid="使用或切换系统字体" tips="复制节点链接"></i></h2>          <p>系统字体可以有多种，可以先获取系统字体配置信息，再根据其中的字体家族名来进行系统字体的切换和使用。</p>     <p>如果不指定使用任何字体时，会使用系统默认字体“HarmonyOS Sans”显示文本。</p>     <ol>      <li>       <p>在工程的src/main/cpp/CMakeLists.txt文件中添加以下lib。</p>       <div _ngcontent-frl-c106="" class="highlight-div"><div _ngcontent-frl-c106="" class="highlight-div-header"><div _ngcontent-frl-c106="" class="highlight-div-header-left"><div _ngcontent-frl-c106="" class="handle-button expand-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-frl-c106="" class="highlight-div-header-right"><div _ngcontent-frl-c106="" class="handle-button ai-button"></div><div _ngcontent-frl-c106="" class="handle-button line-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-frl-c106="" class="handle-button theme-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-frl-c106="" class="handle-button copy-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-frl-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-undefined" data-highlighted="yes"><ol class="linenums"><li>libnative_drawing.so</li></ol></pre></div></div></li>      <li>       <p>导入依赖的相关头文件。</p>       <div _ngcontent-frl-c106="" class="highlight-div"><div _ngcontent-frl-c106="" class="highlight-div-header"><div _ngcontent-frl-c106="" class="highlight-div-header-left"><div _ngcontent-frl-c106="" class="handle-button expand-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-frl-c106="" class="highlight-div-header-right"><div _ngcontent-frl-c106="" class="handle-button ai-button"></div><div _ngcontent-frl-c106="" class="handle-button line-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-frl-c106="" class="handle-button theme-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-frl-c106="" class="handle-button copy-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-frl-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;native_drawing/drawing_font_collection.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;native_drawing/drawing_text_typography.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;native_drawing/drawing_register_font.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;hilog/log.h&gt;</span></span></li></ol></pre></div></div></li>      <li>       <p>创建字体管理器，建议优先使用OH_Drawing_CreateSharedFontCollection创建可共享的字体集对象。</p>       <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">         <p>使用OH_Drawing_CreateFontCollection和OH_Drawing_CreateSharedFontCollection均可创建字体管理器OH_Drawing_FontCollection对象，但前者创建的字体集指针对象只能被一个段落生成器OH_Drawing_TypographyCreate对象使用，无法被多个段落生成器OH_Drawing_TypographyCreate对象共享使用。如需在多个段落生成器OH_Drawing_TypographyCreate对象间共享使用，请使用后者创建可共享的字体集对象。</p>        </div></div></div>       <div _ngcontent-frl-c106="" class="highlight-div"><div _ngcontent-frl-c106="" class="highlight-div-header"><div _ngcontent-frl-c106="" class="highlight-div-header-left"><div _ngcontent-frl-c106="" class="handle-button expand-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-frl-c106="" class="highlight-div-header-right"><div _ngcontent-frl-c106="" class="handle-button ai-button"></div><div _ngcontent-frl-c106="" class="handle-button line-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-frl-c106="" class="handle-button theme-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-frl-c106="" class="handle-button copy-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-frl-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-undefined" data-highlighted="yes"><ol class="linenums"><li>OH_Drawing_FontCollection *fontCollection = OH_Drawing_CreateSharedFontCollection();</li></ol></pre></div></div></li>      <li>       <p>创建一个文本样式对象，即OH_Drawing_TextStyle对象，用于设置文本样式。</p>       <div _ngcontent-frl-c106="" class="highlight-div"><div _ngcontent-frl-c106="" class="highlight-div-header"><div _ngcontent-frl-c106="" class="highlight-div-header-left"><div _ngcontent-frl-c106="" class="handle-button expand-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-frl-c106="" class="highlight-div-header-right"><div _ngcontent-frl-c106="" class="handle-button ai-button"></div><div _ngcontent-frl-c106="" class="handle-button line-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-frl-c106="" class="handle-button theme-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-frl-c106="" class="handle-button copy-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-frl-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-undefined" data-highlighted="yes"><ol class="linenums"><li>OH_Drawing_TextStyle* textStyle = OH_Drawing_CreateTextStyle();</li></ol></pre></div></div></li>      <li>       <p><a href="/consumer/cn/doc/harmonyos-guides/system-font-c#获取系统字体信息">获取系统字体信息</a>，获取系统字体的字体家族名，并在文本样式中设置为该系统字体。</p>       <div _ngcontent-frl-c106="" class="highlight-div"><div _ngcontent-frl-c106="" class="highlight-div-header"><div _ngcontent-frl-c106="" class="highlight-div-header-left"><div _ngcontent-frl-c106="" class="handle-button expand-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-frl-c106="" class="highlight-div-header-right"><div _ngcontent-frl-c106="" class="handle-button ai-button"></div><div _ngcontent-frl-c106="" class="handle-button line-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-frl-c106="" class="handle-button theme-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-frl-c106="" class="handle-button copy-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-frl-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 情况一：设置系统字体为"HarmonyOS Sans Condensed"</span></li><li><span class="hljs-type">const</span> <span class="hljs-type">char</span>* myFontFamilies[] = {<span class="hljs-string">"HarmonyOS Sans Condensed"</span>};</li><li><span class="hljs-built_in">OH_Drawing_SetTextStyleFontFamilies</span>(textStyle, <span class="hljs-number">1</span>, myFontFamilies);</li><li>
</li><li><span class="hljs-comment">// 情况二：不手动设置，此时使用的是系统默认字体"HarmonyOS Sans"</span></li><li><span class="hljs-comment">// const char* myFontFamilies[] = {"HarmonyOS Sans Condensed"};</span></li><li><span class="hljs-comment">// OH_Drawing_SetTextStyleFontFamilies(textStyle, 1, myFontFamilies);</span></li></ol></pre></div></div></li>      <li>       <p>生成最终段落文本，以便实现最终的文本绘制和显示。</p>       <div _ngcontent-frl-c106="" class="highlight-div"><div _ngcontent-frl-c106="" class="highlight-div-header"><div _ngcontent-frl-c106="" class="highlight-div-header-left"><div _ngcontent-frl-c106="" class="handle-button expand-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-frl-c106="" class="highlight-div-header-right"><div _ngcontent-frl-c106="" class="handle-button ai-button"></div><div _ngcontent-frl-c106="" class="handle-button line-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-frl-c106="" class="handle-button theme-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-frl-c106="" class="handle-button copy-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-frl-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 设置其他文本样式</span></li><li><span class="hljs-built_in">OH_Drawing_SetTextStyleColor</span>(textStyle , <span class="hljs-built_in">OH_Drawing_ColorSetArgb</span>(<span class="hljs-number">0xFF</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>));</li><li><span class="hljs-built_in">OH_Drawing_SetTextStyleFontSize</span>(textStyle , <span class="hljs-number">70.0</span>);</li><li><span class="hljs-comment">// 创建一个段落样式对象，以设置排版风格</span></li><li>OH_Drawing_TypographyStyle *typographyStyle = <span class="hljs-built_in">OH_Drawing_CreateTypographyStyle</span>();</li><li><span class="hljs-built_in">OH_Drawing_SetTypographyTextAlign</span>(typographyStyle, TEXT_ALIGN_LEFT); <span class="hljs-comment">// 设置段落样式为左对齐</span></li><li><span class="hljs-comment">// 创建一个段落生成器</span></li><li>OH_Drawing_TypographyCreate* handler = <span class="hljs-built_in">OH_Drawing_CreateTypographyHandler</span>(typographyStyle, fontCollection);</li><li><span class="hljs-comment">// 在段落生成器中设置文本样式</span></li><li><span class="hljs-built_in">OH_Drawing_TypographyHandlerPushTextStyle</span>(handler, textStyle);</li><li><span class="hljs-comment">// 在段落生成器中设置文本内容</span></li><li><span class="hljs-type">const</span> <span class="hljs-type">char</span>* text = <span class="hljs-string">"Hello World. 你好世界。\n以上文字使用了系统字体"</span>;</li><li><span class="hljs-built_in">OH_Drawing_TypographyHandlerAddText</span>(handler, text);</li><li><span class="hljs-comment">// 通过段落生成器生成段落</span></li><li>OH_Drawing_Typography* typography = <span class="hljs-built_in">OH_Drawing_CreateTypography</span>(handler);</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="禁用系统字体">禁用系统字体<i class="anchor-icon anchor-icon-link" anchorid="禁用系统字体" tips="复制节点链接"></i></h2>          <p>当自定义字体不存在时，不禁用系统字体，系统则会自动回退到默认字体。通过禁用系统字体，开发者可以在任何场景避免字体回退为系统默认字体，确保文本渲染符合设计预期，从而统一应用的视觉风格。</p>     <p>在一些应用场景中，开发者可能希望只使用自定义字体来确保字体一致性或提供更具个性化的用户体验。此时，开发者可以通过禁用系统字体，确保应用只使用注册的自定义字体，而不依赖于系统字体。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>禁用系统字体后，请确保注册使用自定义字体，否则文本将无法正常显示。</p>      </div></div></div>     <ol>      <li>       <p>确保已成功注册自定义字体，用于保证禁用系统字体后文本的正常显示，具体可见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/custom-font-c">自定义字体的注册和使用</a>。</p></li>      <li>       <p>在工程的src/main/cpp/CMakeLists.txt文件中添加以下lib。</p>       <div _ngcontent-frl-c106="" class="highlight-div"><div _ngcontent-frl-c106="" class="highlight-div-header"><div _ngcontent-frl-c106="" class="highlight-div-header-left"><div _ngcontent-frl-c106="" class="handle-button expand-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-frl-c106="" class="highlight-div-header-right"><div _ngcontent-frl-c106="" class="handle-button ai-button"></div><div _ngcontent-frl-c106="" class="handle-button line-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-frl-c106="" class="handle-button theme-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-frl-c106="" class="handle-button copy-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-frl-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-undefined" data-highlighted="yes"><ol class="linenums"><li>libnative_drawing.so</li></ol></pre></div></div></li>      <li>       <p>导入依赖的相关头文件。</p>       <div _ngcontent-frl-c106="" class="highlight-div"><div _ngcontent-frl-c106="" class="highlight-div-header"><div _ngcontent-frl-c106="" class="highlight-div-header-left"><div _ngcontent-frl-c106="" class="handle-button expand-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-frl-c106="" class="highlight-div-header-right"><div _ngcontent-frl-c106="" class="handle-button ai-button"></div><div _ngcontent-frl-c106="" class="handle-button line-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-frl-c106="" class="handle-button theme-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-frl-c106="" class="handle-button copy-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-frl-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;native_drawing/drawing_font_collection.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;native_drawing/drawing_text_typography.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;native_drawing/drawing_register_font.h&gt;</span></span></li><li><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;hilog/log.h&gt;</span></span></li></ol></pre></div></div></li>      <li>       <p>创建字体管理器，建议优先使用OH_Drawing_CreateSharedFontCollection创建可共享的字体集对象。</p>       <div _ngcontent-frl-c106="" class="highlight-div"><div _ngcontent-frl-c106="" class="highlight-div-header"><div _ngcontent-frl-c106="" class="highlight-div-header-left"><div _ngcontent-frl-c106="" class="handle-button expand-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-frl-c106="" class="highlight-div-header-right"><div _ngcontent-frl-c106="" class="handle-button ai-button"></div><div _ngcontent-frl-c106="" class="handle-button line-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-frl-c106="" class="handle-button theme-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-frl-c106="" class="handle-button copy-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-frl-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-undefined" data-highlighted="yes"><ol class="linenums"><li>OH_Drawing_FontCollection *fontCollection = OH_Drawing_CreateSharedFontCollection();</li></ol></pre></div></div></li>      <li>       <p>禁用系统字体。</p>       <div _ngcontent-frl-c106="" class="highlight-div"><div _ngcontent-frl-c106="" class="highlight-div-header"><div _ngcontent-frl-c106="" class="highlight-div-header-left"><div _ngcontent-frl-c106="" class="handle-button expand-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-frl-c106="" class="highlight-div-header-right"><div _ngcontent-frl-c106="" class="handle-button ai-button"></div><div _ngcontent-frl-c106="" class="handle-button line-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-frl-c106="" class="handle-button theme-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-frl-c106="" class="handle-button copy-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-frl-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-scss" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">OH_Drawing_DisableFontCollectionSystemFont</span>(fontCollection);</li></ol></pre></div></div></li>      <li>       <p>创建文本样式对象，使用注册成功的自定义字体。</p>       <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">         <p>若不设置字体，文本会默认使用系统字体，而系统字体禁用后若不设置使用自定义字体，文本将无法正常显示。</p>        </div></div></div>       <div _ngcontent-frl-c106="" class="highlight-div"><div _ngcontent-frl-c106="" class="highlight-div-header"><div _ngcontent-frl-c106="" class="highlight-div-header-left"><div _ngcontent-frl-c106="" class="handle-button expand-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-frl-c106="" class="highlight-div-header-right"><div _ngcontent-frl-c106="" class="handle-button ai-button"></div><div _ngcontent-frl-c106="" class="handle-button line-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-frl-c106="" class="handle-button theme-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-frl-c106="" class="handle-button copy-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-frl-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li>OH_Drawing_TextStyle* textStyle = <span class="hljs-built_in">OH_Drawing_CreateTextStyle</span>();</li><li><span class="hljs-comment">// 禁用系统字体后的几种情况如下：</span></li><li><span class="hljs-comment">// 情况一：如果此时设置使用了自定义字体，文本会正常显示</span></li><li><span class="hljs-type">const</span> <span class="hljs-type">char</span>* myFontFamilies[] = {<span class="hljs-string">"myFamilyName"</span>}; <span class="hljs-comment">//确保已成功注册自定义字体，填入自定义字体的字体家族名</span></li><li><span class="hljs-built_in">OH_Drawing_SetTextStyleFontFamilies</span>(textStyle, <span class="hljs-number">1</span>, myFontFamilies);</li><li>
</li><li><span class="hljs-comment">// 情况二：如果此时使用了系统字体，文本将无法显示</span></li><li><span class="hljs-type">const</span> <span class="hljs-type">char</span>* myFontFamilies[] = {<span class="hljs-string">"HarmonyOS_Sans"</span>};</li><li><span class="hljs-built_in">OH_Drawing_SetTextStyleFontFamilies</span>(textStyle, <span class="hljs-number">1</span>, myFontFamilies);</li><li>
</li><li><span class="hljs-comment">// 情况三：如果此时不设置使用字体，文本会默认使用系统默认字体，而此时系统字体已被禁用，因此文本将无法显示</span></li><li><span class="hljs-type">const</span> <span class="hljs-type">char</span>* myFontFamilies[] = {<span class="hljs-string">"HarmonyOS_Sans"</span>};</li><li><span class="hljs-comment">// OH_Drawing_SetTextStyleFontFamilies(textStyle, 1, myFontFamilies);</span></li></ol></pre></div></div></li>      <li>       <p>生成最终的段落文本，以便实现最终的文本绘制和显示。</p>       <div _ngcontent-frl-c106="" class="highlight-div"><div _ngcontent-frl-c106="" class="highlight-div-header"><div _ngcontent-frl-c106="" class="highlight-div-header-left"><div _ngcontent-frl-c106="" class="handle-button expand-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-frl-c106="" class="highlight-div-header-right"><div _ngcontent-frl-c106="" class="handle-button ai-button"></div><div _ngcontent-frl-c106="" class="handle-button line-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-frl-c106="" class="handle-button theme-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-frl-c106="" class="handle-button copy-button"><div _ngcontent-frl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-frl-c106="" class="highlight-scroll-div"><pre class="prettyprint linenums hljs language-cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 设置其他文本样式</span></li><li><span class="hljs-built_in">OH_Drawing_SetTextStyleColor</span>(textStyle , <span class="hljs-built_in">OH_Drawing_ColorSetArgb</span>(<span class="hljs-number">0xFF</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x00</span>));</li><li><span class="hljs-built_in">OH_Drawing_SetTextStyleFontSize</span>(textStyle , <span class="hljs-number">70.0</span>);</li><li><span class="hljs-comment">// 创建一个段落样式对象，以设置排版风格</span></li><li>OH_Drawing_TypographyStyle *typographyStyle = <span class="hljs-built_in">OH_Drawing_CreateTypographyStyle</span>();</li><li><span class="hljs-built_in">OH_Drawing_SetTypographyTextAlign</span>(typographyStyle, TEXT_ALIGN_LEFT); <span class="hljs-comment">// 设置段落样式为左对齐</span></li><li><span class="hljs-comment">// 创建一个段落生成器</span></li><li>OH_Drawing_TypographyCreate* handler = <span class="hljs-built_in">OH_Drawing_CreateTypographyHandler</span>(typographyStyle, fontCollection);</li><li><span class="hljs-comment">// 在段落生成器中设置文本样式</span></li><li><span class="hljs-built_in">OH_Drawing_TypographyHandlerPushTextStyle</span>(handler, textStyle);</li><li><span class="hljs-comment">// 在段落生成器中设置文本内容</span></li><li><span class="hljs-type">const</span> <span class="hljs-type">char</span>* text = <span class="hljs-string">"Hello World. 你好世界。\n以上文字使用了主题字体"</span>;</li><li><span class="hljs-built_in">OH_Drawing_TypographyHandlerAddText</span>(handler, text);</li><li><span class="hljs-comment">// 通过段落生成器生成段落</span></li><li>OH_Drawing_Typography* typography = <span class="hljs-built_in">OH_Drawing_CreateTypography</span>(handler);</li></ol></pre></div></div></li>     </ol>    </div>   </div>   <div></div></div>