<h1 _ngcontent-ugi-c119="" class="doc-title ng-star-inserted" title="系统相册资源使用指导"> 系统相册资源使用指导 </h1>

<div _ngcontent-ugi-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>photoAccessHelper提供对收藏夹、视频相册、截屏和录屏相册的相关操作。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>在进行功能开发前，请查阅<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-preparation">开发准备</a>，了解如何获取相册管理模块实例及申请相关权限。</p>      <p>文档中使用到PhotoAccessHelper的地方，默认使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-preparation">开发准备</a>中获取的对象，如未添加此段代码提示PhotoAccessHelper未定义的错误请自行添加。</p>     </div></div></div>    <p>为了保证应用的运行效率，大部分photoAccessHelper的接口调用都是异步的。以下异步调用的API示例均采用Promise函数，更多方式可以查阅<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper" target="_blank">API参考</a>。</p>    <p>如无特别说明，文档中涉及的待获取的资源均视为已经预置且在数据库中存在相应数据。如出现按照示例代码执行出现获取资源为空的情况，请确认文件是否已预置，数据库中是否存在该文件的数据。</p>    <div class="tiledSection">     <h2 id="收藏夹">收藏夹<i class="anchor-icon anchor-icon-link" anchorid="收藏夹" tips="复制节点链接"></i></h2>          <p>收藏夹属于系统相册，对图片或视频设置收藏时会自动将其加入到收藏夹中，取消收藏则会从收藏夹中移除。</p>    </div>    <div class="tiledSection">     <h3 id="获取收藏夹对象" class="firsth2">获取收藏夹对象<i class="anchor-icon anchor-icon-link" anchorid="获取收藏夹对象" tips="复制节点链接"></i></h3>          <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-photoaccesshelper#getalbums-2" target="_blank">PhotoAccessHelper.getAlbums</a>接口获取收藏夹对象。</p>     <p><strong>前提条件</strong></p>     <ul>      <li>获取相册管理模块photoAccessHelper实例。</li>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-preparation#申请相册管理模块功能相关权限">申请相册管理模块权限</a>'ohos.permission.READ_IMAGEVIDEO'。</li>     </ul>     <p><strong>开发步骤</strong></p>     <ol>      <li>设置获取收藏夹的参数为photoAccessHelper.AlbumType.SYSTEM和photoAccessHelper.AlbumSubtype.FAVORITE。</li>      <li>调用PhotoAccessHelper.getAlbums接口获取收藏夹对象。</li>     </ol>     <div _ngcontent-ugi-c106="" class="highlight-div"><div _ngcontent-ugi-c106="" class="highlight-div-header"><div _ngcontent-ugi-c106="" class="highlight-div-header-left"><div _ngcontent-ugi-c106="" class="handle-button expand-button"><div _ngcontent-ugi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ugi-c106="" class="highlight-div-header-right"><div _ngcontent-ugi-c106="" class="handle-button ai-button"></div><div _ngcontent-ugi-c106="" class="handle-button line-button"><div _ngcontent-ugi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ugi-c106="" class="handle-button theme-button"><div _ngcontent-ugi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ugi-c106="" class="handle-button copy-button"><div _ngcontent-ugi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ugi-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { photoAccessHelper } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MediaLibraryKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">example</span>(<span class="hljs-params">phAccessHelper: photoAccessHelper.PhotoAccessHelper</span>) {</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">fetchResult</span>: photoAccessHelper.<span class="hljs-property">FetchResult</span>&lt;photoAccessHelper.<span class="hljs-property">Album</span>&gt; = <span class="hljs-keyword">await</span> phAccessHelper.<span class="hljs-title function_">getAlbums</span>(photoAccessHelper.<span class="hljs-property">AlbumType</span>.<span class="hljs-property">SYSTEM</span>, photoAccessHelper.<span class="hljs-property">AlbumSubtype</span>.<span class="hljs-property">FAVORITE</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">album</span>: photoAccessHelper.<span class="hljs-property">Album</span> = <span class="hljs-keyword">await</span> fetchResult.<span class="hljs-title function_">getFirstObject</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'get favorite album successfully, albumUri: '</span> + album.<span class="hljs-property">albumUri</span>);</li><li>    fetchResult.<span class="hljs-title function_">close</span>();</li><li>  } <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'get favorite album failed with err: '</span> + err);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="获取收藏夹中的图片和视频">获取收藏夹中的图片和视频<i class="anchor-icon anchor-icon-link" anchorid="获取收藏夹中的图片和视频" tips="复制节点链接"></i></h3>          <p>先<a href="/consumer/cn/doc/harmonyos-guides/photoaccesshelper-systemalbum-guidelines#获取收藏夹对象">获取收藏夹对象</a>。然后调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-absalbum#getassets-1" target="_blank">Album.getAssets</a>接口获取收藏夹中的资源。</p>     <p><strong>前提条件</strong></p>     <ul>      <li>获取相册管理模块photoAccessHelper实例。</li>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-preparation#申请相册管理模块功能相关权限">申请相册管理模块权限</a>'ohos.permission.READ_IMAGEVIDEO'。</li>     </ul>     <p>下面以获取收藏夹中的一张图片为例。</p>     <p><strong>开发步骤</strong></p>     <ol>      <li><a href="/consumer/cn/doc/harmonyos-guides/photoaccesshelper-systemalbum-guidelines#获取收藏夹对象">获取收藏夹对象</a>。</li>      <li>建立图片检索条件，用于获取图片。</li>      <li>调用Album.getAssets接口获取图片资源。</li>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-fetchresult#getfirstobject-1" target="_blank">FetchResult.getFirstObject</a>接口获取第一张图片。</li>     </ol>     <div _ngcontent-ugi-c106="" class="highlight-div"><div _ngcontent-ugi-c106="" class="highlight-div-header"><div _ngcontent-ugi-c106="" class="highlight-div-header-left"><div _ngcontent-ugi-c106="" class="handle-button expand-button"><div _ngcontent-ugi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ugi-c106="" class="highlight-div-header-right"><div _ngcontent-ugi-c106="" class="handle-button ai-button"></div><div _ngcontent-ugi-c106="" class="handle-button line-button"><div _ngcontent-ugi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ugi-c106="" class="handle-button theme-button"><div _ngcontent-ugi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ugi-c106="" class="handle-button copy-button"><div _ngcontent-ugi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ugi-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataSharePredicates } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkData'</span>;</li><li><span class="hljs-keyword">import</span> { photoAccessHelper } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MediaLibraryKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">example</span>(<span class="hljs-params">phAccessHelper: photoAccessHelper.PhotoAccessHelper</span>) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">predicates</span>: dataSharePredicates.<span class="hljs-property">DataSharePredicates</span> = <span class="hljs-keyword">new</span> dataSharePredicates.<span class="hljs-title class_">DataSharePredicates</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">fetchOptions</span>: photoAccessHelper.<span class="hljs-property">FetchOptions</span> = {</li><li>    <span class="hljs-attr">fetchColumns</span>: [],</li><li>    <span class="hljs-attr">predicates</span>: predicates</li><li>  };</li><li>
</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">albumFetchResult</span>: photoAccessHelper.<span class="hljs-property">FetchResult</span>&lt;photoAccessHelper.<span class="hljs-property">Album</span>&gt; = <span class="hljs-keyword">await</span> phAccessHelper.<span class="hljs-title function_">getAlbums</span>(photoAccessHelper.<span class="hljs-property">AlbumType</span>.<span class="hljs-property">SYSTEM</span>, photoAccessHelper.<span class="hljs-property">AlbumSubtype</span>.<span class="hljs-property">FAVORITE</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">album</span>: photoAccessHelper.<span class="hljs-property">Album</span> = <span class="hljs-keyword">await</span> albumFetchResult.<span class="hljs-title function_">getFirstObject</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'get favorite album successfully, albumUri: '</span> + album.<span class="hljs-property">albumUri</span>);</li><li>
</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">photoFetchResult</span>: photoAccessHelper.<span class="hljs-property">FetchResult</span>&lt;photoAccessHelper.<span class="hljs-property">PhotoAsset</span>&gt; = <span class="hljs-keyword">await</span> album.<span class="hljs-title function_">getAssets</span>(fetchOptions);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">photoAsset</span>: photoAccessHelper.<span class="hljs-property">PhotoAsset</span> = <span class="hljs-keyword">await</span> photoFetchResult.<span class="hljs-title function_">getFirstObject</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'favorite album getAssets successfully, photoAsset displayName: '</span> + photoAsset.<span class="hljs-property">displayName</span>);</li><li>    photoFetchResult.<span class="hljs-title function_">close</span>();</li><li>    albumFetchResult.<span class="hljs-title function_">close</span>();</li><li>  } <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'favorite failed with err: '</span> + err);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="视频相册">视频相册<i class="anchor-icon anchor-icon-link" anchorid="视频相册" tips="复制节点链接"></i></h2>          <p>视频相册属于系统相册，用户文件中属于视频类型的媒体文件会自动加入到视频相册中。</p>    </div>    <div class="tiledSection">     <h3 id="获取视频相册对象" class="firsth2">获取视频相册对象<i class="anchor-icon anchor-icon-link" anchorid="获取视频相册对象" tips="复制节点链接"></i></h3>          <p>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-photoaccesshelper#getalbums-2" target="_blank">PhotoAccessHelper.getAlbums</a>接口获取视频相册对象。</p>     <p><strong>前提条件</strong></p>     <ul>      <li>获取相册管理模块photoAccessHelper实例。</li>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-preparation#申请相册管理模块功能相关权限">申请相册管理模块权限</a>'ohos.permission.READ_IMAGEVIDEO'。</li>     </ul>     <p><strong>开发步骤</strong></p>     <ol>      <li>设置获取视频相册的参数为photoAccessHelper.AlbumType.SYSTEM和photoAccessHelper.AlbumSubtype.VIDEO。</li>      <li>调用PhotoAccessHelper.getAlbums接口获取视频相册。</li>     </ol>     <div _ngcontent-ugi-c106="" class="highlight-div"><div _ngcontent-ugi-c106="" class="highlight-div-header"><div _ngcontent-ugi-c106="" class="highlight-div-header-left"><div _ngcontent-ugi-c106="" class="handle-button expand-button"><div _ngcontent-ugi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ugi-c106="" class="highlight-div-header-right"><div _ngcontent-ugi-c106="" class="handle-button ai-button"></div><div _ngcontent-ugi-c106="" class="handle-button line-button"><div _ngcontent-ugi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ugi-c106="" class="handle-button theme-button"><div _ngcontent-ugi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ugi-c106="" class="handle-button copy-button"><div _ngcontent-ugi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ugi-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { photoAccessHelper } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MediaLibraryKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">example</span>(<span class="hljs-params">phAccessHelper: photoAccessHelper.PhotoAccessHelper</span>) {</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">fetchResult</span>: photoAccessHelper.<span class="hljs-property">FetchResult</span>&lt;photoAccessHelper.<span class="hljs-property">Album</span>&gt; = <span class="hljs-keyword">await</span> phAccessHelper.<span class="hljs-title function_">getAlbums</span>(photoAccessHelper.<span class="hljs-property">AlbumType</span>.<span class="hljs-property">SYSTEM</span>, photoAccessHelper.<span class="hljs-property">AlbumSubtype</span>.<span class="hljs-property">VIDEO</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">album</span>: photoAccessHelper.<span class="hljs-property">Album</span> = <span class="hljs-keyword">await</span> fetchResult.<span class="hljs-title function_">getFirstObject</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'get video album successfully, albumUri: '</span> + album.<span class="hljs-property">albumUri</span>);</li><li>    fetchResult.<span class="hljs-title function_">close</span>();</li><li>  } <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'get video album failed with err: '</span> + err);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="获取视频相册中的视频">获取视频相册中的视频<i class="anchor-icon anchor-icon-link" anchorid="获取视频相册中的视频" tips="复制节点链接"></i></h3>          <p>先<a href="/consumer/cn/doc/harmonyos-guides/photoaccesshelper-systemalbum-guidelines#获取视频相册对象">获取视频相册对象</a>。然后调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-absalbum#getassets-1" target="_blank">Album.getAssets</a>接口获取视频相册对象中的视频资源。</p>     <p><strong>前提条件</strong></p>     <ul>      <li>获取相册管理模块photoAccessHelper实例。</li>      <li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/photoaccesshelper-preparation#申请相册管理模块功能相关权限">申请相册管理模块权限</a>'ohos.permission.READ_IMAGEVIDEO'。</li>     </ul>     <p>下面以获取视频相册中的一个视频为例。</p>     <p><strong>开发步骤</strong></p>     <ol>      <li>先<a href="/consumer/cn/doc/harmonyos-guides/photoaccesshelper-systemalbum-guidelines#获取视频相册对象">获取视频相册对象</a>。</li>      <li>建立视频检索条件，用于获取视频。</li>      <li>调用Album.getAssets接口获取视频资源。</li>      <li>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-photoaccesshelper-fetchresult#getfirstobject-1" target="_blank">FetchResult.getFirstObject</a>接口获取第一个视频。</li>     </ol>     <div _ngcontent-ugi-c106="" class="highlight-div"><div _ngcontent-ugi-c106="" class="highlight-div-header"><div _ngcontent-ugi-c106="" class="highlight-div-header-left"><div _ngcontent-ugi-c106="" class="handle-button expand-button"><div _ngcontent-ugi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ugi-c106="" class="highlight-div-header-right"><div _ngcontent-ugi-c106="" class="handle-button ai-button"></div><div _ngcontent-ugi-c106="" class="handle-button line-button"><div _ngcontent-ugi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ugi-c106="" class="handle-button theme-button"><div _ngcontent-ugi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ugi-c106="" class="handle-button copy-button"><div _ngcontent-ugi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ugi-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { dataSharePredicates } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkData'</span>;</li><li><span class="hljs-keyword">import</span> { photoAccessHelper } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.MediaLibraryKit'</span>;</li><li>
</li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">example</span>(<span class="hljs-params">phAccessHelper: photoAccessHelper.PhotoAccessHelper</span>) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">predicates</span>: dataSharePredicates.<span class="hljs-property">DataSharePredicates</span> = <span class="hljs-keyword">new</span> dataSharePredicates.<span class="hljs-title class_">DataSharePredicates</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">fetchOptions</span>: photoAccessHelper.<span class="hljs-property">FetchOptions</span> = {</li><li>    <span class="hljs-attr">fetchColumns</span>: [],</li><li>    <span class="hljs-attr">predicates</span>: predicates</li><li>  };</li><li>
</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">albumFetchResult</span>: photoAccessHelper.<span class="hljs-property">FetchResult</span>&lt;photoAccessHelper.<span class="hljs-property">Album</span>&gt; = <span class="hljs-keyword">await</span> phAccessHelper.<span class="hljs-title function_">getAlbums</span>(photoAccessHelper.<span class="hljs-property">AlbumType</span>.<span class="hljs-property">SYSTEM</span>, photoAccessHelper.<span class="hljs-property">AlbumSubtype</span>.<span class="hljs-property">VIDEO</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">album</span>: photoAccessHelper.<span class="hljs-property">Album</span> = <span class="hljs-keyword">await</span> albumFetchResult.<span class="hljs-title function_">getFirstObject</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'get video album successfully, albumUri: '</span> + album.<span class="hljs-property">albumUri</span>);</li><li>
</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">videoFetchResult</span>: photoAccessHelper.<span class="hljs-property">FetchResult</span>&lt;photoAccessHelper.<span class="hljs-property">PhotoAsset</span>&gt; = <span class="hljs-keyword">await</span> album.<span class="hljs-title function_">getAssets</span>(fetchOptions);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">photoAsset</span>: photoAccessHelper.<span class="hljs-property">PhotoAsset</span> = <span class="hljs-keyword">await</span> videoFetchResult.<span class="hljs-title function_">getFirstObject</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'video album getAssets successfully, photoAsset displayName: '</span> + photoAsset.<span class="hljs-property">displayName</span>);</li><li>    videoFetchResult.<span class="hljs-title function_">close</span>();</li><li>    albumFetchResult.<span class="hljs-title function_">close</span>();</li><li>  } <span class="hljs-keyword">catch</span> (err) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">'video failed with err: '</span> + err);</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>