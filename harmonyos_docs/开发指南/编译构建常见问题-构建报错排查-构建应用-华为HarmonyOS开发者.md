<h1 _ngcontent-kln-c119="" class="doc-title ng-star-inserted" title="编译构建常见问题"> 编译构建常见问题 </h1>

<div _ngcontent-kln-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted renderOptimization" style="position: relative;"> <div id="body0000001233028585"><div class="tiledSection" style="contain-intrinsic-size: auto 1664px;"><h2 id="section109291048201717">如何解决编译过程内存过高<i class="anchor-icon anchor-icon-link" anchorid="section109291048201717" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p257414230306"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p185741323103016">编译构建时，内存或CPU占用过高，导致出现DevEco Studio运行卡顿、延迟等现象。</p> <p id="ZH-CN_TOPIC_0000002510174481__p11276212173218"><strong>解决措施</strong></p> <ul id="ZH-CN_TOPIC_0000002510174481__ul8451195018266"><li id="li174515504264">在执行hvigor构建的过程中，通过减少内存中的缓存数据、减少线程数量，可以减少编译过程中的内存占用。<p id="ZH-CN_TOPIC_0000002510174481__p142246365401">可以在hvigor-config.json5中添加配置。</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen15318201495" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-string">"properties"</span></span><span class="">: </span>{</li><li>  <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">配置为</span></span><span class=""><span class="hljs-comment">0</span></span><span class=""><span class="hljs-comment">，表示不启用内存缓存配置，默认为</span></span><span class=""><span class="hljs-comment">4</span></span><span class=""><span class="hljs-comment">，数值越低，内存中缓存数据越少</span></span></li><li>  <span class=""><span class="hljs-string">"hvigor.pool.cache.capacity"</span></span><span class="">: </span><span class=""><span class="hljs-number">0</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">默认配置为</span></span><span class=""><span class="hljs-comment">cpu</span></span><span class=""><span class="hljs-comment">核数</span></span><span class=""><span class="hljs-comment">-1</span></span><span class=""><span class="hljs-comment">， 包含</span></span><span class=""><span class="hljs-comment">ohos.arkCompile.maxSize</span></span><span class=""><span class="hljs-comment">，值越小，占用内存越少</span></span></li><li>  <span class=""><span class="hljs-string">"hvigor.pool.maxSize"</span> </span><span class="">: </span><span class=""><span class="hljs-number">5</span></span><span class="">,</span></li><li>  <span class=""><span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">默认配置值为</span></span><span class=""><span class="hljs-comment">5, </span></span><span class=""><span class="hljs-comment">值越小，占用内存越少</span></span></li><li>  <span class=""><span class="hljs-string">"ohos.arkCompile.maxSize"</span></span><span class="">: </span><span class=""><span class="hljs-number">3</span></span>,</li><li><span class="">  <span class="hljs-comment">// </span></span><span class=""><span class="hljs-comment">默认配置值为</span></span><span class=""><span class="hljs-comment">true, </span></span><span class=""><span class="hljs-comment">表示开启内存缓存，占用内存较多，配置为false，关闭内存缓存，占用内存较少</span></span></li><li>  <span class=""><span class="hljs-string">"</span></span><span class=""><span class="hljs-string">hvigor.enableMemoryCache</span></span><span class=""><span class="hljs-string">"</span></span><span class="">: <span class="hljs-keyword">false</span></span></li><li>}<span class="">,</span></li></ol></pre></div></div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002510174481__p5129121313214">当配置项"hvigor.pool.maxSize"和"ohos.arkCompile.maxSize"的值改小，"hvigor.enableMemoryCache"改为false后，可能会导致编译时长增加，请耐心等待。</p> </div></div></div> </li></ul> <ul id="ZH-CN_TOPIC_0000002510174481__ul16909185202620"><li id="li1690945232616">如果以上修改没有取得明显的效果，可以使用非并行的模式来执行编译。<ul id="ZH-CN_TOPIC_0000002510174481__ul17260902276"><li id="li1589715822614">在菜单栏点击“File &gt; Settings（macOS为DevEco Studio &gt; Preferences/Settings） &gt; Build, Execution, Deployment &gt; Build Tools &gt; Hvigor”，取消勾选“Execute tasks in parallel mode (may require larger heap size)”。<p id="ZH-CN_TOPIC_0000002510174481__p1151173685111"><span><img originheight="707" originwidth="984" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104907.30401661352873689963099366231901:50001231000000:2800:D1E4B36CB25CE2AC972EA90B51085C14A5A285E99DC6BD0D5BCEDA4094E573B8.png" width="920" height="661.0162601626016"></span></p> </li><li id="li1023014128271">流水线场景中，在命令行最后增加  --no-parallel，示例：<div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-css" id="ZH-CN_TOPIC_0000002510174481__screen17303162982619" data-highlighted="yes"><ol class="linenums"><li>hvigorw assembleHap <span class="hljs-attr">--no-parallel</span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p131401558163820"></p> </li></ul> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002510174481__p1020103562611">使用非并行模式编译，内存占用会减少，但可能会导致编译时长增加，请耐心等待。</p> </div></div></div> </li></ul> </div> <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 3870px;"><h2 id="section119742124315">构建报错“Cannot read properties of undefined(reading 'XXX')”<i class="anchor-icon anchor-icon-link" anchorid="section119742124315" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p351311545712">请先根据XXX的值从以下场景排查，没解决问题再参考最终方案。</p> <ul id="ZH-CN_TOPIC_0000002510174481__ul548495120148"><li id="li17484125113147"><strong>场景一：</strong><p id="ZH-CN_TOPIC_0000002510174481__p644911719157"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1944917173151">编译构建时，出现报错“Cannot read properties of undefined(reading 'setEnabled')”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1714823814588"><strong>问题确认</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p21486384585">hvigorfile.ts里有如下代码：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" id="ZH-CN_TOPIC_0000002510174481__screen148441353185815" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { hvigor, getHvigorNode } <span class="hljs-keyword">from</span> <span class="hljs-string">"@ohos/hvigor"</span></li><li><span class="hljs-keyword">import</span> { hapTasks} <span class="hljs-keyword">from</span> <span class="hljs-string">'@ohos/hvigor-ohos-plugin'</span>;</li><li><span class="hljs-comment">// 问题代码</span></li><li><span class="hljs-title function_">getHvigorNode</span>(__filename).<span class="hljs-title function_">getTaskByName</span>(<span class="hljs-string">'XXX'</span>).<span class="hljs-title function_">setEnabled</span>(<span class="hljs-literal">false</span>);</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {</li><li>    <span class="hljs-attr">system</span>: hapTasks, <span class="hljs-comment">/* Built-in plugin of Hvigor. It cannot be modified. */</span></li><li>    <span class="hljs-attr">plugins</span>: []         <span class="hljs-comment">/* Custom plugin to extend the functionality of Hvigor. */</span></li><li>}</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p144941791520"><strong>处理措施</strong></p> <ol id="ZH-CN_TOPIC_0000002510174481__ol117110413418"><li id="li1217111416417">确保XXX是当前的HvigorNode里存在的任务。<p id="ZH-CN_TOPIC_0000002510174481__p29231511415">假设是entry模块的hvigorfile.ts中的代码导致的问题 ，XXX的有效值就是下图中的“default@SignHap”、“default@CollectDebugSymbol”、“assembleHap”等值。</p> <p id="ZH-CN_TOPIC_0000002510174481__p12673535645"><span><img originheight="398" originwidth="1093" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104908.66659575978333516809787392064227:50001231000000:2800:70EDD5EDC82D024F2C1F9E41CDEDB44BD8682145F4ABE249BEB14AEB8CA3D648.png" width="920" height="335.00457456541625"></span></p> </li><li id="li550613149417">确保getTaskByName的使用位置是在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-life-cycle#section746253616316">Hvigor的配置阶段</a>及之后的生命周期里，包括beforeNodeEvaluate、afterNodeEvaluate、nodesEvaluated、taskGraphResolved、buildFinished。</li></ol> </li><li id="li197322212155"><strong>场景二：</strong><p id="ZH-CN_TOPIC_0000002510174481__p197551827111510"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1475515272156">编译构建时，出现报错“Cannot read properties of undefined(reading 'isSO')”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1975572711517"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p06439041010">升级到DevEco Studio 5.1.0.840及以上的版本。</p> </li><li id="li2148113821519"><strong>场景三：</strong><p id="ZH-CN_TOPIC_0000002510174481__p482464441512"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p178241944141517">编译构建时，出现报错“Cannot read properties of undefined(reading 'getPluginId')”<strong>。</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p48249443157"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p12824204411515">确保hvigorfile.ts里export default的对象中的字段system的值是appTasks/hapTasks/hspTasks/harTasks之一。</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" id="ZH-CN_TOPIC_0000002510174481__screen192151656151117" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> <span class="">{ </span><span class="">appTasks </span><span class="">} </span><span class="hljs-keyword">from</span> <span class=""><span class="hljs-string">'@ohos/hvigor-ohos-plugin'</span></span><span class="">;</span></li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="">{</span></li><li>    <span class=""><span class="hljs-attr">system</span></span><span class="">: </span><span class="">appTasks</span><span class="">,  </span><span class=""><span class="hljs-comment">/* Built-in plugin of Hvigor. It cannot be modified. */</span></span></li><li>    <span class=""><span class="hljs-attr">plugins</span></span><span class="">:</span><span class="">[]         </span><span class=""><span class="hljs-comment">/* Custom plugin to extend the functionality of Hvigor. */</span></span></li><li><span class="">}</span></li></ol></pre></div></div> </li><li id="li192589507154"><strong>场景四：</strong><p id="ZH-CN_TOPIC_0000002510174481__p208245916158"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p182185917152">编译构建时，出现报错“Cannot read properties of undefined(reading 'getNeedExecTargetServiceList')”<strong>。</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p282165961510"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p3825591151">确保模块下的module.json5的type字段的值和hvigorfile.ts中export default的对象的system字段符合以下对应关系：</p>  <div class="tablenoborder"><div class="tbBox"><table id="table191816246169" class="layoutFixed idpTab"><caption><b>表1 </b></caption><thead><tr id="ZH-CN_TOPIC_0000002510174481__row218152412165"><th align="left" class="cellrowborder" id="mcps1.3.2.3.4.6.2.3.1.1" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002510174481__p1137803761614">module.json5的type字段</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.3.4.6.2.3.1.2" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002510174481__p737853710167">hvigorfile.ts中export default的对象的system字段</p> </th> </tr> </thead> <tbody><tr id="ZH-CN_TOPIC_0000002510174481__row101842491615"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002510174481__p337823791613">entry</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002510174481__p63781237181616">hapTasks</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002510174481__row91872418166"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002510174481__p1537803721610">feature</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002510174481__p1737813714162">hapTasks</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002510174481__row318172451610"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002510174481__p18378937191615">shared</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002510174481__p6379183741618">hspTasks</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002510174481__row10191524131613"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002510174481__p93791137141618">har</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002510174481__p9379137131618">harTasks</p> </td> </tr>  </tbody></table></div> </div> </li><li id="li5407135314177"><strong>场景五：</strong><p id="ZH-CN_TOPIC_0000002510174481__p1119713556173"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1439145419166">编译构建时，出现报错“Cannot read properties of undefined(reading 'app')”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p143910543163"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p539854101618">确保工程目录下AppScope/app.json5文件存在。</p> </li><li id="li9782134631712"><strong>场景六：</strong><p id="ZH-CN_TOPIC_0000002510174481__p4928124312174"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p92411871713">Linux环境下，执行单元测试，出现报错“Cannot read properties of undefined(reading 'toString')”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1024118101712"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p112411984171">Linux环境暂不支持单元测试。</p> </li><li id="li17117141441714"><strong>场景七：</strong><p id="ZH-CN_TOPIC_0000002510174481__p18642112119176"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p0642182151720">编译构建时，出现报错“Cannot read properties of undefined(reading 'kind')”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p264211214176"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p56421217179">检查ArkTS代码是否有如下写法：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002510174481__screen9538113218384" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 错误写法：空数组</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">w</span> {</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-attr">a</span>: [][] = []</li><li>  <span class="hljs-title function_">test</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"1"</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">a</span>[<span class="hljs-number">0</span>])</li><li>  }</li><li>}</li><li><span class="hljs-comment">// 正确写法</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">w</span> {</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-attr">a</span>: <span class="hljs-built_in">string</span>[][] = []</li><li>  <span class="hljs-title function_">test</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">"1"</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">a</span>[<span class="hljs-number">0</span>])</li><li>  }</li><li>}</li></ol></pre></div></div> </li><li id="li183681335171913"><strong>场景八：</strong><p id="ZH-CN_TOPIC_0000002510174481__p29921250131916"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p9991154631911">编译构建时，出现报错“Cannot read properties of undefined(reading 'clear')”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1699114661912"><strong>问题确认</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p530134424115">在工程根目录hvigor/hvigor-config.json5文件中配置如下内容打开堆栈。</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002510174481__screen1030154494117" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">"debugging":</span> {</li><li>  <span class="hljs-attr">"stacktrace":</span> <span class="hljs-literal">true</span>                <span class="hljs-string">/*</span> <span class="hljs-attr">Disable stacktrace compilation. Value:</span> [ <span class="hljs-literal">true</span> <span class="hljs-string">|</span> <span class="hljs-literal">false</span> ]<span class="hljs-string">.</span> <span class="hljs-attr">Default:</span> <span class="hljs-literal">false</span> <span class="hljs-string">*/</span></li><li>}<span class="hljs-string">,</span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p6710196172013">确认堆栈内容是否如下。</p> <p id="ZH-CN_TOPIC_0000002510174481__p13412613132012"><span><img originheight="70" originwidth="886" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104908.87858998916069305944556696878694:50001231000000:2800:F98D31D978C218C24507DBF44510771078CCB7CB084305CB8D1518F232C7ADFE.png" width="886" height="70"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p999164671919"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1699104618197">确认DevEco Studio是否有使用安全加固等三方插件。如果有，可以先禁用三方插件，看是否会复现问题，还能复现就参考下面的最终方案。</p> </li><li id="li69216479461"><strong>最终方案：</strong><p id="ZH-CN_TOPIC_0000002510174481__p10436158184616">如果以上场景都不符合，打开堆栈后，根据堆栈信息排查代码。</p> <p id="ZH-CN_TOPIC_0000002510174481__p21394135010">堆栈打开方法：工程根目录hvigor/hvigor-config.json5文件中配置如下内容。</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002510174481__screen1116195735015" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">"debugging":</span> {</li><li>  <span class="hljs-attr">"stacktrace":</span> <span class="hljs-literal">true</span>                <span class="hljs-string">/*</span> <span class="hljs-attr">Disable stacktrace compilation. Value:</span> [ <span class="hljs-literal">true</span> <span class="hljs-string">|</span> <span class="hljs-literal">false</span> ]<span class="hljs-string">.</span> <span class="hljs-attr">Default:</span> <span class="hljs-literal">false</span> <span class="hljs-string">*/</span></li><li>}<span class="hljs-string">,</span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p743619586460">优先排查hvigorconfig.ts文件和hvigorfile.ts文件，其他代码次之。</p> <p id="ZH-CN_TOPIC_0000002510174481__p943675810466">如果上述文件中并未排查出问题，请通过<a href="https://developer.huawei.com/consumer/cn/support/feedback/#/" target="_blank">在线提单</a>提交问题。</p> </li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 1727px;"><h2 id="section61271726101614">构建报错“Duplicated files found in module xxx. This may cause unexpected errors at runtime”<i class="anchor-icon anchor-icon-link" anchorid="section61271726101614" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p51271726141619"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p6127192651613">编译构建时，出现报错“Duplicated files found in module xxx. This may cause unexpected errors at runtime”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p142031720132419">问题原因是构建时存在不同版本的同名so文件。比如将har模块产物里的so文件拷贝到entry模块的libs目录下，这时har模块里有一个libhar.so，entry模块里也有一个libhar.so，再配置entry依赖har，构建entry就会出现报错。</p> <p id="ZH-CN_TOPIC_0000002510174481__p107801152162410"><span><img originheight="594" originwidth="928" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104908.57734171925966093807253822232913:50001231000000:2800:BB2FAC5AF7048B36D68B938E831F304787D66CD59775C9073E7FCAAFB846E825.png" width="920" height="588.8793103448276"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p3127152681618"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1474945302317">使用select、pickFirsts、pickLasts等配置选中要使用的so文件; select提供native产物的精准选择能力，优先级高于excludes、pickFirsts等配置项。pickFirsts、pickLasts按照.so文件的优先级顺序，打包最高优先级的.so文件，优先级顺序是指依赖收集的顺序，越晚被收集优先级越高。</p> <p id="ZH-CN_TOPIC_0000002510174481__p4750115310234">具体可参考：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-cpp">配置CPP</a>。</p> <p id="ZH-CN_TOPIC_0000002510174481__p10543266240">基于上面的例子，可以在entry的build-profile.json5中添加配置select选中har模块中的so文件，package选中包名为“har”的模块, include选中“libhar.so”文件。</p> <p id="ZH-CN_TOPIC_0000002510174481__p5511174915340"><span><img originheight="919" originwidth="1514" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104908.86310528193221163910120432683051:50001231000000:2800:17AB70300482D0FC2243D953D07B4334490B6AD5BB0339954D4A00624EA37E55.png" width="920" height="558.441215323646"></span></p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 1107px;"><h2 id="section2039312481259">构建报错“input module releaseType is different”<i class="anchor-icon anchor-icon-link" anchorid="section2039312481259" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p5455955112510"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p13764359269">打包APP时，提示“input module releaseType is different”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p5455135510258"><span><img originheight="238" originwidth="1001" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104908.46832317812888185794397842098805:50001231000000:2800:7B5EDC5B63DEDD9B1DB238AB61DFE21DD0A20C69E52661A855595A94DA055D11.png" width="920" height="218.74125874125872"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p1455195542513"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p456691322714">根据报错日志的Warning信息所提示的模块名称，检查模块间的apiReleaseType字段是否一致。</p> <p id="ZH-CN_TOPIC_0000002510174481__p45661113122719">该apiReleaseType字段由编译构建工具自动生成，保存在HAP/HSP包的module.json文件中。如下图所示，首先确认各模块间该字段是否一致，如果存在不一致的情况，需要将应用的各个模块，使用相同版本的SDK重新打包，然后打包APP。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1374917192277"><span><img originheight="723" originwidth="1308" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104908.45571808808058020946048160949708:50001231000000:2800:6495AD83F581FDDC3F9CFFDF9785E4F3B82E3B473B3916B08CC533B415549962.png" width="920" height="508.5321100917431"></span></p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 1751px;"><h2 id="section1889316053019">构建报错“debug is different”<i class="anchor-icon anchor-icon-link" anchorid="section1889316053019" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p1289370163018"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p7893200193018">打包APP时，提示“debug is different”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p19893909300"><span><img originheight="238" originwidth="1004" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104908.37123918202096430291792844742737:50001231000000:2800:66A6063CE3B527509D96D73F687D48D3EDA25EA244E09B07C6F5DFCA40D467B7.png" width="920" height="218.08764940239044"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p78931209309"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1680485513010">根据报错日志的Warning信息所提示的模块名称，检查模块间的debug字段是否一致，尤其需要关注本地模块和外部引用模块之间是否一致。</p> <p id="ZH-CN_TOPIC_0000002510174481__p880495512306">1.该debug字段由编译构建工具自动生成，保存在HAP/HSP包的module.json文件中，如下图所示，首先确认各模块间该字段是否一致。</p> <p id="ZH-CN_TOPIC_0000002510174481__p118939016303"><span><img originheight="608" originwidth="1081" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104908.27160109900593182085920387754405:50001231000000:2800:27DFBAD9EE47A5DD9B209407FD633FCA23F11BAFA2BFE9345EAB2A5DDCE73D46.png" width="920" height="517.4468085106383"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p2053316154317">2.编译工具根据设置的Build Mode选项生成debug标识，如图所示，可以通过此处进行设置。</p> <p id="ZH-CN_TOPIC_0000002510174481__p177491022163116"><span><img originheight="539" originwidth="896" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104908.92161106853850358480115882466826:50001231000000:2800:7320F67EB99527842BBE41A61C7A6A67B6721F6B8B81429123BEAB3E0C636A44.png" width="896" height="539"></span></p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 966px;"><h2 id="section171131929133215">构建报错“proxy data is duplicated”<i class="anchor-icon anchor-icon-link" anchorid="section171131929133215" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p1711312910321"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p11162174663211">打包APP时，提示“uri datashareproxy://bundleName/** in proxy data is duplicated”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p111131829173215"><span><img originheight="225" originwidth="985" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104908.82570766656338521765576543129932:50001231000000:2800:E92D2CC0B62C236FB70F585D107B10F47483B1739F17E009EB03B313867DF0BF.png" width="920" height="210.1522842639594"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p1211322920321"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p4113629163210">proxyData标识模块提供的数据代理列表，只允许entry和feature配置，不同的proxyData中配置的URI不可重复。遇到此问题，检查模块间是否配置了相同uri的proxyData。</p> <p id="ZH-CN_TOPIC_0000002510174481__p611362911329"><span><img originheight="554" originwidth="1203" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104908.08558647379773918640641936999368:50001231000000:2800:49B3919A1D7444C2C3D65EB58FE6C626119BE630F4DCB50CC943BD83082F8412.png" width="920" height="423.6741479634248"></span></p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 640px;"><h2 id="section104639397814">编译报错“Init keystore failed: parseAlgParameters failed: ObjectIdentifier()”<i class="anchor-icon anchor-icon-link" anchorid="section104639397814" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p185717548816"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1041311796">编译构建时，出现错误：Init keystore failed: parseAlgParameters failed: ObjectIdentifier()。</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen10567340171116" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">hap</span>-<span class="hljs-variable">sign</span>-<span class="hljs-variable">tool</span>: <span class="hljs-title class_">error</span>: <span class="hljs-title class_">ACCESS_ERROR</span>, <span class="hljs-variable">code</span>: <span class="hljs-number">109</span>. <span class="hljs-title class_">Details</span>: <span class="hljs-title class_"> </span> <span class="hljs-title class_">Init</span> <span class="hljs-title class_">keystore</span> <span class="hljs-title class_">failed</span>: <span class="hljs-title class_">parseAlgParameters</span> <span class="hljs-title class_">failed</span>: <span class="hljs-title class_">ObjectIdentifier</span>() -- <span class="hljs-title class_">data</span> <span class="hljs-title class_">isn</span><span class="hljs-string">'t an object ID (tag = 48)   Detail: Please check the message from tools</span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p412662331514"><strong>错误原因</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1847412931517">使用高版本JDK生成密钥对(p12)，再使用低版本的JDK执行签名命令时，会因为不兼容导致解析p12失败，从而签名失败。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1574333119158"><strong>场景</strong></p> <ol id="ZH-CN_TOPIC_0000002510174481__ol2041316615481"><li id="li411639134814">使用DevEco Studio生产密钥对时，DevEco Studio默认会调用软件内预置的JDK17，而用户使用本地的低版本JDK进行签名时则会报错。</li><li id="li1541317614818">用户本地使用高版本JDK生成密钥对时，又通过DevEco Studio进行签名，DevEco Studio中预置的JDK17版本低于用户的JDK，导致报错。</li></ol> <p id="ZH-CN_TOPIC_0000002510174481__p1877243611517"><strong>解决方案</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p10410105617160">请检查当前使用的JDK版本和生产密钥对使用的JDK版本，使用版本匹配的JDK执行签名命令。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 592px;"><h2 id="section2129143462518">编译报错“generate SignerBlock failed”<i class="anchor-icon anchor-icon-link" anchorid="section2129143462518" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p1412918343251"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p11291434102511">编译构建时，出现错误：message:generate SignerBlock failed。</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen1112983417250" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">hap</span>-<span class="hljs-variable">sign</span>-<span class="hljs-variable">tool</span>: <span class="hljs-title class_">error</span>: {<span class="hljs-variable">errorcode</span>:<span class="hljs-number">0</span>,<span class="hljs-variable">message</span>:<span class="hljs-title class_">generate</span> <span class="hljs-title class_">SignerBlock</span> <span class="hljs-title class_">failed</span>}</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p7129133442516"><strong>错误原因</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p96213218286">签名用的公私钥对不匹配，使用私钥签名后，用公钥验签失败。需保证私钥(keyalias)和公钥(appCertPath)配对使用。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1412943414256"><strong>场景</strong></p> <ol id="ZH-CN_TOPIC_0000002510174481__ol2031411556471"><li id="li565285812475">本地生产签名材料时，未导出正确的keyalias对应的csr(证书请求文件)，导致生成证书时，公钥与keyalias对应的私钥不匹配。</li><li id="li12314145564714">签名过程参数填写错误，使用了错误的keyalias或者appCertPath文件。</li></ol> <p id="ZH-CN_TOPIC_0000002510174481__p91291634102517"><strong>解决方案</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p6129163462511">请选择正确、配对的keyalias和appCertPath文件。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 592px;"><h2 id="section851824020353">编译报错“java.io.IOException: DerValue.getOID, not an OID 49”<i class="anchor-icon anchor-icon-link" anchorid="section851824020353" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p6518114012352"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p75182408357">编译构建时，出现错误：java.io.IOException: DerValue.getOID, not an OID 49。</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen115189405356" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">hap</span>-<span class="hljs-variable">sign</span>-<span class="hljs-variable">tool</span>: <span class="hljs-title class_">error</span>: <span class="hljs-title class_">ACCESS_ERROR</span>, <span class="hljs-variable">code</span>: <span class="hljs-number">109</span>. <span class="hljs-title class_">Details</span>: <span class="hljs-title class_">java</span>.<span class="hljs-title class_">io</span>.<span class="hljs-title class_">IOException</span>: <span class="hljs-title class_">DerValue</span>.<span class="hljs-title class_">getOID</span>, <span class="hljs-variable">not</span> <span class="hljs-variable">an</span> <span class="hljs-variable">OID</span> <span class="hljs-number">49</span> <span class="hljs-variable">Detail</span>: <span class="hljs-title class_">Please</span> <span class="hljs-title class_">check</span> <span class="hljs-title class_">the</span> <span class="hljs-title class_">message</span> <span class="hljs-keyword">from</span> <span class="hljs-title class_">tools</span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p5518154010359"><strong>报错原因</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p184271538104311">证书文件解析失败，找不到证书的OID。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1051884033510"><strong>场景</strong></p> <ol id="ZH-CN_TOPIC_0000002510174481__ol872421184914"><li id="li259472313498">证书被篡改。</li><li id="li172521204912">appCertPath参数中传入了非证书文件。</li></ol> <p id="ZH-CN_TOPIC_0000002510174481__p135181940103518"><strong>解决方案</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p16592349154417">请检查证书文件是否正确。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 1708px;"><h2 id="section516572532613">编译报错“JS heap out of memory”<i class="anchor-icon anchor-icon-link" anchorid="section516572532613" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p51652025202617"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p216532511267">编译构建时，出现报错“JS heap out of memory“。</p> <p id="ZH-CN_TOPIC_0000002510174481__p9920175863513"><span><img originheight="455" originwidth="818" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104908.22941112488382502611427235510665:50001231000000:2800:0E580170D6F758688178EE187D3B542919D978A06238F8B5049537E900AA69D2.png" width="818" height="455"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p51661254260"></p> <p id="ZH-CN_TOPIC_0000002510174481__p2016662514265"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p12731041154915">出现该报错的原因是Hvigor运行时内存不足，在使用3.1.0及以上版本的Hvigor时，可通过以下方式修改Hvigor运行时内存的最大值。</p> <p id="ZH-CN_TOPIC_0000002510174481__p2499646154518">勾选Enable the Daemon for tasks：</p> <p id="ZH-CN_TOPIC_0000002510174481__p54491436018"><span><img originheight="709" originwidth="983" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104908.39838314887209514129148208573821:50001231000000:2800:46BAB527232B29A9D09EEC49DECD9E4C7E6C9A4BB065F81CE65144A68C144060.png" width="920" height="663.560528992879"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p107671448174516"></p> <p id="ZH-CN_TOPIC_0000002510174481__p2166152542611">在hvigor-config.json5中修改maxOldSpaceSize字段，根据工程的大小，适当将其增大（如设置为8192）：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen13640217124010" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-string">"nodeOptions"</span></span><span class="">: </span>{</li><li>  <span class=""><span class="hljs-string">"maxOldSpaceSize"</span></span><span class="">: </span><span class=""><span class="hljs-number">8192</span></span></li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 1409px;"><h2 id="section2815113165520">Linux环境下编译报错“JS heap out of memory”<i class="anchor-icon anchor-icon-link" anchorid="section2815113165520" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p20815113145513"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p84191356165519">在Linux环境下，系统内存有64G，Hvigorw脚本中配置--max-old-space-size=40960，在编译构建时，实际在使用内存未达到配置的内存（例如使用到20G左右）就出现报错“JS heap out of memory“。</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen13606645142018" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">FATAL</span> <span class="hljs-variable">ERROR</span>: <span class="hljs-title class_">NewSpace</span>::<span class="hljs-title class_">Rebalance</span> <span class="hljs-title class_">Allocation</span> <span class="hljs-title class_">failed</span> - <span class="hljs-title class_">JavaScript</span> <span class="hljs-title class_">heap</span> <span class="hljs-title class_">out</span> <span class="hljs-title class_">of</span> <span class="hljs-title class_">memory</span></li><li><span class="hljs-variable">Writing</span> <span class="hljs-variable">Node</span>.<span class="hljs-variable">js</span> <span class="hljs-variable">report</span> <span class="hljs-variable">to</span> <span class="hljs-variable">file</span>: <span class="hljs-title class_">report</span><span class="hljs-number">.20200512.172528</span><span class="hljs-number">.47517.24</span><span class="hljs-number">.011</span>.<span class="hljs-title class_">json</span></li><li><span class="hljs-variable">Node</span>.<span class="hljs-variable">js</span> <span class="hljs-variable">report</span> <span class="hljs-variable">completed</span></li><li><span class="hljs-number">1</span>: <span class="hljs-number">0xa295e0</span> <span class="hljs-title class_">node</span>::<span class="hljs-title class_">Abort</span>() [<span class="hljs-title class_">node</span>]</li><li><span class="hljs-number">2</span>: <span class="hljs-number">0x9782df</span> <span class="hljs-title class_">node</span>::<span class="hljs-title class_">FatalError</span>(<span class="hljs-title class_">char</span> <span class="hljs-keyword">const</span>*, <span class="hljs-title class_">char</span> <span class="hljs-keyword">const</span>*) [<span class="hljs-title class_">node</span>]</li><li><span class="hljs-number">3</span>: <span class="hljs-number">0xb99c2e</span> <span class="hljs-title class_">v8</span>::<span class="hljs-title class_">Utils</span>::<span class="hljs-title class_">ReportOOMFailure</span>(<span class="hljs-variable">v8</span>::<span class="hljs-keyword">internal</span>::<span class="hljs-variable">Isolate</span>*, <span class="hljs-title class_">char</span> <span class="hljs-keyword">const</span>*, <span class="hljs-title class_">bool</span>) [<span class="hljs-title class_">node</span>]</li><li><span class="hljs-number">4</span>: <span class="hljs-number">0xb99fa7</span> <span class="hljs-title class_">v8</span>::<span class="hljs-keyword">internal</span>::<span class="hljs-title class_">V8</span>::<span class="hljs-title class_">FatalProcessOutOfMemory</span>(<span class="hljs-variable">v8</span>::<span class="hljs-keyword">internal</span>::<span class="hljs-variable">Isolate</span>*, <span class="hljs-title class_">char</span> <span class="hljs-keyword">const</span>*, <span class="hljs-title class_">bool</span>) [<span class="hljs-title class_">node</span>]</li><li><span class="hljs-number">5</span>: <span class="hljs-number">0xd3a3b5</span> [<span class="hljs-title class_">node</span>]</li><li><span class="hljs-number">6</span>: <span class="hljs-number">0xd74f27</span> [<span class="hljs-title class_">node</span>]</li><li><span class="hljs-number">7</span>: <span class="hljs-number">0xd84707</span> <span class="hljs-title class_">v8</span>::<span class="hljs-keyword">internal</span>::<span class="hljs-title class_">MarkCompactCollector</span>::<span class="hljs-title class_">CollectGarbage</span>() [<span class="hljs-title class_">node</span>]</li><li><span class="hljs-number">8</span>: <span class="hljs-number">0xd481b9</span> <span class="hljs-title class_">v8</span>::<span class="hljs-keyword">internal</span>::<span class="hljs-title class_">Heap</span>::<span class="hljs-title class_">MarkCompact</span>() [<span class="hljs-title class_">node</span>]</li><li><span class="hljs-number">9</span>: <span class="hljs-number">0xd48f0b</span> <span class="hljs-title class_">v8</span>::<span class="hljs-keyword">internal</span>::<span class="hljs-title class_">Heap</span>::<span class="hljs-title class_">PerformGarbageCollection</span>(<span class="hljs-variable">v8</span>::<span class="hljs-keyword">internal</span>::<span class="hljs-title class_">GarbageCollector</span>, <span class="hljs-variable">v8</span>::<span class="hljs-title class_">GCCallbackFlags</span>) [<span class="hljs-title class_">node</span>]</li><li><span class="hljs-number">10</span>: <span class="hljs-number">0xd499a5</span> <span class="hljs-title class_">v8</span>::<span class="hljs-keyword">internal</span>::<span class="hljs-title class_">Heap</span>::<span class="hljs-title class_">CollectGarbage</span>(<span class="hljs-variable">v8</span>::<span class="hljs-keyword">internal</span>::<span class="hljs-title class_">AllocationSpace</span>, <span class="hljs-variable">v8</span>::<span class="hljs-keyword">internal</span>::<span class="hljs-title class_">GarbageCollectionReason</span>, <span class="hljs-variable">v8</span>::<span class="hljs-title class_">GCCallbackFlags</span>) [<span class="hljs-title class_">node</span>]</li><li><span class="hljs-number">11</span>: <span class="hljs-number">0xd4aebf</span> <span class="hljs-title class_">v8</span>::<span class="hljs-keyword">internal</span>::<span class="hljs-title class_">Heap</span>::<span class="hljs-title class_">HandleGCRequest</span>() [<span class="hljs-title class_">node</span>]</li><li><span class="hljs-number">12</span>: <span class="hljs-number">0xcf5f97</span> <span class="hljs-title class_">v8</span>::<span class="hljs-keyword">internal</span>::<span class="hljs-title class_">StackGuard</span>::<span class="hljs-title class_">HandleInterrupts</span>() [<span class="hljs-title class_">node</span>]</li><li><span class="hljs-number">13</span>: <span class="hljs-number">0x104b803</span> <span class="hljs-title class_">v8</span>::<span class="hljs-keyword">internal</span>::<span class="hljs-title class_">Runtime_StackGuard</span>(<span class="hljs-title class_">int</span>, <span class="hljs-title class_">unsigned</span> <span class="hljs-variable">long</span>*, <span class="hljs-variable">v8</span>::<span class="hljs-keyword">internal</span>::<span class="hljs-variable">Isolate</span>*) [<span class="hljs-title class_">node</span>]</li><li><span class="hljs-number">14</span>: <span class="hljs-number">0x13a5a99</span> [<span class="hljs-title class_">node</span>]</li><li><span class="hljs-variable">Aborted</span> (<span class="hljs-variable">core</span> <span class="hljs-variable">dumped</span>)</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p178151513125513"></p> <p id="ZH-CN_TOPIC_0000002510174481__p10220825612"><strong>问题原因</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p15272030155616">vm.max_map_count是一个与内核虚拟内存子系统相关的参数，用于控制进程可以拥有的内存映射区域的最大数量。它通常用于限制一个进程可以打开的文件数量，特别是在使用大量内存映射文件的情况下。</p> <p id="ZH-CN_TOPIC_0000002510174481__p7847174385815">在Linux系统上，vm.max_map_count参数的默认值通常是较小的数值，例如65530。然而，对于一些需要大量内存映射的应用程序或者特定的使用场景，可能需要增加该参数的值，以便支持更多的内存映射区域。</p> <p id="ZH-CN_TOPIC_0000002510174481__p28159139556"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p38011017135920">修改vm.max_map_count的值：</p> <ul id="ZH-CN_TOPIC_0000002510174481__ul0242145202217"><li id="li6991192663120">临时修改：<div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-undefined" id="ZH-CN_TOPIC_0000002510174481__screen394710303313" data-highlighted="yes"><ol class="linenums"><li>sysctl -w vm.max_map_count=新值</li></ol></pre></div></div> </li><li id="li27115217239">永久修改：如果希望永久修改参数的值，可以编辑/etc/sysctl.conf文件，并添加或修改以下行：<div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-ini" id="ZH-CN_TOPIC_0000002510174481__screen147092028233" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">vm.max_map_count</span>=新值</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p21402127232">保存文件后，使用以下命令使更改生效：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-css" id="ZH-CN_TOPIC_0000002510174481__screen128221017162312" data-highlighted="yes"><ol class="linenums"><li>sysctl -<span class="hljs-selector-tag">p</span></li></ol></pre></div></div> </li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 7332px;"><h2 id="section2074611341974">编译报错“Cannot find module XXX or its corresponding type declarations”<i class="anchor-icon anchor-icon-link" anchorid="section2074611341974" tips="复制节点链接"></i></h2><ul id="ZH-CN_TOPIC_0000002510174481__ul18815163611914"><li id="li108151936599"><strong>场景一：</strong><p id="ZH-CN_TOPIC_0000002510174481__p157461734872"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1974623410713">Stage模板工程编译引用native文件(.so) 提示 "Cannot find module XXX or its corresponding type declarations."。</p> <p id="ZH-CN_TOPIC_0000002510174481__p157464343715"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1823210430111">当前Stage工程在编译构建阶段新增对native文件(.so)导出符号的语法校验，如果引用了没有对应声明文件(.d.ts)的native文件(.so)的现有工程在编译构建阶段，语法校验工具便会报错提示找不到对应的声明文件。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1874619341878">如果出现类似问题，可尝试通过如下方式进行解决：</p> <ol id="ZH-CN_TOPIC_0000002510174481__ol1346332915107"><li id="li3464152971019">在对应cpp目录下新建types/libxxx目录，并在该目录下新增index.d.ts用于声明native的类型符号；新增oh-package.json5配置文件用于校验工具的模块查询。<p id="ZH-CN_TOPIC_0000002510174481__p137021522311"><span><img originheight="399" originwidth="323" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104908.78204232167706843269878936175323:50001231000000:2800:CA89C5F31DA7520BF2D19518B81D562AEBA8DCA0438E7E88F8AF312ED8519037.png" width="323" height="399"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p183185641016"><span><img originheight="173" originwidth="537" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104908.83118518683429223153154254790816:50001231000000:2800:6BC83BED6D2D5039EA3F25F28231D406DFB658DA672A0A92115A088A55CC60C7.png" width="537" height="173"></span></p> </li><li id="li74641229141016">在native引用的模块内的oh-package.json5中添加native模块的本地依赖，并根据提示点击<strong>Sync Now</strong>同步工程，下图以entry模块引用native模块为例。<p id="ZH-CN_TOPIC_0000002510174481__p1872735731011"><span><img originheight="315" originwidth="1311" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104908.12564171470839067668249425437220:50001231000000:2800:6687D2EC639AD991C28E80557203311EF9E33601866D113E4B171CBDA6FD15E4.png" width="920" height="221.05263157894737"></span></p> </li></ol> </li></ul> <ul id="ZH-CN_TOPIC_0000002510174481__ul986612304115"><li id="li38662302114">场景二：<p id="ZH-CN_TOPIC_0000002510174481__p1225144913113"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p12679150181119">引用三方包，构建失败，提示“Cannot find module 'xxx' or its corresponding type declarations”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p12611554181116"><span><img originheight="263" originwidth="1073" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104909.03139832530781268054316015574677:50001231000000:2800:DDCDAB552F6C484EF49A0C7D22BD6E5245F72DA0F1242CE432A7B8064C2EBB4A.png" width="920" height="225.49860205032618"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p171519569115"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1074745718118">进入对应模块级oh-package.json5文件或工程级oh-package.json5文件中查看三方包是否已安装，若未安装，需执行ohpm install安装；若已安装，需查看“main”字段是否配置正确，若未配置或配置错误，需配置为正确的入口文件。</p> </li><li id="li174751417131510">场景三：<p id="ZH-CN_TOPIC_0000002510174481__p54752177157"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p19302537171610">引用的包路径被混淆，代码中又是在引用包后面拼接了路径，导致模块引用不到而报错。</p> <p id="ZH-CN_TOPIC_0000002510174481__p20395132992410">例如：</p> <p id="ZH-CN_TOPIC_0000002510174481__p15964135072419"><span><img originheight="740" originwidth="668" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104909.77511242876344214374789618583226:50001231000000:2800:47BC2030E27E01267BB15DE41C2485FBAD6DD762E7A693D2E9A6951B4F9F8F9F.png" width="668" height="740"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p975018576271">代码中这样引用</p> <p id="ZH-CN_TOPIC_0000002510174481__p1391135152812"><span><img originheight="152" originwidth="858" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104909.74197076937581426263558896437010:50001231000000:2800:A149436257700D90BB11AFB40B4AAE354FF7E299E7F243376D0B992934FDAEB8.png" width="858" height="152"></span>这样引用会找不到模块，导致报错。</p> <p id="ZH-CN_TOPIC_0000002510174481__p18749592287"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p19899194142916">修改引用方式，改为推荐的引用方式</p> <p id="ZH-CN_TOPIC_0000002510174481__p1817119327294"><span><img originheight="432" originwidth="999" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104909.44939490232013084117139353533947:50001231000000:2800:EBEAF0EB6BD3C7F0E78C20B0937B8C30ABB3BE1A801F07AA1C54256201593C6D.png" width="920" height="397.83783783783787"></span></p> </li><li id="li1127764673018">场景四：<p id="ZH-CN_TOPIC_0000002510174481__p11277346183016"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p5349185713317">被引用模块oh_package.json5配置有误，执行了ohpm install 并且成功地安装了依赖，但是还报错模块找不到。</p> <p id="ZH-CN_TOPIC_0000002510174481__p3125184163515"><span><img originheight="365" originwidth="1389" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104909.92866598084534383874936293491996:50001231000000:2800:32C4DB7DAC10EB6B89EB6325DC8DA444609885CA9452ED377BF6D3D27404DAAC.png" width="920" height="241.75665946724263"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p164262031153511">被引用模块的 oh_package.json5 中配置了错误的types字段。</p> <p id="ZH-CN_TOPIC_0000002510174481__p174260311352">该字段优先于main字段。 如果 types 字段配置的不存在，就会报错模块找不到。</p> <p id="ZH-CN_TOPIC_0000002510174481__p57217013618"><span><img originheight="245" originwidth="671" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104909.61000673203654981292607346993140:50001231000000:2800:30A1979EAB47845B6173BAF97C3E6B8C4551C6CF4592F40F892F1A43BCF59A8F.png" width="671" height="245"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p939519136382"></p> <p id="ZH-CN_TOPIC_0000002510174481__p1522915241381"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1984218264384">如果该包中没有d.ets声明，则这个字段可以删除。配置不存在或者错误，会导致报错。</p> </li><li id="li79967502395">场景五：<p id="ZH-CN_TOPIC_0000002510174481__p12996550113915"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p516150134017">oh_package.json5 中 dependencies 中引入模块的 名称 和 实际使用时 import 的 不一致。</p> <p id="ZH-CN_TOPIC_0000002510174481__p6314517409">例如 在 oh_package.json5 中这样引入：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen831055408" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-string">"dependencies"</span>: {   <span class="hljs-string">"har"</span>: <span class="hljs-string">"file:../har"</span> }</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p1730516401">但是实际上在代码中import 的时候是 大写 HAR 或者其他而不是 dependencies 里面配置的 ‘har’ 的值，要注意保持完全一致。（目前windows 没有问题，linux会报错模块找不到）</p> <p id="ZH-CN_TOPIC_0000002510174481__p13298162124014"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p10141525104017">引入和使用改成一致。</p> </li><li id="li179814395403">场景六：<p id="ZH-CN_TOPIC_0000002510174481__p998639134019"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p175621244114012">引用模块的 oh_package.json5 中 main 字段值和实际的文件名称大小写不一致。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1817794784013"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p7813135120400">将main字段和实际文件名称的大小写改为一致。</p> </li><li id="li485223752615">场景七：<p id="ZH-CN_TOPIC_0000002510174481__p3853193712266"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p2853103716262">Stage模板工程编译构建失败，提示 "Cannot find module '@bundle:rollup_plugin_ignore_empty_module_placeholder' or its corresponding type declarations"。</p> <p id="ZH-CN_TOPIC_0000002510174481__p10853537172613"><span><img originheight="99" originwidth="886" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104909.74101863554282880236937146368119:50001231000000:2800:C855F93C0E73E29A06E62A254B309414423D336C6707729CE3653B07A7721C15.png" width="886" height="99"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p1085333720261"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p8853143716267">该问题是由于工程引用了无对应实现文件的.d.ts声明文件：</p> <ol id="ZH-CN_TOPIC_0000002510174481__ol208531937112617"><li id="li16853237202611">通过在build目录中搜索'rollup_plugin_ignore_empty_module_placeholder'，找到报错的中间文件，并根据中间文件找到对应工程文件。<p id="ZH-CN_TOPIC_0000002510174481__p0853163710265"><span><img originheight="360" originwidth="497" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104909.67382555269770155544159533277375:50001231000000:2800:BC466D404ED83BCB15AA9F71C81FDC8E1C00AF52C41ACBD9D185911B74C51082.png" width="497" height="360"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p28531337202612">在输入栏中输入rollup_plugin_ignore_empty_module_placeholder，找到问题模块的中间文件。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1985373722620"><span><img originheight="765" originwidth="759" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104909.69528092061457712812500927273112:50001231000000:2800:BFD34CFCD1A3DC8E575AD50AF6FF9DBD811095A63C3B73FC527B8B9908C1A095.png" width="759" height="765"></span></p> </li></ol><ol id="ZH-CN_TOPIC_0000002510174481__ol98532370265" start="2"><li id="li17853837102617">在引用类型文件中通过添加type显式声明符号类型引用：<div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-typescript" id="ZH-CN_TOPIC_0000002510174481__screen1185353742611" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">type</span> {T} <span class="hljs-keyword">from</span> <span class="hljs-string">'./type'</span>;</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p78531437142619"><span><img originheight="356" originwidth="985" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104909.00888186368037158093779075202409:50001231000000:2800:1C899267435F69D88D2D4AE0823530C6B02ADE27AD02FF44C372A5A894F924B0.png" width="920" height="332.507614213198"></span></p> </li></ol><ol id="ZH-CN_TOPIC_0000002510174481__ol5853237102615" start="3"><li id="li208534371264">同时排查是否从d.ts/d.ets中引用值类型符号，禁止在声明文件中声明值变量。<p id="ZH-CN_TOPIC_0000002510174481__p98531937132612"><span><img originheight="338" originwidth="1069" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104909.43186552798797070421417651432119:50001231000000:2800:6D9952A7BA1165089409F37A2E643E3F194222363E8F1F0593AE89DF092276A9.png" width="920" height="290.88868101029"></span></p> </li></ol> </li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 841px;"><h2 id="section1122656145319">编译报错“Module 'xxx' has no exported member 'yyy'”<i class="anchor-icon anchor-icon-link" anchorid="section1122656145319" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p112225610534"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p679895101516">Stage模板工程编译构建失败，提示 "Module 'xxx' has no exported member 'yyy'" 并且"yyy"符号是由export * from 'x.js'语法从js文件中导出。</p> <p id="ZH-CN_TOPIC_0000002510174481__p612216564537"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p8433105301719">当前Stage工程编译构建期的语法校验工具对js文件不作检查，因此当使用export * from 'x.js'导出js文件中的符号时，符号引用处便会提示"Module 'xxx' has no exported member 'yyy'"的错误信息。</p> <p id="ZH-CN_TOPIC_0000002510174481__p512285617533">如果出现类似问题，可尝试通过如下方式进行解决：</p> <ul id="ZH-CN_TOPIC_0000002510174481__ul84711817111815"><li id="li114711217141814">方法1（推荐使用）： 使用符号显式导出语法，从js文件中re-export符号 。<div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" id="ZH-CN_TOPIC_0000002510174481__screen1912214566532" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">export</span> { yyy } <span class="hljs-keyword">from</span> <span class="hljs-string">'x.js'</span></li></ol></pre></div></div> </li></ul> <ul id="ZH-CN_TOPIC_0000002510174481__ul1471217191817"><li id="li847116172188">方法2：新增x.js对应的声明文件(.d.ts)，并在引用时不指定后缀。<p id="ZH-CN_TOPIC_0000002510174481__p398593251810"><span><img originheight="245" originwidth="799" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104909.99930895741692391566762150392646:50001231000000:2800:099B77D2083A780367A5AE4B54DE1DE7283FB417FE26ACA8FDD486496DB13646.png" width="799" height="245"></span></p> </li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 512px;"><h2 id="section1952539162716">编译报错“Could not load ${file1} (imported by ${file2}): Maximum call stack size exceeded”<i class="anchor-icon anchor-icon-link" anchorid="section1952539162716" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p248410181299"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p5215478355">Stage模板工程编译构建失败，提示 "ERROR: Could not load ${file1} (imported by ${file2}): Maximum call stack size exceeded"。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1221142682912"><span><img originheight="42" originwidth="1354" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104909.89998916781025758028475426281739:50001231000000:2800:5A1B446C750CA4C27858936590B4043D0700558D914F70862EF48A5F0B40709D.png" width="920" height="28.537666174298376"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p9367145715387"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p4592439103519">该问题是由于file1为当前工程外的代码：</p> <p id="ZH-CN_TOPIC_0000002510174481__p723720133510"><span><img originheight="71" originwidth="774" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104909.81603749687839830916193149586373:50001231000000:2800:AF5EF93E2F48D30E6747E772BF465FD0AE7A579DD9B1BE5EC2A1CBA550FA9E4E.png" width="774" height="71"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p1036715571381">请新建Static Library模块，并将工程外的代码迁移至Static Library模块内，并使用HAP引用HAR方式进行模块间引用。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 4978px;"><h2 id="section16345217154214">编译报错“Failed to get a resolved OhmUrl by filepath xx”<i class="anchor-icon anchor-icon-link" anchorid="section16345217154214" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p135052113539"></p> <ul id="ZH-CN_TOPIC_0000002510174481__ul47733455386"><li id="li242216179392"><strong>场景一：</strong><p id="ZH-CN_TOPIC_0000002510174481__p65671231153913"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p2914833123915">三方包在配置依赖时，配置到devDependencies，源码中又有引用依赖中的API时，编译失败。如以下示例：三方包@hms-security/ucs-appauth将依赖@network/gr配置在devDependencies中，源码中使用了@network/grs的API时，编译失败，提示“ERROR: ArkTS:ERROR Failed to get a resolved OhmUrl by filepath xxx”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1714215361393"><span><img originheight="287" originwidth="1580" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104909.62792652770077624432072518141294:50001231000000:2800:FA8C5F3DA53DA220E7F30BF7611C4F007236802A854360ED4F64EE145B29AFE3.png" width="920" height="167.1139240506329"></span></p> <div class="p" id="ZH-CN_TOPIC_0000002510174481__p33968387390"><strong>问题确认</strong><ol id="ZH-CN_TOPIC_0000002510174481__ol1037194714394"><li id="li837747173914">进入上面报黄色的源码文件中，可以看到依赖有红色告警信息。<p id="ZH-CN_TOPIC_0000002510174481__p4761175115398"><span><img height="21.945" originheight="24" originwidth="552" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104909.99718483696805837907522969082877:50001231000000:2800:DA0C20EBC5B4214437FD3241FA42D4C43177AE20FFFB97CE42AEBDE7E8D271A0.png" title="点击放大" width="523.6875"></span></p> </li><li id="li4371147103920">进入包下的oh-package.json5文件，查看依赖配置为devDependencies。<p id="ZH-CN_TOPIC_0000002510174481__p91861253183911"><span><img originheight="134" originwidth="356" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104909.33657029811014991246309756381534:50001231000000:2800:7F4C9142F6E7D03741EC8780223613B448E9A537653AAEC7B243121C676EA29C.png" width="356" height="134"></span></p> </li></ol> </div> <div class="p" id="ZH-CN_TOPIC_0000002510174481__p8920122124012"><strong>处理措施</strong><ul id="ZH-CN_TOPIC_0000002510174481__ul49451855123811"><li id="li1657557154819">向此包开发团队提改进建议：运行时的依赖，不能配置在devDependencies中。</li><li id="li136661438203711">可在依赖上层引入对应devDependencies中的三方包规避此问题。</li></ul> </div> </li></ul> <ul id="ZH-CN_TOPIC_0000002510174481__ul1657514784819"><li id="li44221517163911"><strong>场景二：</strong><p id="ZH-CN_TOPIC_0000002510174481__p195741812114019"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1035411410403">DevEco Studio编译失败，提示“ERROR: ArkTS:ERROR Failed to get a resolved OhmUrl by filepath xxx”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p348951594012"><span><img originheight="133" originwidth="1150" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104909.28498475927409279016539503601489:50001231000000:2800:F42E030CC2BB35841A6EAA987686D85B9A0486DF9CDA415115AEBA613EC6AF66.png" width="920" height="106.4"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p43181717124015"><strong>问题确认</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p58691618184017">查看工程目录下的build-profile.json5文件中modules字段配置的srcPath路径是否与真实路径不相同，是否存在大小写不一致问题。</p> <p id="ZH-CN_TOPIC_0000002510174481__p848610209406"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p312842318401">将工程目录下的build-profile.json5文件中modules字段配置的srcPath路径与真实路径保持一致。</p> </li><li id="li759444845718"><strong>场景三：</strong><p id="ZH-CN_TOPIC_0000002510174481__p5595348105713"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p53656414583">工程A以相对路径引用了工程B的模块，这种引用会导致报错。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1297714617416"><span><img originheight="226" originwidth="1448" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104910.33963207728934003472008410242265:50001231000000:2800:DC97DD3CD280159E65ECBB37BC18FC830E53B09EC8284FC0E04166D4A93C2D28.png" width="920" height="143.59116022099448"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p166827502588"><span><img originheight="93" originwidth="1288" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104910.94862314026345140382131083281206:50001231000000:2800:51840B9CD5660AC5F181AE9BCDB95670E552638E180BD0D4A326618C1627417A.png" width="920" height="66.42857142857143"></span><span><img originheight="30" originwidth="1319" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104910.94730914993835561950364935665295:50001231000000:2800:831CB4A2FBF9C8F38A1E5CAD39E739E0E6210A29166FEAC1C15F996255ED3A04.png" width="920" height="20.924943138741472"></span><strong>处理措施</strong></p> <ul id="ZH-CN_TOPIC_0000002510174481__ul837213153157"><li id="li43721915191519">把工程B这种的har转至工程A里，作为A的一个模块引用。</li><li id="li17372215151514">把工程B的har提前打包，在A中 以.har的方式引用。</li><li id="li2372115121516">上传到仓库，以版本号的方式引用。</li></ul> </li><li id="li43861212105216"><strong>场景四：</strong><p id="ZH-CN_TOPIC_0000002510174481__p1217614585216"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1175418234145">DevEco Studio编译失败，提示“Error Message: Failed to get a resolved OhmUrl for 'hvigor_ignore_xxxxx' imported by xxx”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p617614515523"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p15394194516365">如果hvigor_ignore_xxxxx所在的模块是一个har模块，需要排查oh_package.json5中是否存在"packageType": "InterfaceHar"，如果存在，请删除"packageType": "InterfaceHar"。</p> </li><li id="li59901539114311"><strong>场景五：</strong><p id="ZH-CN_TOPIC_0000002510174481__p1617684517524"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p317694511529">DevEco Studio编译失败，提示“Failed to get a resolved OhmUrl for 'xxx' imported by 'yyy'”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p15638546113219"><span><img height="200.59326000000001" originheight="239" originwidth="1071" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104910.09816838438574434015644371191425:50001231000000:2800:DE061CB9DA4D78B2F8DEC168D94A455F6498645306A6072B83CA1D6B57200C9E.png" title="点击放大" width="881.7900000000001"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p4176945105210"><strong>问题确认</strong></p> <ol id="ZH-CN_TOPIC_0000002510174481__ol109881119542"><li id="li59886165418">排查yyy所在模块是否为<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-build-har#section16598338112415">字节码har</a>，查看工程级build-profile.json5的useNormalizedOHMUrl是否为true（缺省默认值为false），如果为true则默认构建字节码har。</li><li id="li16950172315913">如果yyy所在模块是字节码har，请排查xxx依赖是否被配置在工程级oh_package.json5的dependencies，但没有配置在yyy模块级oh_package.json5的dependencies中。</li></ol> <p id="ZH-CN_TOPIC_0000002510174481__p617619456523"><strong>处理措施</strong></p> <ul id="ZH-CN_TOPIC_0000002510174481__ul1272618442164"><li id="li0437114313163">将xxx依赖配置到yyy模块oh_package.json5的dependencies中。<p id="ZH-CN_TOPIC_0000002510174481__p84971350111613"><span><img height="382.7796112311015" originheight="468" originwidth="1143" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104910.74414229613501489087940046232526:50001231000000:2800:DDE20EEE0B23EBDEAE37D5B615EF87A176D1E83D483761B57D0BA62C38F6AB6E.png" title="点击放大" width="920"></span></p> </li><li id="li18783165551619">将yyy模块改为非字节码har，在模块级build-profile.json5文件中添加byteCodeHar字段并设置为false。<div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen18114175762214" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-string">"buildOption"</span>: { </li><li>  <span class="hljs-string">"arkOptions"</span>: { </li><li>    <span class="hljs-string">"byteCodeHar"</span>: <span class="hljs-keyword">false</span></li><li>  }</li><li>}</li></ol></pre></div></div> </li></ul> </li><li id="li1755773610478"><strong>场景六：</strong><p id="ZH-CN_TOPIC_0000002510174481__p199391708486">请确认当前使用的DevEco Studio和SDK版本是配套的，点击菜单栏<strong>Help &gt; About DevEco Studio</strong>，<strong>Help &gt; About HarmonyOS SDK</strong>分别查看配套的DevEco Studio和SDK版本。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1893915011484"><span><img originheight="504" originwidth="582" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104910.73794579988139430836727087432973:50001231000000:2800:710D42A8C08847F1847BA6DC2AA621866514819811164094153FE9B3394418F3.png" width="582" height="504"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p1968263671619"></p> </li><li id="li9465171113484"><strong>场景七：</strong><p id="ZH-CN_TOPIC_0000002510174481__p6223102554811"><strong>问题现象：</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p7815113794915">DevEco Studio编译失败，提示 "ERROR:  ArkTS:ERROR failed to execute es2abc ERROR:  ArkTS:ERROR Failed to get a resolved OhmUrl by filepath xxx"。</p> <p id="ZH-CN_TOPIC_0000002510174481__p168151737124919"><span><img originheight="273" originwidth="900" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104910.71630734034879236618318446543440:50001231000000:2800:1902D23B307C891C774CA0AB9C2F4AEE35692D3A88CEBB7519197FB566200C4A.png" width="900" height="273"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p1581603718498"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p88162037154913">该问题是由于在工程中引用了非工程标准模块目录（即目录内无模块描述文件module.json5），如下图utils目录所示：请新建Static Library模块，并将utils/common里面的代码迁移至Static Library模块内，并使用HAP引用HAR方式进行模块间引用。</p> <p id="ZH-CN_TOPIC_0000002510174481__p181693794912"><span><img originheight="550" originwidth="1183" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104910.32286898810659504465177441018291:50001231000000:2800:0DFDD8E570C4C60A8D1806493B582C5BB81AE3B3D69C61EA34A81F7B80EC949D.png" width="920" height="427.7261200338124"></span></p> </li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 3047px;"><h2 id="section1115020543287">编译报错“Property xxx does not exist on type 'typeof BuildProfile'.”<i class="anchor-icon anchor-icon-link" anchorid="section1115020543287" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p1515045452819"><strong>问题现象</strong><strong>1</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p968994223213">使用了自定义参数BuildProfile，编译态无异常但编译构建失败，提示“Property xxx does not exist on type 'typeof BuildProfile'.”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1468954233219"><span><img originheight="578" originwidth="1136" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104910.60171964735777387670065061604426:50001231000000:2800:7C37841C110E03613328ED95497EA438A85953F1F5580A030E9B1B731E817908.png" width="920" height="468.0985915492958"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p151502054182810"></p> <p id="ZH-CN_TOPIC_0000002510174481__p17150175418289"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1150472793312">检查在当前模块下build-profile.json5中的targets &gt; buildProfileFields配置的自定义参数中key值是否相同，如果不同请将targets内所有buildProfileFields中的key值保持相同。</p> <p id="ZH-CN_TOPIC_0000002510174481__p75053277333">以下为导致编译报错的<strong>错误</strong>配置示例：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen1572451165520" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-string">"targets"</span></span>: [</li><li>  {</li><li>    <span class=""><span class="hljs-string">"name"</span></span>: <span class=""><span class="hljs-string">"default"</span></span>,</li><li>    <span class=""><span class="hljs-string">"config"</span></span>: {</li><li>      <span class=""><span class="hljs-string">"buildOption"</span></span>: {</li><li>        <span class=""><span class="hljs-string">"arkOptions"</span></span>: {</li><li>          <span class=""><span class="hljs-string">"buildProfileFields"</span></span>: {</li><li>            <span class=""><span class="hljs-string">"targetName"</span></span>: <span class=""><span class="hljs-string">"default"</span></span></li><li>          }</li><li>        }</li><li>      }</li><li>    }</li><li>  },</li><li>  {</li><li>    <span class=""><span class="hljs-string">"name"</span></span>: <span class=""><span class="hljs-string">"default1"</span></span>,</li><li>    <span class=""><span class="hljs-string">"config"</span></span>: {</li><li>      <span class=""><span class="hljs-string">"buildOption"</span></span>: {</li><li>        <span class=""><span class="hljs-string">"arkOptions"</span></span>: {</li><li>          <span class=""><span class="hljs-string">"buildProfileFields"</span></span>: {</li><li>            <span class=""><span class="hljs-string">"targetName1"</span></span>: <span class=""><span class="hljs-string">"default1"</span></span></li><li>          }</li><li>        }</li><li>      }</li><li>    }</li><li>  },</li><li>]</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p2050572773312"></p> <p id="ZH-CN_TOPIC_0000002510174481__p15505827143317">请将targets内所有buildProfileFields中的key值修改一致，如以下示例：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen157696417552" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-string">"targets"</span></span>: [</li><li>  {</li><li>    <span class=""><span class="hljs-string">"name"</span></span>: <span class=""><span class="hljs-string">"default"</span></span>,</li><li>    <span class=""><span class="hljs-string">"config"</span></span>: {</li><li>      <span class=""><span class="hljs-string">"buildOption"</span></span>: {</li><li>        <span class=""><span class="hljs-string">"arkOptions"</span></span>: {</li><li>          <span class=""><span class="hljs-string">"buildProfileFields"</span></span>: {</li><li>            <span class=""><span class="hljs-string">"targetName"</span></span>: <span class=""><span class="hljs-string">"default"</span></span></li><li>          }</li><li>        }</li><li>      }</li><li>    }</li><li>  },</li><li>  {</li><li>    <span class=""><span class="hljs-string">"name"</span></span>: <span class=""><span class="hljs-string">"default1"</span></span>,</li><li>    <span class=""><span class="hljs-string">"config"</span></span>: {</li><li>      <span class=""><span class="hljs-string">"buildOption"</span></span>: {</li><li>        <span class=""><span class="hljs-string">"arkOptions"</span></span>: {</li><li>          <span class=""><span class="hljs-string">"buildProfileFields"</span></span>: {</li><li>            <strong style="color: rgb(135,16,148);"><span class="hljs-string">"targetName"</span></strong>: <span class=""><span class="hljs-string">"default1"</span></span></li><li>          }</li><li>        }</li><li>      }</li><li>    }</li><li>  },</li><li>]</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p1450511272338"></p> <p id="ZH-CN_TOPIC_0000002510174481__p9954102712913"><strong>问题现象2</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p16130625519">使用了自定义参数BuildProfile并且编译器标红且构建失败，提示“Property xxx does not exist on type 'typeof BuildProfile'.”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p179541227192911"><span><img originheight="572" originwidth="1064" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104910.92591631200916779236245021884293:50001231000000:2800:C9F62675D47E54FF3EA0E4DDD18BADDEBCE9AE54A987D183DC465C0A4F7C48DD.png" width="920" height="494.5864661654135"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p17954142732914"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p187512042143018">请检查当前模块下build-profile.json5中buildProfileFields内是否添加了所使用的自定义参数，请确保该自定义参数已配置在buildProfileFields内。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 488px;"><h2 id="section967711427406">C++工程编译导致电脑卡顿的处理建议<i class="anchor-icon anchor-icon-link" anchorid="section967711427406" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p127591357114215"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p9890163414">在执行代码规模较大的C++工程的编译时，由于C++编译时的CPU占用率较高，可能出现电脑卡顿、反应迟缓等现象。</p> <p id="ZH-CN_TOPIC_0000002510174481__p03528194438"><strong>处理措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p165031426124315">如果出现类似问题，可尝试通过如下方式进行解决：</p> <div class="p" id="ZH-CN_TOPIC_0000002510174481__p375923134514">打开模块下的build-profile.json5文件，在<strong>arguments</strong>参数中添加如下配置。并根据电脑CPU配置，修改compile和link的值。建议compile和link的值之和，设置为CPU核数的一半，如CPU为8核，则compile和link分别设置为2。<div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen16703183418449" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-string">"arguments"</span>: <span class="hljs-string">"-DCMAKE_JOB_POOL_COMPILE:STRING=compile -DCMAKE_JOB_POOL_LINK:STRING=link -DCMAKE_JOB_POOLS:STRING=compile=2;link=2"</span>,</li></ol></pre></div></div> </div> <p id="ZH-CN_TOPIC_0000002510174481__p19634122017477">需要说明的是，修改了compile和link的值，可能会导致编译时长增加，请耐心等待。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 3080px;"><h2 id="section13911353105320">CPP编译报错"A 'undefined symbol' error has occurred"<i class="anchor-icon anchor-icon-link" anchorid="section13911353105320" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p4912053115319"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p179185313536">在编译HarmonyOS C++ 项目时，报错提示"A 'undefined symbol' error has occurred"。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1691125385310"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p39115316532">"undefined symbol"错误通常表示链接器找不到特定符号的定义。这通常是因为源文件没有正确编译或链接，或者因为缺少必要的库文件。以下是如何定位和解决这个问题的步骤：</p> <p id="ZH-CN_TOPIC_0000002510174481__p13300229628">1. 确保所有源文件都已包含在 CMake 构建中。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1730012915212">首先，检查您的 CMakeLists.txt 文件，确保所有相关的源文件都已包含在项目中。</p> <div class="p" id="ZH-CN_TOPIC_0000002510174481__p123009291821"><strong>示例 CMakeLists.txt</strong><div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" id="ZH-CN_TOPIC_0000002510174481__screen133001729623" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-built_in">cmake_minimum_required</span></span>(VERSION <span class=""><span class="hljs-number">3.10</span></span>) </li><li><span class=""><span class="hljs-built_in">project</span></span>(MyProject)  </li><li><span class=""><span class="hljs-built_in">set</span></span>(CMAKE_CXX_STANDARD <span class=""><span class="hljs-number">17</span></span>)  </li><li><span class=""><span class="hljs-built_in">include_directories</span></span>(<span class="">${CMAKE_CURRENT_SOURCE_DIR}</span>                    </li><li><span class="">                    ${CMAKE_CURRENT_SOURCE_DIR}</span>/<span class="">include</span>)  </li><li><span class=""># 添加所有源文件</span></li><li><span class=""><span class="hljs-built_in">add_library</span></span>(myProgram SHARED main.cpp myLibrary.cpp) </li></ol></pre></div></div> </div> <p id="ZH-CN_TOPIC_0000002510174481__p153000292219">2. 确认源文件的符号定义。</p> <p id="ZH-CN_TOPIC_0000002510174481__p18300929629">确保在所有相关的源文件中正确定义了符号。例如，检查 myLibrary.cpp 是否包含 myFunction 的定义：</p> <p id="ZH-CN_TOPIC_0000002510174481__p1030002916210"><strong>myLibrary.cpp</strong></p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" id="ZH-CN_TOPIC_0000002510174481__screen630013290211" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"myLibrary.h"</span></span></span><span class="hljs-meta"> </span></li><li><span class=""><span class="hljs-function"><span class="hljs-type">void</span></span></span><span class="hljs-function"> </span><span class=""><span class="hljs-function"><span class="hljs-title">myFunction</span></span></span><span class="hljs-function"><span class="hljs-params">()</span> </span>{     </li><li><span class=""><span class="hljs-comment">// Function implementation</span></span></li><li>}</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p123005291523"><strong>myLibrary.h</strong></p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" id="ZH-CN_TOPIC_0000002510174481__screen73001295210" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> MY_LIBRARY_H</span></span></li><li><span class=""><span class="hljs-meta">#<span class="hljs-keyword">define</span> MY_LIBRARY_H</span></span><span class="hljs-meta"> </span></li><li><span class=""><span class="hljs-function"><span class="hljs-type">void</span></span></span><span class="hljs-function"> </span><span class=""><span class="hljs-function"><span class="hljs-title">myFunction</span></span></span><span class="hljs-function"><span class="hljs-params">()</span></span>;  </li><li><span class=""><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span></span><span class="hljs-meta"> </span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p173006291825">3. 检查编译和链接顺序。</p> <p id="ZH-CN_TOPIC_0000002510174481__p83005291213">确保所有源文件和库文件按照正确的顺序进行编译和链接。CMake 和 Ninja 通常会处理这个问题，但在手动编译时可能会出现问题。</p> <p id="ZH-CN_TOPIC_0000002510174481__p13005291126">4. 清理和重新生成构建文件。</p> <p id="ZH-CN_TOPIC_0000002510174481__p133006291023">有时，构建文件可能会损坏或丢失符号定义。尝试清理构建目录并重新生成构建文件：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-undefined" id="ZH-CN_TOPIC_0000002510174481__screen83007299215" data-highlighted="yes"><ol class="linenums"><li>hvigorw clean 1 </li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p173002291624">或手动删除模块下.cxx目录。</p> <p id="ZH-CN_TOPIC_0000002510174481__p18300152915217">5. 检查库路径和链接器标志。</p> <p id="ZH-CN_TOPIC_0000002510174481__p230052911215">如果使用三方库，确保 CMakeLists.txt 中正确配置了库路径和链接器标志。例如：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" id="ZH-CN_TOPIC_0000002510174481__screen1330014291721" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-built_in">cmake_minimum_required</span></span>(VERSION <span class=""><span class="hljs-number">3.10</span></span>) </li><li><span class=""><span class="hljs-built_in">project</span></span>(MyProject)  </li><li><span class=""><span class="hljs-built_in">set</span></span>(CMAKE_CXX_STANDARD <span class=""><span class="hljs-number">17</span></span>)  </li><li><span class=""># 确保添加三方库的头文件</span></li><li><span class=""><span class="hljs-built_in">include_directories</span></span>(<span class="">${PATH_TO_EXTERNAL_LIBRARY}</span></li><li>                    <span class="">${PATH_TO_EXTERNAL_LIBRARY}</span>/<span class="">include</span>)  </li><li><span class=""># 添加源文件</span></li><li><span class=""><span class="hljs-built_in">add_library</span></span>(myProgram SHARED main.cpp myLibrary.cpp)  </li><li><span class=""># 链接三方库</span></li><li><span class=""><span class="hljs-built_in">target_link_libraries</span></span>(myProgram PUBLIC /path/to/external/library) </li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p11300122914215">6. 启用详细编译和链接输出。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1130042919213">为了解详细的编译和链接过程，可以启用更详细的输出。在 CMakeLists.txt 中添加以下内容：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" id="ZH-CN_TOPIC_0000002510174481__screen15300172917214" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-built_in">set</span></span>(CMAKE_VERBOSE_MAKEFILE <span class="">ON</span>)</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p1430019291426">7. 检查 Ninja 输出日志。</p> <p id="ZH-CN_TOPIC_0000002510174481__p930017291928">Ninja 默认生成 .ninja_log 文件，其中包含构建过程的详细信息。您可以检查这个日志文件以了解构建过程中的问题。</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-bash" id="ZH-CN_TOPIC_0000002510174481__screen33001529227" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">cat</span> {module}/.cxx/default/default/arm64-v8a/.ninja_log </li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p73005299210">检查编译日志中是否存在符号所在的源文件或头文件。</p> <p id="ZH-CN_TOPIC_0000002510174481__p2300142911211">8. 使用 nm 工具检查符号。</p> <p id="ZH-CN_TOPIC_0000002510174481__p930011291826">使用 nm 工具检查目标文件和库文件中的符号，确保符号定义存在。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1830012291020">可使用sdk中内置的nm工具：sdk/default/openharmony/native/llvm/bin/llvm-nm。</p> <p id="ZH-CN_TOPIC_0000002510174481__p0300182912219"><strong>检查目标文件</strong></p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-perl" id="ZH-CN_TOPIC_0000002510174481__screen18300182920216" data-highlighted="yes"><ol class="linenums"><li>nm myLibrary.o | <span class="hljs-keyword">grep</span> myFunction </li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p1030082913217"><strong>检查三方库文件</strong></p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-swift" id="ZH-CN_TOPIC_0000002510174481__screen183010291225" data-highlighted="yes"><ol class="linenums"><li>nm <span class="hljs-regexp">/path/</span>to<span class="hljs-regexp">/external/</span>library <span class="hljs-operator">|</span> grep myFunction</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p43011029326"><strong>结论</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1830117291322">通过上述步骤，您可以定位和解决 error: undefined symbol 问题。在使用 CMake、Ninja 和 LLVM 编译 C++ 项目时，确保所有源文件和库文件正确包含在项目中，并正确配置编译和链接选项是关键。如果问题依旧存在，详细的编译和链接输出日志通常能提供更多线索，帮助您找到具体的原因。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 2164px;"><h2 id="section2087337175510">CPP编译报错"A 'unknown type name' error has occurred"<i class="anchor-icon anchor-icon-link" anchorid="section2087337175510" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p287311785518"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1587311715559">在编译HarmonyOS C++ 项目时，报错提示"A 'unknown type name' error has occurred"。</p> <p id="ZH-CN_TOPIC_0000002510174481__p2873177175513"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1135919276612">在编译HarmonyOS C++ 项目时，遇到"unknown type name"错误通常表示编译器无法识别某个类型。这可能是因为类型未定义、未包含相关的头文件，或者包含的头文件路径不正确。以下是定位和解决这个问题的步骤：</p> <ol id="ZH-CN_TOPIC_0000002510174481__ol201881932153118"><li id="li818813212316">检查是否包含头文件。<p id="ZH-CN_TOPIC_0000002510174481__p23598275616">确保所有必要的头文件都已正确包含在源文件中。例如，如果您正在使用某个自定义类型或库提供的类型，请确保在使用该类型的文件中包含了相关的头文件。</p> <p id="ZH-CN_TOPIC_0000002510174481__p16979257123117"><strong>示例：</strong></p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cpp" id="ZH-CN_TOPIC_0000002510174481__screen821420512322" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-comment">// main.cpp</span></span></li><li><span class=""><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">"myLibrary.h"</span></span></span><span class="hljs-meta"> </span></li><li><span class=""><span class="hljs-function"><span class="hljs-type">int</span></span></span><span class="hljs-function"> </span><span class=""><span class="hljs-function"><span class="hljs-title">main</span></span></span><span class="hljs-function"><span class="hljs-params">()</span> </span>{</li><li>     MyType obj;</li><li> <span class="">    <span class="hljs-comment">// 使用自定义类型</span></span></li><li>     <span class=""><span class="hljs-keyword">return</span></span> <span class=""><span class="hljs-number">0</span></span>;</li><li>}</li><li>
</li><li><span class=""><span class="hljs-comment">// myLibrary.h</span></span></li><li><span class=""><span class="hljs-meta">#<span class="hljs-keyword">ifndef</span> MY_LIBRARY_H</span></span></li><li><span class=""><span class="hljs-meta">#<span class="hljs-keyword">define</span> MY_LIBRARY_H</span></span></li><li><span class=""><span class="hljs-keyword">class</span></span> <span class=""><span class="hljs-title class_">MyType</span></span> {</li><li><span class=""><span class="hljs-keyword">public</span></span>:</li><li>     <span class=""><span class="hljs-built_in">MyType</span></span>() {}</li><li>     <span class=""><span class="hljs-function"><span class="hljs-type">void</span></span></span><span class="hljs-function"> </span><span class=""><span class="hljs-function"><span class="hljs-title">doSomething</span></span></span><span class="hljs-function"><span class="hljs-params">()</span></span>;</li><li>};</li><li><span class=""><span class="hljs-meta">#<span class="hljs-keyword">endif</span></span></span></li></ol></pre></div></div> </li><li id="li108853539327">检查头文件路径。<p id="ZH-CN_TOPIC_0000002510174481__p1035911271868">确保 CMakeLists.txt 中正确设置了头文件的搜索路径。可以通过 include_directories 添加头文件目录。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1235922719617"><strong>示例 CMakeLists.txt：</strong></p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" id="ZH-CN_TOPIC_0000002510174481__screen1835992720614" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-built_in">cmake_minimum_required</span></span>(VERSION <span class=""><span class="hljs-number">3.10</span></span>) </li><li><span class=""><span class="hljs-built_in">project</span></span>(MyProject)  </li><li><span class=""><span class="hljs-built_in">set</span></span>(CMAKE_CXX_STANDARD <span class=""><span class="hljs-number">17</span></span>)  </li><li><span class=""># 添加头文件目录</span></li><li><span class=""><span class="hljs-built_in">include_directories</span></span>(<span class="">${CMAKE_SOURCE_DIR}</span>/<span class="">include</span>)  </li><li><span class=""># 添加源文件</span></li><li><span class=""><span class="hljs-built_in">add_library</span></span>(myProgram SHARED src/main.cpp src/myLibrary.cpp) </li></ol></pre></div></div> </li><li id="li6541183217335">清理和重新生成构建文件。<p id="ZH-CN_TOPIC_0000002510174481__p128931156103318">有时，构建文件可能会损坏或丢失符号定义。尝试清理构建目录并重新生成构建文件：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-undefined" id="ZH-CN_TOPIC_0000002510174481__screen158931565338" data-highlighted="yes"><ol class="linenums"><li>hvigorw clean</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p1789395633320">或手动删除模块下.cxx目录。</p> </li><li id="li9962184263416">启用详细编译输出。<p id="ZH-CN_TOPIC_0000002510174481__p3359122710612">为了解详细的编译过程，可以启用更详细的输出。在 CMakeLists.txt 中添加以下内容：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" id="ZH-CN_TOPIC_0000002510174481__screen835972720612" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-built_in">set</span></span>(CMAKE_VERBOSE_MAKEFILE <span class="">ON</span>) </li></ol></pre></div></div> </li><li id="li2095117565348">检查编译输出日志。<p id="ZH-CN_TOPIC_0000002510174481__p182548198369">Ninja 默认生成 .ninja_log 文件，其中包含构建过程的详细信息。你可以检查这个日志文件以了解构建过程中的问题。</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-bash" id="ZH-CN_TOPIC_0000002510174481__screen1925413193365" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-built_in">cat</span> .cxx/default/default/arm64-v8a/.ninja_log</li></ol></pre></div></div> </li><li id="li15313046133620">使用 CMake 的 message 函数调试。<p id="ZH-CN_TOPIC_0000002510174481__p153590271618">可以在 CMakeLists.txt 文件中添加 message 函数来打印一些调试信息，以确保路径和变量正确设置。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1835915270611"><strong>示例：</strong></p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen6359727067" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-title function_">message</span></span>(<span class="hljs-variable">STATUS</span> <span class=""><span class="hljs-string">"Source directory: <span class="hljs-subst">${<span class="hljs-variable">CMAKE_SOURCE_DIR</span>}</span>"</span></span>) </li><li><span class=""><span class="hljs-title function_">message</span></span>(<span class="hljs-variable">STATUS</span> <span class=""><span class="hljs-string">"Include directories: <span class="hljs-subst">${<span class="hljs-variable">CMAKE_INCLUDE_PATH</span>}</span>"</span></span>) </li></ol></pre></div></div> </li><li id="li41681737371">如果报错接口是系统API，请查阅对应API参考的起始版本，确认接口在当前版本是否可用。</li></ol> <p id="ZH-CN_TOPIC_0000002510174481__p1735913271162"><strong>结论</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1035915271762">通过上述步骤，您可以定位和解决 unknown type name 问题。在使用 CMake、Ninja 和 LLVM 编译 C++ 项目时，确保所有头文件正确包含并设置正确的头文件路径是关键。如果问题依旧存在，详细的编译输出日志通常能提供更多线索，帮助您找到具体的原因。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 669px;"><h2 id="section1814413127911">JDK版本不匹配导致编译失败<i class="anchor-icon anchor-icon-link" anchorid="section1814413127911" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p1415945110913"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1135213571598">通过命令行方式构建HarmonyOS应用或元服务过程中出现构建失败，现象如下图所示。</p> <p id="ZH-CN_TOPIC_0000002510174481__p42932585916"><span><img originheight="293" originwidth="960" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104910.52715033650131310780209995849108:50001231000000:2800:5FCDDD8668A8A5FC16BF2190BE152AD6DEE1324097700D8957D0C1C23BBB4BBC.png" width="920" height="280.7916666666667"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p36361344171612"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p181127508168">该问题是由于JDK版本不匹配导致，当前配套的版本为JDK 17。因此，请根据如下方法进行修正：</p> <ol id="ZH-CN_TOPIC_0000002510174481__ol31261316186"><li id="li1812683119184">下载并安装JDK 17版本。</li><li id="li1712723117189">修改JAVA_HOME环境变量，取值修改为JDK 17。如果是Linux系统，可参考使用命令行方式构建元服务或应用的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-command-line-building-app#section195447475220" target="_blank">配置JDK章节</a>。</li></ol> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 839px;"><h2 id="section141421101516">LABEL_VALUE_ERROR处理指导<i class="anchor-icon anchor-icon-link" anchorid="section141421101516" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p449604093915"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p14893155415505">在工程同步、编译构建过程中，提示<strong>LABEL_VALUE_ERROR</strong>错误信息。</p> <p id="ZH-CN_TOPIC_0000002510174481__p18892125418505"><span><img originheight="182" originwidth="800" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104910.02416565445435841939399267717146:50001231000000:2800:CD36F322059DAF94081D15E3A3EAB0528B4FB4B5D8CFE58C93E9442BCE39C544.png" width="800" height="182"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p9378104773911"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p173711152143910">该问题是由于config.json文件的资源引用规则变更导致，需要将“label”字段的取值，修改为资源引用方式。</p> <ol id="ZH-CN_TOPIC_0000002510174481__ol149944819519"><li id="li19941983516"><span>在<strong>resources &gt; base &gt; element</strong>中的string.json中添加对应的字符串信息。</span></li><li id="li128216175612"><span>然后在config.json中重新引用该字符串资源。</span><p></p><p id="ZH-CN_TOPIC_0000002510174481__p98151695614"><span><img originheight="229" originwidth="800" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104910.77818310606481288450216559013734:50001231000000:2800:0F97C5BAD36067BBEA31FCF692201143C40C3FF6C893C731133C45374CB7E9D8.png" width="800" height="229"></span></p> <p></p></li></ol> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 3270px;"><h2 id="section7802117182519">应用/元服务的启动界面信息缺失，提示"Schema validate failed"报错<i class="anchor-icon anchor-icon-link" anchorid="section7802117182519" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p3767114816449"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p5767134816442">在工程同步或者编译构建时出现错误，提示“Schema validate failed”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p25911536219"><span><img originheight="418" originwidth="844" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104910.22204344144487531869170509978333:50001231000000:2800:13CD26D5619F76C304E25E319F259485185A5017B745EC44E8F3AABCC4A2AE73.png" width="844" height="418"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p1876764864417"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p8060118">在开发应用/元服务时，可以设置应用/元服务的启动界面的图标及背景颜色，创建工程后自动设置了默认的启动界面信息，但若开发者误删其中某个字段后将导致报错。下面以重新设置启动界面信息为例，开发者可自定义启动界面的图标及背景颜色。</p> <p id="ZH-CN_TOPIC_0000002510174481__p126114540497">在开发应用/元服务时，为了提升应用/元服务冷启动的性能，您可以通过如下方式设置应用/元服务的启动界面的图标及背景颜色。</p> <ol id="ZH-CN_TOPIC_0000002510174481__ol14785131416519"><li id="li1926991314557"><span>在模块下的<strong>resources &gt; base &gt; element</strong>下，点击右键选择<strong>New &gt; Element Resource File</strong>创建资源文件。</span><p></p><p id="ZH-CN_TOPIC_0000002510174481__p1192065392419"><span><img originheight="395" originwidth="713" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104910.85422109635322148200241487556871:50001231000000:2800:BF3BB76E1027F85ED81E2FD0EA5BEB764C8E8F48954040124EE517289E3E2246.png" width="713" height="395"></span></p> <p></p></li><li id="li124901748185712"><span>在弹出的对话框中，“File name”开发者可自定义，如color；“Root element”请选择<strong>color。</strong></span><p></p><p id="ZH-CN_TOPIC_0000002510174481__p54907482573"><span><img originheight="264" originwidth="628" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104910.71225711839583362427114225417198:50001231000000:2800:DC80950BE587A173119F7A8AE3E126A19779553627AC0DDFFAAD174AB8FFD8E8.png" width="628" height="264"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p76956560413">创建完成后，color.json文件如下图所示：</p> <p id="ZH-CN_TOPIC_0000002510174481__p32471117247"><span><img originheight="208" originwidth="627" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104910.63520608738006848709433625514332:50001231000000:2800:95802C259C68C26013BFE80A1014A4DB44202AC5DD1F2B5D9E811944B22A8561.png" width="627" height="208"></span></p> <p></p></li><li id="li118541350154610"><span>将<a href="/consumer/cn/doc/harmonyos-guides/ide-hvigor-faqs#li124901748185712">2</a>创建的color.json文件拷贝至模块的<strong>ohosTest &gt; resources &gt; base &gt; element</strong>目录下。</span><p></p><p id="ZH-CN_TOPIC_0000002510174481__p4854350184613"><span><img originheight="486" originwidth="627" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104911.26630347362049099917570357691012:50001231000000:2800:A204B290BF825754F57DF8E2F331A10E5C55D13E73D7A28AD60B70AA08D8D387.png" width="627" height="486"></span></p> <p></p></li><li id="li178261511573"><span>在模块的<strong>src &gt; main &gt; module.json5</strong>文件的abilities数组中，添加startWindowIcon和startWindowBackground字段（若缺少任一字段，将出现ERROR: Schema validate failed报错）。其中，startWindowIcon字段索引模块下<strong>resources &gt; base &gt; media</strong>中的图标资源，startWindowBackground字段索引<strong>resources &gt; base &gt; element</strong><strong> &gt; color.json</strong>中的color。</span><p></p><p id="ZH-CN_TOPIC_0000002510174481__p178261611272"><span><img originheight="559" originwidth="548" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104911.54599559849533630427472789236200:50001231000000:2800:A69BF6297B1F50B68A4A5947C102772D42E9647B1A0D3780CBD5444365BFA5C1.png" width="548" height="559"></span></p> <p></p></li><li id="li1229554542413"><span>在<strong>src &gt; ohosTest &gt; module.json5</strong>文件的abilities数组中，加startWindowIcon和startWindowBackground字段。其中，startWindowIcon字段索引模块ohosTest下<strong>resources &gt; base &gt; media</strong>中的图标资源， startWindowBackground字段索引<strong>resources &gt; base &gt; element</strong><strong> &gt; color.json</strong>中的color。</span></li></ol> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 3126px;"><h2 id="section134821719104416">编译报错“Schema validate failed”<i class="anchor-icon anchor-icon-link" anchorid="section134821719104416" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p54791041152"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p94793419520">DevEco Studio编译时出现错误，提示“Schema validate failed”错误信息。</p> <p id="ZH-CN_TOPIC_0000002510174481__p447914411458"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p79954112525">出现该问题的原因是配置文件中字段缺失或拼写错误，可根据报错的详细信息进行问题定位。</p> <p id="ZH-CN_TOPIC_0000002510174481__p463110151816">如将module.json5文件中abilities标签中的“name”错写为“nam”，报错信息如下：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen0993193691018" data-highlighted="yes"><ol class="linenums"><li>     <span class="hljs-variable">Detail</span>: <span class="hljs-title class_">Please</span> <span class="hljs-title class_">check</span> <span class="hljs-title class_">the</span> <span class="hljs-title class_">following</span> <span class="hljs-title class_">fields</span>.</li><li>{</li><li>  <span class="hljs-variable">instancePath</span>: <span class="hljs-string">'module.abilities[0]'</span>,</li><li>  <span class="hljs-variable">keyword</span>: <span class="hljs-string">'required'</span>,</li><li>  <span class="hljs-variable">params</span>: { <span class="hljs-variable">missingProperty</span>: <span class="hljs-string">'name'</span> },</li><li>  <span class="hljs-variable">message</span>: <span class="hljs-string">"must have required property 'name'"</span>,</li><li>  <span class="hljs-variable">location</span>: <span class="hljs-string">'D:/MyApplication/entry/src/main/module.json5:15:8'</span></li><li>} </li><li>{</li><li>  <span class="hljs-variable">instancePath</span>: <span class="hljs-string">'module.abilities[0]'</span>,</li><li>  <span class="hljs-variable">keyword</span>: <span class="hljs-string">'required'</span>,</li><li>  <span class="hljs-variable">params</span>: { <span class="hljs-variable">missingProperty</span>: <span class="hljs-string">'srcEntrance'</span> },</li><li>  <span class="hljs-variable">message</span>: <span class="hljs-string">"must have required property 'srcEntrance'"</span>,</li><li>  <span class="hljs-variable">location</span>: <span class="hljs-string">'D:/MyApplication/entry/src/main/module.json5:15:8'</span></li><li>} </li><li>{</li><li>  <span class="hljs-variable">instancePath</span>: <span class="hljs-string">'module.abilities[0]'</span>,</li><li>  <span class="hljs-variable">keyword</span>: <span class="hljs-string">'required'</span>,</li><li>  <span class="hljs-variable">params</span>: { <span class="hljs-variable">missingProperty</span>: <span class="hljs-string">'name'</span> },</li><li>  <span class="hljs-variable">message</span>: <span class="hljs-string">"must have required property 'name'"</span>,</li><li>  <span class="hljs-variable">location</span>: <span class="hljs-string">'D:/MyApplication/entry/src/main/module.json5:15:8'</span></li><li>} </li><li>{</li><li>  <span class="hljs-variable">instancePath</span>: <span class="hljs-string">'module.abilities[0]'</span>,</li><li>  <span class="hljs-variable">keyword</span>: <span class="hljs-string">'oneOf'</span>,</li><li>  <span class="hljs-variable">params</span>: { <span class="hljs-variable">passingSchemas</span>: <span class="hljs-title class_">null</span> },</li><li>  <span class="hljs-variable">message</span>: <span class="hljs-string">'must match exactly one schema in oneOf'</span>,</li><li>  <span class="hljs-variable">location</span>: <span class="hljs-string">'D:/MyApplication/entry/src/main/module.json5:15:8'</span></li><li>} </li><li>{</li><li>  <span class="hljs-variable">instancePath</span>: <span class="hljs-string">'module.abilities[0]'</span>,</li><li>  <span class="hljs-variable">keyword</span>: <span class="hljs-string">'enum'</span>,</li><li>  <span class="hljs-variable">params</span>: {</li><li>    <span class="hljs-variable">allowedValues</span>: [</li><li>      <span class="hljs-string">'priority'</span>,</li><li>      <span class="hljs-string">'name'</span>,</li><li>      <span class="hljs-string">'srcEntrance'</span>,</li><li>      <span class="hljs-string">'srcEntry'</span>,</li><li>      <span class="hljs-string">'launchType'</span>,</li><li>      <span class="hljs-string">'description'</span>,</li><li>      <span class="hljs-string">'icon'</span>,</li><li>      <span class="hljs-string">'label'</span>,</li><li>      <span class="hljs-string">'permissions'</span>,</li><li>      <span class="hljs-string">'metadata'</span>,</li><li>      <span class="hljs-string">'visible'</span>,</li><li>      <span class="hljs-string">'exported'</span>,</li><li>      <span class="hljs-string">'skills'</span>,</li><li>      <span class="hljs-string">'backgroundModes'</span>,</li><li>      <span class="hljs-string">'continuable'</span>,</li><li>      <span class="hljs-string">'startWindowIcon'</span>,</li><li>      <span class="hljs-string">'startWindowBackground'</span>,</li><li>      <span class="hljs-string">'removeMissionAfterTerminate'</span>,</li><li>      <span class="hljs-string">'orientation'</span>,</li><li>      <span class="hljs-string">'supportWindowMode'</span>,</li><li>      <span class="hljs-string">'maxWindowRatio'</span>,</li><li>      <span class="hljs-string">'minWindowRatio'</span>,</li><li>      <span class="hljs-string">'maxWindowWidth'</span>,</li><li>      <span class="hljs-string">'minWindowWidth'</span>,</li><li>      <span class="hljs-string">'maxWindowHeight'</span>,</li><li>      <span class="hljs-string">'minWindowHeight'</span>,</li><li>      <span class="hljs-string">'excludeFromMissions'</span></li><li>    ]</li><li>  },</li><li>  <span class="hljs-variable">message</span>: <span class="hljs-string">'must be equal to one of the allowed values'</span>,</li><li>  <span class="hljs-variable">location</span>: <span class="hljs-string">'D:/MyApplication/entry/src/main/module.json5:15:8'</span></li><li>} </li><li>{</li><li>  <span class="hljs-variable">instancePath</span>: <span class="hljs-string">'module.abilities[0]'</span>,</li><li>  <span class="hljs-variable">keyword</span>: <span class="hljs-string">'propertyNames'</span>,</li><li>  <span class="hljs-variable">params</span>: { <span class="hljs-variable">propertyName</span>: <span class="hljs-string">'nam'</span> },</li><li>  <span class="hljs-variable">message</span>: <span class="hljs-string">'property name must be valid'</span>,</li><li>  <span class="hljs-variable">location</span>: <span class="hljs-string">'D:/MyApplication/entry/src/main/module.json5:15:8'</span></li><li>} </li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p139710565181">以上述报错为例，说明报错中关键词的含义，便于开发者理解报错信息，完成问题定位及修改。</p> <ul id="ZH-CN_TOPIC_0000002510174481__ul1589753024919"><li id="li1732219203194">instancePath：错误所在的文件位置。'module.abilities[0]'表示在module.json5文件中的第一个abilities。</li><li id="li5897123084915">keyword：标识当前报错字段的可选配属性，当前报错中包括'required'、'oneOf'、'enum'、'propertyNames'。<ul id="ZH-CN_TOPIC_0000002510174481__ul5263174274920"><li id="li167701536174912">required：表示该字段为必选配置项。由于缺失或拼写错误导致该属性未配置。</li><li id="li1740715416513">oneOf：表示当前配置不符合oneOf要求。通过instancePath已经确认报错出现在abilities标签，在DevEco Studio中，按住Ctrl点击"abilities"跳转到对应的module.json文件，可以查看到必须配置以下两组中的一组。根据对比排查，可识别到因拼写错误导致"name"属性未配置。<p id="ZH-CN_TOPIC_0000002510174481__p549104413515"><span><img originheight="486" originwidth="346" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104911.34569509320634677965972633287219:50001231000000:2800:E941BE22F8C3F263C7DA111FB57AA823E9D0611A4DB339891185701E3A3CD65E.png" width="346" height="486"></span></p> </li><li id="li799774720491">enum：该标签内所有可配置的属性。开发者可根据枚举值确认属性的正确写法。</li><li id="li1696652085111">propertyNames：如果字段拼写错误将出现propertyNames，propertyName: 'nam'指明“nam”为错误属性。</li></ul> </li><li id="li178971930154919">params：不同keyword对应不同的详细说明，如keyword为'required'时，params的missingProperty: 'name' 表示缺失的属性为“name”。</li><li id="li1189763024911">message：修改要求的说明，如keyword为'required'时，message表示必须配置name属性。</li><li id="li14481843171918">location：错误的具体位置，点击可以跳转。</li></ul> <p id="ZH-CN_TOPIC_0000002510174481__p153601021192811"></p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 436px;"><h2 id="section1117715444103">编译报错“No available entry module found”<i class="anchor-icon anchor-icon-link" anchorid="section1117715444103" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p18177144101010"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p7177544181013">DevEco Studio编译时出现错误，提示“No available entry module found”错误信息。</p> <p id="ZH-CN_TOPIC_0000002510174481__p5177194420105"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p18862210140">feature模块中需要配置依赖的entry模块，DevEco Studio在编译时会校验feature模块所依赖的entry模块是否存在，出现该问题的原因可能为以下情况：</p> <ol id="ZH-CN_TOPIC_0000002510174481__ol1640082714114"><li id="li732615921317">在feature模块的build-profile.json5文件中，entryModules字段配置的名称与实际entry模块的名称不一致。请将entryModules字段的值修改为entry模块的名称；</li><li id="li4720943101412">在项目级build-profile.json5文件的modules字段中，feature模块位于entry模块之前。由于DevEco Studio在进行编译时会按照从前往后的顺序进行配置，当配置feature模块时，尚未读取和配置entry模块，则会报entry模块不存在的错误。请在modules字段中将feature模块置于所依赖的entry模块之后。</li></ol> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 1824px;"><h2 id="section165158289282">编译报错“keystore password was incorrect”<i class="anchor-icon anchor-icon-link" anchorid="section165158289282" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p1051512288280"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1451522818286">DevEco Studio编译时出现错误，提示“ERROR - hap-sign-tool: error: ACCESS_ERROR, code: 109. Details: Init keystore failed: keystore password was incorrect”错误信息。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1695512615378"><span><img originheight="111" originwidth="1067" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104911.56425996304661168853103675418270:50001231000000:2800:E6C96DBFB4DA214FE3F6C0C0215C5EA70F5E3F0694DA345AA98468C7AC6EAC1A.png" width="920" height="95.70759137769447"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p6679283479"><strong>报错原因</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p6197104815478">密钥库(p12)密码错误。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p id="ZH-CN_TOPIC_0000002510174481__p19174406312"><strong>密钥库密码</strong>和<strong>密钥密码</strong>是在创建p12文件时由开发者自行输入的，请牢记该密码。DevEco Studio工程的build-profile.json5文件中有记录密码的密文，但签名工具需要输入密码明文，不能直接将build-profile.json5中的值用到签名工具中。</p> </div></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p325162161615"><strong>常见场景</strong></p> <ol id="ZH-CN_TOPIC_0000002510174481__ol161074181615"><li id="li73382616166">密码输入错误。</li><li id="li26359851618">命令行中需要输入真实密码，误输入了加密后的密码。</li><li id="li12104421617">密钥(keyAlias)密码和密钥库(p12)密码记混。</li></ol> <p id="ZH-CN_TOPIC_0000002510174481__p20516102812816"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p3730143213379">出现该问题的原因是签名文件中签名密码错误。</p> <p id="ZH-CN_TOPIC_0000002510174481__p27305320374"><span><img originheight="309" originwidth="1074" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104911.98751411675134894252181689256880:50001231000000:2800:DEE5A15DFF5766D8E061FC2D844E8C8CE8CD68BE4A652D653D5709AE064420BD.png" width="920" height="264.6927374301676"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p187301832133717">开发者可通过重新自动签名解决该问题：</p> <p id="ZH-CN_TOPIC_0000002510174481__p973019325372">1. 点击<strong>File &gt; Project Structure &gt; Project &gt; Signing Configs</strong>，打开签名配置页面。</p> <p id="ZH-CN_TOPIC_0000002510174481__p5731183217372">2. 勾选“Automatically generate signing”（如果是HarmonyOS工程，需同时勾选“Support HarmonyOS”），等待重新签名，然后点击<strong>OK</strong>即可。</p> <p id="ZH-CN_TOPIC_0000002510174481__p13482102911615"><span><img originheight="589" originwidth="954" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104911.19234544232488862729964147849831:50001231000000:2800:8A49D3C1EB58BA8A6D55A6CF3231AA05DC30FD26BAC87703EC2BA541D0B09E85.png" width="920" height="568.0083857442348"></span></p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 1256px;"><h2 id="section2060994545011">编译报错“please check deviceType or distroFilter of the module”<i class="anchor-icon anchor-icon-link" anchorid="section2060994545011" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p360964516503"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p11372109181311">DevEco Studio编译时出现错误，出现如下提示之一：</p> <ul id="ZH-CN_TOPIC_0000002510174481__ul1474105191817"><li id="li1074751201816">Module: (xxx) and Module: (xxx) are entry, please check deviceType or distroFilter of the module.<p id="ZH-CN_TOPIC_0000002510174481__p882014520189"><span><img originheight="335" originwidth="1351" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104911.90037438385444738310769437212116:50001231000000:2800:1AE990E9FE91955DBBFE9C8D412A6CBC3F70720145C0EBB7DF99623D1BE2DA52.png" width="920" height="228.12731310140637"></span></p> </li><li id="li1274195116184">Module: (xxx) and Module: (xxx) have the same moduleName, please check deviceType or distroFilter of the module.<p id="ZH-CN_TOPIC_0000002510174481__p1121910547187"><span><img originheight="218" originwidth="1368" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104911.47932151233703637047129499916438:50001231000000:2800:80B302C26552BABE41CEE90017E9522AB0377A4EA2D63187A587446523B0AF83.png" width="920" height="146.60818713450294"></span></p> </li><li id="li87475113182">Module: (xxx) and Module: (xxx) have the same packageName, please check deviceType or distroFilter of the module.<p id="ZH-CN_TOPIC_0000002510174481__p1219125617184"><span><img originheight="307" originwidth="1411" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104911.11107978076368176887350872582205:50001231000000:2800:103F01B7723837E539FF6654B98F89CBD84C50C8C678E75F2E3157E9613F5CA7.png" width="920" height="200.17009213323885"></span></p> </li><li id="li674125110182">Module: (xxx) and Module: (xxx) have the same ability name.<p id="ZH-CN_TOPIC_0000002510174481__p148395816182"><span><img originheight="131" originwidth="1172" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104911.74174470681861075947852231066949:50001231000000:2800:8B401363666CCC3F31979E669EE13E1D315C46B59770C59652572D18BF2A57A4.png" width="920" height="102.83276450511946"></span></p> </li></ul> <p id="ZH-CN_TOPIC_0000002510174481__p5609194545011"></p> <p id="ZH-CN_TOPIC_0000002510174481__p146098456508"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1660984525014">出现该问题的原因是打包时工程未满足HAP唯一性校验逻辑，请根据<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-verification-rule">HAP唯一性校验逻辑</a>修改工程，满足校验逻辑即可正常打包。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 728px;"><h2 id="section9924162013592">编译报错“Failed to generate test project build system”<i class="anchor-icon anchor-icon-link" anchorid="section9924162013592" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p11169122595912"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p136181518105">执行多模块native模块构建时，提示“Failed to generate test project build system.”错误信息。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1616972518597"><span><img originheight="506" originwidth="1535" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104911.29616475661881725627557809551740:50001231000000:2800:B08A029FD7928F3357A0280508F144C849915DA684D68F9F21E9C61EF5D8BFFF.png" width="920" height="303.27035830618894"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p1816992575915"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p617010250590">请删除报错模块下的.cxx文件夹，然后选中需要构建的模块，执行<strong>Make Module</strong><strong> ${moduleName}</strong>完成单独构建，避免同时构建多个模块。</p> <p id="ZH-CN_TOPIC_0000002510174481__p674718480616"><span><img originheight="93" originwidth="378" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104911.25370188154268817174521183386424:50001231000000:2800:B8FFF616D567D27570553C5E74281CEF3644BDCB7A268C8399F98700B4FE2F5E.png" width="378" height="93"></span></p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 541px;"><h2 id="section1183184334014">C/C++项目三方依赖库未打包入HAP<i class="anchor-icon anchor-icon-link" anchorid="section1183184334014" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p161336132417"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1713317139411">C/C++项目依赖三方so时，在打包生成HAP后，发现三方so未打包到HAP中。</p> <p id="ZH-CN_TOPIC_0000002510174481__p8133151324120"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p877091017494">当前DevEco Studio对C/C++项目三方so的寻址方式有限，如出现三方so未打包到HAP中，请尝试修改so引入方式。</p> <ol id="ZH-CN_TOPIC_0000002510174481__ol147825407540"><li id="li14782194035413"><span>定义一个别名（如jsbind_shared_lib_tracing），代表将要引入的三方so。</span></li><li id="li9782840145414"><span>使用SHARED IMPORT将三方so定义为动态引入。</span></li><li id="li15782240145417"><span>使用IMPORTED_LOCATION定义引入so的具体位置。</span></li><li id="li15485152616561"><span>将定义的三方so声明给目标。</span><p></p><p id="ZH-CN_TOPIC_0000002510174481__p1525712911569"><span><img originheight="82" originwidth="1486" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104911.61935339923394300113566803211008:50001231000000:2800:AEC16D51615E2B096DA870863954E2F0B1C9FB0A4F06FE24D15CF198BB97B1E0.png" width="920" height="50.767160161507405"></span></p> <p></p></li><li id="li1737217333583"><span>再次打包生成HAP，确认三方so是否打包到HAP中。</span></li></ol> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 1639px;"><h2 id="section154704225916">Static Library模块中src/main/cpp目录下的文件未打包进HAR<i class="anchor-icon anchor-icon-link" anchorid="section154704225916" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p671024634617"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p177884484719">点击<strong>Build &gt; Make Module ${libraryName}</strong>编译构建生成HAR后，发现构建产物中未出现cpp目录下的文件。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1570416274488"><span><img originheight="808" originwidth="1010" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104911.15876253223347615651929383794187:50001231000000:2800:32A79AC4982AC2B73C1EFE38AB8954CC2508F50AA5E5D484215A395B1E003D71.png" width="920" height="736"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p020213163539"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p15793124118306">如果使用的Hvigor为2.5.0-s及以上版本，在编译构建HAR的过程中，只会将dependencies内处于本模块路径下的本地依赖也打包进.har文件中，devDependencies里的依赖不会打包进.har文件中。</p> <p id="ZH-CN_TOPIC_0000002510174481__p5447114811555">请将相应的本地依赖移至dependencies中后重新编译。</p> <p id="ZH-CN_TOPIC_0000002510174481__p959248165718"><span><img originheight="567" originwidth="998" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104911.21989472075359322437128211041522:50001231000000:2800:51897C6BF8EF40099A74AF967FEADC96DA16E49453D247F8D18BA90F63EF38F7.png" width="920" height="522.685370741483"></span></p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 629px;"><h2 id="section1615516278442">工程编译告警提示“ArkTS:WARN: For details about ArkTS syntax errors”<i class="anchor-icon anchor-icon-link" anchorid="section1615516278442" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__zh-cn_topic_0000001233028585_zh-cn_topic_0000001166752005_p1142721234719"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__zh-cn_topic_0000001233028585_zh-cn_topic_0000001166752005_p432681820">工程构建时，提示“ArkTS:WARN: For details about ArkTS syntax errors, see FAQs”。</p> <p id="ZH-CN_TOPIC_0000002510174481__zh-cn_topic_0000001233028585_zh-cn_topic_0000001166752005_p2321081084"><span><img originheight="323" originwidth="1000" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104911.71274643462102862918187147917893:50001231000000:2800:8A6322828FC2EA5FCBB172D4DDCEB3A101B57C24BBC6520E56096F9D25AFAE0E.png" width="920" height="297.16"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__zh-cn_topic_0000001233028585_zh-cn_topic_0000001166752005_p127301625184714"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__zh-cn_topic_0000001233028585_p320341144815">出现该告警说明当前工程存在不符合ArkTS语法规范的写法，请根据ERROR报错中括号内的语法规则如(arkts-no-var)，查看<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/typescript-to-arkts-migration-guide#使用let而非var" target="_blank">从TypeScript到ArkTS的适配规则</a>中对应的说明，修改为ArkTS规范写法。</p> <p id="ZH-CN_TOPIC_0000002510174481__p917612179101"></p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 1073px;"><h2 id="section1638214184549">编译报错“ninja: error: mkdir(xxx): No such file or directory”<i class="anchor-icon anchor-icon-link" anchorid="section1638214184549" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p91622425519"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p690653255614">Native工程编译报错，同时出现以下告警和报错信息。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1216214413555">出现工程目录长度超过250字符的告警，示例如下：</p> <p id="ZH-CN_TOPIC_0000002510174481__p62381734567"><span><img height="86.7825" originheight="272" originwidth="1634" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104911.94864857897359675115709855404089:50001231000000:2800:F5E4D5D44422267662C9482141F7359A5C8FCAEE11AD752695749D5D3A754910.png" title="点击放大" width="523.6875"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p141629405513">出现编译报错“ninja: error: mkdir(xxx): No such file or directory”，示例如下：</p> <p id="ZH-CN_TOPIC_0000002510174481__p124101213115611"><span><img height="35.910000000000004" originheight="125" originwidth="1809" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104912.39560410757305105153441258667127:50001231000000:2800:C2CB7264C50D31AF8C166C7665A990AEA1BDF51F4D731DA78AE6C0FB7D497DE5.png" title="点击放大" width="523.6875"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p116210425511"></p> <p id="ZH-CN_TOPIC_0000002510174481__p12162174125518"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p12230469583">CMAKE_OBJECT_PATH_MAX默认大小为250，如果工程中object file实际路径长度超出该大小，将导致编译报错。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1816210485515">开发者需要根据object file实际路径长度在工程CMakeLists.txt中设置CMAKE_OBJECT_PATH_MAX大小，具体方法如下：</p> <ul id="ZH-CN_TOPIC_0000002510174481__ul42571148605"><li id="li11257948705">方法一： 通常在CMAKE_OBJECT_PATH_MAX默认值基础上增加一个文件名长度即可。<p id="ZH-CN_TOPIC_0000002510174481__p142171350207">示例中告警文件为TextMeasureCache.cpp.obj，长度为24字符，在默认值250的基础上增加24，即设置set(CMAKE_OBJECT_PATH_MAX 274)</p> </li><li id="li172571948804">方法二：根据object file实际路径长度计算CMAKE_OBJECT_PATH_MAX大小。<p id="ZH-CN_TOPIC_0000002510174481__p141267280115">计算公式：CMAKE_OBJECT_PATH_MAX = 总路径长度 - object file中目录部分长度 + cmake哈希值字符数（固定为32）</p> <ul id="ZH-CN_TOPIC_0000002510174481__ul022182220318"><li id="li1550212201838">总路径长度 = object file directory长度 + object file长度，object file directory、object file如下图所示，两个长度之和为297字符，以实际为准<p id="ZH-CN_TOPIC_0000002510174481__p446015431132"><span><img height="89.775" originheight="282" originwidth="1645" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104912.76456295326863579928909799089395:50001231000000:2800:7EC8CC7A067C4C55650D5AB39C600C89801B0C8C6BD76FCE1AD3E5163AF2CF46.png" title="点击放大" width="523.6875"></span></p> </li><li id="li14523520637">object file中目录部分长度：示例中“__/__/__/__/__/third-party/rn/ReactCommon/react/renderer/textlayoutmanager”长度为74字符，以实际为准</li><li id="li86414321645">cmake哈希值字符数：cmake将长路径转换为哈希值时哈希值的长度，固定为32</li></ul> <p id="ZH-CN_TOPIC_0000002510174481__p20437134642">代入示例中的长度后，计算可得：CMAKE_OBJECT_PATH_MAX = 297 - 74 + 32 = 255，即设置set(CMAKE_OBJECT_PATH_MAX 255)</p> <p id="ZH-CN_TOPIC_0000002510174481__p13524671952"></p> </li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 1231px;"><h2 id="section1987517223515">编译报错“(is the command line too long?)”<i class="anchor-icon anchor-icon-link" anchorid="section1987517223515" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p464918450515"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1065018451952">Native工程编译报错，同时出现以下告警和报错信息。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1765016451856">出现工程目录长度超过250字符的告警，示例如下：</p> <p id="ZH-CN_TOPIC_0000002510174481__p196507451450"><span><img height="86.7825" originheight="272" originwidth="1634" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104912.53025585548887158135069164481795:50001231000000:2800:CFDBC41267236923839A6FF6335A98D27C6124F86282BF2324DDE88D19A8C0FF.png" title="点击放大" width="523.6875"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p15650445856">出现编译报错“(is the command line too long?)”，示例如下：</p> <p id="ZH-CN_TOPIC_0000002510174481__p32677810615"><span><img originheight="122" originwidth="489" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104912.51558031392160034270954990392868:50001231000000:2800:A8C3C43F866DE41442B0559C5E4692A79B716A68D4586A7EF8948473F15A6DD2.png" width="489" height="122"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p638771713617"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p143879171668">CMAKE_OBJECT_PATH_MAX默认大小为250，如果工程中object file实际路径长度超出该大小，将导致编译报错。</p> <p id="ZH-CN_TOPIC_0000002510174481__p183873170614">开发者需要根据object file实际路径长度在工程CMakeLists.txt中设置CMAKE_OBJECT_PATH_MAX大小，具体方法如下：</p> <ul id="ZH-CN_TOPIC_0000002510174481__ul738713174610"><li id="li9388617464">方法一： 通常在CMAKE_OBJECT_PATH_MAX默认值基础上增加一个文件名长度即可。<p id="ZH-CN_TOPIC_0000002510174481__p143888175616">示例中告警文件为TextMeasureCache.cpp.obj，长度为24字符，在默认值250的基础上增加24，即设置set(CMAKE_OBJECT_PATH_MAX 274)</p> </li><li id="li43881717069">方法二：根据object file实际路径长度计算CMAKE_OBJECT_PATH_MAX大小。<p id="ZH-CN_TOPIC_0000002510174481__p1238811171864">计算公式：CMAKE_OBJECT_PATH_MAX = 总路径长度 - object file中目录部分长度 + cmake哈希值字符数（固定为32）</p> <ul id="ZH-CN_TOPIC_0000002510174481__ul18388141715614"><li id="li63882017965">总路径长度 = object file directory长度 + object file长度，object file directory、object file如下图所示，两个长度之和为297字符，以实际为准<p id="ZH-CN_TOPIC_0000002510174481__p1738810171968"><span><img height="89.775" originheight="282" originwidth="1645" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104912.04767501770134348101283746364671:50001231000000:2800:08538EE53CE7DE82EFEABDC07778F65ECA3E590A0B2AB03A6A76439885582A88.png" title="点击放大" width="523.6875"></span></p> </li><li id="li203880171969">object file中目录部分长度：示例中“__/__/__/__/__/third-party/rn/ReactCommon/react/renderer/textlayoutmanager”长度为74字符，以实际为准</li><li id="li138813171616">cmake哈希值字符数：cmake将长路径转换为哈希值时哈希值的长度，固定为32</li></ul> <p id="ZH-CN_TOPIC_0000002510174481__p19388171712614">代入示例中的长度后，计算可得：CMAKE_OBJECT_PATH_MAX = 297 - 74 + 32 = 255，即设置set(CMAKE_OBJECT_PATH_MAX 255)</p> </li><li id="li102886253389">方法三：若设置CMAKE_OBJECT_PATH_MAX后，仍然报相同错误，需要修改工程存放目录，将其存放在较短的目录下。<p id="ZH-CN_TOPIC_0000002510174481__p283761844613">设置CMAKE_OBJECT_PATH_MAX后，cmake会将长路径转换为32字符的哈希值以缩短路径长度，如果转换后的路径依然过长，只能缩短工程的存放路径。</p> </li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 560px;"><h2 id="section9406125414615">编译报错“CMake Error: The following variables are used in this project, but they are set to NOTFOUND”<i class="anchor-icon anchor-icon-link" anchorid="section9406125414615" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p84621971571"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1946217711713">Native工程中使用find_path时出现以下报错信息。</p> <p id="ZH-CN_TOPIC_0000002510174481__p499362099"><span><img height="39.900000000000006" originheight="68" originwidth="886" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104912.83903652043809393377816613715843:50001231000000:2800:61D2EA12D069CD01D9174AEDFDAF20F524117309F3506A92C0D6455F65D04590.png" title="点击放大" width="523.6875"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p28023391893"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p194512614208">OpenHarmony SDK提供的CMake交叉编译配置文件（ohos.toolchain.cmake）中，限制了搜索路径为CMAKE_SYSROOT。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1446612339352">如果开发者需要添加搜索路径，可在CMakeLists.txt中使用list接口添加自定义路径，如将"D:demo"添加至搜索路径：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-objectivec" id="ZH-CN_TOPIC_0000002510174481__screen1358325368" data-highlighted="yes"><ol class="linenums"><li>list(APPEND <span class="hljs-built_in">CMAKE_FIND_ROOT_PATH_MODE_INCLUDE</span> <span class="hljs-string">"D:demo"</span>)</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p1084717202125">添加后，即可使用find_path查找"D:demo"目录下的文件。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 3238px;"><h2 id="section111751131205212">编译报错 “Unknown resource name”<i class="anchor-icon anchor-icon-link" anchorid="section111751131205212" tips="复制节点链接"></i></h2><ul id="ZH-CN_TOPIC_0000002510174481__ul8212195516545"><li id="li321214555541">场景一</li></ul> <p id="ZH-CN_TOPIC_0000002510174481__p1052713521525"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p179895935315">工程中模块A引用了模块B，编译模块A时出现错误，提示 "Unknown resource name 'xxxx'"，找不到模块B的资源。</p> <p id="ZH-CN_TOPIC_0000002510174481__p2019519465414"><span><img height="264.33750000000003" originheight="653" originwidth="1289" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104912.25937662330174818388162493372510:50001231000000:2800:6AF9742F805763CAC162A6FC78781561D63549A450B45AA55F9868DD014502C7.png" title="点击放大" width="523.6875"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p106102015105412"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p45654178445">请确保符合以下条件：</p> <ol id="ZH-CN_TOPIC_0000002510174481__ol41422052165315"><li id="li141421521532">资源需放置在目录resource/base路径下。</li><li id="li1454695435317">模块B已安装。</li><li id="li43302465419">模块A中不能使用相对路径引用模块B的资源，应直接通过定义的模块名称来引用。</li></ol> <ul id="ZH-CN_TOPIC_0000002510174481__ul109794912555"><li id="li19792945519">场景二</li></ul> <p id="ZH-CN_TOPIC_0000002510174481__p139214150551"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p971252916551">引用模块的方式不对，如果引用的是一个其他模块的代码，也会报资源找不到。</p> <p id="ZH-CN_TOPIC_0000002510174481__p8610529331"><span><img originheight="780" originwidth="983" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104912.48178270620041616101930153509301:50001231000000:2800:E2973E314BEEA74AEF922508ED359CFB6B869D124A436B389FBEC153C45BF778.png" width="920" height="730.0101729399797"></span><span><img originheight="786" originwidth="963" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104912.23548568604862362929864353330612:50001231000000:2800:AD1BACAF2994258C7977208A905ED958142295AA15D494D1687634CC446CA31D.png" width="920" height="750.9034267912773"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p5903185065519"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p19858163755613">在oh_package.json5中引入该模块。通过定义的模块名称来引用。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1983128145713">如下图所示：</p> <p id="ZH-CN_TOPIC_0000002510174481__p10975111375713"><span><img originheight="871" originwidth="1742" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104912.24326326236214764494819739720297:50001231000000:2800:A4AC2E7AB72BA84196443CF5C296BADC590DF23429B47EF298FF7BFE88004DC5.png" width="920" height="459.99999999999994"></span></p> <ul id="ZH-CN_TOPIC_0000002510174481__ul11687124185712"><li id="li66871641185716">场景三</li></ul> <p id="ZH-CN_TOPIC_0000002510174481__p18687141145720"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p775317165812">HSP A 申请了某个权限，这个权限进行了资源的引用，在所有依赖A的组件进行构建时，报错 A 引用的资源找不到。</p> <p id="ZH-CN_TOPIC_0000002510174481__p6649036145917"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1560333775915">手动在引用方配置对应资源可以解决此问题。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 560px;"><h2 id="section1059835017401">构建报错“ERROR: Task xxx was not found in the project xxx”<i class="anchor-icon anchor-icon-link" anchorid="section1059835017401" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p1022163519429"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p49226391421">命令行手动执行构建命令时，构建失败，提示“ERROR: Task xxx was not found in the project xxx”</p> <p id="ZH-CN_TOPIC_0000002510174481__p13520171917445"><span><img originheight="185" originwidth="1464" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104912.59303461737418286170841649756103:50001231000000:2800:2018237F14CFFCAD345B8DD43D43BB20D2F691CA296A0A0053E9FDF4B9D32977.png" width="920" height="116.2568306010929"></span><strong>问题确认</strong></p> <ol id="ZH-CN_TOPIC_0000002510174481__ol1011510618536"><li id="li181159615312">执行hvigorw tasks命令，查看对应命令是否存在。</li><li id="li17170161065320">查看对应工程中module.json5文件中“type”字段是否为命令执行模块。比如图中执行assembleHar命令，是对工程中的har模块进行打包，若module.json5文件中的“type”字段不是"har"类型，则会出现上述错误提示。</li></ol> <p id="ZH-CN_TOPIC_0000002510174481__p13900104344419"><strong>解决措施</strong></p> <ol id="ZH-CN_TOPIC_0000002510174481__ol173831036537"><li id="li73836315311">执行正确命令。</li><li id="li195560239537">查看对应工程中module.json5文件中“type”字段类型，执行对应命令。</li></ol> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 894px;"><h2 id="section11576710153611">编译报错“The reason and usedScene attributes are mandatory for user_grant permissions”<i class="anchor-icon anchor-icon-link" anchorid="section11576710153611" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p491792563610"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p0261173019362">DevEco Studio编译失败，提示“The reason and usedScene attributes are mandatory for user_grant permissions”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p5261154613432"><span><img height="61.845000000000006" originheight="91" originwidth="765" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104912.33161481466645858077626183728441:50001231000000:2800:67E8C0808CA84492D1F851A379B664C4A41104D3DEECAB2B107BA3632996FB71.png" title="点击放大" width="523.6875"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p164794275386"><strong>问题原因</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p126081473915">从DevEco Studio NEXT Developer Preview2版本开始新增规则：APP包中，所有entry和feature hap的module下的requestPermissions权限清单必须指定(可以缺省为空，若非空则name必填,user_grant权限则必填reason、usedScene字段)。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1412131312412"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p17511105144211">进入对应module.json5文件中，补齐requestPermissions字段下的reason和usedScene字段。如以下示例：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen13924320164513" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-string">"requestPermissions"</span>: [</li><li>  {</li><li>    <span class="hljs-string">"name"</span>: <span class="hljs-string">"ohos.permission.READ_IMAGEVIDEO"</span>,</li><li>    <span class="hljs-string">"reason"</span>: <span class="hljs-string">"$string:module_desc"</span>,</li><li>    <span class="hljs-string">"usedScene"</span>: {</li><li>      <span class="hljs-string">"abilities"</span>: [</li><li>        <span class="hljs-string">"EntryAbility"</span></li><li>      ],</li><li>      <span class="hljs-string">"when"</span>: <span class="hljs-string">"inuse"</span></li><li>    }</li><li>  }</li><li>]</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p1822111198458"></p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 483px;"><h2 id="section20779140205212">编译报错“Only one default card can be configured in the form_config.json file”<i class="anchor-icon anchor-icon-link" anchorid="section20779140205212" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p1159142610521"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1159112619529">DevEco Studio编译失败，提示“Only one default card can be configured in the form_config.json file”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1670951710561"><span><img height="54.862500000000004" originheight="92" originwidth="875" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104912.85221375278544932552768002135078:50001231000000:2800:CC5B68AE8ABBF97A9469F1A344A355A25AA5939A1179FA9912814CBD3F318398.png" title="点击放大" width="523.6875"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p109471439205219"><strong>问题原因</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p12947173955219">从DevEco Studio NEXT Developer Preview2版本开始新增规则：卡片的配置文件中isDefault不可缺省，每个UIAbility有且只有一个默认卡片。</p> <p id="ZH-CN_TOPIC_0000002510174481__p11947639125217"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p115017395317">进入对应module.json5文件中，选择唯一默认卡片，将其他卡片的isDefault字段设置为false。</p> <p id="ZH-CN_TOPIC_0000002510174481__p158443524576"></p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 551px;"><h2 id="section7492155413573">编译报错“In the form_config.json file, if the value of the updateEnabled field is true, the updateDuration and scheduleUpdateTime fields cannot be both empty”<i class="anchor-icon anchor-icon-link" anchorid="section7492155413573" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p1962553485818"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p962693416587">DevEco Studio编译失败，提示“In the form_config.json file, if the value of the updateEnabled field is true, the updateDuration and scheduleUpdateTime fields cannot be both empty.”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p17420218596"><span><img height="33.915" originheight="89" originwidth="1340" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104912.58844636363681054879249168808343:50001231000000:2800:90B171E876B4D24BB14519A7E646D1DFBA89E6752D10D2A55A3590AE152B7B5D.png" title="点击放大" width="523.6875"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p96267342589"><strong>问题原因</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p146261234175816">从DevEco Studio NEXT Developer Preview2版本开始新增规则：卡片的配置文件中updateEnabled不可缺省，为true时可以在定时刷新（updateDuration）和定点刷新（scheduledUpdateTime）两种方式任选其一，当两者同时配置时，定时刷新优先生效。</p> <p id="ZH-CN_TOPIC_0000002510174481__p166260346587"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p2626634165810">进入对应module.json5文件中，按照需求，选择配置updateEnabled为false，或者增加定时刷新（updateDuration）和定点刷新（scheduledUpdateTime）两种方式配置。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 449px;"><h2 id="section181041852164410">编译报错“The path XX is not writable. please choose a new location”<i class="anchor-icon anchor-icon-link" anchorid="section181041852164410" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p181055520440"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p19105165217445">在mac上，通过直接打开dmg中的DevEco Studio，构建报错 The path XX is not writable. please choose a new location.”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1269155713471"><span><img originheight="74" originwidth="986" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104912.27573107318144068430572337056101:50001231000000:2800:FCAAD7153D680E394BD51B7721E7B416D2F81E0045B89AC7D582349BE6D9E505.png" width="920" height="69.04665314401623"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p11105552154412"><strong>问题原因</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p010515219448">在mac上直接打开dmg 中的DevEco Studio，是会以只读的方式打开的，内置到DevEco Studio里面的文件是没有写权限的。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1110517522443"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p9139102225110">将“DevEco-Studio.app”拖拽到“Applications”中，先安装再使用。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 491px;"><h2 id="section121971472239">编译报错“Property 'XX' does not exist on type 'typeof BuildProfile'”<i class="anchor-icon anchor-icon-link" anchorid="section121971472239" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p51978476236"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p8197847142319">本地HSP模块对外提供的接口中使用了HAP未定义的自定义参数BuildProfileFileds，且HAP引用了HSP中的该接口，导致编译失败，提示“Property 'XX' does not exist on type 'typeof BuildProfile'”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p111971947132319"><span><img originheight="79" originwidth="759" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104912.66892846270668503541268346290985:50001231000000:2800:95B94447E07C0B3F7B59B02BC32892EB326EC4809CC53EB7646D3C3E5314566B.png" width="759" height="79"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p6198154713239"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p18589152893515">可采用以下两种方式解决该问题：</p> <ul id="ZH-CN_TOPIC_0000002510174481__ul545919393335"><li id="li1845973903315">在HAP中配置与HSP相同的自定义参数BuildProfileFileds。</li><li id="li12511134619347">将与HSP相同的自定义参数BuildProfileFields配置到工程级build-profile.json5中，该方法会使HSP中的自定义参数在全局生效。</li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 1157px;"><h2 id="section1585241711814">编译报错“The useNormalizedOHMUrl settings of packages xxx and the project useNormalizedOHMUrl: xxx do not match”<i class="anchor-icon anchor-icon-link" anchorid="section1585241711814" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p158523172816"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p138521017884">编译报错“The useNormalizedOHMUrl settings of packages xxx and the project useNormalizedOHMUrl: xxx do not match”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p585210171580"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p193731833174914"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-build-profile-app#section13181758123312">useNormalizedOHMUrl</a> 为true的时候ohmurl使用的是新的拼接和解析方式，不能和旧的ohmurl混用，会导致运行时无法识别。</p> <p id="ZH-CN_TOPIC_0000002510174481__p19852161717815">可采用以下两种方式解决该问题：</p> <ul id="ZH-CN_TOPIC_0000002510174481__ul585215170810"><li id="li73955351458">将报错的依赖包的工程级build-profile.json5中的useNormalizedOHMUrl修改为与当前工程一致，重新生成依赖包并替换（useNormalizedOHMUrl缺省默认值为false）。<div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen147181675315" data-highlighted="yes"><ol class="linenums"><li>{</li><li>  <span class=""><span class="hljs-string">"app"</span></span>: {</li><li>    <span class="hljs-string">"products"</span>: [</li><li>      {</li><li>         <span class="hljs-string">"buildOption"</span>: {</li><li>           <span class="hljs-string">"strictMode"</span>: {</li><li>             <span class="hljs-string">"useNormalizedOHMUrl"</span>: <span class="hljs-keyword">true</span></li><li>           }</li><li>         }</li><li>      }</li><li>    ]</li><li>  }</li><li>}</li></ol></pre></div></div> </li><li id="li885213171385">如果与工程不一致的依赖包较多，建议修改工程的工程级build-profile.json5中的useNormalizedOHMUrl值以及替换其它的不一致的依赖包。</li></ul> <p id="ZH-CN_TOPIC_0000002510174481__p8299657101518">如果修改了useNormalizedOHMUrl仍无法解决，表明当前hsp包是本地包，需要以本地hsp包的形式引入，请在工程下的build-profile.json5中的modules中添加报错hsp模块，示例如下：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen319519157195" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-string">"modules"</span>: [</li><li>  {</li><li>    <span class="hljs-variable">name</span>: <span class="hljs-string">"hsp"</span>,   <span class="hljs-comment">// 引用的hsp包依赖</span></li><li>    <span class="hljs-variable">srcPath</span>: <span class="hljs-string">"../MyApplication_stageB/hsp"</span>,   <span class="hljs-comment">// 引用的hsp包的路径（绝对和相对都可以）</span></li><li>  }</li><li>]</li></ol></pre></div></div> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 797px;"><h2 id="section16585162814254">如何配置oh-package.json5动态依赖<i class="anchor-icon anchor-icon-link" anchorid="section16585162814254" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p16295151122616">oh-package.json5文件中：</p> <ul id="ZH-CN_TOPIC_0000002510174481__ul131476442618"><li id="li5320715192715">dependencies（生产依赖）：声明需要在代码中import的三方库（参与编译/运行阶段使用的依赖）。</li><li id="li3815515182616">devDependencies（开发依赖）：参与项目的开发或测试阶段。</li><li id="li9147741268">dynamicDependencies（动态依赖）：动态依赖的HSP模块。在开发者需要动态加载HSP的时候配置使用。</li></ul> <p id="ZH-CN_TOPIC_0000002510174481__p1432142512282">示例如下，详细内容可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-oh-package-json5" target="_blank">oh-package.json5文件</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-dependencies">添加依赖项</a>。</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen1166518813290" data-highlighted="yes"><ol class="linenums"><li>{</li><li>  <span class="hljs-string">"name"</span>: <span class="hljs-string">"parameter-test"</span>,</li><li>  <span class="hljs-string">"version"</span>: <span class="hljs-string">"@param:version"</span>, </li><li>  <span class="hljs-string">"description"</span>: <span class="hljs-string">"test desc."</span>,</li><li>  <span class="hljs-string">"main"</span>: <span class="hljs-string">"index.ets"</span>,</li><li>  <span class="hljs-string">"author"</span>: <span class="hljs-string">"test author"</span>,</li><li>  <span class="hljs-string">"license"</span>: <span class="hljs-string">"ISC"</span>,</li><li>  <span class="hljs-string">"dependencies"</span>: {</li><li>    <span class="hljs-string">"libtest1"</span>: <span class="hljs-string">"@param:dependencies.libtest1"</span></li><li>  },</li><li>  <span class="hljs-string">"devDependencies"</span>: {</li><li>    <span class="hljs-string">"libtest2"</span>: <span class="hljs-string">"@param:devDependencies.libtest2"</span></li><li>  },</li><li>  <span class="hljs-string">"dynamicDependencies"</span>: {</li><li>    <span class="hljs-string">"libtest3"</span>: <span class="hljs-string">"@param:dynamicDependencies.libtest3"</span></li><li>  },</li><li>  <span class="hljs-string">"parameterFile"</span>: <span class="hljs-string">'.parameterFile/parameterFile.json5'</span> <span class="hljs-comment">// 开启参数化并指定参数化配置文件路径</span></li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 380px;"><h2 id="section134601461081">如何解决SDK与镜像不匹配导致abc文件无法正常运行的问题  <i class="anchor-icon anchor-icon-link" anchorid="section134601461081" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p11281929789"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p18447184441318">当SDK版本与镜像版本不匹配时，应用将会闪退，出现jscrash，同时hilog出现日志。</p> <p id="ZH-CN_TOPIC_0000002510174481__p68983951412"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p9982125413149">现象根本原因是SDK工具与镜像版本不匹配。推荐使用匹配的SDK与镜像版本。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1195841161614">查看SDK版本方法：</p> <p id="ZH-CN_TOPIC_0000002510174481__p93855547164">在DevEco Studio安装路径下的sdk路径中，执行 {sdk.dir}/openharmony/ets/build-tools/ets-loader/bin/ark/build-win/bin/es2abc.exe --bc-version可查看SDK版本号。用于检验SDK与镜像版本是否匹配。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 380px;"><h2 id="section212173413234">如何解决编译报错“Could not resolve 'xxx' from”，但'xxx'目录存在的问题 <i class="anchor-icon anchor-icon-link" anchorid="section212173413234" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p1213462133015"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p196484018313">编译报错：“Could not resolve 'xxx' from”，但'xxx'目录存在，目录下存在Index文件。</p> <p id="ZH-CN_TOPIC_0000002510174481__p19541210343"><strong>问题原因</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p161222025133418">在引用目录时，编译时自动拼接小写的index文件，而目录中是大写的Index文件，在编译大小写敏感时，找不到index文件，则报错。</p> <p id="ZH-CN_TOPIC_0000002510174481__p13805124512300"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1518172913334">在引用'xxx'目录时，明确写明引用到'xxx/Index'文件。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 512px;"><h2 id="section3124123011112">用户目录下没有npmrc文件<i class="anchor-icon anchor-icon-link" anchorid="section3124123011112" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p16124830171118"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1612419303110">新建项目报错 Error: The hvigor depends on the npmrc file. Configure the npmrc file first。</p> <p id="ZH-CN_TOPIC_0000002510174481__p812453011114"><strong>问题原因</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p812423014117">在用户目录下没有 .npmrc 文件。</p> <p id="ZH-CN_TOPIC_0000002510174481__p151241230151116"><strong>解决措施</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p144266342329">在用户目录下创建.npmrc文件，配置如下信息：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-ruby" id="ZH-CN_TOPIC_0000002510174481__screen139252268336" data-highlighted="yes"><ol class="linenums"><li>registry=<span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/repo.huaweicloud.com/repository</span><span class="hljs-regexp">/npm/</span></li><li><span class="hljs-variable">@ohos</span><span class="hljs-symbol">:registry=https</span><span class="hljs-symbol">://repo</span>.harmonyos.com/npm/</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p91241630181120"></p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 712px;"><h2 id="section8932191163513">如何解决编译报错“ Error: 'icon' value `$media:icons` invalid value.”的问题<i class="anchor-icon anchor-icon-link" anchorid="section8932191163513" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p948295516377"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p194794326393">编译报错“ Error: 'icon' value `$media:icons` invalid value”。</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen1731917128395" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">ERROR</span>: <span class="hljs-title class_">Failed</span> :<span class="hljs-title class_">entry</span>:<span class="hljs-title class_">default</span>@<span class="hljs-title class_">CompileResource</span>...</li><li><span class="hljs-variable">ERROR</span>: <span class="hljs-title class_">Tools</span> <span class="hljs-title class_">execution</span> <span class="hljs-title class_">failed</span>.</li><li><span class="hljs-variable">Error</span>: <span class="hljs-title class_">ref</span> `$<span class="hljs-title class_">media</span>:<span class="hljs-title class_">icons</span>` <span class="hljs-title class_">don</span>`<span class="hljs-title class_">t</span> <span class="hljs-title class_">be</span> <span class="hljs-title class_">defined</span>.</li><li><span class="hljs-variable">Error</span>: <span class="hljs-string">'icon'</span> <span class="hljs-title class_">value</span> `$<span class="hljs-title class_">media</span>:<span class="hljs-title class_">icons</span>` <span class="hljs-title class_">invalid</span> <span class="hljs-title class_">value</span>.</li><li><span class="hljs-variable">at</span> <span class="hljs-variable">D</span>:\<span class="hljs-title class_">project</span>\<span class="hljs-title class_">process_profile</span>\<span class="hljs-title class_">default</span>\<span class="hljs-title class_">module</span>.<span class="hljs-title class_">json</span></li><li><span class="hljs-variable">Detail</span>: <span class="hljs-title class_">Please</span> <span class="hljs-title class_">check</span> <span class="hljs-title class_">the</span> <span class="hljs-title class_">message</span> <span class="hljs-keyword">from</span> <span class="hljs-title class_">tools</span>.</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p675905943612"><strong>报错原因</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1375935963610">引用的资源不存在时，编译报错指向的文件路径是build目录。</p> <p id="ZH-CN_TOPIC_0000002510174481__p415524665817"><strong>常见场景</strong></p> <ol id="ZH-CN_TOPIC_0000002510174481__ol474654735812"><li id="li1520685185818">资源文件未添加。</li><li id="li474610471582">资源文件被意外删除。</li></ol> <p id="ZH-CN_TOPIC_0000002510174481__p10760459193618"><strong>解决方案</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p12760259103615">根据报错的资源id全局搜索，查看报错的资源是否存在。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 649px;"><h2 id="section5410192524610">如何解决编译报错“Error: cJSON_Parse failed, please check the JSON file.”的问题<i class="anchor-icon anchor-icon-link" anchorid="section5410192524610" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p164111825194611"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p44759560407">编译报错“Error: cJSON_Parse failed, please check the JSON file”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p187151553185514"><span><img height="124.6875" originheight="139" originwidth="581" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104912.81846174185871692301211490407192:50001231000000:2800:43463C8E8B531C8FB47EBAA3F77BF86EC10AA41ED3D2E518E2382D5826238ACE.png" title="点击放大" width="523.6875"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p1441102534617"><strong>报错原因</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p4411125154616">module.json文件格式不正确。</p> <p id="ZH-CN_TOPIC_0000002510174481__p2411192517465"><strong>常见场景</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1341172517466">1. json文件内末尾多了逗号。</p> <p id="ZH-CN_TOPIC_0000002510174481__p19411182534616">2. 根标签不是大括号{}。</p> <p id="ZH-CN_TOPIC_0000002510174481__p5411525134613"><strong>解决方案</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1741132516469">检查报错指向的json文件格式，比如是否末尾多了逗号，根标签是否为大括号{}。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 403px;"><h2 id="section0151133714502">如何解决编译报错“Error: the name 'XXX' can only contain [a-zA-Z0-9_].”的问题<i class="anchor-icon anchor-icon-link" anchorid="section0151133714502" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p19151737165016"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p468612111637">编译报错“Error: the name 'XXX' can only contain [a-zA-Z0-9_]”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1471410392720"><span><img originheight="119" originwidth="883" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104913.78484071735303867656049636419331:50001231000000:2800:955C27757B8BC64F6B6764EBC9F817A9B0AD27ACC50E965CD0CEFC6D283B529B.png" width="883" height="119"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p9152123712504"><strong>解决方案</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1215203735011">检查文件名是否合法，文件名只能包含大小写字母、数字、下划线。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 2137px;"><h2 id="section12693104505313">如何解决三方包require语句报错<i class="anchor-icon anchor-icon-link" anchorid="section12693104505313" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p469344511539"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1669394575316">当引入三方包时编译报错。</p> <p id="ZH-CN_TOPIC_0000002510174481__p3693245115311"><strong>报错原因</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1147351745914">部分三方包由npm迁移而来，其开发环境为node， 其中的require语法arkcompiler不完全支持，出现运行报错情况。</p> <p id="ZH-CN_TOPIC_0000002510174481__p86941345185313"><strong>场景1</strong>：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen8689353433" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-comment">// Module/src/test.json</span></span></li><li>{<span class="hljs-variable">a</span>: <span class=""><span class="hljs-number">1</span></span>, <span class="hljs-variable">b</span>: <span class=""><span class="hljs-number">2</span></span>}</li><li><span class=""><span class="hljs-comment">//use.js</span></span></li><li><span class="hljs-keyword">let</span> <span class="hljs-variable">test</span> = <span class=""><span class="hljs-title function_">require</span></span>(<span class=""><span class="hljs-string">"Module/src/test.json"</span></span>)</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p195491546212"><strong>需修改为：</strong></p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-java" id="ZH-CN_TOPIC_0000002510174481__screen5513171814316" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-comment">// Module/src/test.js</span></span></li><li><span class="hljs-keyword">module</span>.<span class="hljs-keyword">exports</span> = {a: <span class=""><span class="hljs-number">1</span></span>, b: <span class=""><span class="hljs-number">2</span></span>}</li><li><span class=""><span class="hljs-comment">//use.js</span></span></li><li><span class="hljs-type">let</span> <span class="hljs-variable">test</span> <span class="hljs-operator">=</span> <span class="">require</span>(<span class=""><span class="hljs-string">"Module/src/test"</span></span>)</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p1762315610592"><strong>场景2：</strong></p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" id="ZH-CN_TOPIC_0000002510174481__screen6636103254319" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-comment">// Module/package.json</span></span></li><li>...</li><li><span class="hljs-attr">main</span>: <span class=""><span class="hljs-string">"./src"</span></span></li><li>...</li><li><span class=""><span class="hljs-comment">// use.js</span></span></li><li><span class="hljs-keyword">let</span> <span class="hljs-variable language_">module</span> = <span class=""><span class="hljs-built_in">require</span></span>(<span class=""><span class="hljs-string">"Module"</span></span>)</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p138272612314"><strong>需修改为：</strong></p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" id="ZH-CN_TOPIC_0000002510174481__screen59097441437" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-comment">// Module/package.json</span></span></li><li>...</li><li><span class="hljs-attr">main</span>: <span class=""><span class="hljs-string">"./src/index.js"</span></span></li><li>...</li><li><span class=""><span class="hljs-comment">// use.js</span></span></li><li><span class="hljs-keyword">let</span> <span class="hljs-variable language_">module</span> = <span class=""><span class="hljs-built_in">require</span></span>(<span class=""><span class="hljs-string">"Module"</span></span>)</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p2090711718114"><strong>场景3：</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p153418381514">编译出现warning信息：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510174481__screen1960181017282" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">Plugin</span> <span class="hljs-variable">node</span>-<span class="hljs-variable">resolve</span>: <span class="hljs-title class_">preferring</span> <span class="hljs-title class_">built</span>-<span class="hljs-keyword">in</span> <span class="hljs-title class_">module</span> <span class="hljs-string">'util'</span> <span class="hljs-title class_">over</span> <span class="hljs-title class_">local</span> <span class="hljs-title class_">alternative</span> <span class="hljs-title class_">at</span> <span class="hljs-string">'/Users/~/Documents/fe-module/demo/node_modules/util/util.js'</span>, <span class="hljs-variable">pass</span> <span class="hljs-string">'preferBuiltins: false'</span> <span class="hljs-variable">to</span> <span class="hljs-variable">disable</span> <span class="hljs-keyword">this</span> <span class="hljs-variable">behavior</span> <span class="hljs-variable">or</span> <span class="hljs-string">'preferBuiltins: true'</span> <span class="hljs-variable">to</span> <span class="hljs-variable">disable</span> <span class="hljs-keyword">this</span> <span class="hljs-variable">warning</span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p101018493529"><strong>解决方案</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1538815331449">修改rollup 配置文件，rollup.config.js中修改 preferBuiltins 字段：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-php" id="ZH-CN_TOPIC_0000002510174481__screen1219961281814" data-highlighted="yes"><ol class="linenums"><li>plugins: [ </li><li>  <span class="hljs-title function_ invoke__">resolve</span>({ </li><li>    <span class="hljs-attr">preferBuiltins</span>: <span class="hljs-literal">false</span>,    // <span class="hljs-literal">true</span> 或 <span class="hljs-literal">false</span></li><li>    <span class="hljs-attr">mainFields</span>: [<span class="hljs-string">'module'</span>, <span class="hljs-string">'main'</span>], </li><li>    extensions</li><li>  })</li><li>];</li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p2038911491112"><strong>场景4：</strong></p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" id="ZH-CN_TOPIC_0000002510174481__screen936911258476" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> {<span class="hljs-title class_">Buffer</span>} <span class="hljs-keyword">from</span> <span class=""><span class="hljs-string">'buffer'</span></span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p1647162812512"><strong>需修改为：</strong></p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" id="ZH-CN_TOPIC_0000002510174481__screen535210301472" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> {<span class="hljs-title class_">Buffer</span>} <span class="hljs-keyword">from</span> <span class=""><span class="hljs-string">'buffer/'</span></span></li></ol></pre></div></div> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 959px;"><h2 id="section1189393019506">如何解决编译报错“Indexed access is not supported for fields(arkts-no-props-by-index)”的问题<i class="anchor-icon anchor-icon-link" anchorid="section1189393019506" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p75621516105210"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p31547555522">动态调用类或者接口的字段，导致编译报错出现：Indexed access is not supported for fields(arkts-no-props-by-index)。</p> <p id="ZH-CN_TOPIC_0000002510174481__p4464194819013"><span><img originheight="482" originwidth="871" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104913.61648526590713543755059863263908:50001231000000:2800:64D098FE39BC0718A08955CCA695C188944212F932B0D495601742C31F1E6572.png" width="871" height="482"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p116921425512"><strong>解决方案</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p12331036818">修改代码：</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" id="ZH-CN_TOPIC_0000002510174481__screen18334192618587" data-highlighted="yes"><ol class="linenums"><li>getValue(breakpoint: string): T {</li><li>    <span class="hljs-keyword">return</span> Reflect.<span class="hljs-keyword">get</span>(<span class="hljs-keyword">this</span>.options, breakpoint) <span class="hljs-keyword">as</span> T;</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 1098px;"><h2 id="section48101848026">如何解决编译报错“Declaration merging is not supported(arkts-no-decl-merging)” 或 “Cannot redeclare block-scoped variable 'xxx'”的问题<i class="anchor-icon anchor-icon-link" anchorid="section48101848026" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p746510542015"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p55872048613">在不同的文件中声明相同变量或者interface、enum等类型，DevEco Studio不报错，但是编译报错。</p> <p id="ZH-CN_TOPIC_0000002510174481__p158928302911"><span><img originheight="812" originwidth="986" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104913.95408260085387696527949743870654:50001231000000:2800:BD137478104D6D50DA396F516435BD4D56BD0CD756165A96A3CC6DF1F05CC900.png" width="920" height="757.6470588235294"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p94654541917"><strong>解决方案</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1024613404716">如果文件中不包含export关键字，该文件将视作全局命名空间的一部分，相当于两个文件实质为同一个文件。请添加export关键字使其成为独立命名空间，或者将声明的内容添加到自定义的命名空间中。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 779px;"><h2 id="section6138105341511">如何解决编译报错“ The inferred type of 'xxx' cannot be named without a reference to 'xxx'. This is likely not portable. A type annotation is necessary<strong>.</strong>”的问题<i class="anchor-icon anchor-icon-link" anchorid="section6138105341511" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p1941154018206"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1141340172015">编译报错"The inferred type of 'xxx' cannot be named without a reference to 'xxx'. This is likely not portable. A type annotation is necessary"。</p> <p id="ZH-CN_TOPIC_0000002510174481__p67205127150"><strong>问题原因</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p3512817162">HSP会生成.d.ts声明文件，由于原始文件中未注明类型，导致生成的.d.ts文件缺少类型注解。</p> <p id="ZH-CN_TOPIC_0000002510174481__p161511188215"><span><img height="310.2225" originheight="653" originwidth="1101" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104913.45424620188926892510073365098238:50001231000000:2800:89FC6F8C2A3EF377B1EB5336683D83940604DBA16013206BEC3139BDCD29044C.png" title="点击放大" width="523.6875"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p0721121216157"><strong>解决方案</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p203191940102112">报错位置添加类型注解。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 763px;"><h2 id="section16989165018222">如何解决编译报错"arkts-no-any-unknown" 和 "Cannot find module 'xx' or its corresponding type declarations"的问题<i class="anchor-icon anchor-icon-link" anchorid="section16989165018222" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p27491549151812"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p13749104913187">编译报错"arkts-no-any-unknown" 和 "Cannot find module 'xx' or its corresponding type declarations"。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1844533062219"><strong>问题</strong><strong>原因</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p343181520233">大小写敏感导致模块找不到，常见于图片中的两种错误同时出现。</p> <p id="ZH-CN_TOPIC_0000002510174481__p12319162872714"><span><img originheight="351" originwidth="917" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104913.72268545042486874089715767905286:50001231000000:2800:A36730AB00781668CD4D686B8C40370B1D5AF768507A9DF057B378392CDD47F6.png" width="917" height="351"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p194461730172218"><strong>解决方案</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p54499328232">解决引用中的大小写问题。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 525px;"><h2 id="section8507226193311">如何解决编译报错“ERROR: ArkTS Compiler Error ERROR: /bin/sh: "xxxx/es2abc": Operation not permitted”的问题<i class="anchor-icon anchor-icon-link" anchorid="section8507226193311" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p11164171213"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p141119441216">编译报错“ERROR: ArkTS Compiler Error ERROR: /bin/sh: "xxxx/es2abc": Operation not permitted”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p1578523123217"><strong>问题原因</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p136073633516">由于获取SDK的方式是从网络上下载，mac的安全设置会给可执行文件添加来源于网络的标识（com.apple.quarantine），导致无法执行。</p> <p id="ZH-CN_TOPIC_0000002510174481__p117852363211"><strong>解决方案</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p2798041163617">执行命令删除可执行文件的com.apple.quarantine标识。</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-bash" id="ZH-CN_TOPIC_0000002510174481__screen1231564731016" data-highlighted="yes"><ol class="linenums"><li>xattr -d com.apple.quarantine /path/to/es2abc</li></ol></pre></div></div> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 356px;"><h2 id="section88869588437">如何解决编译报错“Cannot add xxxx items to index”的问题<i class="anchor-icon anchor-icon-link" anchorid="section88869588437" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p576323564320"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p2066904184514">编译报错“Cannot add xxxx items to index”。</p> <p id="ZH-CN_TOPIC_0000002510174481__p29653439817"><strong>问题原因</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1236947287">被编译文件中某函数内部有大量object literal, array literal和string，导致item的数量超过了上限（65536）。</p> <p id="ZH-CN_TOPIC_0000002510174481__p10764193554314"><strong>解决方案</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p1676413524319">排查相关文件，将存在上述原因的函数进行拆分。</p> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 1529px;"><h2 id="section2167182518466">编译初始化报错“resource busy or locked, open 'xxx\outputs\build-logs\build.log'”<i class="anchor-icon anchor-icon-link" anchorid="section2167182518466" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p17816164516477"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p118166456473">在升级DevEco Studio至5.0.3.403版本后，打开旧工程概率性报错：resource busy or locked, open 'xxx\outputs\build-logs\build.log'。</p> <p id="ZH-CN_TOPIC_0000002510174481__p922923817499"><span><img originheight="310" originwidth="865" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104913.93695146883056519891913953412628:50001231000000:2800:92C77627D3F96EFF417D461E171AB2F8B7625DFE5FECC9334F995149CC6062B3.png" width="865" height="310"></span></p> <p id="ZH-CN_TOPIC_0000002510174481__p4816194544710"><strong>问题原因</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p15816194544719">初始化时日志写入存在冲突，.hvigor目录中的build-log文件被占用导致了该报错。</p> <p id="ZH-CN_TOPIC_0000002510174481__p2816114584713"><strong>解决方案</strong></p> <ul id="ZH-CN_TOPIC_0000002510174481__ul885493545017"><li id="li285453520502">方法一：点击编辑器窗口上方的Sync Now。<p id="ZH-CN_TOPIC_0000002510174481__p746474065116"><span><img originheight="128" originwidth="1248" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104913.41164837135293042442879351361079:50001231000000:2800:518E7FBF1C60AB971BAF6E09A2583199C78F0180D8267FFA7B664C6A5B196532.png" width="920" height="94.35897435897436"></span></p> </li><li id="li11976125717518">方法二：点击工具栏<strong>File &gt; Sync and Refresh Project</strong>。<p id="ZH-CN_TOPIC_0000002510174481__p166401819545"><span><img originheight="306" originwidth="299" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104913.73081212208531617895875411835848:50001231000000:2800:95BCD74D3F5FFDC99F19E126E90AEDD2B1F5A5A871A32C57E3EFC1D212174D77.png" class="notEnlarge" width="299" height="306"></span></p> </li><li id="li191347865411">方法三：如果方法1、2无法解决问题，可以手动删除工程目录下的.hvigor目录后重启执行Sync。<p id="ZH-CN_TOPIC_0000002510174481__p1013855010547"><span><img originheight="169" originwidth="772" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104913.95869785706170071642627224219849:50001231000000:2800:6487AD6B384C861ED55E507123FF105B167F78BC85E8F718BD99A3D0DB0719DF.png" width="772" height="169"></span></p> </li></ul> </div> <div class="tiledSection" style="contain-intrinsic-size: auto 1105px;"><h2 id="section6377192464719">Mac环境下加载动态库，签名拦截导致未生效<i class="anchor-icon anchor-icon-link" anchorid="section6377192464719" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510174481__p877613301295"><strong>问题现象</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p6620203713911">Mac环境下，在DevEco项目开发时，build-profile.json中添加了如下的插桩配置，但是插桩功能未生效。</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-json" id="ZH-CN_TOPIC_0000002510174481__screen689719118201" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">"transformLib"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"&lt;相对模块根路径的动态库路径，以./开头&gt;"</span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510174481__p1014912501299"><strong>判断与验证</strong></p> <ol id="ZH-CN_TOPIC_0000002510174481__ol1561823151318"><li id="li135618231139">进入sdk中es2abc所在目录：[DevEco-Studio安装目录]/Contents/sdk/default/openharmony/ets/build-tools/ets-loader/bin/ark/build-mac/bin。</li><li id="li6495111121517">执行下列命令：<div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-css" id="ZH-CN_TOPIC_0000002510174481__screen13735191017172" data-highlighted="yes"><ol class="linenums"><li>./es2abc <span class="hljs-attr">--merge-abc</span> <span class="hljs-attr">--transform-lib</span> &lt;动态库路径&gt; &lt;测试js文件路径&gt;</li></ol></pre></div></div> </li><li id="li15313837131411">如果提示类似如下报错信息，原因可能是es2abc和动态库文件不属于一个签名组。<div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-vbnet" id="ZH-CN_TOPIC_0000002510174481__screen165511750141919" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-symbol">os:</span>:library_loader::Load <span class="hljs-keyword">error</span>: dlopen(..., <span class="hljs-number">0</span>x0001): </li><li><span class="hljs-symbol">tried:</span> <span class="hljs-comment">'...' (code signature in &lt;...&gt; '...' not valid for use in process: mapped file has no cdhash, completely unsigned? Code has to be at least ad-hoc signed.)</span></li></ol></pre></div></div> </li><li id="li1550485251510">用下面命令查看es2abc和动态库文件的签名组信息，如果两个文件，一个有签名信息，一个没有签名信息，或者都有签名信息，但是签名信息中属性'TeamIdentifier'的值是不一样的，那就说明问题是签名组不一致导致的，可以使用"解决方案"提供的方式处理。<div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-lua" id="ZH-CN_TOPIC_0000002510174481__screen475216347187" data-highlighted="yes"><ol class="linenums"><li>codesign -dv <span class="hljs-comment">--verbose=1 &lt;es2abc路径&gt;</span></li><li>codesign -dv <span class="hljs-comment">--verbose=1 &lt;动态库路径&gt;</span></li></ol></pre></div></div> </li></ol> <p id="ZH-CN_TOPIC_0000002510174481__p18979141019199"><strong>解决方案</strong></p> <p id="ZH-CN_TOPIC_0000002510174481__p105471867196">执行下列命令，将es2abc文件的签名替换成和动态库文件一样的用户签名。</p> <div _ngcontent-kln-c106="" class="highlight-div"><div _ngcontent-kln-c106="" class="highlight-div-header"><div _ngcontent-kln-c106="" class="highlight-div-header-left"><div _ngcontent-kln-c106="" class="handle-button expand-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kln-c106="" class="highlight-div-header-right"><div _ngcontent-kln-c106="" class="handle-button ai-button"></div><div _ngcontent-kln-c106="" class="handle-button line-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kln-c106="" class="handle-button theme-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kln-c106="" class="handle-button copy-button"><div _ngcontent-kln-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kln-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-php-template" id="ZH-CN_TOPIC_0000002510174481__screen1081162315192" data-highlighted="yes"><ol class="linenums"><li><span class="language-xml">codesign --remove-signature <span class="hljs-tag">&lt;<span class="hljs-name">es2abc路径</span>&gt;</span></span></li><li><span class="language-xml">codesign -s - -v <span class="hljs-tag">&lt;<span class="hljs-name">es2abc路径</span>&gt;</span></span></li></ol></pre></div></div> </div> </div> <div></div></div>