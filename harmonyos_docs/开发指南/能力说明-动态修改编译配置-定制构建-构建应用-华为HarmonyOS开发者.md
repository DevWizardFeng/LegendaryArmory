<h1 _ngcontent-wiq-c119="" class="doc-title ng-star-inserted" title="能力说明"> 能力说明 </h1>

<div _ngcontent-wiq-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div id="body0000001815603520"><p id="ZH-CN_TOPIC_0000002510294365__p65941143155511">Hvigor支持在hvigorfile.ts里接收部分编译配置，以实现动态配置构建配置、并使能到构建的过程与结果中。</p> <p id="ZH-CN_TOPIC_0000002510294365__p636012415576">此能力现有两种方式实现：</p> <ul id="ZH-CN_TOPIC_0000002510294365__ul1866795015107"><li id="li8667145041016">以hvigor hook能力为基础通过插件上下文来动态配置。(推荐使用)</li><li id="li266711501102">在hvigorfile.ts中通过overrides关键字导出动态配置。(不推荐使用)</li></ul> <div class="tiledSection"><h2 id="section1419815194449">通过hook以及插件上下文实现动态配置<i class="anchor-icon anchor-icon-link" anchorid="section1419815194449" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510294365__p1252819771215">Hvigor支持stage模型在hvigor hook中操作从硬盘上读取的以下配置文件：</p> <ul id="ZH-CN_TOPIC_0000002510294365__ul757634461015"><li id="li1065816101266">每个hvigorNode中的build-profile.json5</li><li id="li1962481919260">module.json5</li><li id="li3576184411104">app.json5</li><li id="li56194016106">每个module下的oh-package.json5文件中的dependency、devDependency、dynamicDependency以及version。</li></ul> <p id="ZH-CN_TOPIC_0000002510294365__p4715195310206">目前可以通过hvigor对象提供的上下文直接获取和修改配置以实现动态配置构建配置、并使能到构建的过程与结果中。</p> <p id="ZH-CN_TOPIC_0000002510294365__p15290837132313">在hvigorfile.ts或hvigorconfig.ts文件中，可以使用Hvigor提供的API接口来实现此能力。</p> <p id="ZH-CN_TOPIC_0000002510294365__p515645616531">相比于下面的overrides的能力来说，通过hook以及插件上下文来动态修改签名和编译配置更为灵活和易于理解，功能也更为全面，推荐采用此种方式。具体使用方式请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-config-ohos-sample#section67131365449">通过hook以及插件上下文动态配置构建配置(推荐使用)</a>。</p> </div> <div class="tiledSection"><h2 id="section19588121902">在hvigorfile.ts中通过overrides关键字导出动态配置<i class="anchor-icon anchor-icon-link" anchorid="section19588121902" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510294365__p1975975418">在hvigorfile.ts中，我们约定在导出的对象中的config.ohos属性里接收编译的配置：</p> <div _ngcontent-wiq-c106="" class="highlight-div"><div _ngcontent-wiq-c106="" class="highlight-div-header"><div _ngcontent-wiq-c106="" class="highlight-div-header-left"><div _ngcontent-wiq-c106="" class="handle-button expand-button"><div _ngcontent-wiq-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-wiq-c106="" class="highlight-div-header-right"><div _ngcontent-wiq-c106="" class="handle-button ai-button"></div><div _ngcontent-wiq-c106="" class="handle-button line-button"><div _ngcontent-wiq-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-wiq-c106="" class="handle-button theme-button"><div _ngcontent-wiq-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-wiq-c106="" class="handle-button copy-button"><div _ngcontent-wiq-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-wiq-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" id="ZH-CN_TOPIC_0000002510294365__screen8556837115913" data-highlighted="yes"><ol class="linenums"><li><span class=""><span class="hljs-variable">export</span> <span class="hljs-variable">default</span> {  </span></li><li><span class="">    <span class="hljs-variable">system</span>: <span class="hljs-title class_">hapTasks</span>,  </span></li><li><span class="">    <span class="hljs-variable">config</span>: {  </span></li><li><span class="">        <span class="hljs-variable">ohos</span>: {</span></li><li><span class="">            ...</span></li><li><span class="">        }    </span></li><li><span class="">    }</span></li><li><span class="">}</span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510294365__p1995912110442">目前可以在工程级的hvigorfile.ts的config.ohos中配置的字段：</p> <ul id="ZH-CN_TOPIC_0000002510294365__ul79593118442"><li id="li395961174412">overrides：定义需要覆盖的字段，会在构建过程中覆盖原有的对应配置项。<ul id="ZH-CN_TOPIC_0000002510294365__ul2959117448"><li id="li18960317442">signingConfig：签名配置，对应build-profile.json5里的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-build-profile-app#section153288223224">signingConfigs配置项</a>。<ul id="ZH-CN_TOPIC_0000002510294365__ul139601517443"><li id="li196041114419">type</li><li id="li89608117446">material<ul id="ZH-CN_TOPIC_0000002510294365__ul496013194410"><li id="li189608111444">certpath</li><li id="li596019144417">storePassword</li><li id="li109608118448">keyAlias</li><li id="li196018144414">keyPassword</li><li id="li1196016113448">profile</li><li id="li1196001154418">signAlg</li><li id="li1896041104410">storeFile</li></ul> </li></ul> </li><li id="li12960319440">appOpt：对应<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-configuration-file" target="_blank">app.json5</a>里的配置项字段。<ul id="ZH-CN_TOPIC_0000002510294365__ul8960131154415"><li id="li12960012443">bundleName</li><li id="li6960111104415">bundleType</li><li id="li199601614444">icon</li><li id="li6960161154419">label</li><li id="li09609124419">vendor</li><li id="li596010114418">versionCode</li><li id="li5960117442">versionName</li></ul> </li></ul> </li></ul> <p id="ZH-CN_TOPIC_0000002510294365__p1396031134412">目前可以在模块级的hvigorfile.ts的config.ohos中配置的字段：</p> <ul id="ZH-CN_TOPIC_0000002510294365__ul18100185711446"><li id="li7198811174514">overrides：定义需要覆盖的字段，会在构建过程中覆盖原有的对应配置项。<ul id="ZH-CN_TOPIC_0000002510294365__ul8695811154512"><li id="li19101125719446">buildOption：对应build-profile.json5里的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-build-profile#section1010733210421">buildOption配置项</a>。<ul id="ZH-CN_TOPIC_0000002510294365__ul15033434516"><li id="li154516317459">arkOptions</li><li id="li24512031144515">externalNativeOptions</li><li id="li6451631194518">napiLibFilterOption</li><li id="li6452163114510">nativeLib</li><li id="li8452631174514">resOptions</li><li id="li9452731184517">sourceOption</li></ul> </li></ul> </li></ul> <p id="ZH-CN_TOPIC_0000002510294365__p29624154420">配置在overrides项中的参数，其优先级会高于在配置项中的对应字段。</p> </div> </div> <div></div></div>