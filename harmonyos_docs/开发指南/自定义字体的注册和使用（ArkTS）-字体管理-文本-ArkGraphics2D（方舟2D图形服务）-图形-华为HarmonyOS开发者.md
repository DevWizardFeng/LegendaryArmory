<h1 _ngcontent-beb-c119="" class="doc-title ng-star-inserted" title="自定义字体的注册和使用（ArkTS）"> 自定义字体的注册和使用（ArkTS） </h1>

<div _ngcontent-beb-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="场景介绍">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="场景介绍" tips="复制节点链接"></i></h2>          <p>自定义字体是指开发者根据应用需求创建或选择的字体，通常用于实现特定的文字风格或满足独特的设计要求。当应用需要使用特定的文本样式和字符集时，可以注册并使用自定义字体进行文本渲染。</p>    </div>    <div class="tiledSection">     <h2 id="实现流程">实现流程<i class="anchor-icon anchor-icon-link" anchorid="实现流程" tips="复制节点链接"></i></h2>          <p><strong>自定义字体的注册</strong>是指将字体文件（如ttf、otf文件等）从应用资源注册到系统中，使得应用能够使用这些字体进行文本渲染。注册过程是将字体文件通过字体管理接口注册到系统字体库中，以便在应用中进行调用。</p>     <p><strong>自定义字体的使用</strong>是指在应用中显式指定使用已注册的自定义字体进行文本渲染。开发者可以根据需要选择特定的文本样式（如常规、粗体、斜体等），并将其应用到UI元素、文本控件或其他文本展示区域，以满足设计要求并提供视觉效果的一致性。</p>    </div>    <div class="tiledSection">     <h2 id="接口说明">接口说明<i class="anchor-icon anchor-icon-link" anchorid="接口说明" tips="复制节点链接"></i></h2>          <p>自定义字体注册和使用的常用接口如下表所示，详细接口说明请见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-graphics-text" target="_blank">@ohos.graphics.text (文本模块)</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.1" valign="top" width="50%">接口</th>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.1.3.1.2" valign="top" width="50%">描述</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">loadFontSync(name: string, path: string | Resource): void</td>         <td class="cellrowborder" valign="top" width="50%">          <p>同步接口，将路径对应的文件，以name作为使用的别名，注册自定义字体。</p>          <p><strong>说明：</strong></p>          <p>需保证使用自定义字体时，自定义字体已完成注册，非性能严格要求场景下，建议使用同步接口。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">loadFont(name: string, path: string | Resource): Promise&lt;void&gt;</td>         <td class="cellrowborder" valign="top" width="50%">使用指定的别名和文件路径注册对应字体，使用Promise异步回调。此接口从API version 14开始支持。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">unloadFontSync(name: string): void</td>         <td class="cellrowborder" valign="top" width="50%">同步接口，注销指定别名的字体。此接口从API version 20开始支持。</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">unloadFont(name: string): Promise&lt;void&gt;</td>         <td class="cellrowborder" valign="top" width="50%">使用指定的别名注销对应字体，使用Promise异步回调。此接口从API version 20开始支持。</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="开发步骤">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="开发步骤" tips="复制节点链接"></i></h2>          <ol>      <li>       <p>导入依赖的相关模块。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">NodeController</span>, <span class="hljs-title class_">FrameNode</span>, <span class="hljs-title class_">RenderNode</span>, <span class="hljs-title class_">DrawContext</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIContext</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span></li><li><span class="hljs-keyword">import</span> { text } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkGraphics2D'</span></li></ol></pre></div></div></li>      <li>       <p>注册自定义字体。有以下两种方式：</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 注册自定义字体</span></li><li><span class="hljs-keyword">let</span> fontCollection = text.<span class="hljs-property">FontCollection</span>.<span class="hljs-title function_">getGlobalInstance</span>()</li><li><span class="hljs-comment">// 方式一：/system/fonts/myFontFile.ttf文件仅为示例路径，应用根据自身实际填写文件路径</span></li><li>fontCollection.<span class="hljs-title function_">loadFontSync</span>(<span class="hljs-string">'myFamilyName0'</span>, <span class="hljs-string">'file:///system/fonts/myFontFile.ttf'</span>)</li><li>
</li><li><span class="hljs-comment">// 方式二：确保已经将自定义字体myFontFile.ttf文件放在本应用工程的entry/src/main/resources/rawfile目录</span></li><li>fontCollection.<span class="hljs-title function_">loadFontSync</span>(<span class="hljs-string">'myFamilyName1'</span>,$rawfile(<span class="hljs-string">'myFontFile.ttf'</span>))</li></ol></pre></div></div></li>      <li>       <p>使用自定义字体。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 填写注册自定义字体时传入的字体家族名</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">myFontFamily</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">string</span>&gt; = [<span class="hljs-string">"myFamilyName0"</span>]</li><li><span class="hljs-comment">// 设置文本样式</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">myTextStyle</span>: text.<span class="hljs-property">TextStyle</span> = {</li><li>  <span class="hljs-attr">color</span>: { <span class="hljs-attr">alpha</span>: <span class="hljs-number">255</span>, <span class="hljs-attr">red</span>: <span class="hljs-number">255</span>, <span class="hljs-attr">green</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">blue</span>: <span class="hljs-number">0</span> },</li><li>  <span class="hljs-attr">fontSize</span>: <span class="hljs-number">100</span>,</li><li>  <span class="hljs-comment">// 在文本样式中加入可使用的自定义字体</span></li><li>  <span class="hljs-attr">fontFamilies</span>: myFontFamily</li><li>};</li></ol></pre></div></div></li>      <li>       <p>创建段落样式，并使用字体管理器实例构造段落生成器ParagraphBuilder实例。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 创建一个段落样式对象，以设置排版风格</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">myParagraphStyle</span>: text.<span class="hljs-property">ParagraphStyle</span> = {<span class="hljs-attr">textStyle</span>: myTextStyle}</li><li><span class="hljs-comment">// 创建一个段落生成器</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">paragraphBuilder</span>: text.<span class="hljs-property">ParagraphBuilder</span> = <span class="hljs-keyword">new</span> text.<span class="hljs-title class_">ParagraphBuilder</span>(myParagraphStyle, fontCollection);</li></ol></pre></div></div></li>      <li>       <p>生成段落。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 在段落生成器中设置文本样式</span></li><li>paragraphBuilder.<span class="hljs-title function_">pushStyle</span>(myTextStyle);</li><li><span class="hljs-comment">// 在段落生成器中设置文本内容</span></li><li>paragraphBuilder.<span class="hljs-title function_">addText</span>(<span class="hljs-string">"Custom font test"</span>);</li><li><span class="hljs-comment">// 通过段落生成器生成段落</span></li><li><span class="hljs-keyword">let</span> paragraph = paragraphBuilder.<span class="hljs-title function_">build</span>();</li></ol></pre></div></div></li>      <li>       <p>如果需要释放自定义字体，可以使用unloadFontSync接口。</p>       <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 注销自定义字体</span></li><li>fontCollection.<span class="hljs-title function_">unloadFontSync</span>(familyName)</li><li><span class="hljs-comment">// 注销之后需要刷新使用该fontCollection的节点</span></li><li>newNode.<span class="hljs-title function_">invalidate</span>()</li></ol></pre></div></div></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="完整示例">完整示例<i class="anchor-icon anchor-icon-link" anchorid="完整示例" tips="复制节点链接"></i></h2>          <p>这里以使用自定义注册字体方式一为例绘制“Custom font test”文本，并提供如下完整示例。</p>     <p>请保证自定义字体文件已放置到设备正确的路径下。</p>     <div _ngcontent-beb-c106="" class="highlight-div"><div _ngcontent-beb-c106="" class="highlight-div-header"><div _ngcontent-beb-c106="" class="highlight-div-header-left"><div _ngcontent-beb-c106="" class="handle-button expand-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-beb-c106="" class="highlight-div-header-right"><div _ngcontent-beb-c106="" class="handle-button ai-button"></div><div _ngcontent-beb-c106="" class="handle-button line-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-beb-c106="" class="handle-button theme-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-beb-c106="" class="handle-button copy-button"><div _ngcontent-beb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-beb-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Index.ets</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">NodeController</span>, <span class="hljs-title class_">FrameNode</span>, <span class="hljs-title class_">RenderNode</span>, <span class="hljs-title class_">DrawContext</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span></li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">UIContext</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span></li><li><span class="hljs-keyword">import</span> { text } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkGraphics2D'</span></li><li>
</li><li><span class="hljs-comment">// 获取全局字体集实例</span></li><li><span class="hljs-keyword">let</span> fontCollection = text.<span class="hljs-property">FontCollection</span>.<span class="hljs-title function_">getGlobalInstance</span>() <span class="hljs-comment">//获取Arkui全局FC</span></li><li><span class="hljs-keyword">const</span> familyName = <span class="hljs-string">"myFamilyName"</span></li><li>
</li><li><span class="hljs-comment">// 创建一个自定义的渲染节点类，用于绘制文本</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyRenderNode</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">RenderNode</span> {</li><li>  <span class="hljs-keyword">async</span> <span class="hljs-title function_">draw</span>(<span class="hljs-params">context: DrawContext</span>) {</li><li>    <span class="hljs-comment">// 创建画布canvas对象</span></li><li>    <span class="hljs-keyword">const</span> canvas = context.<span class="hljs-property">canvas</span></li><li>    <span class="hljs-comment">// 使用自定义字体</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">myFontFamily</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">string</span>&gt; = [familyName] <span class="hljs-comment">// 如果已经注册自定义字体，填入自定义字体的字体家族名</span></li><li>    <span class="hljs-comment">// 设置文本样式</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">myTextStyle</span>: text.<span class="hljs-property">TextStyle</span> = {</li><li>      <span class="hljs-attr">color</span>: {</li><li>        <span class="hljs-attr">alpha</span>: <span class="hljs-number">255</span>,</li><li>        <span class="hljs-attr">red</span>: <span class="hljs-number">255</span>,</li><li>        <span class="hljs-attr">green</span>: <span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">blue</span>: <span class="hljs-number">0</span></li><li>      },</li><li>      <span class="hljs-attr">fontSize</span>: <span class="hljs-number">30</span>,</li><li>      <span class="hljs-comment">// 在文本样式中加入可使用的自定义字体</span></li><li>      <span class="hljs-attr">fontFamilies</span>: myFontFamily</li><li>    };</li><li>    <span class="hljs-comment">// 创建一个段落样式对象，以设置排版风格</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">myParagraphStyle</span>: text.<span class="hljs-property">ParagraphStyle</span> = {</li><li>      <span class="hljs-attr">textStyle</span>: myTextStyle,</li><li>      <span class="hljs-attr">align</span>: <span class="hljs-number">3</span>,</li><li>      <span class="hljs-attr">wordBreak</span>: text.<span class="hljs-property">WordBreak</span>.<span class="hljs-property">NORMAL</span></li><li>    };</li><li>    <span class="hljs-comment">// 创建一个段落生成器</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-title class_">ParagraphGraphBuilder</span> = <span class="hljs-keyword">new</span> text.<span class="hljs-title class_">ParagraphBuilder</span>(myParagraphStyle, fontCollection)</li><li>    <span class="hljs-comment">// 在段落生成器中设置文本样式</span></li><li>    <span class="hljs-title class_">ParagraphGraphBuilder</span>.<span class="hljs-title function_">pushStyle</span>(myTextStyle);</li><li>    <span class="hljs-comment">// 在段落生成器中设置文本内容</span></li><li>    <span class="hljs-title class_">ParagraphGraphBuilder</span>.<span class="hljs-title function_">addText</span>(<span class="hljs-string">"Custom font test"</span>);</li><li>    <span class="hljs-comment">// 通过段落生成器生成段落</span></li><li>    <span class="hljs-keyword">let</span> paragraph = <span class="hljs-title class_">ParagraphGraphBuilder</span>.<span class="hljs-title function_">build</span>();</li><li>    <span class="hljs-comment">// 设置段落宽度为1000px</span></li><li>    paragraph.<span class="hljs-title function_">layoutSync</span>(<span class="hljs-number">1000</span>);</li><li>    paragraph.<span class="hljs-title function_">paint</span>(canvas, <span class="hljs-number">0</span>, <span class="hljs-number">400</span>);</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-comment">// 创建并初始化渲染节点实例</span></li><li><span class="hljs-keyword">const</span> newNode = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyRenderNode</span>();</li><li><span class="hljs-comment">// 设置渲染节点的位置和尺寸</span></li><li>newNode.<span class="hljs-property">frame</span> = {</li><li>  <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>,</li><li>  <span class="hljs-attr">y</span>: <span class="hljs-number">0</span>,</li><li>  <span class="hljs-attr">width</span>: <span class="hljs-number">400</span>,</li><li>  <span class="hljs-attr">height</span>: <span class="hljs-number">600</span></li><li>};</li><li>
</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">MyNodeController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">NodeController</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">rootNode</span>: <span class="hljs-title class_">FrameNode</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>
</li><li>  <span class="hljs-title function_">makeNode</span>(<span class="hljs-attr">uiContext</span>: <span class="hljs-title class_">UIContext</span>): <span class="hljs-title class_">FrameNode</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">rootNode</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">FrameNode</span>(uiContext)</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">rootNode</span> == <span class="hljs-literal">null</span>) {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">rootNode</span></li><li>    }</li><li>    <span class="hljs-keyword">const</span> renderNode = <span class="hljs-variable language_">this</span>.<span class="hljs-property">rootNode</span>.<span class="hljs-title function_">getRenderNode</span>()</li><li>    <span class="hljs-keyword">if</span> (renderNode != <span class="hljs-literal">null</span>) {</li><li>      renderNode.<span class="hljs-property">frame</span> = {</li><li>        <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">y</span>: <span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">width</span>: <span class="hljs-number">300</span>,</li><li>        <span class="hljs-attr">height</span>: <span class="hljs-number">50</span></li><li>      }</li><li>      renderNode.<span class="hljs-property">pivot</span> = { <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> }</li><li>    }</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">rootNode</span></li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">addNode</span>(<span class="hljs-attr">node</span>: <span class="hljs-title class_">RenderNode</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">rootNode</span> == <span class="hljs-literal">null</span>) {</li><li>      <span class="hljs-keyword">return</span></li><li>    }</li><li>    <span class="hljs-keyword">const</span> renderNode = <span class="hljs-variable language_">this</span>.<span class="hljs-property">rootNode</span>.<span class="hljs-title function_">getRenderNode</span>()</li><li>    <span class="hljs-keyword">if</span> (renderNode != <span class="hljs-literal">null</span>) {</li><li>      renderNode.<span class="hljs-title function_">appendChild</span>(node)</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">clearNodes</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">rootNode</span> == <span class="hljs-literal">null</span>) {</li><li>      <span class="hljs-keyword">return</span></li><li>    }</li><li>    <span class="hljs-keyword">const</span> renderNode = <span class="hljs-variable language_">this</span>.<span class="hljs-property">rootNode</span>.<span class="hljs-title function_">getRenderNode</span>()</li><li>    <span class="hljs-keyword">if</span> (renderNode != <span class="hljs-literal">null</span>) {</li><li>      renderNode.<span class="hljs-title function_">clearChildren</span>()</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">RenderTest</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">myNodeController</span>: <span class="hljs-title class_">MyNodeController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyNodeController</span>()</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-comment">// 如果使用getGlobalInstance的fontCollection注册字体，使用对应family name的组件会自动刷新</span></li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">"Text Component"</span>)</li><li>          .<span class="hljs-title function_">fontFamily</span>(familyName)</li><li>        <span class="hljs-title class_">NodeContainer</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">myNodeController</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>          .<span class="hljs-title function_">onAppear</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">myNodeController</span>.<span class="hljs-title function_">clearNodes</span>()</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">myNodeController</span>.<span class="hljs-title function_">addNode</span>(newNode)</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'90%'</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>
</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">"load font"</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-string">'16fp'</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-number">500</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">24</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">12</span> })</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-comment">// 注册自定义字体</span></li><li>            fontCollection.<span class="hljs-title function_">loadFontSync</span>(familyName, <span class="hljs-string">'file:///system/fonts/NotoSansMalayalamUI-SemiBold.ttf'</span>)</li><li>            <span class="hljs-comment">// 注册之后需要刷新使用该fontCollection的节点</span></li><li>            newNode.<span class="hljs-title function_">invalidate</span>()</li><li>          })</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'30%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>          .<span class="hljs-title function_">shadow</span>(<span class="hljs-title class_">ShadowStyle</span>.<span class="hljs-property">OUTER_DEFAULT_LG</span>)</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">"unload font"</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-string">'16fp'</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-number">500</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">24</span>, <span class="hljs-attr">right</span>: <span class="hljs-number">12</span> })</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-comment">// 注销自定义字体</span></li><li>            fontCollection.<span class="hljs-title function_">unloadFontSync</span>(familyName)</li><li>            <span class="hljs-comment">// 注销之后需要刷新使用该fontCollection的节点</span></li><li>            newNode.<span class="hljs-title function_">invalidate</span>()</li><li>          })</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'30%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>          .<span class="hljs-title function_">shadow</span>(<span class="hljs-title class_">ShadowStyle</span>.<span class="hljs-property">OUTER_DEFAULT_LG</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>) <span class="hljs-comment">// 设置当前Row容器内子元素在主轴上居中对齐</span></li><li>      .<span class="hljs-title function_">shadow</span>(<span class="hljs-title class_">ShadowStyle</span>.<span class="hljs-property">OUTER_DEFAULT_SM</span>) <span class="hljs-comment">// 设置Row容器外阴影效果</span></li><li>      .<span class="hljs-title function_">alignItems</span>(<span class="hljs-title class_">VerticalAlign</span>.<span class="hljs-property">Bottom</span>) <span class="hljs-comment">// 设置当前Row容器内子元素在交叉轴（垂直方向）上的对齐方式为底部对齐</span></li><li>      .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>) <span class="hljs-comment">// 设置当前Row在父容器Column中的布局权重为1</span></li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="效果展示">效果展示<i class="anchor-icon anchor-icon-link" anchorid="效果展示" tips="复制节点链接"></i></h2>          <p><span><img originheight="1156" originwidth="720" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114402.63527614566502536096424714683526:50001231000000:2800:E6AB2FDFF48A811591D1C7893BA99EBD201E7BBE97F119AA09BA9EC91BE2745D.png" width="720" height="1156"></span></p>     <p><span><img originheight="1149" originwidth="720" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114402.26310149038672481876918008613973:50001231000000:2800:42ED67D084523F79787C25B40D585543E9D06B0CA8AE177A4B12B7EE85143059.png" width="720" height="1149"></span></p>    </div>   </div>   <div></div></div>