<h1 _ngcontent-lxs-c119="" class="doc-title ng-star-inserted" title="自定义组件冻结功能"> 自定义组件冻结功能 </h1>

<div _ngcontent-lxs-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>当@ComponentV2装饰的自定义组件处于非激活状态时，状态变量将不响应更新，即<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-new-monitor">@Monitor</a>不会调用，状态变量关联的节点不会刷新。该冻结机制在复杂UI场景下能显著优化性能，避免非激活组件因状态变量更新进行无效刷新，从而减少资源消耗。通过freezeWhenInactive属性来决定是否使用冻结功能，不传参数时默认不使用。支持的场景有：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-router" target="_blank">页面路由</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-tabcontent" target="_blank">TabContent</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-components-navigation" target="_blank">Navigation</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-rendering-control-repeat" target="_blank">Repeat</a>。</p>    <p>在阅读本文档前，开发者需要了解@ComponentV2基本语法。建议提前阅读：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-new-componentv2">@ComponentV2</a>。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>从API version 12开始，支持@ComponentV2装饰的自定义组件冻结功能。</p>      <p>从API version 18开始，支持自定义组件冻结混用场景。</p>      <p>与@Component的组件冻结不同，@ComponentV2装饰的自定义组件不支持在LazyForEach场景下缓存节点组件冻结。</p>     </div></div></div>    <div class="tiledSection">     <h2 id="当前支持的场景">当前支持的场景<i class="anchor-icon anchor-icon-link" anchorid="当前支持的场景" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="页面路由" class="firsth2">页面路由<i class="anchor-icon anchor-icon-link" anchorid="页面路由" tips="复制节点链接"></i></h3>          <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>本示例使用了router进行页面跳转，建议开发者使用组件导航(Navigation)代替页面路由(router)来实现页面切换。Navigation提供了更多的功能和更灵活的自定义能力。请参考<a href="/consumer/cn/doc/harmonyos-guides/arkts-custom-components-freezev2#navigation">使用Navigation的组件冻结用例</a>。</p>      </div></div></div>     <p>当页面1调用this.getUIContext().getRouter().pushUrl()接口跳转到页面2时，页面1为隐藏不可见状态，此时如果更新页面1中的状态变量，不会触发页面1刷新。</p>     <p>图示如下：</p>     <p><span><img originheight="351" originwidth="371" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114959.76925840892132638867952175664116:50001231000000:2800:752407C5F6B7F794BACA2C5FAB13A739A3175A9719E3542BE3F6B8B2353EDBDF.png" width="371" height="351"></span></p>     <p>页面1：</p>     <div _ngcontent-lxs-c106="" class="highlight-div"><div _ngcontent-lxs-c106="" class="highlight-div-header"><div _ngcontent-lxs-c106="" class="highlight-div-header-left"><div _ngcontent-lxs-c106="" class="handle-button expand-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lxs-c106="" class="highlight-div-header-right"><div _ngcontent-lxs-c106="" class="handle-button ai-button"></div><div _ngcontent-lxs-c106="" class="handle-button line-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lxs-c106="" class="handle-button theme-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lxs-c106="" class="handle-button copy-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lxs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Book</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'100'</span>;</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">page: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = page;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span>({ <span class="hljs-attr">freezeWhenInactive</span>: <span class="hljs-literal">true</span> })</li><li><span class="hljs-keyword">export</span> struct <span class="hljs-title class_">Page1</span> {</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">bookTest</span>: <span class="hljs-title class_">Book</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Book</span>(<span class="hljs-string">`A Midsummer Night's Dream`</span>);</li><li>
</li><li>  <span class="hljs-meta">@Monitor</span>(<span class="hljs-string">'bookTest.name'</span>)</li><li>  <span class="hljs-title function_">onMessageChange</span>(<span class="hljs-params">monitor: IMonitor</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`The book name change from <span class="hljs-subst">${monitor.value()?.before}</span> to <span class="hljs-subst">${monitor.value()?.now}</span>`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Book name is  <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.bookTest.name}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">25</span>)</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'changeBookName'</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">25</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">bookTest</span>.<span class="hljs-property">name</span> = <span class="hljs-string">'The Old Man and the Sea'</span>;</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'go to next page'</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">25</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getRouter</span>().<span class="hljs-title function_">pushUrl</span>({ <span class="hljs-attr">url</span>: <span class="hljs-string">'pages/Page2'</span> });</li><li>          <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">bookTest</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Book</span>(<span class="hljs-string">`Jane Austen's Pride and Prejudice`</span>);</li><li>          }, <span class="hljs-number">1000</span>)</li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>页面2：</p>     <div _ngcontent-lxs-c106="" class="highlight-div"><div _ngcontent-lxs-c106="" class="highlight-div-header"><div _ngcontent-lxs-c106="" class="highlight-div-header-left"><div _ngcontent-lxs-c106="" class="handle-button expand-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lxs-c106="" class="highlight-div-header-right"><div _ngcontent-lxs-c106="" class="handle-button ai-button"></div><div _ngcontent-lxs-c106="" class="handle-button line-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lxs-c106="" class="handle-button theme-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lxs-c106="" class="handle-button copy-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lxs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Page2</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'This is the page2'</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">25</span>)</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Back'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getRouter</span>().<span class="hljs-title function_">back</span>();</li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>在上面的示例中：</p>     <ol>      <li>       <p>在页面1中点击changeBookName，bookTest变量的name属性改变，@Monitor中注册的方法onMessageChange会被调用。</p></li>      <li>       <p>在页面1中点击go to next page，跳转到页面2，然后延迟1s更新状态变量bookTest。在更新bookTest的时候，已经跳转到页面2，页面1处于inactive状态，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-new-local">@Local</a>装饰的状态变量bookTest将不响应更新，其@Monitor不会调用，关联的节点不会刷新。</p></li>     </ol>     <p>Trace如下：</p>     <p><span><img originheight="419" originwidth="1140" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114959.49836470403574091475587694124159:50001231000000:2800:18C64D77832881DB62F08ECE6273A8D75E3649CA87298E0D0874B4646136FA17.png" width="920" height="338.140350877193"></span></p>     <ol>      <li>点击Back，页面2被销毁，页面1的状态由inactive变为active。状态变量bookTest的更新被观察到，@Monitor中注册的方法onMessageChange被调用，对应的Text显示内容改变。</li>     </ol>     <p><span><img originheight="604" originwidth="1991" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114959.64884811203935578649114934540609:50001231000000:2800:2DF3C7FDF7A114B8A02B4B7F5411EA27573DE8FF661A673C806A0020D54B11D8.gif" width="920" height="279.0959316926168"></span></p>    </div>    <div class="tiledSection">     <h3 id="tabcontent">TabContent<i class="anchor-icon anchor-icon-link" anchorid="tabcontent" tips="复制节点链接"></i></h3>          <p>对Tabs中当前不可见的TabContent进行冻结，修改状态变量不会触发冻结组件的更新。</p>     <p>需要注意的是：在首次渲染的时候，Tabs只会创建当前正在显示的TabContent，当切换全部的TabContent后，TabContent才会被全部创建。</p>     <p>图示如下：</p>     <p><span><img originheight="271" originwidth="451" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115000.88324811395880086322815847637417:50001231000000:2800:2F92ADBD63AE8F69A2406ED48FE9D533ECB546E82F0B998A08AA77918F5B97A2.png" width="451" height="271"></span></p>     <div _ngcontent-lxs-c106="" class="highlight-div"><div _ngcontent-lxs-c106="" class="highlight-div-header"><div _ngcontent-lxs-c106="" class="highlight-div-header-left"><div _ngcontent-lxs-c106="" class="handle-button expand-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lxs-c106="" class="highlight-div-header-right"><div _ngcontent-lxs-c106="" class="handle-button ai-button"></div><div _ngcontent-lxs-c106="" class="handle-button line-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lxs-c106="" class="handle-button theme-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lxs-c106="" class="handle-button copy-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lxs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">TabContentTest</span> {</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">data</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>];</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change message'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>++;</li><li>        })</li><li>
</li><li>        <span class="hljs-title class_">Tabs</span>() {</li><li>          <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>            <span class="hljs-title class_">TabContent</span>() {</li><li>              <span class="hljs-title class_">FreezeChild</span>({ <span class="hljs-attr">message</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>, <span class="hljs-attr">index</span>: item })</li><li>            }.<span class="hljs-title function_">tabBar</span>(<span class="hljs-string">`tab<span class="hljs-subst">${item}</span>`</span>)</li><li>          }, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> item.<span class="hljs-title function_">toString</span>())</li><li>        }</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@ComponentV2</span>({ <span class="hljs-attr">freezeWhenInactive</span>: <span class="hljs-literal">true</span> })</li><li>struct <span class="hljs-title class_">FreezeChild</span> {</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-meta">@Monitor</span>(<span class="hljs-string">'message'</span>) <span class="hljs-title function_">onMessageUpdated</span>(<span class="hljs-params">mon: IMonitor</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`FreezeChild message callback func <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.message}</span>, index: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.index}</span>`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Text</span>(<span class="hljs-string">'message'</span> + <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.message}</span>, index: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.index}</span>`</span>)</li><li>      .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">50</span>)</li><li>      .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>在上面的示例中：</p>     <p>1.点击change message更改message的值，当前正在显示的TabContent组件中@Monitor注册的方法onMessageUpdated被触发。</p>     <p>2.点击tab1切换到另外的TabContent，该TabContent的状态由inactive变为active，对应的@Monitor注册的方法onMessageUpdated被触发。</p>     <p>3.再次点击change message更改message的值，仅当前显示的TabContent子组件中@Monitor注册的方法onMessageUpdated被触发。其他inactive的TabContent组件不会触发@Monitor。</p>     <p><span><img originheight="641" originwidth="1757" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115000.42050058340287981450721826579874:50001231000000:2800:04EF755D30741F32405458813EEE585634C3DEB684A399C926A387376C0622A9.gif" width="920" height="335.64029595902105"></span></p>    </div>    <div class="tiledSection">     <h3 id="navigation">Navigation<i class="anchor-icon anchor-icon-link" anchorid="navigation" tips="复制节点链接"></i></h3>          <p>当NavDestination不可见时，会将其子自定义组件设置成非激活态，修改状态变量不会触发冻结组件的刷新。当返回该页面时，其子自定义组件重新恢复成激活态，触发@Monitor回调进行刷新。</p>     <p>需要注意：本文档里说的“激活（active）/非激活（inactive）”是指组件冻结的激活/非激活状态，和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-components-navdestination" target="_blank">NavDestination</a>组件中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-components-navdestination#onactive17" target="_blank">onActive</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-components-navdestination#oninactive17" target="_blank">onInactive</a>不同。</p>     <div _ngcontent-lxs-c106="" class="highlight-div"><div _ngcontent-lxs-c106="" class="highlight-div-header"><div _ngcontent-lxs-c106="" class="highlight-div-header-left"><div _ngcontent-lxs-c106="" class="handle-button expand-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lxs-c106="" class="highlight-div-header-right"><div _ngcontent-lxs-c106="" class="handle-button ai-button"></div><div _ngcontent-lxs-c106="" class="handle-button line-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lxs-c106="" class="handle-button theme-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lxs-c106="" class="handle-button copy-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lxs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">MyNavigationTestStack</span> {</li><li>  <span class="hljs-meta">@Provider</span>(<span class="hljs-string">'pageInfo'</span>) <span class="hljs-attr">pageInfo</span>: <span class="hljs-title class_">NavPathStack</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NavPathStack</span>();</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-meta">@Monitor</span>(<span class="hljs-string">'message'</span>) <span class="hljs-title function_">info</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`freeze-test MyNavigation message callback <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.message}</span>`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-meta">@Builder</span></li><li>  <span class="hljs-title class_">PageMap</span>(<span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>) {</li><li>    <span class="hljs-keyword">if</span> (name === <span class="hljs-string">'pageOne'</span>) {</li><li>      <span class="hljs-title class_">PageOneStack</span>({ <span class="hljs-attr">message</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> })</li><li>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (name === <span class="hljs-string">'pageTwo'</span>) {</li><li>      <span class="hljs-title class_">PageTwoStack</span>({ <span class="hljs-attr">message</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> })</li><li>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (name === <span class="hljs-string">'pageThree'</span>) {</li><li>      <span class="hljs-title class_">PageThreeStack</span>({ <span class="hljs-attr">message</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> })</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change message'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>++;</li><li>        })</li><li>      <span class="hljs-title class_">Navigation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span>) {</li><li>        <span class="hljs-title class_">Column</span>() {</li><li>          <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Next Page'</span>, { <span class="hljs-attr">stateEffect</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span> })</li><li>            .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span>.<span class="hljs-title function_">pushPath</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'pageOne'</span> }); <span class="hljs-comment">//将name指定的NavDestination页面信息入栈</span></li><li>            })</li><li>        }</li><li>      }.<span class="hljs-title function_">title</span>(<span class="hljs-string">'NavIndex'</span>)</li><li>      .<span class="hljs-title function_">navDestination</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">PageMap</span>)</li><li>      .<span class="hljs-title function_">mode</span>(<span class="hljs-title class_">NavigationMode</span>.<span class="hljs-property">Stack</span>)</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">PageOneStack</span> {</li><li>  <span class="hljs-meta">@Consumer</span>(<span class="hljs-string">'pageInfo'</span>) <span class="hljs-attr">pageInfo</span>: <span class="hljs-title class_">NavPathStack</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NavPathStack</span>();</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">NavDestination</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">NavigationContentMsgStack</span>({ <span class="hljs-attr">message</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>, <span class="hljs-attr">index</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">index</span> })</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'cur stack size:'</span> + <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.pageInfo.size()}</span>`</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Next Page'</span>, { <span class="hljs-attr">stateEffect</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span> })</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span>.<span class="hljs-title function_">pushPathByName</span>(<span class="hljs-string">'pageTwo'</span>, <span class="hljs-literal">null</span>);</li><li>          })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Back Page'</span>, { <span class="hljs-attr">stateEffect</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span> })</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span>.<span class="hljs-title function_">pop</span>();</li><li>          })</li><li>      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    }.<span class="hljs-title function_">title</span>(<span class="hljs-string">'pageOne'</span>)</li><li>    .<span class="hljs-title function_">onBackPressed</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span>.<span class="hljs-title function_">pop</span>();</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</li><li>    })</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">PageTwoStack</span> {</li><li>  <span class="hljs-meta">@Consumer</span>(<span class="hljs-string">'pageInfo'</span>) <span class="hljs-attr">pageInfo</span>: <span class="hljs-title class_">NavPathStack</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NavPathStack</span>();</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">2</span>;</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">NavDestination</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">NavigationContentMsgStack</span>({ <span class="hljs-attr">message</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>, <span class="hljs-attr">index</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">index</span> })</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'cur stack size:'</span> + <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.pageInfo.size()}</span>`</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Next Page'</span>, { <span class="hljs-attr">stateEffect</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span> })</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span>.<span class="hljs-title function_">pushPathByName</span>(<span class="hljs-string">'pageThree'</span>, <span class="hljs-literal">null</span>);</li><li>          })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Back Page'</span>, { <span class="hljs-attr">stateEffect</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span> })</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span>.<span class="hljs-title function_">pop</span>();</li><li>          })</li><li>      }</li><li>    }.<span class="hljs-title function_">title</span>(<span class="hljs-string">'pageTwo'</span>)</li><li>    .<span class="hljs-title function_">onBackPressed</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span>.<span class="hljs-title function_">pop</span>();</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</li><li>    })</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">PageThreeStack</span> {</li><li>  <span class="hljs-meta">@Consumer</span>(<span class="hljs-string">'pageInfo'</span>) <span class="hljs-attr">pageInfo</span>: <span class="hljs-title class_">NavPathStack</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NavPathStack</span>();</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">3</span>;</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">NavDestination</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">NavigationContentMsgStack</span>({ <span class="hljs-attr">message</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>, <span class="hljs-attr">index</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">index</span> })</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'cur stack size:'</span> + <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.pageInfo.size()}</span>`</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Next Page'</span>, { <span class="hljs-attr">stateEffect</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span> })</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span>.<span class="hljs-title function_">pushPathByName</span>(<span class="hljs-string">'pageOne'</span>, <span class="hljs-literal">null</span>);</li><li>          })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Back Page'</span>, { <span class="hljs-attr">stateEffect</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span> })</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span>.<span class="hljs-title function_">pop</span>();</li><li>          })</li><li>      }</li><li>    }.<span class="hljs-title function_">title</span>(<span class="hljs-string">'pageThree'</span>)</li><li>    .<span class="hljs-title function_">onBackPressed</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span>.<span class="hljs-title function_">pop</span>();</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</li><li>    })</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@ComponentV2</span>({ <span class="hljs-attr">freezeWhenInactive</span>: <span class="hljs-literal">true</span> })</li><li>struct <span class="hljs-title class_">NavigationContentMsgStack</span> {</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-meta">@Monitor</span>(<span class="hljs-string">'message'</span>) <span class="hljs-title function_">info</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`freeze-test NavigationContent message callback <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.message}</span>`</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`freeze-test ---- called by content <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.index}</span>`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">'msg:'</span> + <span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.message}</span>`</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>在上面的示例中：</p>     <p>1.点击change message更改message的值，当前正在显示的MyNavigationTestStack组件中@Monitor注册的方法info被触发。</p>     <p>2.点击Next Page切换到PageOne，创建PageOneStack节点。</p>     <p>3.再次点击change message更改message的值，仅PageOneStack中的NavigationContentMsgStack子组件中@Monitor注册的方法info被触发。</p>     <p>4.再次点击Next Page切换到PageTwo，创建PageTwoStack节点。PageOneStack节点状态由active变为inactive。</p>     <p>5.再次点击change message更改message的值，仅PageTwoStack中的NavigationContentMsgStack子组件中@Monitor注册的方法info被触发。Navigation路由栈中非栈顶的NavDestination中的子自定义组件是inactive状态，@Monitor方法不会触发。</p>     <p>6.再次点击Next Page切换到PageThree，创建PageThreeStack节点。PageTwoStack节点状态由active变为inactive。</p>     <p>7.再次点击change message更改message的值，仅PageThreeStack中的NavigationContentMsgStack子组件中@Monitor注册的方法info被触发。Navigation路由栈中非栈顶的NavDestination中的子自定义组件是inactive状态，@Monitor方法不会触发。</p>     <p>8.点击Back Page回到PageTwo，此时，PageTwoStack节点状态由inactive变为active，其NavigationContentMsgStack子组件中@Monitor注册的方法info被触发。</p>     <p>9.再次点击Back Page回到PageOne，此时，PageOneStack节点状态由inactive变为active，其NavigationContentMsgStack子组件中@Monitor注册的方法info被触发。</p>     <p>10.再次点击Back Page回到初始页，此时，无任何触发。</p>     <p><span><img originheight="461" originwidth="1567" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115000.97557906878134186269351633336984:50001231000000:2800:78FC52FB4BCA07EA17F902482B46B7B0D8891293A7B61A589006B467575FAD75.gif" width="920" height="270.6573069559668"></span></p>    </div>    <div class="tiledSection">     <h3 id="repeat">Repeat<i class="anchor-icon anchor-icon-link" anchorid="repeat" tips="复制节点链接"></i></h3>          <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>Repeat从API version 18开始支持自定义组件冻结。</p>      </div></div></div>     <p>对Repeat缓存池中的自定义组件进行冻结，避免不必要的组件刷新。建议提前阅读<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-new-rendering-control-repeat#节点更新复用能力说明">Repeat节点更新/复用能力说明</a>。</p>     <div _ngcontent-lxs-c106="" class="highlight-div"><div _ngcontent-lxs-c106="" class="highlight-div-header"><div _ngcontent-lxs-c106="" class="highlight-div-header-left"><div _ngcontent-lxs-c106="" class="handle-button expand-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lxs-c106="" class="highlight-div-header-right"><div _ngcontent-lxs-c106="" class="handle-button ai-button"></div><div _ngcontent-lxs-c106="" class="handle-button line-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lxs-c106="" class="handle-button theme-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lxs-c106="" class="handle-button copy-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lxs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">RepeatVirtualScrollFreeze</span> {</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">simpleList</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-built_in">string</span>&gt; = [];</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">bgColor</span>: <span class="hljs-title class_">Color</span> = <span class="hljs-title class_">Color</span>.<span class="hljs-property">Pink</span>;</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">7</span>; i++) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">simpleList</span>.<span class="hljs-title function_">push</span>(<span class="hljs-string">`item<span class="hljs-subst">${i}</span>`</span>);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Reduce length to 5'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">simpleList</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">simpleList</span>.<span class="hljs-title function_">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">5</span>);</li><li>          })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Change bgColor'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">bgColor</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">bgColor</span> == <span class="hljs-title class_">Color</span>.<span class="hljs-property">Pink</span> ? <span class="hljs-title class_">Color</span>.<span class="hljs-property">Blue</span> : <span class="hljs-title class_">Color</span>.<span class="hljs-property">Pink</span>;</li><li>          })</li><li>      }</li><li>
</li><li>      <span class="hljs-title class_">List</span>() {</li><li>        <span class="hljs-title class_">Repeat</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">simpleList</span>)</li><li>          .<span class="hljs-title function_">each</span>(<span class="hljs-function">(<span class="hljs-params">obj: RepeatItem&lt;<span class="hljs-built_in">string</span>&gt;</span>) =&gt;</span> {</li><li>          })</li><li>          .<span class="hljs-title function_">key</span>(<span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">string</span>, index: <span class="hljs-built_in">number</span></span>) =&gt;</span> item)</li><li>          .<span class="hljs-title function_">virtualScroll</span>({ <span class="hljs-attr">totalCount</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">simpleList</span>.<span class="hljs-property">length</span> })</li><li>          .<span class="hljs-title function_">templateId</span>(<span class="hljs-function">() =&gt;</span> <span class="hljs-string">'a'</span>)</li><li>          .<span class="hljs-title function_">template</span>(<span class="hljs-string">'a'</span>, <span class="hljs-function">(<span class="hljs-params">ri</span>) =&gt;</span> {</li><li>            <span class="hljs-title class_">ChildComponent</span>({</li><li>              <span class="hljs-attr">message</span>: ri.<span class="hljs-property">item</span>,</li><li>              <span class="hljs-attr">bgColor</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">bgColor</span></li><li>            })</li><li>          }, { <span class="hljs-attr">cachedCount</span>: <span class="hljs-number">2</span> })</li><li>      }</li><li>      .<span class="hljs-title function_">cachedCount</span>(<span class="hljs-number">0</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-number">500</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-comment">// 开启组件冻结</span></li><li><span class="hljs-meta">@ComponentV2</span>({ <span class="hljs-attr">freezeWhenInactive</span>: <span class="hljs-literal">true</span> })</li><li>struct <span class="hljs-title class_">ChildComponent</span> {</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-meta">@Require</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-meta">@Require</span> <span class="hljs-attr">bgColor</span>: <span class="hljs-title class_">Color</span> = <span class="hljs-title class_">Color</span>.<span class="hljs-property">Pink</span>;</li><li>  <span class="hljs-meta">@Monitor</span>(<span class="hljs-string">'bgColor'</span>)</li><li>  <span class="hljs-title function_">onBgColorChange</span>(<span class="hljs-params">monitor: IMonitor</span>) {</li><li>    <span class="hljs-comment">// bgColor改变时，缓存池中组件不刷新，不会打印日志</span></li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`repeat---bgColor change from <span class="hljs-subst">${monitor.value()?.before}</span> to <span class="hljs-subst">${monitor.value()?.now}</span>`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Text</span>(<span class="hljs-string">`[a]: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.message}</span>`</span>)</li><li>      .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">50</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">bgColor</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>在上面的示例中：</p>     <p>点击Reduce length to 5后，被移除的两个组件会进入Repeat缓存池，然后点击Change bgColor更改bgColor的值触发节点刷新。</p>     <p>开启组件冻结（freezeWhenInactive: true），只有剩余节点中@Monitor装饰的方法onBgColorChange被触发，如示例中屏上的5个节点会刷新并打印5条日志，缓存池中的节点则不会。</p>     <p><span><img originheight="508" originwidth="1520" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115000.16228681536762084288383132604100:50001231000000:2800:235CA5E3C89EE552A676253731637AB470335A651EA0325DA4E832650652B3E6.gif" width="920" height="307.4736842105263"></span></p>     <div _ngcontent-lxs-c106="" class="highlight-div"><div _ngcontent-lxs-c106="" class="highlight-div-header"><div _ngcontent-lxs-c106="" class="highlight-div-header-left"><div _ngcontent-lxs-c106="" class="handle-button expand-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lxs-c106="" class="highlight-div-header-right"><div _ngcontent-lxs-c106="" class="handle-button ai-button"></div><div _ngcontent-lxs-c106="" class="handle-button line-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lxs-c106="" class="handle-button theme-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lxs-c106="" class="handle-button copy-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lxs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 关闭组件冻结</span></li><li><span class="hljs-meta">@ComponentV2</span>({ <span class="hljs-attr">freezeWhenInactive</span>: <span class="hljs-literal">false</span> })</li><li>struct <span class="hljs-title class_">ChildComponent</span> {</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-meta">@Require</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-meta">@Require</span> <span class="hljs-attr">bgColor</span>: <span class="hljs-title class_">Color</span> = <span class="hljs-title class_">Color</span>.<span class="hljs-property">Pink</span>;</li><li>  <span class="hljs-meta">@Monitor</span>(<span class="hljs-string">'bgColor'</span>)</li><li>  <span class="hljs-title function_">onBgColorChange</span>(<span class="hljs-params">monitor: IMonitor</span>) {</li><li>    <span class="hljs-comment">// bgColor改变时，缓存池组件也会刷新，并打印日志</span></li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`repeat---bgColor change from <span class="hljs-subst">${monitor.value()?.before}</span> to <span class="hljs-subst">${monitor.value()?.now}</span>`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Text</span>(<span class="hljs-string">`[a]: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.message}</span>`</span>)</li><li>      .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">50</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">bgColor</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>不开启组件冻结（freezeWhenInactive: false，当未指定freezeWhenInactive参数时默认不开启组件冻结），剩余节点和缓存池节点中@Monitor装饰的方法onBgColorChange都会被触发，即会有7个节点会刷新并打印7条日志。</p>     <p><span><img originheight="508" originwidth="1520" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115000.44104626221822631712377290277164:50001231000000:2800:30817A01FD547606C1BE4E43C743F4B93E5890E3916837149E7E3C7E20653B02.gif" width="920" height="307.4736842105263"></span></p>    </div>    <div class="tiledSection">     <h3 id="仅子组件开启组件冻结">仅子组件开启组件冻结<i class="anchor-icon anchor-icon-link" anchorid="仅子组件开启组件冻结" tips="复制节点链接"></i></h3>          <p>如果开发者只想冻结某个子组件，可以选择只在子组件设置freezeWhenInactive为true。</p>     <div _ngcontent-lxs-c106="" class="highlight-div"><div _ngcontent-lxs-c106="" class="highlight-div-header"><div _ngcontent-lxs-c106="" class="highlight-div-header-left"><div _ngcontent-lxs-c106="" class="handle-button expand-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lxs-c106="" class="highlight-div-header-right"><div _ngcontent-lxs-c106="" class="handle-button ai-button"></div><div _ngcontent-lxs-c106="" class="handle-button line-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lxs-c106="" class="handle-button theme-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lxs-c106="" class="handle-button copy-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lxs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Page1.ets</span></li><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Book</span> {</li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'TS'</span>;</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Page1</span> {</li><li>  <span class="hljs-attr">pageInfo</span>: <span class="hljs-title class_">NavPathStack</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NavPathStack</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Navigation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span>) {</li><li>        <span class="hljs-title class_">Child</span>()</li><li>
</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Go to next page'</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span>.<span class="hljs-title function_">pushPathByName</span>(<span class="hljs-string">'Page2'</span>, <span class="hljs-literal">null</span>);</li><li>          })</li><li>      }</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@ComponentV2</span>({ <span class="hljs-attr">freezeWhenInactive</span>: <span class="hljs-literal">true</span> })</li><li><span class="hljs-keyword">export</span> struct <span class="hljs-title class_">Child</span> {</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">bookTest</span>: <span class="hljs-title class_">Book</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Book</span>(<span class="hljs-string">`A Midsummer Night's Dream`</span>);</li><li>
</li><li>  <span class="hljs-meta">@Monitor</span>(<span class="hljs-string">'bookTest.name'</span>)</li><li>  <span class="hljs-title function_">onMessageChange</span>(<span class="hljs-params">monitor: IMonitor</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`The book name change from <span class="hljs-subst">${monitor.value()?.before}</span> to <span class="hljs-subst">${monitor.value()?.now}</span>`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">textUpdate</span>(): <span class="hljs-built_in">number</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'The text is update'</span>);</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-number">25</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`The book name is <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.bookTest.name}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">textUpdate</span>())</li><li>
</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change BookName'</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">bookTest</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Book</span>(<span class="hljs-string">`Jane Austen's Pride and Prejudice`</span>);</li><li>          }, <span class="hljs-number">3000</span>);</li><li>        })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <div _ngcontent-lxs-c106="" class="highlight-div"><div _ngcontent-lxs-c106="" class="highlight-div-header"><div _ngcontent-lxs-c106="" class="highlight-div-header-left"><div _ngcontent-lxs-c106="" class="handle-button expand-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lxs-c106="" class="highlight-div-header-right"><div _ngcontent-lxs-c106="" class="handle-button ai-button"></div><div _ngcontent-lxs-c106="" class="handle-button line-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lxs-c106="" class="handle-button theme-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lxs-c106="" class="handle-button copy-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lxs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Page2.ets</span></li><li><span class="hljs-meta">@Builder</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">Page2Builder</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-title class_">Page2</span>()</li><li>}</li><li>
</li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Page2</span> {</li><li>  <span class="hljs-attr">pathStack</span>: <span class="hljs-title class_">NavPathStack</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NavPathStack</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">NavDestination</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'This is the Page2'</span>)</li><li>
</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Back'</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">pathStack</span>.<span class="hljs-title function_">pop</span>();</li><li>          })</li><li>      }</li><li>    }.<span class="hljs-title function_">onReady</span>(<span class="hljs-function">(<span class="hljs-params">context: NavDestinationContext</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">pathStack</span> = context.<span class="hljs-property">pathStack</span>;</li><li>    })</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>使用Navigation时，需要添加配置系统路由表文件src/main/resources/base/profile/route_map.json，并替换pageSourceFile为Page2页面的路径，并且在module.json5中添加："routerMap": "$profile:route_map"。</p>     <div _ngcontent-lxs-c106="" class="highlight-div"><div _ngcontent-lxs-c106="" class="highlight-div-header"><div _ngcontent-lxs-c106="" class="highlight-div-header-left"><div _ngcontent-lxs-c106="" class="handle-button expand-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lxs-c106="" class="highlight-div-header-right"><div _ngcontent-lxs-c106="" class="handle-button ai-button"></div><div _ngcontent-lxs-c106="" class="handle-button line-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lxs-c106="" class="handle-button theme-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lxs-c106="" class="handle-button copy-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lxs-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"routerMap"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>    <span class="hljs-punctuation">{</span></li><li>      <span class="hljs-attr">"name"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Page2"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"pageSourceFile"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"src/main/ets/pages/Page2.ets"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"buildFunction"</span><span class="hljs-punctuation">:</span> <span class="hljs-string">"Page2Builder"</span><span class="hljs-punctuation">,</span></li><li>      <span class="hljs-attr">"data"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">{</span></li><li>        <span class="hljs-attr">"description"</span> <span class="hljs-punctuation">:</span> <span class="hljs-string">"This is the Page2"</span></li><li>      <span class="hljs-punctuation">}</span></li><li>    <span class="hljs-punctuation">}</span></li><li>  <span class="hljs-punctuation">]</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div>     <p>在上面的示例中：</p>     <ul>      <li>Page1的子组件Child，设置freezeWhenInactive: true, 开启了组件冻结功能。</li>      <li>点击change BookName，然后3s内点击Go to next page。在更新bookTest的时候，已经跳转到Page2，Page1的组件处于inactive状态，又因为Child组件开启了组件冻结，状态变量@Local bookTest将不响应更新，其@Monitor装饰的回调方法不会被调用，状态变量关联的组件不会刷新。</li>      <li>点击Back回到前一个页面，调用@Monitor装饰的回调方法，状态变量关联的组件刷新。</li>     </ul>    </div>    <div class="tiledSection">     <h3 id="混用场景">混用场景<i class="anchor-icon anchor-icon-link" anchorid="混用场景" tips="复制节点链接"></i></h3>          <p>当支持组件冻结的场景彼此之间组合使用时，对于不同的API版本，冻结行为会有不同。给父组件设置组件冻结标志，在API version 17及以下，当父组件解冻时，会解冻自己子组件所有的节点；从API version 18开始，父组件解冻时，只会解冻子组件的屏上节点，详细说明见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-custom-components-freeze#组件混用">@Component的自定义组件冻结的混用场景</a>。</p>     <p><strong>Navigation和TabContent的混用</strong></p>     <div _ngcontent-lxs-c106="" class="highlight-div"><div _ngcontent-lxs-c106="" class="highlight-div-header"><div _ngcontent-lxs-c106="" class="highlight-div-header-left"><div _ngcontent-lxs-c106="" class="handle-button expand-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lxs-c106="" class="highlight-div-header-right"><div _ngcontent-lxs-c106="" class="handle-button ai-button"></div><div _ngcontent-lxs-c106="" class="handle-button line-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lxs-c106="" class="handle-button theme-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lxs-c106="" class="handle-button copy-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lxs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">ChildOfParamComponent</span> {</li><li>  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">child_val</span>: <span class="hljs-built_in">number</span>;</li><li>
</li><li>  <span class="hljs-meta">@Monitor</span>(<span class="hljs-string">'child_val'</span>) <span class="hljs-title function_">onChange</span>(<span class="hljs-params">m: IMonitor</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Appmonitor ChildOfParamComponent: changed <span class="hljs-subst">${m.dirty[<span class="hljs-number">0</span>]}</span>: <span class="hljs-subst">${m.value()?.before}</span> -&gt; <span class="hljs-subst">${m.value()?.now}</span>`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Child Param： <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.child_val}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">ParamComponent</span> {</li><li>  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">val</span>: <span class="hljs-built_in">number</span>;</li><li>
</li><li>  <span class="hljs-meta">@Monitor</span>(<span class="hljs-string">'val'</span>) <span class="hljs-title function_">onChange</span>(<span class="hljs-params">m: IMonitor</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Appmonitor ParamComponent: changed <span class="hljs-subst">${m.dirty[<span class="hljs-number">0</span>]}</span>: <span class="hljs-subst">${m.value()?.before}</span> -&gt; <span class="hljs-subst">${m.value()?.now}</span>`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`val： <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.val}</span>`</span>);</li><li>      <span class="hljs-title class_">ChildOfParamComponent</span>({<span class="hljs-attr">child_val</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">val</span>});</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">DelayComponent</span> {</li><li>  <span class="hljs-meta">@Require</span> <span class="hljs-meta">@Param</span> <span class="hljs-attr">delayVal1</span>: <span class="hljs-built_in">number</span>;</li><li>
</li><li>  <span class="hljs-meta">@Monitor</span>(<span class="hljs-string">'delayVal1'</span>) <span class="hljs-title function_">onChange</span>(<span class="hljs-params">m: IMonitor</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Appmonitor DelayComponent: changed <span class="hljs-subst">${m.dirty[<span class="hljs-number">0</span>]}</span>: <span class="hljs-subst">${m.value()?.before}</span> -&gt; <span class="hljs-subst">${m.value()?.now}</span>`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`Delay Param： <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.delayVal1}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@ComponentV2</span> ({<span class="hljs-attr">freezeWhenInactive</span>: <span class="hljs-literal">true</span>})</li><li>struct <span class="hljs-title class_">TabsComponent</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">controller</span>: <span class="hljs-title class_">TabsController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TabsController</span>();</li><li>  <span class="hljs-meta">@Local</span> <span class="hljs-attr">tabState</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">47</span>;</li><li>
</li><li>  <span class="hljs-meta">@Monitor</span>(<span class="hljs-string">'tabState'</span>) <span class="hljs-title function_">onChange</span>(<span class="hljs-params">m: IMonitor</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Appmonitor TabsComponent: changed <span class="hljs-subst">${m.dirty[<span class="hljs-number">0</span>]}</span>: <span class="hljs-subst">${m.value()?.before}</span> -&gt; <span class="hljs-subst">${m.value()?.now}</span>`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>({<span class="hljs-attr">space</span>: <span class="hljs-number">10</span>}) {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">`Incr state <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.tabState}</span>`</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">25</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Button increment state value'</span>);</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">tabState</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">tabState</span> + <span class="hljs-number">1</span>;</li><li>        })</li><li>
</li><li>      <span class="hljs-title class_">Tabs</span>({ <span class="hljs-attr">barPosition</span>: <span class="hljs-title class_">BarPosition</span>.<span class="hljs-property">Start</span>, <span class="hljs-attr">index</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>}) {</li><li>        <span class="hljs-title class_">TabContent</span>() {</li><li>          <span class="hljs-title class_">ParamComponent</span>({<span class="hljs-attr">val</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">tabState</span>});</li><li>        }.<span class="hljs-title function_">tabBar</span>(<span class="hljs-string">'Update'</span>)</li><li>        <span class="hljs-title class_">TabContent</span>() {</li><li>          <span class="hljs-title class_">DelayComponent</span>({<span class="hljs-attr">delayVal1</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">tabState</span>});</li><li>        }.<span class="hljs-title function_">tabBar</span>(<span class="hljs-string">'DelayUpdate'</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">vertical</span>(<span class="hljs-literal">false</span>)</li><li>      .<span class="hljs-title function_">scrollable</span>(<span class="hljs-literal">true</span>)</li><li>      .<span class="hljs-title function_">barMode</span>(<span class="hljs-title class_">BarMode</span>.<span class="hljs-property">Fixed</span>)</li><li>      .<span class="hljs-title function_">barWidth</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">barHeight</span>(<span class="hljs-number">150</span>).<span class="hljs-title function_">animationDuration</span>(<span class="hljs-number">400</span>)</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-number">200</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0xF5F5F5</span>)</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">MyNavigationTestStack</span> {</li><li>  <span class="hljs-meta">@Provide</span>(<span class="hljs-string">'pageInfo'</span>) <span class="hljs-attr">pageInfo</span>: <span class="hljs-title class_">NavPathStack</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NavPathStack</span>();</li><li>
</li><li>  <span class="hljs-meta">@Builder</span></li><li>  <span class="hljs-title class_">PageMap</span>(<span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>) {</li><li>    <span class="hljs-keyword">if</span> (name === <span class="hljs-string">'pageOne'</span>) {</li><li>      <span class="hljs-title class_">PageOneStack</span>()</li><li>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (name === <span class="hljs-string">'pageTwo'</span>) {</li><li>      <span class="hljs-title class_">PageTwoStack</span>()</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Navigation</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span>) {</li><li>        <span class="hljs-title class_">Column</span>() {</li><li>          <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Next Page'</span>, { <span class="hljs-attr">stateEffect</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span> })</li><li>            .<span class="hljs-title function_">width</span>(<span class="hljs-string">'80%'</span>)</li><li>            .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>            .<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>            .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span>.<span class="hljs-title function_">pushPath</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'pageOne'</span> }); <span class="hljs-comment">//将name指定的NavDestination页面信息入栈</span></li><li>            })</li><li>        }</li><li>      }.<span class="hljs-title function_">title</span>(<span class="hljs-string">'NavIndex'</span>)</li><li>      .<span class="hljs-title function_">navDestination</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">PageMap</span>)</li><li>      .<span class="hljs-title function_">mode</span>(<span class="hljs-title class_">NavigationMode</span>.<span class="hljs-property">Stack</span>)</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">PageOneStack</span> {</li><li>  <span class="hljs-meta">@Consume</span>(<span class="hljs-string">'pageInfo'</span>) <span class="hljs-attr">pageInfo</span>: <span class="hljs-title class_">NavPathStack</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">NavDestination</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">TabsComponent</span>();</li><li>
</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Next Page'</span>, { <span class="hljs-attr">stateEffect</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span> })</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'80%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>          .<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span>.<span class="hljs-title function_">pushPathByName</span>(<span class="hljs-string">'pageTwo'</span>, <span class="hljs-literal">null</span>);</li><li>          })</li><li>      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    }.<span class="hljs-title function_">title</span>(<span class="hljs-string">'pageOne'</span>)</li><li>    .<span class="hljs-title function_">onBackPressed</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span>.<span class="hljs-title function_">pop</span>();</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</li><li>    })</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">PageTwoStack</span> {</li><li>  <span class="hljs-meta">@Consume</span>(<span class="hljs-string">'pageInfo'</span>) <span class="hljs-attr">pageInfo</span>: <span class="hljs-title class_">NavPathStack</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">NavDestination</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Back Page'</span>, { <span class="hljs-attr">stateEffect</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span> })</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'80%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>          .<span class="hljs-title function_">margin</span>(<span class="hljs-number">20</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span>.<span class="hljs-title function_">pop</span>();</li><li>          })</li><li>      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    }.<span class="hljs-title function_">title</span>(<span class="hljs-string">'pageTwo'</span>)</li><li>    .<span class="hljs-title function_">onBackPressed</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span>.<span class="hljs-title function_">pop</span>();</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</li><li>    })</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>在API version 17及以下：</p>     <p>点击Next page进入下一个页面并返回，会解冻Tabcontent所有的标签。</p>     <p>在API version 18及以上：</p>     <p>点击Next page进入下一个页面并返回，只会解冻对应标签的节点。</p>    </div>    <div class="tiledSection">     <h2 id="限制条件">限制条件<i class="anchor-icon anchor-icon-link" anchorid="限制条件" tips="复制节点链接"></i></h2>          <p>如下面的例子所示，FreezeBuildNode中使用了自定义节点<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-arkui-buildernode" target="_blank">BuilderNode</a>。BuilderNode可以通过命令式动态挂载组件，而组件冻结又是强依赖父子关系来通知是否开启组件冻结。如果父组件使用组件冻结，且组件树的中间层级上又启用了BuilderNode，则BuilderNode的子组件将无法被冻结。</p>     <div _ngcontent-lxs-c106="" class="highlight-div"><div _ngcontent-lxs-c106="" class="highlight-div-header"><div _ngcontent-lxs-c106="" class="highlight-div-header-left"><div _ngcontent-lxs-c106="" class="handle-button expand-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lxs-c106="" class="highlight-div-header-right"><div _ngcontent-lxs-c106="" class="handle-button ai-button"></div><div _ngcontent-lxs-c106="" class="handle-button line-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lxs-c106="" class="handle-button theme-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lxs-c106="" class="handle-button copy-button"><div _ngcontent-lxs-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lxs-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BuilderNode</span>, <span class="hljs-title class_">FrameNode</span>, <span class="hljs-title class_">NodeController</span>, <span class="hljs-title class_">UIContext</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-comment">// 定义一个Params类，用于传递参数</span></li><li><span class="hljs-meta">@ObservedV2</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Params</span> {</li><li>  <span class="hljs-comment">// 单例模式，确保只有一个Params实例</span></li><li>  <span class="hljs-keyword">static</span> <span class="hljs-attr">singleton_</span>: <span class="hljs-title class_">Params</span>;</li><li>
</li><li>  <span class="hljs-comment">// 获取Params实例的方法</span></li><li>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">instance</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">Params</span>.<span class="hljs-property">singleton_</span>) {</li><li>      <span class="hljs-title class_">Params</span>.<span class="hljs-property">singleton_</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Params</span>(<span class="hljs-number">0</span>);</li><li>    }</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Params</span>.<span class="hljs-property">singleton_</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 使用@Trace装饰器装饰message属性，以便跟踪其变化</span></li><li>  <span class="hljs-meta">@Trace</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello'</span>;</li><li>  <span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">index: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">index</span> = index;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-comment">// 定义一个buildNodeChild组件，它包含一个storage属性和一个index属性</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct buildNodeChild {</li><li>  <span class="hljs-comment">// 使用Params实例作为storage属性</span></li><li>  <span class="hljs-attr">storage</span>: <span class="hljs-title class_">Params</span> = <span class="hljs-title class_">Params</span>.<span class="hljs-title function_">instance</span>();</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-comment">// 使用@Monitor装饰器监听storage.message的变化</span></li><li>  <span class="hljs-meta">@Monitor</span>(<span class="hljs-string">'storage.message'</span>)</li><li>  <span class="hljs-title function_">onMessageChange</span>(<span class="hljs-params">monitor: IMonitor</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`FreezeBuildNode buildNodeChild message callback func <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.storage.message}</span>, index:<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.index}</span>`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Text</span>(<span class="hljs-string">`buildNode Child message: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.storage.message}</span>`</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-comment">// 定义一个buildText函数，它接收一个Params参数并构建一个Column组件</span></li><li><span class="hljs-meta">@Builder</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">buildText</span>(<span class="hljs-params">params: Params</span>) {</li><li>  <span class="hljs-title class_">Column</span>() {</li><li>    <span class="hljs-title function_">buildNodeChild</span>({ <span class="hljs-attr">index</span>: params.<span class="hljs-property">index</span> })</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">TextNodeController</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">NodeController</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">textNode</span>: <span class="hljs-title class_">BuilderNode</span>&lt;[<span class="hljs-title class_">Params</span>]&gt; | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>  </li><li>  <span class="hljs-comment">// 构造函数接收一个index参数</span></li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">index: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">super</span>();</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">index</span> = index;</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 创建并返回一个FrameNode</span></li><li>  <span class="hljs-title function_">makeNode</span>(<span class="hljs-attr">context</span>: <span class="hljs-title class_">UIContext</span>): <span class="hljs-title class_">FrameNode</span> | <span class="hljs-literal">null</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">textNode</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">BuilderNode</span>(context);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">textNode</span>.<span class="hljs-title function_">build</span>(wrapBuilder&lt;[<span class="hljs-title class_">Params</span>]&gt;(buildText), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Params</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">index</span>));</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">textNode</span>.<span class="hljs-title function_">getFrameNode</span>();</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-comment">// 定义一个Index组件，它包含一个message属性和一个data数组</span></li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@ComponentV2</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-comment">// 使用Params实例作为storage属性</span></li><li>  <span class="hljs-attr">storage</span>: <span class="hljs-title class_">Params</span> = <span class="hljs-title class_">Params</span>.<span class="hljs-title function_">instance</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">data</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">0</span>, <span class="hljs-number">1</span>];</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change'</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">storage</span>.<span class="hljs-property">message</span> += <span class="hljs-string">'a'</span>;</li><li>          })</li><li>
</li><li>        <span class="hljs-title class_">Tabs</span>() {</li><li>          <span class="hljs-comment">// 使用Repeat重复渲染TabContent组件</span></li><li>          <span class="hljs-title class_">Repeat</span>&lt;<span class="hljs-built_in">number</span>&gt;(<span class="hljs-variable language_">this</span>.<span class="hljs-property">data</span>)</li><li>            .<span class="hljs-title function_">each</span>(<span class="hljs-function">(<span class="hljs-params">obj: RepeatItem&lt;<span class="hljs-built_in">number</span>&gt;</span>) =&gt;</span> {</li><li>              <span class="hljs-title class_">TabContent</span>() {</li><li>                <span class="hljs-title class_">FreezeBuildNode</span>({ <span class="hljs-attr">index</span>: obj.<span class="hljs-property">item</span> })</li><li>                  .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">20</span> })</li><li>              }.<span class="hljs-title function_">tabBar</span>(<span class="hljs-string">`tab<span class="hljs-subst">${obj.item}</span>`</span>)</li><li>            })</li><li>            .<span class="hljs-title function_">key</span>(<span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> item.<span class="hljs-title function_">toString</span>())</li><li>        }</li><li>      }</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-comment">// 定义一个FreezeBuildNode组件，它包含一个message属性和一个index属性</span></li><li><span class="hljs-meta">@ComponentV2</span>({ <span class="hljs-attr">freezeWhenInactive</span>: <span class="hljs-literal">true</span> })</li><li>struct <span class="hljs-title class_">FreezeBuildNode</span> {</li><li>  <span class="hljs-comment">// 使用Params实例作为storage属性</span></li><li>  <span class="hljs-attr">storage</span>: <span class="hljs-title class_">Params</span> = <span class="hljs-title class_">Params</span>.<span class="hljs-title function_">instance</span>();</li><li>  <span class="hljs-meta">@Param</span> <span class="hljs-attr">index</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-comment">// 使用@Monitor装饰器监听storage.message的变化</span></li><li>  <span class="hljs-meta">@Monitor</span>(<span class="hljs-string">'storage.message'</span>)</li><li>  <span class="hljs-title function_">onMessageChange</span>(<span class="hljs-params">monitor: IMonitor</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`FreezeBuildNode message callback func <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.storage.message}</span>, index: <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.index}</span>`</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">NodeContainer</span>(<span class="hljs-keyword">new</span> <span class="hljs-title class_">TextNodeController</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">index</span>))</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#FFF0F0F0'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p>点击change，改变message的值，当前正在显示的TabContent组件中@Monitor注册的方法onMessageChange被触发。未显示的TabContent中的BuilderNode节点下组件的@Monitor方法onMessageChange也被触发，并没有被冻结。</p>     <p><span><img originheight="656" originwidth="1791" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115000.09887787960831971869208440394020:50001231000000:2800:38DBC9B7C58F315DDF2BCCFF25AE34724EF7E00BB7DECD3C0E44425E22E3D631.gif" width="920" height="336.9737576772753"></span></p>    </div>   </div>   <div></div></div>