<h1 _ngcontent-hif-c119="" class="doc-title ng-star-inserted" title="若开发者在游戏中使用Unity Addressables资源管理框架，如何集成游戏资源包后台下载功能？"> 若开发者在游戏中使用Unity Addressables资源管理框架，如何集成游戏资源包后台下载功能？ </h1>

<div _ngcontent-hif-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>Addressables资源加载机制是根据Addressables的缓存文件判定资源包是否已下载，若未下载再通过游戏资源包后台下载功能把资源文件下载到Addressables的缓存目录下。集成步骤如下：</p>    <ul>     <li>在游戏资源包下载的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-extensionability#section1643305731014" target="_blank">onDownloadContentRequest</a>生命周期函数中：      <ol>       <li>下载远端服务器上的Addressables的资源索引hash文件，与本地Addressables的hash文件做对比。</li>       <li>若hash值不一样，则表示有热更资源，准备进行资源更新，下载远端服务器上的Addressables的资源索引文件catalog.json文件。</li>       <li>将远端的catalog.json文件以及本地的catalog.json文件，按照catalog解析规则（具体可参考Addressables源码中ContentCatalogData.cs的解析实现）解析其中关键字段，diff后获取下载资源包列表信息。</li>       <li>把需要下载的资源列表信息转换成游戏资源包下载的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-assetdownloadmanager#section14401125712" target="_blank">AssetDownloadConfig</a>对象返回给系统。</li>       <li>把catalog.json，catalog.hash以及GroupData.json文件存放在Addressables目标目录下，目录地址参考如下：        <div _ngcontent-hif-c106="" class="highlight-div"><div _ngcontent-hif-c106="" class="highlight-div-header"><div _ngcontent-hif-c106="" class="highlight-div-header-left"><div _ngcontent-hif-c106="" class="handle-button expand-button"><div _ngcontent-hif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hif-c106="" class="highlight-div-header-right"><div _ngcontent-hif-c106="" class="handle-button ai-button"></div><div _ngcontent-hif-c106="" class="handle-button line-button"><div _ngcontent-hif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hif-c106="" class="handle-button theme-button"><div _ngcontent-hif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hif-c106="" class="handle-button copy-button"><div _ngcontent-hif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hif-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-swift" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-regexp">/data/</span>app<span class="hljs-regexp">/el2/</span><span class="hljs-operator">&lt;</span><span class="hljs-type">USERID</span><span class="hljs-operator">&gt;/</span>base<span class="hljs-regexp">/&lt;PACKAGENAME&gt;/</span>haps<span class="hljs-regexp">/entry/</span>files<span class="hljs-operator">/</span>com.unity.addressables</li></ol></pre></div></div></li>      </ol></li>     <li>在游戏资源包下载的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/graphics-accelerate-extensionability#section7400025191119" target="_blank">onBackgroundDownloadSucceeded</a>生命周期函数中：      <p>完成下载的资源文件按照Addressables缓存文件规则，转移到Addressables缓存目录下。缓存目录参考如下：</p>      <div _ngcontent-hif-c106="" class="highlight-div"><div _ngcontent-hif-c106="" class="highlight-div-header"><div _ngcontent-hif-c106="" class="highlight-div-header-left"><div _ngcontent-hif-c106="" class="handle-button expand-button"><div _ngcontent-hif-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-hif-c106="" class="highlight-div-header-right"><div _ngcontent-hif-c106="" class="handle-button ai-button"></div><div _ngcontent-hif-c106="" class="handle-button line-button"><div _ngcontent-hif-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-hif-c106="" class="handle-button theme-button"><div _ngcontent-hif-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-hif-c106="" class="handle-button copy-button"><div _ngcontent-hif-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-hif-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-swift" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 缓存目录规则：{缓存根目录}/{资源名称}/{资源哈希值}</span></li><li><span class="hljs-regexp">/data/</span>app<span class="hljs-regexp">/el2/</span><span class="hljs-operator">&lt;</span><span class="hljs-type">USERID</span><span class="hljs-operator">&gt;/</span>base<span class="hljs-regexp">/&lt;PACKAGENAME&gt;/</span>haps<span class="hljs-regexp">/entry/</span>files<span class="hljs-regexp">/TuanjieCache/</span><span class="hljs-type">Shared</span><span class="hljs-regexp">/feda8eb785f66e8cbfd86bda86dd111e/</span>d73e91fc7611459d41ea88e823492c08</li></ol></pre></div></div></li>    </ul>    <p></p>   </div>   <div></div></div>