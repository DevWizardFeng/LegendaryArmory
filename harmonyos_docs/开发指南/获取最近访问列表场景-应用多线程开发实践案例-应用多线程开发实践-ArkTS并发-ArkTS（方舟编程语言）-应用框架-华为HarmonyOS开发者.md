<h1 _ngcontent-bfa-c119="" class="doc-title ng-star-inserted" title="获取最近访问列表场景"> 获取最近访问列表场景 </h1>

<div _ngcontent-bfa-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>为了快速访问最近使用的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-sendable">Sendable</a>对象，从API version 18开始，ArkTS引入了<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-arkts-utils-sendablelrucache" target="_blank">SendableLruCache</a>。开发者可以通过向SendableLruCache实例中添加、删除和获取Sendable对象，实现快速访问最近使用的Sendable对象。本文提供使用SendableLruCache实现获取最近使用列表的开发指导，以书架为例，每次打开一本图书后，需将图书信息更新到最近访问列表中，并在下次访问书架页面时显示最近访问的图书列表。</p>    <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">      <p>使用SendableLruCache实例对象时需加锁，避免多线程同时操作导致数据不一致。</p>      <p>存放到SendableLruCache实例中的对象必须是Sendable对象。</p>     </div></div></div>    <ol>     <li>      <p>创建SendableLruCache实例对象，并根据业务需求预设最大容量。</p>      <p>此例设置SendableLruCache实例的最大容量为4，用SendableClass类管理，并导出SendableClass类实例对象。</p>      <div _ngcontent-bfa-c106="" class="highlight-div"><div _ngcontent-bfa-c106="" class="highlight-div-header"><div _ngcontent-bfa-c106="" class="highlight-div-header-left"><div _ngcontent-bfa-c106="" class="handle-button expand-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bfa-c106="" class="highlight-div-header-right"><div _ngcontent-bfa-c106="" class="handle-button ai-button"></div><div _ngcontent-bfa-c106="" class="handle-button line-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bfa-c106="" class="handle-button theme-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bfa-c106="" class="handle-button copy-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bfa-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// LruCache.ets</span></li><li>
</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ArkTSUtils</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-comment">// 使用use shared标记为共享模块。</span></li><li><span class="hljs-string">"use shared"</span></li><li>
</li><li><span class="hljs-comment">// SendableClass实例对象在不同线程间可共享。</span></li><li><span class="hljs-meta">@Sendable</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">SendableClass</span> {</li><li>  <span class="hljs-comment">// 使用SendableLruCache实例对象时需加锁，避免多线程同时操作导致数据不一致。</span></li><li>  <span class="hljs-attr">lock_</span>: <span class="hljs-title class_">ArkTSUtils</span>.<span class="hljs-property">locks</span>.<span class="hljs-property">AsyncLock</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArkTSUtils</span>.<span class="hljs-property">locks</span>.<span class="hljs-title class_">AsyncLock</span>();</li><li>  <span class="hljs-attr">books_</span>: <span class="hljs-title class_">ArkTSUtils</span>.<span class="hljs-property">SendableLruCache</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArkTSUtils</span>.<span class="hljs-property">SendableLruCache</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;(<span class="hljs-number">4</span>);</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">books_</span>.<span class="hljs-title function_">put</span>(<span class="hljs-string">"fourth"</span>, <span class="hljs-string">"Book4"</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">books_</span>.<span class="hljs-title function_">put</span>(<span class="hljs-string">"third"</span>, <span class="hljs-string">"Book3"</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">books_</span>.<span class="hljs-title function_">put</span>(<span class="hljs-string">"second"</span>, <span class="hljs-string">"Book2"</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">books_</span>.<span class="hljs-title function_">put</span>(<span class="hljs-string">"first"</span>, <span class="hljs-string">"Book1"</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// 封装put、get、keys方法，加锁操作。</span></li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">put</span>(<span class="hljs-params">key: <span class="hljs-built_in">string</span>, value: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-keyword">await</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">lock_</span>.<span class="hljs-title function_">lockAsync</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">books_</span>.<span class="hljs-title function_">put</span>(key, value);</li><li>    })</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">get</span>(<span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span>&gt; {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">lock_</span>.<span class="hljs-title function_">lockAsync</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">books_</span>.<span class="hljs-title function_">get</span>(key);</li><li>    });</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">async</span> <span class="hljs-title function_">keys</span>(): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-built_in">string</span>[]&gt; {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">lock_</span>.<span class="hljs-title function_">lockAsync</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">books_</span>.<span class="hljs-title function_">keys</span>();</li><li>    });</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">let</span> lruCache = <span class="hljs-keyword">new</span> <span class="hljs-title class_">SendableClass</span>();</li></ol></pre></div></div></li>     <li>      <p>在Index.ets页面同目录下创建4个图书页面，每个页面显示相应的图书信息，并将每个页面的路径注册到src/main/resources/base/profile/main_pages.json文件中。</p>      <div _ngcontent-bfa-c106="" class="highlight-div"><div _ngcontent-bfa-c106="" class="highlight-div-header"><div _ngcontent-bfa-c106="" class="highlight-div-header-left"><div _ngcontent-bfa-c106="" class="handle-button expand-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bfa-c106="" class="highlight-div-header-right"><div _ngcontent-bfa-c106="" class="handle-button ai-button"></div><div _ngcontent-bfa-c106="" class="handle-button line-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bfa-c106="" class="handle-button theme-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bfa-c106="" class="handle-button copy-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bfa-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Book1.ets</span></li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index1</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello World!'</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">RelativeContainer</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">"第一本书的内容"</span>)</li><li>        .<span class="hljs-title function_">id</span>(<span class="hljs-string">'first book'</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        .<span class="hljs-title function_">alignRules</span>({</li><li>          <span class="hljs-attr">center</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'container'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">VerticalAlign</span>.<span class="hljs-property">Center</span> },</li><li>          <span class="hljs-attr">middle</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'container'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Center</span> }</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"返回"</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        .<span class="hljs-title function_">position</span>({ <span class="hljs-attr">x</span>: <span class="hljs-string">"50%"</span> })</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getRouter</span>().<span class="hljs-title function_">pushUrl</span>({ <span class="hljs-attr">url</span>: <span class="hljs-string">'pages/Index'</span> });</li><li>        })</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>      <div _ngcontent-bfa-c106="" class="highlight-div"><div _ngcontent-bfa-c106="" class="highlight-div-header"><div _ngcontent-bfa-c106="" class="highlight-div-header-left"><div _ngcontent-bfa-c106="" class="handle-button expand-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bfa-c106="" class="highlight-div-header-right"><div _ngcontent-bfa-c106="" class="handle-button ai-button"></div><div _ngcontent-bfa-c106="" class="handle-button line-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bfa-c106="" class="handle-button theme-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bfa-c106="" class="handle-button copy-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bfa-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Book2.ets</span></li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index2</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello World!'</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">RelativeContainer</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">"第二本书的内容"</span>)</li><li>        .<span class="hljs-title function_">id</span>(<span class="hljs-string">'second book'</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        .<span class="hljs-title function_">alignRules</span>({</li><li>          <span class="hljs-attr">center</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'container'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">VerticalAlign</span>.<span class="hljs-property">Center</span> },</li><li>          <span class="hljs-attr">middle</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'container'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Center</span> }</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"返回"</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        .<span class="hljs-title function_">position</span>({ <span class="hljs-attr">x</span>: <span class="hljs-string">"50%"</span> })</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getRouter</span>().<span class="hljs-title function_">pushUrl</span>({ <span class="hljs-attr">url</span>: <span class="hljs-string">'pages/Index'</span> });</li><li>        })</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>      <div _ngcontent-bfa-c106="" class="highlight-div"><div _ngcontent-bfa-c106="" class="highlight-div-header"><div _ngcontent-bfa-c106="" class="highlight-div-header-left"><div _ngcontent-bfa-c106="" class="handle-button expand-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bfa-c106="" class="highlight-div-header-right"><div _ngcontent-bfa-c106="" class="handle-button ai-button"></div><div _ngcontent-bfa-c106="" class="handle-button line-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bfa-c106="" class="handle-button theme-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bfa-c106="" class="handle-button copy-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bfa-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Book3.ets</span></li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index3</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello World!'</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">RelativeContainer</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">"第三本书的内容"</span>)</li><li>        .<span class="hljs-title function_">id</span>(<span class="hljs-string">'third book'</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        .<span class="hljs-title function_">alignRules</span>({</li><li>          <span class="hljs-attr">center</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'container'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">VerticalAlign</span>.<span class="hljs-property">Center</span> },</li><li>          <span class="hljs-attr">middle</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'container'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Center</span> }</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"返回"</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        .<span class="hljs-title function_">position</span>({ <span class="hljs-attr">x</span>: <span class="hljs-string">"50%"</span> })</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getRouter</span>().<span class="hljs-title function_">pushUrl</span>({ <span class="hljs-attr">url</span>: <span class="hljs-string">'pages/Index'</span> });</li><li>        })</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>      <div _ngcontent-bfa-c106="" class="highlight-div"><div _ngcontent-bfa-c106="" class="highlight-div-header"><div _ngcontent-bfa-c106="" class="highlight-div-header-left"><div _ngcontent-bfa-c106="" class="handle-button expand-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bfa-c106="" class="highlight-div-header-right"><div _ngcontent-bfa-c106="" class="handle-button ai-button"></div><div _ngcontent-bfa-c106="" class="handle-button line-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bfa-c106="" class="handle-button theme-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bfa-c106="" class="handle-button copy-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bfa-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Book4.ets</span></li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index4</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello World!'</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">RelativeContainer</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">"第四本书的内容"</span>)</li><li>        .<span class="hljs-title function_">id</span>(<span class="hljs-string">'fourth book'</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        .<span class="hljs-title function_">alignRules</span>({</li><li>          <span class="hljs-attr">center</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'container'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">VerticalAlign</span>.<span class="hljs-property">Center</span> },</li><li>          <span class="hljs-attr">middle</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'container'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Center</span> }</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"返回"</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        .<span class="hljs-title function_">position</span>({ <span class="hljs-attr">x</span>: <span class="hljs-string">"50%"</span> })</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getRouter</span>().<span class="hljs-title function_">pushUrl</span>({ <span class="hljs-attr">url</span>: <span class="hljs-string">'pages/Index'</span> });</li><li>        })</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>      <div _ngcontent-bfa-c106="" class="highlight-div"><div _ngcontent-bfa-c106="" class="highlight-div-header"><div _ngcontent-bfa-c106="" class="highlight-div-header-left"><div _ngcontent-bfa-c106="" class="handle-button expand-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bfa-c106="" class="highlight-div-header-right"><div _ngcontent-bfa-c106="" class="handle-button ai-button"></div><div _ngcontent-bfa-c106="" class="handle-button line-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bfa-c106="" class="handle-button theme-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bfa-c106="" class="handle-button copy-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bfa-c106="" class="highlight-scroll-div"><pre class="json prettyprint linenums hljs language-json" hw-language="json" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// main_pages.json</span></li><li>
</li><li><span class="hljs-punctuation">{</span></li><li>  <span class="hljs-attr">"src"</span><span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span></li><li>    <span class="hljs-string">"pages/Index"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-string">"pages/Book1"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-string">"pages/Book2"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-string">"pages/Book3"</span><span class="hljs-punctuation">,</span></li><li>    <span class="hljs-string">"pages/Book4"</span></li><li>  <span class="hljs-punctuation">]</span></li><li><span class="hljs-punctuation">}</span></li></ol></pre></div></div></li>     <li>      <p>访问书架页面时，自动展示最近访问的图书列表。</p>      <div _ngcontent-bfa-c106="" class="highlight-div"><div _ngcontent-bfa-c106="" class="highlight-div-header"><div _ngcontent-bfa-c106="" class="highlight-div-header-left"><div _ngcontent-bfa-c106="" class="handle-button expand-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bfa-c106="" class="highlight-div-header-right"><div _ngcontent-bfa-c106="" class="handle-button ai-button"></div><div _ngcontent-bfa-c106="" class="handle-button line-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bfa-c106="" class="handle-button theme-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bfa-c106="" class="handle-button copy-button"><div _ngcontent-bfa-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bfa-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Index.ets</span></li><li>
</li><li><span class="hljs-keyword">import</span> { taskpool } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li><span class="hljs-keyword">import</span> { lruCache } <span class="hljs-keyword">from</span> <span class="hljs-string">'./LruCache'</span></li><li>
</li><li><span class="hljs-meta">@Concurrent</span></li><li><span class="hljs-keyword">async</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">updateBooks</span>(<span class="hljs-params">key: <span class="hljs-built_in">string</span>, value: <span class="hljs-built_in">string</span></span>) {</li><li>  <span class="hljs-comment">// 在子线程更新最近访问列表</span></li><li>  <span class="hljs-keyword">await</span> lruCache.<span class="hljs-title function_">put</span>(key, value);</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'书架'</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">books</span>: <span class="hljs-built_in">string</span>[] = [];</li><li>
</li><li>  <span class="hljs-keyword">async</span> aboutToAppear () {</li><li>    <span class="hljs-comment">// 自动获取最近访问的图书列表</span></li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">books</span> = <span class="hljs-keyword">await</span> lruCache.<span class="hljs-title function_">keys</span>();</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">1</span> }) {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>        .<span class="hljs-title function_">id</span>(<span class="hljs-string">'HelloWorld'</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">50</span>)</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        .<span class="hljs-title function_">alignRules</span>({</li><li>          <span class="hljs-attr">center</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'container'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">VerticalAlign</span>.<span class="hljs-property">Center</span> },</li><li>          <span class="hljs-attr">middle</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'container'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Center</span> }</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">books</span>[<span class="hljs-number">3</span>])</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>          <span class="hljs-comment">// 获取绑定的图书信息</span></li><li>          <span class="hljs-keyword">let</span> value = <span class="hljs-keyword">await</span> lruCache.<span class="hljs-title function_">get</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">books</span>[<span class="hljs-number">3</span>]);</li><li>          <span class="hljs-comment">// 更新最近访问列表</span></li><li>          taskpool.<span class="hljs-title function_">execute</span>(updateBooks, <span class="hljs-variable language_">this</span>.<span class="hljs-property">books</span>[<span class="hljs-number">3</span>], value);</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getRouter</span>().<span class="hljs-title function_">pushUrl</span>({ <span class="hljs-attr">url</span>: <span class="hljs-string">'pages/'</span> + value });</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">books</span>[<span class="hljs-number">2</span>])</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>          <span class="hljs-comment">// 获取绑定的图书信息</span></li><li>          <span class="hljs-keyword">let</span> value = <span class="hljs-keyword">await</span> lruCache.<span class="hljs-title function_">get</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">books</span>[<span class="hljs-number">2</span>]);</li><li>          <span class="hljs-comment">// 更新最近访问列表</span></li><li>          taskpool.<span class="hljs-title function_">execute</span>(updateBooks, <span class="hljs-variable language_">this</span>.<span class="hljs-property">books</span>[<span class="hljs-number">2</span>], value);</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getRouter</span>().<span class="hljs-title function_">pushUrl</span>({ <span class="hljs-attr">url</span>: <span class="hljs-string">'pages/'</span> + value });</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">books</span>[<span class="hljs-number">1</span>])</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>          <span class="hljs-comment">// 获取绑定的图书信息</span></li><li>          <span class="hljs-keyword">let</span> value = <span class="hljs-keyword">await</span> lruCache.<span class="hljs-title function_">get</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">books</span>[<span class="hljs-number">1</span>]);</li><li>          <span class="hljs-comment">// 更新最近访问列表</span></li><li>          taskpool.<span class="hljs-title function_">execute</span>(updateBooks, <span class="hljs-variable language_">this</span>.<span class="hljs-property">books</span>[<span class="hljs-number">1</span>], value);</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getRouter</span>().<span class="hljs-title function_">pushUrl</span>({ <span class="hljs-attr">url</span>: <span class="hljs-string">'pages/'</span> + value });</li><li>        })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">books</span>[<span class="hljs-number">0</span>])</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">10</span>)</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>        .<span class="hljs-title function_">onClick</span>(<span class="hljs-keyword">async</span> () =&gt; {</li><li>          <span class="hljs-comment">// 获取绑定的图书信息</span></li><li>          <span class="hljs-keyword">let</span> value = <span class="hljs-keyword">await</span> lruCache.<span class="hljs-title function_">get</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">books</span>[<span class="hljs-number">0</span>]);</li><li>          <span class="hljs-comment">// 更新最近访问列表</span></li><li>          taskpool.<span class="hljs-title function_">execute</span>(updateBooks, <span class="hljs-variable language_">this</span>.<span class="hljs-property">books</span>[<span class="hljs-number">0</span>], value);</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getRouter</span>().<span class="hljs-title function_">pushUrl</span>({ <span class="hljs-attr">url</span>: <span class="hljs-string">'pages/'</span> + value });</li><li>        })</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div></li>    </ol>   </div>   <div></div></div>