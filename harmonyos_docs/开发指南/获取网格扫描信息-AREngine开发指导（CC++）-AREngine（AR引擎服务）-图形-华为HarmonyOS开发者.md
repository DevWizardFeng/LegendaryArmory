<h1 _ngcontent-qlw-c119="" class="doc-title ng-star-inserted" title="获取网格扫描信息"> 获取网格扫描信息 </h1>

<div _ngcontent-qlw-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section19803101214197">概要<i class="anchor-icon anchor-icon-link" anchorid="section19803101214197" tips="复制节点链接"></i></h2>          <p>从5.1.0(18)开始，AR Engine支持获取网格扫描信息的能力。</p>     <p>本章节介绍如何获取目标物体的网格扫描（mesh）数据信息，通过学习本章节，可以检测当前环境中包括平面在内的自由曲面，并在应用中处理这些曲面信息。</p>     <div class="fignone">      <span class="figcap"><b>图1 </b>环境网格扫描示意图</span>      <br><span><img originheight="657" originwidth="318" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114356.81012870591343413131766987902545:50001231000000:2800:4D0405F93734956EC8828B3647197D4EBB7E810834C5BD3F915E4BFCFE4A8070.png" width="318" height="657"></span>     </div>     <p>本章节涉及的AR Engine能力如下：</p>     <ul>      <li>运动跟踪能力</li>      <li>环境跟踪能力（平面检测）</li>      <li>命中检测能力</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="section4701164061710">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section4701164061710" tips="复制节点链接"></i></h2>          <p>以下接口为AR网格扫描相关接口。详细接口和说明，请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine" target="_blank">AR Engine API参考</a>。</p>    </div>    <div class="tablenoborder">     <div class="tbBox"><table class="layoutFixed idpTab">      <thead>       <tr>        <th align="left" class="cellrowborder" id="mcps1.3.3.1.3.1.1" valign="top" width="49.94%">         <p>接口名</p></th>        <th align="left" class="cellrowborder" id="mcps1.3.3.1.3.1.2" valign="top" width="50.06%">         <p>描述</p></th>       </tr>      </thead>             <tbody><tr>        <td class="cellrowborder" valign="top" width="49.94%">         <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#ga47713cb18234569e03b5216b6c8442d3" target="_blank">HMS_AREngine_ARSession_Create</a></p></td>        <td class="cellrowborder" valign="top" width="50.06%">         <p>创建一个新的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#ga2dbf3585f50628750ec855501c043650" target="_blank">AREngine_ARSession</a>会话。</p></td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="49.94%">         <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#ga1d1cacf372a8011a439f0e4e76994259" target="_blank">HMS_AREngine_ARSession_Update</a></p></td>        <td class="cellrowborder" valign="top" width="50.06%">         <p>更新AR Engine的计算结果。</p></td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="49.94%">         <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#ga6394ae995148abbe3d00082817bf320a" target="_blank">HMS_AREngine_ARSession_Configure</a></p></td>        <td class="cellrowborder" valign="top" width="50.06%">         <p>配置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#ga2dbf3585f50628750ec855501c043650" target="_blank">AREngine_ARSession</a>会话。</p></td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="49.94%">         <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#gadfcb9589137a39c5afcb217e18853a9d" target="_blank">HMS_AREngine_ARFrame_Create</a></p></td>        <td class="cellrowborder" valign="top" width="50.06%">         <p>创建一个新的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#gaf35f728a1179ef54a3eba9f1cf021719" target="_blank">AREngine_ARFrame</a>对象，将指针存储到*outFrame中。</p></td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="49.94%">         <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#ga3f23bf747def8303c3fb261a9e9a2286" target="_blank">HMS_AREngine_ARSession_SetDisplayGeometry</a></p></td>        <td class="cellrowborder" valign="top" width="50.06%">         <p>设置显示的高和宽（以像素为单位）。该高度和宽度是显示视图的高度和宽度，如果不一致，会导致显示相机预览出错。</p></td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="49.94%">         <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#gac697e4be36db63ed6098f154aa9ac01c" target="_blank">HMS_AREngine_ARSession_SetCameraGLTexture</a></p></td>        <td class="cellrowborder" valign="top" width="50.06%">         <p>设置可用于存储相机预览流数据的openGL纹理。</p></td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="49.94%">         <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#gac5b39338f95317671d8de6d4f409cf9c" target="_blank">HMS_AREngine_ARSession_GetAllTrackables</a></p></td>        <td class="cellrowborder" valign="top" width="50.06%">         <p>获取所有指定类型的可跟踪对象集合。</p></td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="49.94%">         <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#gab1782eeeeddc01b77a140af915cb351c" target="_blank">HMS_AREngine_ARTrackableList_AcquireItem</a></p></td>        <td class="cellrowborder" valign="top" width="50.06%">         <p>从可跟踪列表中获取指定index的对象。</p></td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="49.94%">         <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#gabbb03027afb984be8542d00d2eebd063" target="_blank">HMS_AREngine_ARPlane_GetCenterPose</a></p></td>        <td class="cellrowborder" valign="top" width="50.06%">         <p>获取从平面的局部坐标系到世界坐标系转换的位姿信息。</p></td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="49.94%">         <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#ga5295c975a0ff3d633a1dde5a8eb70863" target="_blank">HMS_AREngine_ARFrame_AcquireCamera</a></p></td>        <td class="cellrowborder" valign="top" width="50.06%">         <p>获取当前帧的相机参数对象。</p></td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="49.94%">         <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#gafb471f39563ca1a4947d4f87c77e24e2" target="_blank">HMS_AREngine_ARPose_Create</a></p></td>        <td class="cellrowborder" valign="top" width="50.06%">         <p>分配并初始化一个新的位姿对象。</p></td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="49.94%">         <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#ga00df108c4ba187967a10e9c4d2e27d3a" target="_blank">HMS_AREngine_ARCamera_GetPose</a></p></td>        <td class="cellrowborder" valign="top" width="50.06%">         <p>获取当前相机对象在AR世界空间中的位姿。</p></td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="49.94%">         <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#section25711548111020" target="_blank">HMS_AREngine_ARFrame_AcquireSceneMesh</a></p></td>        <td class="cellrowborder" valign="top" width="50.06%">         <p>获取当前帧的mesh信息。</p></td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="49.94%">         <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#section1860218429179" target="_blank">HMS_AREngine_ARSceneMesh_AcquireVerticesSize</a></p></td>        <td class="cellrowborder" valign="top" width="50.06%">         <p>获取mesh的顶点个数。</p></td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="49.94%">         <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#section2126723166" target="_blank">HMS_AREngine_ARSceneMesh_AcquireVertexList</a></p></td>        <td class="cellrowborder" valign="top" width="50.06%">         <p>获取mesh顶点集合。</p></td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="49.94%">         <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#section12621161917152" target="_blank">HMS_AREngine_ARSceneMesh_AcquireIndexListSize</a></p></td>        <td class="cellrowborder" valign="top" width="50.06%">         <p>获取mesh面片的索引个数。</p></td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="49.94%">         <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#section7629354145" target="_blank">HMS_AREngine_ARSceneMesh_AcquireIndexList</a></p></td>        <td class="cellrowborder" valign="top" width="50.06%">         <p>获取mesh面片的索引集合。</p></td>       </tr>       <tr>        <td class="cellrowborder" valign="top" width="49.94%">         <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#section446832931813" target="_blank">HMS_AREngine_ARSceneMesh_Release</a></p></td>        <td class="cellrowborder" valign="top" width="50.06%">         <p>释放当前帧的mesh信息。</p></td>       </tr>           </tbody></table></div>    </div>    <div class="tiledSection">     <h2 id="section171161453144613">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section171161453144613" tips="复制节点链接"></i></h2>          <p id="ZH-CN_TOPIC_0000002329946666__zh-cn_topic_0000002363865165_p193824275361">本章节给出了关键开发步骤，完整代码可以参考<a href="https://gitcode.com/harmonyos_samples/arengine_-sample-code_-clientdemo_cpp" target="_blank">示例代码</a>。</p>    </div>    <div class="tiledSection">     <h3 id="section1149014511314" class="firsth2">声明Native接口<i class="anchor-icon anchor-icon-link" anchorid="section1149014511314" tips="复制节点链接"></i></h3>          <p id="ZH-CN_TOPIC_0000002329946666__zh-cn_topic_0000002363865165_p16573195181311">开发者可参考AR物体摆放章节的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arengine-c-arworld#section1557014318265">声明Native接口</a>。</p>    </div>    <div class="tiledSection">     <h3 id="section65312574410">创建UI界面<i class="anchor-icon anchor-icon-link" anchorid="section65312574410" tips="复制节点链接"></i></h3>          <p>创建一个UI界面，使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-components-xcomponent" target="_blank">XComponent</a>组件用于显示相机预览画面，并定时触发每一帧绘制。</p>     <div _ngcontent-qlw-c106="" class="highlight-div"><div _ngcontent-qlw-c106="" class="highlight-div-header"><div _ngcontent-qlw-c106="" class="highlight-div-header-left"><div _ngcontent-qlw-c106="" class="handle-button expand-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qlw-c106="" class="highlight-div-header-right"><div _ngcontent-qlw-c106="" class="handle-button ai-button"></div><div _ngcontent-qlw-c106="" class="handle-button line-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qlw-c106="" class="handle-button theme-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qlw-c106="" class="handle-button copy-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qlw-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 此代码可参考示例代码：ARSample/entry/src/main/ets/pages/ARMesh.ets。</span></li><li><span class="hljs-keyword">import</span> { deviceInfo } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { resourceManager } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.LocalizationKit'</span>;</li><li><span class="hljs-keyword">import</span> arEngineDemo <span class="hljs-keyword">from</span> <span class="hljs-string">'libentry.so'</span>;</li><li>
</li><li><span class="hljs-meta">@Builder</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">ARMeshBuilder</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-title class_">ARMesh</span>();</li><li>}</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">ARMesh</span> {</li><li>  <span class="hljs-attr">pageInfo</span>: <span class="hljs-title class_">NavPathStack</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">NavPathStack</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">interval</span>: <span class="hljs-built_in">number</span> = -<span class="hljs-number">1</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">xComponentId</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'ARMesh'</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">context</span>: <span class="hljs-title class_">Context</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> <span class="hljs-title class_">Context</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">resMgr</span>: resourceManager.<span class="hljs-property">ResourceManager</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span>.<span class="hljs-property">resourceManager</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">rotation</span>: <span class="hljs-built_in">number</span> = deviceInfo.<span class="hljs-property">deviceType</span> === <span class="hljs-string">'tablet'</span> ? <span class="hljs-number">3</span> : <span class="hljs-number">0</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-title class_">NavDestination</span>() {</li><li>      <span class="hljs-title class_">RelativeContainer</span>() {</li><li>        <span class="hljs-title class_">XComponent</span>({ <span class="hljs-attr">id</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">xComponentId</span>, <span class="hljs-attr">type</span>: <span class="hljs-title class_">XComponentType</span>.<span class="hljs-property">SURFACE</span>, <span class="hljs-attr">libraryname</span>: <span class="hljs-string">'entry'</span> })</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>          .<span class="hljs-title function_">alignRules</span>({</li><li>            <span class="hljs-attr">center</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'__container__'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">VerticalAlign</span>.<span class="hljs-property">Center</span> },</li><li>            <span class="hljs-attr">middle</span>: { <span class="hljs-attr">anchor</span>: <span class="hljs-string">'__container__'</span>, <span class="hljs-attr">align</span>: <span class="hljs-title class_">HorizontalAlign</span>.<span class="hljs-property">Center</span> }</li><li>          })</li><li>          .<span class="hljs-title function_">onLoad</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`XComponent onLoad <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.xComponentId}</span>.`</span>);</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">interval</span> = <span class="hljs-built_in">setInterval</span>(<span class="hljs-function">() =&gt;</span> {</li><li>              <span class="hljs-comment">// 调用更新Native API来更新AR Engine每帧的计算结果</span></li><li>              arEngineDemo.<span class="hljs-title function_">update</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">xComponentId</span>);</li><li>            }, <span class="hljs-number">33</span>) <span class="hljs-comment">// 将帧速率设置为30fps（每33ms刷新一次帧）</span></li><li>          })</li><li>          .<span class="hljs-title function_">onDestroy</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`XComponent onDestroy <span class="hljs-subst">${<span class="hljs-variable language_">this</span>.xComponentId}</span>.`</span>);</li><li>            <span class="hljs-built_in">clearInterval</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">interval</span>);</li><li>          })</li><li>      }</li><li>    }</li><li>    .<span class="hljs-title function_">onAppear</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      arEngineDemo.<span class="hljs-title function_">init</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">resMgr</span>);</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">config</span>: <span class="hljs-title class_">Int32Array</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Int32Array</span>([<span class="hljs-number">1</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">rotation</span>]);</li><li>      arEngineDemo.<span class="hljs-title function_">start</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">xComponentId</span>, config);</li><li>    })</li><li>    .<span class="hljs-title function_">onWillDisappear</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      arEngineDemo.<span class="hljs-title function_">stop</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">xComponentId</span>);</li><li>    })</li><li>    .<span class="hljs-title function_">onShown</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      arEngineDemo.<span class="hljs-title function_">show</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">xComponentId</span>);</li><li>    })</li><li>    .<span class="hljs-title function_">onHidden</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      arEngineDemo.<span class="hljs-title function_">hide</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">xComponentId</span>);</li><li>    })</li><li>    .<span class="hljs-title function_">onReady</span>(<span class="hljs-function">(<span class="hljs-params">context: NavDestinationContext</span>) =&gt;</span> {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfo</span> = context.<span class="hljs-property">pathStack</span>;</li><li>    })</li><li>    .<span class="hljs-title function_">hideTitleBar</span>(<span class="hljs-literal">true</span>)</li><li>    .<span class="hljs-title function_">hideBackButton</span>(<span class="hljs-literal">true</span>)</li><li>    .<span class="hljs-title function_">hideToolBar</span>(<span class="hljs-literal">true</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section13951554911">引入AR Engine<i class="anchor-icon anchor-icon-link" anchorid="section13951554911" tips="复制节点链接"></i></h3>          <p id="ZH-CN_TOPIC_0000002329946666__zh-cn_topic_0000002363865165_p1174733951511">开发者可参考AR物体摆放章节的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arengine-c-arworld#section183721115521">引入AR Engine</a>。</p>    </div>    <div class="tiledSection">     <h3 id="section1219284814911">创建AR会话<i class="anchor-icon anchor-icon-link" anchorid="section1219284814911" tips="复制节点链接"></i></h3>          <p>创建AR会话并配置为开启mesh模式。</p>     <div _ngcontent-qlw-c106="" class="highlight-div"><div _ngcontent-qlw-c106="" class="highlight-div-header"><div _ngcontent-qlw-c106="" class="highlight-div-header-left"><div _ngcontent-qlw-c106="" class="handle-button expand-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qlw-c106="" class="highlight-div-header-right"><div _ngcontent-qlw-c106="" class="handle-button ai-button"></div><div _ngcontent-qlw-c106="" class="handle-button line-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qlw-c106="" class="handle-button theme-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qlw-c106="" class="handle-button copy-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qlw-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li>AREngine_ARSession *arSession = <span class="hljs-literal">nullptr</span>;</li><li><span class="hljs-comment">// 创建AR会话。</span></li><li><span class="hljs-built_in">HMS_AREngine_ARSession_Create</span>(<span class="hljs-literal">nullptr</span>, <span class="hljs-literal">nullptr</span>, &amp;arSession);</li><li>AREngine_ARConfig *arConfig = <span class="hljs-literal">nullptr</span>;</li><li><span class="hljs-comment">// 创建AR会话配置器。</span></li><li><span class="hljs-built_in">HMS_AREngine_ARConfig_Create</span>(arSession, &amp;arConfig);</li><li><span class="hljs-comment">// 设置mesh模式为开启状态。</span></li><li><span class="hljs-built_in">HMS_AREngine_ARConfig_SetMeshMode</span>(arSession, arConfig, ARENGINE_MESH_MODE_ENABLED);</li><li><span class="hljs-comment">// 配置器设置给AR会话。</span></li><li><span class="hljs-built_in">HMS_AREngine_ARSession_Configure</span>(arSession, arConfig);</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section777541155016">获取当前环境中的mesh信息<i class="anchor-icon anchor-icon-link" anchorid="section777541155016" tips="复制节点链接"></i></h3>          <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#section25711548111020" target="_blank">HMS_AREngine_ARFrame_AcquireSceneMesh</a>函数，获取当前环境中的mesh信息，并将结果存放在sceneMesh中。</p>     <div _ngcontent-qlw-c106="" class="highlight-div"><div _ngcontent-qlw-c106="" class="highlight-div-header"><div _ngcontent-qlw-c106="" class="highlight-div-header-left"><div _ngcontent-qlw-c106="" class="handle-button expand-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qlw-c106="" class="highlight-div-header-right"><div _ngcontent-qlw-c106="" class="handle-button ai-button"></div><div _ngcontent-qlw-c106="" class="handle-button line-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qlw-c106="" class="handle-button theme-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qlw-c106="" class="handle-button copy-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qlw-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li>AREngine_ARFrame *arFrame = <span class="hljs-literal">nullptr</span>;</li><li><span class="hljs-comment">// 创建AR单帧对象</span></li><li><span class="hljs-built_in">HMS_AREngine_ARFrame_Create</span>(arSession, &amp;arFrame);</li><li>AREngine_ARSceneMesh *sceneMesh = <span class="hljs-literal">nullptr</span>;</li><li><span class="hljs-comment">// 获取当前帧的mesh信息</span></li><li><span class="hljs-built_in">HMS_AREngine_ARFrame_AcquireSceneMesh</span>(arSession, arFrame, &amp;sceneMesh);</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section39173187504">获取当前mesh信息对应的mesh顶点信息<i class="anchor-icon anchor-icon-link" anchorid="section39173187504" tips="复制节点链接"></i></h3>          <p>1. 调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#section1860218429179" target="_blank">HMS_AREngine_ARSceneMesh_AcquireVerticesSize</a>函数，获取mesh顶点信息包含的浮点数数量，每三个浮点数组成一个mesh顶点，将结果存放在meshVerticesSize 中。</p>     <div _ngcontent-qlw-c106="" class="highlight-div"><div _ngcontent-qlw-c106="" class="highlight-div-header"><div _ngcontent-qlw-c106="" class="highlight-div-header-left"><div _ngcontent-qlw-c106="" class="handle-button expand-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qlw-c106="" class="highlight-div-header-right"><div _ngcontent-qlw-c106="" class="handle-button ai-button"></div><div _ngcontent-qlw-c106="" class="handle-button line-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qlw-c106="" class="handle-button theme-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qlw-c106="" class="handle-button copy-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qlw-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-type">int32_t</span> meshVerticesSize = <span class="hljs-number">0</span>;</li><li><span class="hljs-comment">// 获取mesh顶点信息包含的浮点数数量</span></li><li><span class="hljs-built_in">HMS_AREngine_ARSceneMesh_AcquireVerticesSize</span>(arSession, sceneMesh, &amp;meshVerticesSize);</li></ol></pre></div></div>     <p>2. 调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#section2126723166" target="_blank">HMS_AREngine_ARSceneMesh_AcquireVertexList</a>函数，获取mesh顶点信息，并将结果保存在meshVertices中。</p>     <div _ngcontent-qlw-c106="" class="highlight-div"><div _ngcontent-qlw-c106="" class="highlight-div-header"><div _ngcontent-qlw-c106="" class="highlight-div-header-left"><div _ngcontent-qlw-c106="" class="handle-button expand-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qlw-c106="" class="highlight-div-header-right"><div _ngcontent-qlw-c106="" class="handle-button ai-button"></div><div _ngcontent-qlw-c106="" class="handle-button line-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qlw-c106="" class="handle-button theme-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qlw-c106="" class="handle-button copy-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qlw-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-type">float</span> *meshVertices = <span class="hljs-keyword">new</span> <span class="hljs-type">float</span>[meshVerticesSize];</li><li><span class="hljs-comment">// 获取mesh顶点信息</span></li><li><span class="hljs-built_in">HMS_AREngine_ARSceneMesh_AcquireVertexList</span>(arSession, sceneMesh, meshVertices, meshVerticesSize);</li><li><span class="hljs-comment">// 获取mesh顶点个数</span></li><li><span class="hljs-type">int32_t</span> mPointsNum = meshVerticesSize / <span class="hljs-number">3</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section1823235112508">获取当前mesh信息对应的mesh面片信息<i class="anchor-icon anchor-icon-link" anchorid="section1823235112508" tips="复制节点链接"></i></h3>          <p>1. 调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#section12621161917152" target="_blank">HMS_AREngine_ARSceneMesh_AcquireIndexListSize</a>函数，获取mesh面片信息对应顶点的索引个数，每三个顶点索引表示一个mesh面片，将结果存放在triangleIndicesSize 中。</p>     <div _ngcontent-qlw-c106="" class="highlight-div"><div _ngcontent-qlw-c106="" class="highlight-div-header"><div _ngcontent-qlw-c106="" class="highlight-div-header-left"><div _ngcontent-qlw-c106="" class="handle-button expand-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qlw-c106="" class="highlight-div-header-right"><div _ngcontent-qlw-c106="" class="handle-button ai-button"></div><div _ngcontent-qlw-c106="" class="handle-button line-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qlw-c106="" class="handle-button theme-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qlw-c106="" class="handle-button copy-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qlw-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-type">int32_t</span> triangleIndicesSize = <span class="hljs-number">0</span>;</li><li><span class="hljs-comment">// 获取mesh面片信息对应顶点的索引个数</span></li><li><span class="hljs-built_in">HMS_AREngine_ARSceneMesh_AcquireIndexListSize</span>(arSession, sceneMesh, &amp;triangleIndicesSize);</li></ol></pre></div></div>     <p>2. 调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arengine-capi-arengine#section7629354145" target="_blank">HMS_AREngine_ARSceneMesh_AcquireIndexList</a>函数，获取mesh面片信息对应顶点的索引列表，并将结果保存在meshTriangleIndices中。</p>     <div _ngcontent-qlw-c106="" class="highlight-div"><div _ngcontent-qlw-c106="" class="highlight-div-header"><div _ngcontent-qlw-c106="" class="highlight-div-header-left"><div _ngcontent-qlw-c106="" class="handle-button expand-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qlw-c106="" class="highlight-div-header-right"><div _ngcontent-qlw-c106="" class="handle-button ai-button"></div><div _ngcontent-qlw-c106="" class="handle-button line-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qlw-c106="" class="handle-button theme-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qlw-c106="" class="handle-button copy-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qlw-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-type">int32_t</span> *meshTriangleIndices = <span class="hljs-keyword">new</span> <span class="hljs-type">int32_t</span>[triangleIndicesSize];</li><li><span class="hljs-comment">// 获取mesh面片信息对应顶点的索引列表</span></li><li><span class="hljs-built_in">HMS_AREngine_ARSceneMesh_AcquireIndexList</span>(arSession, sceneMesh, meshTriangleIndices, triangleIndicesSize);</li><li><span class="hljs-comment">// 获取mesh面片个数</span></li><li><span class="hljs-type">int32_t</span> mTrianglesNum = triangleIndicesSize / <span class="hljs-number">3</span>;</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="section591012291514">使用完毕后，销毁mesh信息<i class="anchor-icon anchor-icon-link" anchorid="section591012291514" tips="复制节点链接"></i></h3>          <div _ngcontent-qlw-c106="" class="highlight-div"><div _ngcontent-qlw-c106="" class="highlight-div-header"><div _ngcontent-qlw-c106="" class="highlight-div-header-left"><div _ngcontent-qlw-c106="" class="handle-button expand-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qlw-c106="" class="highlight-div-header-right"><div _ngcontent-qlw-c106="" class="handle-button ai-button"></div><div _ngcontent-qlw-c106="" class="handle-button line-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qlw-c106="" class="handle-button theme-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qlw-c106="" class="handle-button copy-button"><div _ngcontent-qlw-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qlw-c106="" class="highlight-scroll-div"><pre class="cpp prettyprint linenums hljs language-cpp" hw-language="cpp" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">HMS_AREngine_ARSceneMesh_Release</span><span class="hljs-params">(AREngine_ARSceneMesh *sceneMesh)</span></span>;</li></ol></pre></div></div>    </div>   </div>   <div></div></div>