<h1 _ngcontent-vel-c119="" class="doc-title ng-star-inserted" title="获取网页内容高度"> 获取网页内容高度 </h1>

<div _ngcontent-vel-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-webview-webviewcontroller#getpageheight" target="_blank">getPageHeight</a>可获取当前网页内容的实际高度，开发者可以根据具体需求选择合适的方法。</p>    <div class="tiledSection">     <h2 id="使用场景">使用场景<i class="anchor-icon anchor-icon-link" anchorid="使用场景" tips="复制节点链接"></i></h2>          <p>在网页加载过程中，获取的高度可能不够精确，特别是在网页还未渲染完成时。因为动态内容加载后会更新这个值。网页内容可能需要长时间加载。现在网站为了优化首次加载速度，会使用动态网页加载技术，用户在看到网页首帧时，网页后台还在动态加载页面，特别是包含图片、动态内容的页面。</p>     <p>非静态网页不建议在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-events#onpageend" target="_blank">onPageEnd</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-events#onpagevisible9" target="_blank">onPageVisible</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-events#onfirstcontentfulpaint10" target="_blank">onFirstContentfulPaint</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-basic-components-web-events#onfirstmeaningfulpaint12" target="_blank">onFirstMeaningfulPaint</a>事件等Web组件生命周期回调和Web性能指标回调中获取。需要根据当前网页的特点，通过JSBridge或延迟等方案，在前端特定的回调通知里获取当前网页内容的实际高度。</p>    </div>    <div class="tiledSection">     <h2 id="普通静态展示页面">普通静态展示页面<i class="anchor-icon anchor-icon-link" anchorid="普通静态展示页面" tips="复制节点链接"></i></h2>          <p>普通静态网页，可以在onPageEnd等Web组件生命周期回调和Web性能指标回调中通过getPageHeight获取网页内容的高度。</p>     <p>应用侧代码</p>     <div _ngcontent-vel-c106="" class="highlight-div"><div _ngcontent-vel-c106="" class="highlight-div-header"><div _ngcontent-vel-c106="" class="highlight-div-header-left"><div _ngcontent-vel-c106="" class="handle-button expand-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vel-c106="" class="highlight-div-header-right"><div _ngcontent-vel-c106="" class="handle-button ai-button"></div><div _ngcontent-vel-c106="" class="handle-button line-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vel-c106="" class="handle-button theme-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vel-c106="" class="handle-button copy-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vel-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">controller</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Web</span>({ <span class="hljs-attr">src</span>: $rawfile(<span class="hljs-string">'index.html'</span>), <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>          .<span class="hljs-title function_">onPageEnd</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"page height: onPageEnd: "</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">getPageHeight</span>());</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="复杂动态网页使用jsbridge传递特定回调">复杂动态网页使用JSBridge传递特定回调<i class="anchor-icon anchor-icon-link" anchorid="复杂动态网页使用jsbridge传递特定回调" tips="复制节点链接"></i></h2>          <p>动态网页可以通过JSBridge传递特定回调，通知到应用侧调用。</p>     <p>应用侧代码</p>     <div _ngcontent-vel-c106="" class="highlight-div"><div _ngcontent-vel-c106="" class="highlight-div-header"><div _ngcontent-vel-c106="" class="highlight-div-header-left"><div _ngcontent-vel-c106="" class="handle-button expand-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vel-c106="" class="highlight-div-header-right"><div _ngcontent-vel-c106="" class="handle-button ai-button"></div><div _ngcontent-vel-c106="" class="handle-button line-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vel-c106="" class="handle-button theme-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vel-c106="" class="handle-button copy-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vel-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestClass</span> {</li><li>  <span class="hljs-attr">testController</span>: webview.<span class="hljs-property">WebviewController</span>;</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">controller: webview.WebviewController</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">testController</span> = controller;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">notifyToGet</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"page height:"</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">testController</span>.<span class="hljs-title function_">getPageHeight</span>());</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">controller</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">jsbObj</span>: <span class="hljs-title class_">TestClass</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TestClass</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>);</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Web</span>({ <span class="hljs-attr">src</span>: $rawfile(<span class="hljs-string">'index.html'</span>), <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>          .<span class="hljs-title function_">javaScriptAccess</span>(<span class="hljs-literal">true</span>)</li><li>          .<span class="hljs-title function_">javaScriptProxy</span>({</li><li>            <span class="hljs-attr">object</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">jsbObj</span>,</li><li>            <span class="hljs-attr">name</span>: <span class="hljs-string">"jsbObj"</span>,</li><li>            <span class="hljs-attr">methodList</span>: [<span class="hljs-string">"notifyToGet"</span>],</li><li>            <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span></li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="加载普通网页" class="firsth2">加载普通网页<i class="anchor-icon anchor-icon-link" anchorid="加载普通网页" tips="复制节点链接"></i></h3>          <p>普通网页可以通过load事件，在网页的所有资源都完全加载完成后触发。</p>     <p>前端代码</p>     <div _ngcontent-vel-c106="" class="highlight-div"><div _ngcontent-vel-c106="" class="highlight-div-header"><div _ngcontent-vel-c106="" class="highlight-div-header-left"><div _ngcontent-vel-c106="" class="handle-button expand-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vel-c106="" class="highlight-div-header-right"><div _ngcontent-vel-c106="" class="handle-button ai-button"></div><div _ngcontent-vel-c106="" class="handle-button line-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vel-c106="" class="handle-button theme-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vel-c106="" class="handle-button copy-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vel-c106="" class="highlight-scroll-div"><pre class="html prettyprint linenums hljs language-xml" hw-language="html" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">&lt;!--index.html--&gt;</span></li><li><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></li><li><span class="language-javascript">    <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"load"</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {</span></li><li><span class="language-javascript">        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> jsbObj !== <span class="hljs-string">'undefined'</span>) {</span></li><li><span class="language-javascript">            jsbObj.<span class="hljs-title function_">notifyToGet</span>();</span></li><li><span class="language-javascript">        } <span class="hljs-keyword">else</span> {</span></li><li><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"jsbObj is error"</span>);</span></li><li><span class="language-javascript">        }</span></li><li><span class="language-javascript">    })</span></li><li><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="加载大图片的网页">加载大图片的网页<i class="anchor-icon anchor-icon-link" anchorid="加载大图片的网页" tips="复制节点链接"></i></h3>          <p>当网页含有大图片时，可使用图片加载完成回调触发。</p>     <p>在前端代码中，请替换图片为真实图片。</p>     <div _ngcontent-vel-c106="" class="highlight-div"><div _ngcontent-vel-c106="" class="highlight-div-header"><div _ngcontent-vel-c106="" class="highlight-div-header-left"><div _ngcontent-vel-c106="" class="handle-button expand-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vel-c106="" class="highlight-div-header-right"><div _ngcontent-vel-c106="" class="handle-button ai-button"></div><div _ngcontent-vel-c106="" class="handle-button line-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vel-c106="" class="handle-button theme-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vel-c106="" class="handle-button copy-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vel-c106="" class="highlight-scroll-div"><pre class="html prettyprint linenums hljs language-xml" hw-language="html" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">&lt;!--index.html--&gt;</span></li><li><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"example.jpg"</span> <span class="hljs-attr">id</span>=<span class="hljs-string">"largeImage"</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">"Large Image"</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></li><li><span class="language-javascript">    <span class="hljs-keyword">var</span> img = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">getElementById</span>(<span class="hljs-string">'largeImage'</span>);</span></li><li><span class="language-javascript"></span></li><li><span class="language-javascript">    img.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">'load'</span>, <span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) {</span></li><li><span class="language-javascript">        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> jsbObj !== <span class="hljs-string">'undefined'</span>) {</span></li><li><span class="language-javascript">            jsbObj.<span class="hljs-title function_">notifyToGet</span>();</span></li><li><span class="language-javascript">        } <span class="hljs-keyword">else</span> {</span></li><li><span class="language-javascript">            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"jsbObj is error"</span>);</span></li><li><span class="language-javascript">        }</span></li><li><span class="language-javascript">    });</span></li><li><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h3 id="加载大量图片的网页">加载大量图片的网页<i class="anchor-icon anchor-icon-link" anchorid="加载大量图片的网页" tips="复制节点链接"></i></h3>          <p>针对图片密集网页，在所有图片加载完成后触发。</p>     <p>在前端代码中，请替换图片为真实图片。</p>     <div _ngcontent-vel-c106="" class="highlight-div"><div _ngcontent-vel-c106="" class="highlight-div-header"><div _ngcontent-vel-c106="" class="highlight-div-header-left"><div _ngcontent-vel-c106="" class="handle-button expand-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vel-c106="" class="highlight-div-header-right"><div _ngcontent-vel-c106="" class="handle-button ai-button"></div><div _ngcontent-vel-c106="" class="handle-button line-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vel-c106="" class="handle-button theme-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vel-c106="" class="handle-button copy-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vel-c106="" class="highlight-scroll-div"><pre class="html prettyprint linenums hljs language-xml" hw-language="html" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">&lt;!--index.html--&gt;</span></li><li><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-keyword">html</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">"en"</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">"UTF-8"</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>Title<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"example1.jpg"</span> &gt;</span></li><li>    <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"example2.jpg"</span> &gt;</span></li><li><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="language-javascript"></span></li><li><span class="language-javascript">    <span class="hljs-keyword">function</span> <span class="hljs-title function_">waitForImages</span>(<span class="hljs-params"></span>) {</span></li><li><span class="language-javascript">        <span class="hljs-keyword">const</span> images = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(<span class="hljs-variable language_">document</span>.<span class="hljs-property">images</span>);</span></li><li><span class="language-javascript">        <span class="hljs-keyword">const</span> promises = images.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">img</span> =&gt;</span> {</span></li><li><span class="language-javascript">            <span class="hljs-keyword">if</span> (img.<span class="hljs-property">complete</span>) <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">resolve</span>();</span></li><li><span class="language-javascript">            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Promise</span>(<span class="hljs-function"><span class="hljs-params">resolve</span> =&gt;</span> {</span></li><li><span class="language-javascript">                img.<span class="hljs-property">onload</span> = img.<span class="hljs-property">onerror</span> = resolve;</span></li><li><span class="language-javascript">            });</span></li><li><span class="language-javascript">        });</span></li><li><span class="language-javascript"></span></li><li><span class="language-javascript">        <span class="hljs-keyword">return</span> <span class="hljs-title class_">Promise</span>.<span class="hljs-title function_">all</span>(promises).<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</span></li><li><span class="language-javascript">            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> jsbObj !== <span class="hljs-string">'undefined'</span>) {</span></li><li><span class="language-javascript">                jsbObj.<span class="hljs-title function_">notifyToGet</span>();</span></li><li><span class="language-javascript">            } <span class="hljs-keyword">else</span> {</span></li><li><span class="language-javascript">                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"jsbObj is error"</span>);</span></li><li><span class="language-javascript">            }</span></li><li><span class="language-javascript">        })</span></li><li><span class="language-javascript">    }</span></li><li><span class="language-javascript">    <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">"DOMContentLoaded"</span>, waitForImages);</span></li><li><span class="language-javascript"></span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span></li><li><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span></li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="无法使用jsbridge场景">无法使用JSBridge场景<i class="anchor-icon anchor-icon-link" anchorid="无法使用jsbridge场景" tips="复制节点链接"></i></h2>          <p>在无法使用JSBridge的场景下，可以通过添加setTimeout等函数来延迟获取当前页面的高度。具体的延迟时间可以根据网页的复杂度来确定。</p>     <p>应用侧代码</p>     <div _ngcontent-vel-c106="" class="highlight-div"><div _ngcontent-vel-c106="" class="highlight-div-header"><div _ngcontent-vel-c106="" class="highlight-div-header-left"><div _ngcontent-vel-c106="" class="handle-button expand-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-vel-c106="" class="highlight-div-header-right"><div _ngcontent-vel-c106="" class="handle-button ai-button"></div><div _ngcontent-vel-c106="" class="handle-button line-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-vel-c106="" class="handle-button theme-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-vel-c106="" class="handle-button copy-button"><div _ngcontent-vel-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-vel-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// xxx.ets</span></li><li><span class="hljs-keyword">import</span> { webview } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkWeb'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-attr">controller</span>: webview.<span class="hljs-property">WebviewController</span> = <span class="hljs-keyword">new</span> webview.<span class="hljs-title class_">WebviewController</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Web</span>({ <span class="hljs-attr">src</span>: $rawfile(<span class="hljs-string">'index.html'</span>), <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>          .<span class="hljs-title function_">onPageEnd</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-built_in">setTimeout</span>(<span class="hljs-function">()=&gt;</span>{</li><li>                <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"page height: onPageEnd: setTimeout: "</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">getPageHeight</span>());</li><li>            },<span class="hljs-number">2000</span>)</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>