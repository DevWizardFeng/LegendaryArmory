<h1 _ngcontent-bun-c119="" class="doc-title ng-star-inserted" title="认证管理"> 认证管理 </h1>

<div _ngcontent-bun-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div id="body0000001796516565"><p id="ZH-CN_TOPIC_0000002510173709__p147958468526">当前ohpm-repo的认证方式有证书认证和AccessToken两种方式：</p> <p id="ZH-CN_TOPIC_0000002510173709__p47956465522">证书认证：在使用ohpm客户端执行publish，unpublish或dist-tags相关命令时，通过嵌入加密ssh证书进行身份验证。</p> <p id="ZH-CN_TOPIC_0000002510173709__p10795154625220">AccessToken认证：将ohpm-repo生成的AccessToken配置到ohpm客户端配置文件中，实现publish、unpublish、dist-tags、info和install等操作的免密认证。</p> <div class="tiledSection"><h2 id="section57201135315">证书认证<i class="anchor-icon anchor-icon-link" anchorid="section57201135315" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510173709__zh-cn_topic_0000001745376494_p339160858204137">使用ohpm发布包时，需要先在配置文件.ohpmrc文件中配置publish_id和key_path。publish_id对应发布码，key_path对应私钥的地址，其详细发布流程见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-quickstart#zh-cn_topic_0000001792256157_使用命令行工具发布">使用命令行工具发布</a>。认证管理主要是管理私钥对应的公钥信息，在用户使用ohpm发布包时进行校验。认证管理页面效果如下图所示：</p> <p id="ZH-CN_TOPIC_0000002510173709__p178393380496"><span><img height="400.592941" originheight="663" originwidth="1253" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104732.12767816644426182408007033673420:50001231000000:2800:61E766E98082938A5F10837F2FDB9EBD4427D31D176EC2694CFD85601B9560BB.png" title="点击放大" width="747.15543"></span></p> <p id="ZH-CN_TOPIC_0000002510173709__p451915113115"></p> <p id="ZH-CN_TOPIC_0000002510173709__p439864420535"></p> <ol id="ZH-CN_TOPIC_0000002510173709__ol276284410446"><li id="li1776214443441">点击新增，弹出添加公钥面板，可以添加公钥信息。一个用户最多可以添加十条公钥信息，因此可以通过配置不同的公钥信息实现多人共享该用户使用ohpm进行发布包操作。页面效果如下图所示：<p id="ZH-CN_TOPIC_0000002510173709__p2011323191214"><span><img height="396.24291000000005" originheight="668" originwidth="1259" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104733.61404625285283054092509681145969:50001231000000:2800:F5BD1E9319AA499EC472D6B9FFBBBF8C6FB3D22DD33BC7A99501A74673128774.png" title="点击放大" width="736.1550000000001"></span></p> </li><li id="li147631444104416">点击如何生成公钥，可查看公钥生成的说明，页面效果如下图所示：<p id="ZH-CN_TOPIC_0000002510173709__p1667125671211"><span><img height="397.68529500000005" originheight="668" originwidth="1259" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104733.93668177143221984631596734060080:50001231000000:2800:4667C40D06AE2142CA5B1B1F96AF3CCCFB7EFCC6FD9C056FDDBC9878ED2E9DA1.png" title="点击放大" width="740.1450000000001"></span></p> </li><li id="li5763644134417">点击删除，可以删除已经存在的公钥信息，页面效果如下图所示：<p id="ZH-CN_TOPIC_0000002510173709__p1538924731317"><span><img height="408.944011" originheight="668" originwidth="1259" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104733.51842740026877094376620334647695:50001231000000:2800:AA04ECA5057867DBE12826EA132CF6653813080D9CFE99CFFAF1E9DC40CC6E36.png" title="点击放大" width="758.312534"></span></p> </li></ol> </div> <div class="tiledSection"><h2 id="section1631316181327">AccessToken<i class="anchor-icon anchor-icon-link" anchorid="section1631316181327" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002510173709__p641016449312">AccessToken是ohpm-repo 2.1.0版本新引入的认证机制（需配套使用1.6.0及以上版本的ohpm命令行工具），用户通过ohpm-repo界面生成Token，并将其配置至ohpm客户端配置文件中。在与ohpm-repo交互时，客户端会自动附带Token进行身份验证。</p> <p id="ZH-CN_TOPIC_0000002510173709__p104109441937">该Token分两种权限等级：只读Token允许执行info和install操作；读写Token除了包含只读权限外，还支持publish，unpublish和dist-tags相关操作。每位用户每种权限类型的Token最多可生成10个，首次生成时系统自动复制到剪贴板，后续不再显示完整Token内容。AccessToken页面效果如下:</p> <p id="ZH-CN_TOPIC_0000002510173709__p620381715143"><span><img height="412.770421" originheight="668" originwidth="1259" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104733.58118126618464296667310723186819:50001231000000:2800:8970DCB46B60DCE73A9BA94518CAD5D12C33B118F5B2B04CBE12AA650F459907.png" title="点击放大" width="766.08"></span></p> <p id="ZH-CN_TOPIC_0000002510173709__p193241446934"></p> <ol id="ZH-CN_TOPIC_0000002510173709__ol137367286816"><li id="li173617281284">点击生成只读Token，ohpm-repo将自动生成一个专用于ohpm客户端进行包信息查询（info）和安装包（install）操作的认证Token，页面效果如下图所示：<p id="ZH-CN_TOPIC_0000002510173709__p859941891515"><span><img height="410.939011" originheight="668" originwidth="1259" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104733.45139743753415413615449315113977:50001231000000:2800:18D07C1FB04FEC2CE796297BE27ABCB13AC3429A44DF0D95548F6E654AFF455D.png" title="点击放大" width="762.787186"></span></p> </li><li id="li184954336812">点击生成读写Token，ohpm-repo将自动生成一个专用于ohpm客户端进行包信息查询（info）、安装包（install）、发布包（publish）、下架包（unpublish）和版本标记（dist-tags）操作的认证Token。页面效果如下图所示：<p id="ZH-CN_TOPIC_0000002510173709__p3749123892"><span><img height="414.929011" originheight="668" originwidth="1259" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104733.87403901944702739186569197696268:50001231000000:2800:334FB34138A96E3F12BE836C4A4FC86C7316AC027B77A26E83BD5329B8D2CDAF.png" title="点击放大" width="766.1768240000001"></span></p> <p id="ZH-CN_TOPIC_0000002510173709__p825719416496"></p> </li><li id="li419216401782">点击AccessToken指南，即刻显示使用教程，指导如何有效使用和配置AccessToken。页面效果如下图所示：<p id="ZH-CN_TOPIC_0000002510173709__p1926873971618"><span><img height="417.921511" originheight="668" originwidth="1259" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104733.54774032618246894593435250924440:50001231000000:2800:F5E50910896AC4598375831AC70C689E673F334B4330070BF7DD5F1481B63174.png" title="点击放大" width="763.774844"></span></p> </li><li id="li1218915421787">点击删除，删除对应的Token。页面效果如下图所示：<p id="ZH-CN_TOPIC_0000002510173709__p1872918961717"><span><img height="409.941511" originheight="668" originwidth="1259" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104733.48328308559851357549253652354954:50001231000000:2800:170C4CABA13D32E7B5EE4768DE3D99DD6F384EA73FECD61A2AA5A6C986649F1E.png" title="点击放大" width="755.152321"></span></p> <p id="ZH-CN_TOPIC_0000002510173709__p103236915178"></p> </li><li id="li168806431480">AccessToken的使用：<ol id="ZH-CN_TOPIC_0000002510173709__ol629319171517"><li id="li62934191514">通过ohpm-repo页面生成Token。</li><li id="li125161751141611">将Token配置在ohpm客户端的.ohpmrc配置文件中，配置示例如下所示:<div _ngcontent-bun-c106="" class="highlight-div"><div _ngcontent-bun-c106="" class="highlight-div-header"><div _ngcontent-bun-c106="" class="highlight-div-header-left"><div _ngcontent-bun-c106="" class="handle-button expand-button"><div _ngcontent-bun-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bun-c106="" class="highlight-div-header-right"><div _ngcontent-bun-c106="" class="handle-button ai-button"></div><div _ngcontent-bun-c106="" class="handle-button line-button"><div _ngcontent-bun-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bun-c106="" class="handle-button theme-button"><div _ngcontent-bun-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bun-c106="" class="handle-button copy-button"><div _ngcontent-bun-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bun-c106="" class="highlight-scroll-div"><pre class="codeblock prettyprint linenums hljs language-ruby" id="ZH-CN_TOPIC_0000002510173709__codeblock780121101818" hw-language="codeblock" data-highlighted="yes"><ol class="linenums"><li>/<span class="hljs-regexp">/127.0.0.1:8088/repos</span><span class="hljs-regexp">/ohpm/</span><span class="hljs-symbol">:_auth=readWriteToken</span></li><li>/<span class="hljs-regexp">/127.0.0.1:8088/repos</span><span class="hljs-regexp">/ohpm/</span><span class="hljs-symbol">:_read_auth=readOnlyToken</span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002510173709__p9423975183">其中//127.0.0.1:8088/repos/ohpm/是您ohpm-repo的registry地址去除协议名的部分，:_auth和:_read_auth分别代表配置为读写Token或只读Token，readWriteToken和readOnlyToken代表Token具体的值。ohpm客户端执行info、install操作会优先使用只读Token，如果只读Token不存在才会使用读写Token。ohpm客户端执行publish、unpublish和dist-tags操作时只会使用读写Token。每种Token最多配置三条。</p> </li></ol> </li></ol> </div> </div> <div></div></div>