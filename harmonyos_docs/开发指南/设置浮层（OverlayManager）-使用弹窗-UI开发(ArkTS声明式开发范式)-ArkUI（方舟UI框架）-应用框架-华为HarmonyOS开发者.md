<h1 _ngcontent-miy-c119="" class="doc-title ng-star-inserted" title="设置浮层（OverlayManager）"> 设置浮层（OverlayManager） </h1>

<div _ngcontent-miy-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>浮层（OverlayManager）用于在页面（Page）之上展示自定义的UI内容，位于Dialog、Popup、Menu、BindSheet、BindContentCover和Toast等组件之下，展示范围为当前窗口的安全区内，适用于常驻悬浮等场景。</p>    <p><span><img originheight="398" originwidth="391" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114854.39422442353913828410372193215579:50001231000000:2800:2AE43A97B9481007B098931680A0A2533E728992EDF019359538CEFC3EB0C45A.png" width="391" height="398"></span></p>    <p>可以通过使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-uicontext" target="_blank">UIContext</a>中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-uicontext#getoverlaymanager12" target="_blank">getOverlayManager</a>方法获取当前UI上下文关联的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-overlaymanager" target="_blank">OverlayManager</a>对象，再通过该对象调用对应方法。</p>    <div class="tiledSection">     <h2 id="规格约束">规格约束<i class="anchor-icon anchor-icon-link" anchorid="规格约束" tips="复制节点链接"></i></h2>          <ul>      <li>OverlayManager上节点的层级在Page页面层级之上，在Dialog、Popup、Menu、BindSheet、BindContentCover和Toast等组件之下。</li>      <li>OverlayManager添加的节点显示和消失时没有默认动画。</li>      <li>OverlayManager上节点安全区域内外的绘制方式与Page一致，键盘避让方式与Page一致。</li>      <li>推荐使用AppStorage存储与OverlayManager相关的属性，以避免页面切换时属性值变化导致业务错误。</li>      <li>当使用API version 19以下版本时，OverlayManager不支持侧滑（左滑/右滑）关闭，需在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-custom-component-lifecycle#onbackpress" target="_blank">onBackPress</a>中添加OverlayManager关闭的逻辑。API 19及以上版本可通过配置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-i#overlaymanageroptions15" target="_blank">OverlayManagerOptions</a>中的enableBackPressedEvent属性设置OverlayManager是否响应侧滑手势。</li>      <li>OverlayManager中的事件机制优先被WrappedBuilder装饰的组件接收。若需实现浮层底部接收事件，可通过设置hitTestBehavior为HitTestMode.Transparent将事件传递至底层。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="设置浮层">设置浮层<i class="anchor-icon anchor-icon-link" anchorid="设置浮层" tips="复制节点链接"></i></h2>          <p>在OverlayManager上<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-overlaymanager#addcomponentcontent12" target="_blank">新增指定节点（addComponentContent）</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-overlaymanager#removecomponentcontent12" target="_blank">删除指定节点（removeComponentContent）</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-overlaymanager#showallcomponentcontents12" target="_blank">显示所有节点（showAllComponentContents）</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-overlaymanager#hideallcomponentcontents12" target="_blank">隐藏所有节点（hideAllComponentContents）</a>。</p>     <div _ngcontent-miy-c106="" class="highlight-div"><div _ngcontent-miy-c106="" class="highlight-div-header"><div _ngcontent-miy-c106="" class="highlight-div-header-left"><div _ngcontent-miy-c106="" class="handle-button expand-button"><div _ngcontent-miy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-miy-c106="" class="highlight-div-header-right"><div _ngcontent-miy-c106="" class="handle-button ai-button"></div><div _ngcontent-miy-c106="" class="handle-button line-button"><div _ngcontent-miy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-miy-c106="" class="handle-button theme-button"><div _ngcontent-miy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-miy-c106="" class="handle-button copy-button"><div _ngcontent-miy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-miy-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ComponentContent</span>, <span class="hljs-title class_">OverlayManager</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Params</span> {</li><li>  <span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">""</span>;</li><li>  <span class="hljs-attr">offset</span>: <span class="hljs-title class_">Position</span>;</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">text: <span class="hljs-built_in">string</span>, offset: Position</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">text</span> = text;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">offset</span> = offset;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Builder</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">builderText</span>(<span class="hljs-params">params: Params</span>) {</li><li>  <span class="hljs-title class_">Column</span>() {</li><li>    <span class="hljs-title class_">Text</span>(params.<span class="hljs-property">text</span>)</li><li>      .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>      .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>  }.<span class="hljs-title function_">offset</span>(params.<span class="hljs-property">offset</span>)</li><li>}</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">initOverlayNode</span>(<span class="hljs-params">uiContext: UIContext</span>): <span class="hljs-title class_">OverlayManager</span> {</li><li>  uiContext.<span class="hljs-title function_">setOverlayManagerOptions</span>({</li><li>    <span class="hljs-attr">enableBackPressedEvent</span>: <span class="hljs-literal">true</span></li><li>  });</li><li>  <span class="hljs-keyword">return</span> uiContext.<span class="hljs-title function_">getOverlayManager</span>();</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">OverlayExample</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'ComponentContent'</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">uiContext</span>: <span class="hljs-title class_">UIContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">overlayNode</span>: <span class="hljs-title class_">OverlayManager</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>.<span class="hljs-title function_">getOverlayManager</span>();</li><li>  <span class="hljs-meta">@StorageLink</span>(<span class="hljs-string">'contentArray'</span>) <span class="hljs-attr">contentArray</span>: <span class="hljs-title class_">ComponentContent</span>&lt;<span class="hljs-title class_">Params</span>&gt;[] = [];</li><li>  <span class="hljs-meta">@StorageLink</span>(<span class="hljs-string">'componentContentIndex'</span>) <span class="hljs-attr">componentContentIndex</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-meta">@StorageLink</span>(<span class="hljs-string">'arrayIndex'</span>) <span class="hljs-attr">arrayIndex</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-meta">@StorageLink</span>(<span class="hljs-string">"componentOffset"</span>) <span class="hljs-attr">componentOffset</span>: <span class="hljs-title class_">Position</span> = { <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">30</span> };</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">10</span> }) {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"递增componentContentIndex: "</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">componentContentIndex</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        ++<span class="hljs-variable language_">this</span>.<span class="hljs-property">componentContentIndex</span>;</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"递减componentContentIndex: "</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">componentContentIndex</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        --<span class="hljs-variable language_">this</span>.<span class="hljs-property">componentContentIndex</span>;</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"增加ComponentContent"</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentArray</span>.<span class="hljs-property">length</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-keyword">let</span> componentContent = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ComponentContent</span>(</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>, wrapBuilder&lt;[<span class="hljs-title class_">Params</span>]&gt;(builderText),</li><li>          <span class="hljs-keyword">new</span> <span class="hljs-title class_">Params</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span> + (<span class="hljs-variable language_">this</span>.<span class="hljs-property">contentArray</span>.<span class="hljs-property">length</span>), <span class="hljs-variable language_">this</span>.<span class="hljs-property">componentOffset</span>)</li><li>        );</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentArray</span>.<span class="hljs-title function_">push</span>(componentContent);</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">overlayNode</span>.<span class="hljs-title function_">addComponentContent</span>(componentContent, <span class="hljs-variable language_">this</span>.<span class="hljs-property">componentContentIndex</span>);</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"递增arrayIndex: "</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayIndex</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        ++<span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayIndex</span>;</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"递减arrayIndex: "</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayIndex</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        --<span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayIndex</span>;</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"删除ComponentContent"</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayIndex</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayIndex</span> &gt;= <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayIndex</span> &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentArray</span>.<span class="hljs-property">length</span>) {</li><li>          <span class="hljs-keyword">let</span> componentContent = <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentArray</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayIndex</span>, <span class="hljs-number">1</span>);</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">overlayNode</span>.<span class="hljs-title function_">removeComponentContent</span>(componentContent.<span class="hljs-title function_">pop</span>());</li><li>        } <span class="hljs-keyword">else</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"arrayIndex有误"</span>);</li><li>        }</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"显示ComponentContent"</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayIndex</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayIndex</span> &gt;= <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayIndex</span> &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentArray</span>.<span class="hljs-property">length</span>) {</li><li>          <span class="hljs-keyword">let</span> componentContent = <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentArray</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayIndex</span>];</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">overlayNode</span>.<span class="hljs-title function_">showComponentContent</span>(componentContent);</li><li>        } <span class="hljs-keyword">else</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"arrayIndex有误"</span>);</li><li>        }</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"隐藏ComponentContent"</span> + <span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayIndex</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayIndex</span> &gt;= <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayIndex</span> &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentArray</span>.<span class="hljs-property">length</span>) {</li><li>          <span class="hljs-keyword">let</span> componentContent = <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentArray</span>[<span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayIndex</span>];</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-property">overlayNode</span>.<span class="hljs-title function_">hideComponentContent</span>(componentContent);</li><li>        } <span class="hljs-keyword">else</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"arrayIndex有误"</span>);</li><li>        }</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"显示所有ComponentContent"</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">overlayNode</span>.<span class="hljs-title function_">showAllComponentContents</span>();</li><li>      })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"隐藏所有ComponentContent"</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">overlayNode</span>.<span class="hljs-title function_">hideAllComponentContents</span>();</li><li>      })</li><li>
</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">"跳转页面"</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getRouter</span>().<span class="hljs-title function_">pushUrl</span>({</li><li>          <span class="hljs-attr">url</span>: <span class="hljs-string">'pages/Second'</span></li><li>        })</li><li>      })</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="642" originwidth="409" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114854.50945286867173677270893623686853:50001231000000:2800:12036345B2186D821CB3A890D835A3549F3B54E0CD7B67E2CE343B5B2D2F12A7.gif" width="409" height="642"></span></p>     <p>显示一个始终在屏幕左侧的悬浮球，点击可以弹出alertDialog弹窗。</p>     <div _ngcontent-miy-c106="" class="highlight-div"><div _ngcontent-miy-c106="" class="highlight-div-header"><div _ngcontent-miy-c106="" class="highlight-div-header-left"><div _ngcontent-miy-c106="" class="handle-button expand-button"><div _ngcontent-miy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-miy-c106="" class="highlight-div-header-right"><div _ngcontent-miy-c106="" class="handle-button ai-button"></div><div _ngcontent-miy-c106="" class="handle-button line-button"><div _ngcontent-miy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-miy-c106="" class="handle-button theme-button"><div _ngcontent-miy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-miy-c106="" class="handle-button copy-button"><div _ngcontent-miy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-miy-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ComponentContent</span>, <span class="hljs-title class_">OverlayManager</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Params</span> {</li><li>  <span class="hljs-attr">context</span>: <span class="hljs-title class_">UIContext</span>;</li><li>  <span class="hljs-attr">offset</span>: <span class="hljs-title class_">Position</span>;</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">context: UIContext, offset: Position</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">context</span> = context;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">offset</span> = offset;</li><li>  }</li><li>}</li><li><span class="hljs-meta">@Builder</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">builderOverlay</span>(<span class="hljs-params">params: Params</span>) {</li><li>  <span class="hljs-title class_">Column</span>() {</li><li>    <span class="hljs-title class_">Stack</span>(){</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-number">50</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Yellow</span>).<span class="hljs-title function_">position</span>(params.<span class="hljs-property">offset</span>).<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">50</span>)</li><li>    .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>      params.<span class="hljs-property">context</span>.<span class="hljs-title function_">showAlertDialog</span>(</li><li>        {</li><li>          <span class="hljs-attr">title</span>: <span class="hljs-string">'title'</span>,</li><li>          <span class="hljs-attr">message</span>: <span class="hljs-string">'Text'</span>,</li><li>          <span class="hljs-attr">autoCancel</span>: <span class="hljs-literal">true</span>,</li><li>          <span class="hljs-attr">alignment</span>: <span class="hljs-title class_">DialogAlignment</span>.<span class="hljs-property">Center</span>,</li><li>          <span class="hljs-attr">gridCount</span>: <span class="hljs-number">3</span>,</li><li>          <span class="hljs-attr">confirm</span>: {</li><li>            <span class="hljs-attr">value</span>: <span class="hljs-string">'Button'</span>,</li><li>            <span class="hljs-attr">action</span>: <span class="hljs-function">() =&gt;</span> {}</li><li>          },</li><li>          <span class="hljs-attr">cancel</span>: <span class="hljs-function">() =&gt;</span> {}</li><li>        }</li><li>      )</li><li>    })</li><li>  }.<span class="hljs-title function_">focusable</span>(<span class="hljs-literal">false</span>).<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">hitTestBehavior</span>(<span class="hljs-title class_">HitTestMode</span>.<span class="hljs-property">Transparent</span>)</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">OverlayExample</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">uiContext</span>: <span class="hljs-title class_">UIContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">overlayNode</span>: <span class="hljs-title class_">OverlayManager</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>.<span class="hljs-title function_">getOverlayManager</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">overlayContent</span>:<span class="hljs-title class_">ComponentContent</span>&lt;<span class="hljs-title class_">Params</span>&gt;[] = [];</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">TextInputController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TextInputController</span>();</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">let</span> uiContext = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>();</li><li>    <span class="hljs-keyword">let</span> componentContent = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ComponentContent</span>(</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>, wrapBuilder&lt;[<span class="hljs-title class_">Params</span>]&gt;(builderOverlay),</li><li>      <span class="hljs-keyword">new</span> <span class="hljs-title class_">Params</span>(uiContext, {<span class="hljs-attr">x</span>:<span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">100</span>})</li><li>    );</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">overlayNode</span>.<span class="hljs-title function_">addComponentContent</span>(componentContent, <span class="hljs-number">0</span>);</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">overlayContent</span>.<span class="hljs-title function_">push</span>(componentContent);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">aboutToDisappear</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-keyword">let</span> componentContent = <span class="hljs-variable language_">this</span>.<span class="hljs-property">overlayContent</span>.<span class="hljs-title function_">pop</span>();</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">overlayNode</span>.<span class="hljs-title function_">removeComponentContent</span>(componentContent);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>
</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="664" originwidth="350" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114854.75693181111706047572842929826926:50001231000000:2800:9D7F88E0BBF73F8F00AB784582D4F1DDE18069A7A72A6AEC46A0E12C57C42AF4.gif" width="350" height="664"></span></p>     <p>从API version 18开始，可以通过调用UIContext中getOverlayManager方法获取OverlayManager对象，并利用该对象在指定层级上新增指定节点（<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-overlaymanager#addcomponentcontentwithorder18" target="_blank">addComponentContentWithOrder</a>），层次高的浮层会覆盖在层级低的浮层之上。</p>     <div _ngcontent-miy-c106="" class="highlight-div"><div _ngcontent-miy-c106="" class="highlight-div-header"><div _ngcontent-miy-c106="" class="highlight-div-header-left"><div _ngcontent-miy-c106="" class="handle-button expand-button"><div _ngcontent-miy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-miy-c106="" class="highlight-div-header-right"><div _ngcontent-miy-c106="" class="handle-button ai-button"></div><div _ngcontent-miy-c106="" class="handle-button line-button"><div _ngcontent-miy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-miy-c106="" class="handle-button theme-button"><div _ngcontent-miy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-miy-c106="" class="handle-button copy-button"><div _ngcontent-miy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-miy-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">ComponentContent</span>, <span class="hljs-title class_">LevelOrder</span>, <span class="hljs-title class_">OverlayManager</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkUI'</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Params</span> {</li><li>  <span class="hljs-attr">text</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">""</span>;</li><li>  <span class="hljs-attr">offset</span>: <span class="hljs-title class_">Position</span>;</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">text: <span class="hljs-built_in">string</span>, offset: Position</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">text</span> = text;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">offset</span> = offset;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Builder</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">builderTopText</span>(<span class="hljs-params">params: Params</span>) {</li><li>  <span class="hljs-title class_">Column</span>() {</li><li>    <span class="hljs-title class_">Stack</span>(){</li><li>      <span class="hljs-title class_">Text</span>(params.<span class="hljs-property">text</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-number">300</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">padding</span>(<span class="hljs-number">5</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F7F7F7'</span>).<span class="hljs-title function_">alignContent</span>(<span class="hljs-title class_">Alignment</span>.<span class="hljs-property">Top</span>)</li><li>  }.<span class="hljs-title function_">offset</span>(params.<span class="hljs-property">offset</span>)</li><li>}</li><li>
</li><li><span class="hljs-meta">@Builder</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">builderNormalText</span>(<span class="hljs-params">params: Params</span>) {</li><li>  <span class="hljs-title class_">Column</span>() {</li><li>    <span class="hljs-title class_">Stack</span>(){</li><li>      <span class="hljs-title class_">Text</span>(params.<span class="hljs-property">text</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>    }.<span class="hljs-title function_">width</span>(<span class="hljs-number">300</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">400</span>).<span class="hljs-title function_">padding</span>(<span class="hljs-number">5</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#D5D5D5'</span>).<span class="hljs-title function_">alignContent</span>(<span class="hljs-title class_">Alignment</span>.<span class="hljs-property">Top</span>)</li><li>  }.<span class="hljs-title function_">offset</span>(params.<span class="hljs-property">offset</span>)</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">ctx</span>: <span class="hljs-title class_">UIContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>();</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-attr">overlayManager</span>: <span class="hljs-title class_">OverlayManager</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>.<span class="hljs-title function_">getOverlayManager</span>();</li><li>  <span class="hljs-meta">@StorageLink</span>(<span class="hljs-string">'contentArray'</span>) <span class="hljs-attr">contentArray</span>: <span class="hljs-title class_">ComponentContent</span>&lt;<span class="hljs-title class_">Params</span>&gt;[] = [];</li><li>  <span class="hljs-meta">@StorageLink</span>(<span class="hljs-string">'componentContentIndex'</span>) <span class="hljs-attr">componentContentIndex</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-meta">@StorageLink</span>(<span class="hljs-string">'arrayIndex'</span>) <span class="hljs-attr">arrayIndex</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-meta">@StorageLink</span>(<span class="hljs-string">'componentOffset'</span>) <span class="hljs-attr">componentOffset</span>: <span class="hljs-title class_">Position</span> = {<span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">80</span>};</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>({ <span class="hljs-attr">space</span>: <span class="hljs-number">5</span> }) {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'点击打开置顶弹窗'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">let</span> componentContent = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ComponentContent</span>(</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>, wrapBuilder&lt;[<span class="hljs-title class_">Params</span>]&gt;(builderTopText),</li><li>              <span class="hljs-keyword">new</span> <span class="hljs-title class_">Params</span>(<span class="hljs-string">'我是置顶弹窗'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">componentOffset</span>)</li><li>            );</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentArray</span>.<span class="hljs-title function_">push</span>(componentContent);</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">overlayManager</span>.<span class="hljs-title function_">addComponentContentWithOrder</span>(componentContent, <span class="hljs-title class_">LevelOrder</span>.<span class="hljs-title function_">clamp</span>(<span class="hljs-number">100000</span>));</li><li>          })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'点击打开普通弹窗'</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-keyword">let</span> componentContent = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ComponentContent</span>(</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">ctx</span>, wrapBuilder&lt;[<span class="hljs-title class_">Params</span>]&gt;(builderNormalText),</li><li>              <span class="hljs-keyword">new</span> <span class="hljs-title class_">Params</span>(<span class="hljs-string">'我是普通弹窗'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">componentOffset</span>)</li><li>            );</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentArray</span>.<span class="hljs-title function_">push</span>(componentContent);</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">overlayManager</span>.<span class="hljs-title function_">addComponentContentWithOrder</span>(componentContent, <span class="hljs-title class_">LevelOrder</span>.<span class="hljs-title function_">clamp</span>(<span class="hljs-number">0</span>));</li><li>          })</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">"点击移除弹窗"</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">()=&gt;</span>{</li><li>          <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayIndex</span> &gt;= <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayIndex</span> &lt; <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentArray</span>.<span class="hljs-property">length</span>) {</li><li>            <span class="hljs-keyword">let</span> componentContent = <span class="hljs-variable language_">this</span>.<span class="hljs-property">contentArray</span>.<span class="hljs-title function_">splice</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayIndex</span>, <span class="hljs-number">1</span>);</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">overlayManager</span>.<span class="hljs-title function_">removeComponentContent</span>(componentContent.<span class="hljs-title function_">pop</span>());</li><li>          } <span class="hljs-keyword">else</span> {</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">"arrayIndex有误"</span>);</li><li>          }</li><li>        })</li><li>      }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div>     <p><span><img originheight="755" originwidth="430" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114854.05656887321429478112900570511809:50001231000000:2800:18E357019CC578A2B0F3AA6F12B17B58D645A6A2D2F4F1E01FB4D8951AF453DF.gif" width="430" height="755"></span></p>    </div>   </div>   <div></div></div>