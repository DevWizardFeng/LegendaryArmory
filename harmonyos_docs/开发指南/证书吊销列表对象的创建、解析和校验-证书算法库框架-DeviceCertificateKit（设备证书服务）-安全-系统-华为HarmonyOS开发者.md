<h1 _ngcontent-yfy-c119="" class="doc-title ng-star-inserted" title="证书吊销列表对象的创建、解析和校验"> 证书吊销列表对象的创建、解析和校验 </h1>

<div _ngcontent-yfy-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>以校验证书是否已吊销为例，完成证书吊销列表对象的创建、解析和校验。若证书已被吊销，将打印被吊销日期。</p>    <div class="tiledSection">     <h2 id="开发步骤">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="开发步骤" tips="复制节点链接"></i></h2>          <ol>      <li>       <p>导入<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cert" target="_blank">证书算法库框架模块</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cryptoframework" target="_blank">加解密算法库模块</a>。</p>       <div _ngcontent-yfy-c106="" class="highlight-div"><div _ngcontent-yfy-c106="" class="highlight-div-header"><div _ngcontent-yfy-c106="" class="highlight-div-header-left"><div _ngcontent-yfy-c106="" class="handle-button expand-button"><div _ngcontent-yfy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yfy-c106="" class="highlight-div-header-right"><div _ngcontent-yfy-c106="" class="handle-button ai-button"></div><div _ngcontent-yfy-c106="" class="handle-button line-button"><div _ngcontent-yfy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yfy-c106="" class="handle-button theme-button"><div _ngcontent-yfy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yfy-c106="" class="handle-button copy-button"><div _ngcontent-yfy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yfy-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { cert } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DeviceCertificateKit'</span>;</li><li><span class="hljs-keyword">import</span> { cryptoFramework } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CryptoArchitectureKit'</span>;</li></ol></pre></div></div></li>      <li>       <p>基于已有的CRL数据，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cert#certcreatex509crl11" target="_blank">cert.createX509CRL</a>创建X509证书吊销列表的对象。</p></li>      <li>       <p>解析证书吊销列表信息。</p>       <p>此处以获取证书吊销列表版本、证书吊销列表类型、证书吊销列表颁发者名称、证书吊销列表对象的字符串类型数据为例，更多字段信息获取接口请查看<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cert#x509crl11" target="_blank">API参考文档</a>。</p></li>      <li>       <p>基于已有公钥信息，创建PublicKey公钥对象。</p>       <p>具体可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cryptoframework#convertkey-3" target="_blank">加解密算法库框架-指定二进制数据生成非对称密钥对</a>。</p></li>      <li>       <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cert#verify11" target="_blank">X509CRL.verify</a>校验签名合法性。</p></li>      <li>       <p>基于已有的X509证书数据，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cert#certcreatex509cert" target="_blank">cert.createX509Cert</a>创建证书对象。</p></li>      <li>       <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cert#isrevoked11" target="_blank">X509CRL.isRevoked</a>判断X509证书是否已被吊销。</p></li>      <li>       <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cert#getrevokedcert11" target="_blank">X509CRL.getRevokedCert</a>获取被吊销证书对象。</p></li>      <li>       <p>调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-cert#getrevocationdate11" target="_blank">X509CRLEntry.getRevocationDate</a>获取被吊销日期。</p></li>     </ol>     <div _ngcontent-yfy-c106="" class="highlight-div"><div _ngcontent-yfy-c106="" class="highlight-div-header"><div _ngcontent-yfy-c106="" class="highlight-div-header-left"><div _ngcontent-yfy-c106="" class="handle-button expand-button"><div _ngcontent-yfy-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yfy-c106="" class="highlight-div-header-right"><div _ngcontent-yfy-c106="" class="handle-button ai-button"></div><div _ngcontent-yfy-c106="" class="handle-button line-button"><div _ngcontent-yfy-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yfy-c106="" class="handle-button theme-button"><div _ngcontent-yfy-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yfy-c106="" class="handle-button copy-button"><div _ngcontent-yfy-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yfy-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { cert } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.DeviceCertificateKit'</span>;</li><li><span class="hljs-keyword">import</span> { cryptoFramework } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.CryptoArchitectureKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { util } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkTS'</span>;</li><li>
</li><li><span class="hljs-comment">// CRL数据，以下只是一个示例，需要根据具体业务来赋值。</span></li><li><span class="hljs-keyword">let</span> crlData = <span class="hljs-string">'-----BEGIN X509 CRL-----\n'</span> +</li><li>  <span class="hljs-string">'MIIByzCBtAIBATANBgkqhkiG9w0BAQsFADBXMQswCQYDVQQGEwJDTjEPMA0GA1UE\n'</span> +</li><li>  <span class="hljs-string">'CAwG6ZmV6KW/MQ8wDQYDVQQHDAbopb/lrokxDzANBgNVBAoMBua1i+ivlTEVMBMG\n'</span> +</li><li>  <span class="hljs-string">'A1UEAwwM5Lit5paH5rWL6K+VFw0yNTAyMjAwNjEzMTZaFw0yNTAzMjIwNjEzMTZa\n'</span> +</li><li>  <span class="hljs-string">'MBkwFwIGAXKnJjrAFw0yNTAyMjAwNjEzMDNaoA4wDDAKBgNVHRQEAwIBADANBgkq\n'</span> +</li><li>  <span class="hljs-string">'hkiG9w0BAQsFAAOCAQEAt9AZ/B5FQiXnKKBGocKmM5QKeky/3etcI+cAVyD0zfjI\n'</span> +</li><li>  <span class="hljs-string">'r1UrL1aF+49LdZps3zQRqm4RQmo9CwL+KsMZiIMSeWF5Q6LW7BQa08hx5PtdjoOu\n'</span> +</li><li>  <span class="hljs-string">'1IWVKAwR5IigpaOwMKRTq1xJ372EiUkDD83AsxEkQoQW0bBvFklGrzglSACeKST+\n'</span> +</li><li>  <span class="hljs-string">'Pn6ywwFyYj34cfRuz3ueqwHRmN/mGzQdet7Ns8JBGWutDzfJsAiPC/TIaafTOocO\n'</span> +</li><li>  <span class="hljs-string">'CHo81Q2rMcqAJj5uXyc1Gq8KfOEqsxo/oDwReghjwrUedJ+9l/cQBr0F8HPV4H8W\n'</span> +</li><li>  <span class="hljs-string">'49sYMpseywjp9lxjWt/2nrx1z2yMaivGrVhoFasZvQ==\n'</span> +</li><li>  <span class="hljs-string">'-----END X509 CRL-----\n'</span></li><li>
</li><li><span class="hljs-keyword">let</span> certData = <span class="hljs-string">'-----BEGIN CERTIFICATE-----\n'</span> +</li><li>  <span class="hljs-string">'MIIDgTCCAmmgAwIBAgIGAXKnJjrAMA0GCSqGSIb3DQEBCwUAMFcxCzAJBgNVBAYT\n'</span> +</li><li>  <span class="hljs-string">'AkNOMQ8wDQYDVQQIDAbpmZXopb8xDzANBgNVBAcMBuilv+WuiTEPMA0GA1UECgwG\n'</span> +</li><li>  <span class="hljs-string">'5rWL6K+VMRUwEwYDVQQDDAzkuK3mlofmtYvor5UwHhcNMjUwMjIwMDYwOTUyWhcN\n'</span> +</li><li>  <span class="hljs-string">'MzUwMjE4MDYwOTUyWjBXMQswCQYDVQQGEwJDTjEPMA0GA1UECAwG6ZmV6KW/MQ8w\n'</span> +</li><li>  <span class="hljs-string">'DQYDVQQHDAbopb/lrokxDzANBgNVBAoMBua1i+ivlTEVMBMGA1UEAwwM5Lit5paH\n'</span> +</li><li>  <span class="hljs-string">'5rWL6K+VMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA2DQpPYN7cJjQ\n'</span> +</li><li>  <span class="hljs-string">'LWLlkP5dD8J/g1xx97t2bFciUOru14IBm9EeX6qkohDSl6kQHwfVSqTfcqdIn9We\n'</span> +</li><li>  <span class="hljs-string">'73FiitfDjHc9xxbvBKbCYicCzS/eNl0W9q14FiEB8M9vz4dpKK00KZBcGc1QK2m+\n'</span> +</li><li>  <span class="hljs-string">'/N6zw4Tw4wXZ97v6/M+bhY5X0b3qEJlgQNyz7dD0wF7SCuzLL9zbr403KktHMG5Y\n'</span> +</li><li>  <span class="hljs-string">'MzyOBaGOaMuVQFlXMV/E5OWfqbM7n0Pu/cGj+AfkkziWxB+5WFCRP6Pw64LJGo+e\n'</span> +</li><li>  <span class="hljs-string">'uZHgHp07kk6+a2YNnFMcdTsOIWBSpCvC3I612NjpBirn2bFRWqTD++YAuvJQagmM\n'</span> +</li><li>  <span class="hljs-string">'+VhIjXD48wIDAQABo1MwUTAdBgNVHQ4EFgQUIN7ulBn89L5HXh9m9JM7rpkvlXUw\n'</span> +</li><li>  <span class="hljs-string">'HwYDVR0jBBgwFoAUIN7ulBn89L5HXh9m9JM7rpkvlXUwDwYDVR0TAQH/BAUwAwEB\n'</span> +</li><li>  <span class="hljs-string">'/zANBgkqhkiG9w0BAQsFAAOCAQEAxWNa3LSOR3QOJ+wE1Y/q5zzEPWmWR5OMrRJK\n'</span> +</li><li>  <span class="hljs-string">'juBHhYbzsg3r74fBO3Hw8XggEpHr6SOI1rBpZhciA8D9E8RnM1aJLY53rpBDY5OV\n'</span> +</li><li>  <span class="hljs-string">'wxTFzrjdwIknt13t6ILfGeLye5OAF0S8VPdfDqP9NddNNr/WFKpd3tKoBlG0ObMa\n'</span> +</li><li>  <span class="hljs-string">'LaQvOqObz0MJrjKsyI680nJjFLjLZ6+lEDSg4rsGU+bxEkONerStAPNcN2x9z7O6\n'</span> +</li><li>  <span class="hljs-string">'YJOvhiLjWvr8VRjlMZYVmT9gqCImoo+7JaHbu8jz9mjRxD6fo9I1OvCLNFyFw2sV\n'</span> +</li><li>  <span class="hljs-string">'iYID9UEbT6IWv/kKBdr7Te9+SY6AWxUxO8Hd7HdPKDOCrGrU9A==\n'</span> +</li><li>  <span class="hljs-string">'-----END CERTIFICATE-----\n'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> pubKeyData = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Uint8Array</span>([</li><li>  <span class="hljs-number">0x30</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x86</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x01</span>,</li><li>  <span class="hljs-number">0x01</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x0f</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x01</span>,</li><li>  <span class="hljs-number">0x00</span>, <span class="hljs-number">0xd8</span>, <span class="hljs-number">0x34</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x3d</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x7b</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0x98</span>, <span class="hljs-number">0xd0</span>, <span class="hljs-number">0x2d</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0xfe</span>, <span class="hljs-number">0x5d</span>,</li><li>  <span class="hljs-number">0x0f</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0x7f</span>, <span class="hljs-number">0x83</span>, <span class="hljs-number">0x5c</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0xbb</span>, <span class="hljs-number">0x76</span>, <span class="hljs-number">0x6c</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x22</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0xea</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0xd7</span>,</li><li>  <span class="hljs-number">0x82</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0xd1</span>, <span class="hljs-number">0x1e</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0xaa</span>, <span class="hljs-number">0xa4</span>, <span class="hljs-number">0xa2</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0xd2</span>, <span class="hljs-number">0x97</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0x10</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0x07</span>,</li><li>  <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x4a</span>, <span class="hljs-number">0xa4</span>, <span class="hljs-number">0xdf</span>, <span class="hljs-number">0x72</span>, <span class="hljs-number">0xa7</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x9f</span>, <span class="hljs-number">0xd5</span>, <span class="hljs-number">0x9e</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0x71</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x8a</span>, <span class="hljs-number">0xd7</span>, <span class="hljs-number">0xc3</span>,</li><li>  <span class="hljs-number">0x8c</span>, <span class="hljs-number">0x77</span>, <span class="hljs-number">0x3d</span>, <span class="hljs-number">0xc7</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xef</span>, <span class="hljs-number">0x04</span>, <span class="hljs-number">0xa6</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0x62</span>, <span class="hljs-number">0x27</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0xcd</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0x36</span>,</li><li>  <span class="hljs-number">0x5d</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0xf6</span>, <span class="hljs-number">0xad</span>, <span class="hljs-number">0x78</span>, <span class="hljs-number">0x16</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0xf0</span>, <span class="hljs-number">0xcf</span>, <span class="hljs-number">0x6f</span>, <span class="hljs-number">0xcf</span>, <span class="hljs-number">0x87</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0x28</span>, <span class="hljs-number">0xad</span>,</li><li>  <span class="hljs-number">0x34</span>, <span class="hljs-number">0x29</span>, <span class="hljs-number">0x90</span>, <span class="hljs-number">0x5c</span>, <span class="hljs-number">0x19</span>, <span class="hljs-number">0xcd</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x2b</span>, <span class="hljs-number">0x69</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0xde</span>, <span class="hljs-number">0xb3</span>, <span class="hljs-number">0xc3</span>, <span class="hljs-number">0x84</span>, <span class="hljs-number">0xf0</span>,</li><li>  <span class="hljs-number">0xe3</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0xd9</span>, <span class="hljs-number">0xf7</span>, <span class="hljs-number">0xbb</span>, <span class="hljs-number">0xfa</span>, <span class="hljs-number">0xfc</span>, <span class="hljs-number">0xcf</span>, <span class="hljs-number">0x9b</span>, <span class="hljs-number">0x85</span>, <span class="hljs-number">0x8e</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0xd1</span>, <span class="hljs-number">0xbd</span>, <span class="hljs-number">0xea</span>, <span class="hljs-number">0x10</span>,</li><li>  <span class="hljs-number">0x99</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0xdc</span>, <span class="hljs-number">0xb3</span>, <span class="hljs-number">0xed</span>, <span class="hljs-number">0xd0</span>, <span class="hljs-number">0xf4</span>, <span class="hljs-number">0xc0</span>, <span class="hljs-number">0x5e</span>, <span class="hljs-number">0xd2</span>, <span class="hljs-number">0x0a</span>, <span class="hljs-number">0xec</span>, <span class="hljs-number">0xcb</span>, <span class="hljs-number">0x2f</span>, <span class="hljs-number">0xdc</span>,</li><li>  <span class="hljs-number">0xdb</span>, <span class="hljs-number">0xaf</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0x37</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0x4b</span>, <span class="hljs-number">0x47</span>, <span class="hljs-number">0x30</span>, <span class="hljs-number">0x6e</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x33</span>, <span class="hljs-number">0x3c</span>, <span class="hljs-number">0x8e</span>, <span class="hljs-number">0x05</span>, <span class="hljs-number">0xa1</span>, <span class="hljs-number">0x8e</span>,</li><li>  <span class="hljs-number">0x68</span>, <span class="hljs-number">0xcb</span>, <span class="hljs-number">0x95</span>, <span class="hljs-number">0x40</span>, <span class="hljs-number">0x59</span>, <span class="hljs-number">0x57</span>, <span class="hljs-number">0x31</span>, <span class="hljs-number">0x5f</span>, <span class="hljs-number">0xc4</span>, <span class="hljs-number">0xe4</span>, <span class="hljs-number">0xe5</span>, <span class="hljs-number">0x9f</span>, <span class="hljs-number">0xa9</span>, <span class="hljs-number">0xb3</span>, <span class="hljs-number">0x3b</span>, <span class="hljs-number">0x9f</span>,</li><li>  <span class="hljs-number">0x43</span>, <span class="hljs-number">0xee</span>, <span class="hljs-number">0xfd</span>, <span class="hljs-number">0xc1</span>, <span class="hljs-number">0xa3</span>, <span class="hljs-number">0xf8</span>, <span class="hljs-number">0x07</span>, <span class="hljs-number">0xe4</span>, <span class="hljs-number">0x93</span>, <span class="hljs-number">0x38</span>, <span class="hljs-number">0x96</span>, <span class="hljs-number">0xc4</span>, <span class="hljs-number">0x1f</span>, <span class="hljs-number">0xb9</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x50</span>,</li><li>  <span class="hljs-number">0x91</span>, <span class="hljs-number">0x3f</span>, <span class="hljs-number">0xa3</span>, <span class="hljs-number">0xf0</span>, <span class="hljs-number">0xeb</span>, <span class="hljs-number">0x82</span>, <span class="hljs-number">0xc9</span>, <span class="hljs-number">0x1a</span>, <span class="hljs-number">0x8f</span>, <span class="hljs-number">0x9e</span>, <span class="hljs-number">0xb9</span>, <span class="hljs-number">0x91</span>, <span class="hljs-number">0xe0</span>, <span class="hljs-number">0x1e</span>, <span class="hljs-number">0x9d</span>, <span class="hljs-number">0x3b</span>,</li><li>  <span class="hljs-number">0x92</span>, <span class="hljs-number">0x4e</span>, <span class="hljs-number">0xbe</span>, <span class="hljs-number">0x6b</span>, <span class="hljs-number">0x66</span>, <span class="hljs-number">0x0d</span>, <span class="hljs-number">0x9c</span>, <span class="hljs-number">0x53</span>, <span class="hljs-number">0x1c</span>, <span class="hljs-number">0x75</span>, <span class="hljs-number">0x3b</span>, <span class="hljs-number">0x0e</span>, <span class="hljs-number">0x21</span>, <span class="hljs-number">0x60</span>, <span class="hljs-number">0x52</span>, <span class="hljs-number">0xa4</span>,</li><li>  <span class="hljs-number">0x2b</span>, <span class="hljs-number">0xc2</span>, <span class="hljs-number">0xdc</span>, <span class="hljs-number">0x8e</span>, <span class="hljs-number">0xb5</span>, <span class="hljs-number">0xd8</span>, <span class="hljs-number">0xd8</span>, <span class="hljs-number">0xe9</span>, <span class="hljs-number">0x06</span>, <span class="hljs-number">0x2a</span>, <span class="hljs-number">0xe7</span>, <span class="hljs-number">0xd9</span>, <span class="hljs-number">0xb1</span>, <span class="hljs-number">0x51</span>, <span class="hljs-number">0x5a</span>, <span class="hljs-number">0xa4</span>,</li><li>  <span class="hljs-number">0xc3</span>, <span class="hljs-number">0xfb</span>, <span class="hljs-number">0xe6</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0xba</span>, <span class="hljs-number">0xf2</span>, <span class="hljs-number">0x50</span>, <span class="hljs-number">0x6a</span>, <span class="hljs-number">0x09</span>, <span class="hljs-number">0x8c</span>, <span class="hljs-number">0xf9</span>, <span class="hljs-number">0x58</span>, <span class="hljs-number">0x48</span>, <span class="hljs-number">0x8d</span>, <span class="hljs-number">0x70</span>, <span class="hljs-number">0xf8</span>,</li><li>  <span class="hljs-number">0xf3</span>, <span class="hljs-number">0x02</span>, <span class="hljs-number">0x03</span>, <span class="hljs-number">0x01</span>, <span class="hljs-number">0x00</span>, <span class="hljs-number">0x01</span></li><li>]);</li><li>
</li><li><span class="hljs-comment">// CRL示例</span></li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">crlSample</span>(<span class="hljs-params"></span>): <span class="hljs-built_in">void</span> {</li><li>  <span class="hljs-keyword">let</span> textEncoder = <span class="hljs-keyword">new</span> util.<span class="hljs-title class_">TextEncoder</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">encodingBlob</span>: cert.<span class="hljs-property">EncodingBlob</span> = {</li><li>    <span class="hljs-comment">// 将CRL数据从string转为Unit8Array。</span></li><li>    <span class="hljs-attr">data</span>: textEncoder.<span class="hljs-title function_">encodeInto</span>(crlData),</li><li>    <span class="hljs-comment">// CRL格式，仅支持PEM和DER格式。在这个例子中，CRL用的是PEM格式。</span></li><li>    <span class="hljs-attr">encodingFormat</span>: cert.<span class="hljs-property">EncodingFormat</span>.<span class="hljs-property">FORMAT_PEM</span></li><li>  };</li><li>
</li><li>  <span class="hljs-comment">// 创建X509CRL实例。</span></li><li>  cert.<span class="hljs-title function_">createX509CRL</span>(encodingBlob, <span class="hljs-function">(<span class="hljs-params">err, x509Crl</span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">if</span> (err != <span class="hljs-literal">null</span>) {</li><li>      <span class="hljs-comment">// 创建X509CRL实例失败。</span></li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`createX509Crl failed, errCode: <span class="hljs-subst">${err.code}</span>, errMsg:<span class="hljs-subst">${err.message}</span> `</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-comment">// 创建X509CRL实例成功。</span></li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'createX509CRL success'</span>);</li><li>
</li><li>    <span class="hljs-comment">// 获取CRL的版本。</span></li><li>    <span class="hljs-keyword">let</span> version = x509Crl.<span class="hljs-title function_">getVersion</span>();</li><li>    <span class="hljs-comment">// 获取证书吊销列表类型。</span></li><li>    <span class="hljs-keyword">let</span> revokedType = x509Crl.<span class="hljs-title function_">getType</span>();</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`X509 CRL version: <span class="hljs-subst">${version}</span>, type :<span class="hljs-subst">${revokedType}</span>`</span>);</li><li>
</li><li>    <span class="hljs-comment">// 获取证书吊销列表颁发者名称。</span></li><li>    <span class="hljs-keyword">let</span> issuerName = x509Crl.<span class="hljs-title function_">getIssuerName</span>(cert.<span class="hljs-property">EncodingType</span>.<span class="hljs-property">ENCODING_UTF8</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`X509 CRL issuerName: <span class="hljs-subst">${issuerName}</span>`</span>);</li><li>
</li><li>    <span class="hljs-comment">// 获取证书吊销列表对象的字符串类型数据。</span></li><li>    <span class="hljs-keyword">let</span> crlString = x509Crl.<span class="hljs-title function_">toString</span>(cert.<span class="hljs-property">EncodingType</span>.<span class="hljs-property">ENCODING_UTF8</span>);</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`X509 CRL crlString: <span class="hljs-subst">${crlString}</span>`</span>);</li><li>
</li><li>
</li><li>    <span class="hljs-comment">// 公钥的二进制数据需要传入@ohos.security.cryptoFramework的convertKey()方法去获取公钥对象。</span></li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-keyword">let</span> keyGenerator = cryptoFramework.<span class="hljs-title function_">createAsyKeyGenerator</span>(<span class="hljs-string">'RSA1024|PRIMES_3'</span>);</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'createAsyKeyGenerator success'</span>);</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">pubEncodingBlob</span>: cryptoFramework.<span class="hljs-property">DataBlob</span> = {</li><li>        <span class="hljs-attr">data</span>: pubKeyData,</li><li>      };</li><li>      keyGenerator.<span class="hljs-title function_">convertKey</span>(pubEncodingBlob, <span class="hljs-literal">null</span>, <span class="hljs-function">(<span class="hljs-params">e, keyPair</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (e == <span class="hljs-literal">null</span>) {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'convert key success'</span>);</li><li>          x509Crl.<span class="hljs-title function_">verify</span>(keyPair.<span class="hljs-property">pubKey</span>, <span class="hljs-function">(<span class="hljs-params">err, data</span>) =&gt;</span> {</li><li>            <span class="hljs-keyword">if</span> (err == <span class="hljs-literal">null</span>) {</li><li>              <span class="hljs-comment">// 签名验证成功。</span></li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'verify success'</span>);</li><li>            } <span class="hljs-keyword">else</span> {</li><li>              <span class="hljs-comment">// 签名验证失败。</span></li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`verify failed, errCode: <span class="hljs-subst">${err.code}</span>, errMsg: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>            }</li><li>          });</li><li>        } <span class="hljs-keyword">else</span> {</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`convert key failed, message: <span class="hljs-subst">${e.message}</span>, code: <span class="hljs-subst">${e.code}</span> `</span>);</li><li>        }</li><li>      })</li><li>    } <span class="hljs-keyword">catch</span> (error) {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`get pubKey failed, errCode: <span class="hljs-subst">${e.code}</span>, errMsg: <span class="hljs-subst">${e.message}</span>`</span> );</li><li>    }</li><li>
</li><li>    <span class="hljs-comment">// 使用certFramework的createX509Cert()方法创建一个X509Cert实例。</span></li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">certBlob</span>: cert.<span class="hljs-property">EncodingBlob</span> = {</li><li>      <span class="hljs-attr">data</span>: textEncoder.<span class="hljs-title function_">encodeInto</span>(certData),</li><li>      <span class="hljs-attr">encodingFormat</span>: cert.<span class="hljs-property">EncodingFormat</span>.<span class="hljs-property">FORMAT_PEM</span></li><li>    };</li><li>    <span class="hljs-keyword">let</span> revokedFlag = <span class="hljs-literal">true</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">serial</span>:<span class="hljs-built_in">bigint</span> = <span class="hljs-title class_">BigInt</span>(<span class="hljs-string">'0'</span>);</li><li>    cert.<span class="hljs-title function_">createX509Cert</span>(certBlob, <span class="hljs-function">(<span class="hljs-params">err, cert</span>) =&gt;</span> {</li><li>      serial = cert.<span class="hljs-title function_">getCertSerialNumber</span>();</li><li>      <span class="hljs-keyword">if</span> (err == <span class="hljs-literal">null</span>) {</li><li>        <span class="hljs-keyword">try</span> {</li><li>          <span class="hljs-comment">// 检查证书是否被吊销。</span></li><li>          revokedFlag = x509Crl.<span class="hljs-title function_">isRevoked</span>(cert);</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`revokedFlag is: <span class="hljs-subst">${revokedFlag}</span>`</span>);</li><li>          <span class="hljs-keyword">if</span> (!revokedFlag) {</li><li>              <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'the given cert is not revoked.'</span>);</li><li>              <span class="hljs-keyword">return</span>;</li><li>          }</li><li>          <span class="hljs-comment">// 根据序列号来获取被吊销的证书。</span></li><li>          <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-keyword">let</span> crlEntry = x509Crl.<span class="hljs-title function_">getRevokedCert</span>(serial);</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'get getRevokedCert success'</span>);</li><li>            <span class="hljs-keyword">let</span> serialNumber = crlEntry.<span class="hljs-title function_">getSerialNumber</span>();</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`crlEntry serialNumber is: <span class="hljs-subst">${serialNumber}</span>`</span>);</li><li>
</li><li>            <span class="hljs-comment">// 获取被吊销证书的吊销日期。</span></li><li>            <span class="hljs-keyword">let</span> date = crlEntry.<span class="hljs-title function_">getRevocationDate</span>();</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`revocation date is: <span class="hljs-subst">${date}</span>`</span>);</li><li>          } <span class="hljs-keyword">catch</span> (error) {</li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>            <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`getRevokedCert failed, errCode: <span class="hljs-subst">${e.code}</span>, errMsg: <span class="hljs-subst">${e.message}</span>`</span>);</li><li>          }</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>          <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>          <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`isRevoked failed, errCode: <span class="hljs-subst">${e.code}</span>, errMsg:<span class="hljs-subst">${e.message}</span>`</span>);</li><li>        }</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`create x509 cert failed, errCode: <span class="hljs-subst">${err.code}</span>, errMsg: <span class="hljs-subst">${err.message}</span>`</span>);</li><li>      }</li><li>    })</li><li>
</li><li>  });</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>