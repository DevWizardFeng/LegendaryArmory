<h1 _ngcontent-qcf-c119="" class="doc-title ng-star-inserted" title="请求动画绘制帧率"> 请求动画绘制帧率 </h1>

<div _ngcontent-qcf-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>在应用开发中，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-animatorproperty" target="_blank">属性动画</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-explicit-animation" target="_blank">显式动画</a>能够使用可选参数<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-explicit-animation#expectedframeraterange11" target="_blank">ExpectedFrameRateRange</a>，为不同的动画配置不同的期望绘制帧率。</p>    <div class="tiledSection">     <h2 id="请求属性动画的绘制帧率">请求属性动画的绘制帧率<i class="anchor-icon anchor-icon-link" anchorid="请求属性动画的绘制帧率" tips="复制节点链接"></i></h2>          <p>定义文本组件的属性动画，请求绘制帧率为60，范例如下：</p>     <div _ngcontent-qcf-c106="" class="highlight-div"><div _ngcontent-qcf-c106="" class="highlight-div-header"><div _ngcontent-qcf-c106="" class="highlight-div-header-left"><div _ngcontent-qcf-c106="" class="handle-button expand-button"><div _ngcontent-qcf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qcf-c106="" class="highlight-div-header-right"><div _ngcontent-qcf-c106="" class="handle-button ai-button"></div><div _ngcontent-qcf-c106="" class="handle-button line-button"><div _ngcontent-qcf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qcf-c106="" class="handle-button theme-button"><div _ngcontent-qcf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qcf-c106="" class="handle-button copy-button"><div _ngcontent-qcf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qcf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li> <span class="hljs-title class_">Text</span>()</li><li>  .<span class="hljs-title function_">animation</span>({</li><li>     <span class="hljs-attr">duration</span>: <span class="hljs-number">1200</span>,</li><li>     <span class="hljs-attr">iterations</span>: <span class="hljs-number">10</span>,</li><li>     <span class="hljs-attr">expectedFrameRateRange</span>: { <span class="hljs-comment">// 设置属性动画的帧率范围</span></li><li>       <span class="hljs-attr">expected</span>: <span class="hljs-number">60</span>, <span class="hljs-comment">// 设置动画的期望帧率为60hz</span></li><li>       <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// 设置帧率范围</span></li><li>       <span class="hljs-attr">max</span>: <span class="hljs-number">120</span>, <span class="hljs-comment">// 设置帧率范围</span></li><li>     },</li><li>  })</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="请求显式动画的绘制帧率">请求显式动画的绘制帧率<i class="anchor-icon anchor-icon-link" anchorid="请求显式动画的绘制帧率" tips="复制节点链接"></i></h2>          <p>定义按钮组件的显式动画，请求绘制帧率为30，范例如下：</p>     <div _ngcontent-qcf-c106="" class="highlight-div"><div _ngcontent-qcf-c106="" class="highlight-div-header"><div _ngcontent-qcf-c106="" class="highlight-div-header-left"><div _ngcontent-qcf-c106="" class="handle-button expand-button"><div _ngcontent-qcf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qcf-c106="" class="highlight-div-header-right"><div _ngcontent-qcf-c106="" class="handle-button ai-button"></div><div _ngcontent-qcf-c106="" class="handle-button line-button"><div _ngcontent-qcf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qcf-c106="" class="handle-button theme-button"><div _ngcontent-qcf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qcf-c106="" class="handle-button copy-button"><div _ngcontent-qcf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qcf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title class_">Button</span>()</li><li> .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>   <span class="hljs-comment">// uiContext需通过getUIContext获取，具体可见下文完整示例</span></li><li>   <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>?.<span class="hljs-title function_">animateTo</span>({</li><li>     <span class="hljs-attr">duration</span>: <span class="hljs-number">1200</span>,</li><li>     <span class="hljs-attr">iterations</span>: <span class="hljs-number">10</span>,</li><li>     <span class="hljs-attr">expectedFrameRateRange</span>: { <span class="hljs-comment">// 设置显式动画的帧率范围</span></li><li>       <span class="hljs-attr">expected</span>: <span class="hljs-number">30</span>, <span class="hljs-comment">// 设置动画的期望帧率为30hz</span></li><li>       <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// 设置帧率范围</span></li><li>       <span class="hljs-attr">max</span>: <span class="hljs-number">120</span>, <span class="hljs-comment">// 设置帧率范围</span></li><li>     },</li><li>   }, <span class="hljs-function">() =&gt;</span> {</li><li>   })</li><li> })</li></ol></pre></div></div>    </div>    <div class="tiledSection">     <h2 id="完整示例">完整示例<i class="anchor-icon anchor-icon-link" anchorid="完整示例" tips="复制节点链接"></i></h2>          <div _ngcontent-qcf-c106="" class="highlight-div"><div _ngcontent-qcf-c106="" class="highlight-div-header"><div _ngcontent-qcf-c106="" class="highlight-div-header-left"><div _ngcontent-qcf-c106="" class="handle-button expand-button"><div _ngcontent-qcf-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qcf-c106="" class="highlight-div-header-right"><div _ngcontent-qcf-c106="" class="handle-button ai-button"></div><div _ngcontent-qcf-c106="" class="handle-button line-button"><div _ngcontent-qcf-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qcf-c106="" class="handle-button theme-button"><div _ngcontent-qcf-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qcf-c106="" class="handle-button copy-button"><div _ngcontent-qcf-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qcf-c106="" class="highlight-scroll-div"><pre class="ts prettyprint linenums hljs language-typescript" hw-language="ts" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">AnimationToAnimationDemo</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">isAnimation</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">translateX1</span>: <span class="hljs-built_in">number</span> = -<span class="hljs-number">100</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">translateX2</span>: <span class="hljs-built_in">number</span> = -<span class="hljs-number">100</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">translateX3</span>: <span class="hljs-built_in">number</span> = -<span class="hljs-number">100</span>;</li><li>  <span class="hljs-attr">uiContext</span>: <span class="hljs-title class_">UIContext</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>();</li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">warn</span>(<span class="hljs-string">'no uiContext'</span>);</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'30'</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)</li><li>          .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>          .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>)</li><li>          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">10</span>)</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0xF56C6C</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-number">80</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">80</span>)</li><li>          .<span class="hljs-title function_">translate</span>({ <span class="hljs-attr">x</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">translateX1</span> })</li><li>      }</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'20%'</span>)</li><li>
</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'40'</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)</li><li>          .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>          .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>)</li><li>          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">10</span>)</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0x2E8B57</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-number">80</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">80</span>)</li><li>          .<span class="hljs-title function_">translate</span>({ <span class="hljs-attr">x</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">translateX2</span> })</li><li>      }</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'20%'</span>)</li><li>
</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-string">'60'</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Bold</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)</li><li>          .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>          .<span class="hljs-title function_">textAlign</span>(<span class="hljs-title class_">TextAlign</span>.<span class="hljs-property">Center</span>)</li><li>          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">10</span>)</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-number">0x008B8B</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-number">80</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">80</span>)</li><li>          .<span class="hljs-title function_">translate</span>({ <span class="hljs-attr">x</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">translateX3</span> })</li><li>          .<span class="hljs-title function_">animation</span>({</li><li>            <span class="hljs-attr">duration</span>: <span class="hljs-number">1200</span>,</li><li>            <span class="hljs-attr">iterations</span>: <span class="hljs-number">10</span>,</li><li>            <span class="hljs-attr">playMode</span>: <span class="hljs-title class_">PlayMode</span>.<span class="hljs-property">AlternateReverse</span>,</li><li>            <span class="hljs-attr">expectedFrameRateRange</span>: { <span class="hljs-comment">// 设置属性动画的帧率范围</span></li><li>              <span class="hljs-attr">expected</span>: <span class="hljs-number">60</span>, <span class="hljs-comment">// 设置动画的期望帧率为60hz</span></li><li>              <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// 设置帧率范围</span></li><li>              <span class="hljs-attr">max</span>: <span class="hljs-number">120</span>, <span class="hljs-comment">// 设置帧率范围</span></li><li>            },</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'20%'</span>)</li><li>
</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Start'</span>)</li><li>          .<span class="hljs-title function_">id</span>(<span class="hljs-string">'PropertyAnimationStart'</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-number">500</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-number">10</span>, <span class="hljs-attr">left</span>: <span class="hljs-number">5</span> })</li><li>          .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">White</span>)</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">isAnimation</span> = !<span class="hljs-variable language_">this</span>.<span class="hljs-property">isAnimation</span>;</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">translateX3</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">isAnimation</span> ? <span class="hljs-number">100</span> : -<span class="hljs-number">100</span>;</li><li>
</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>?.<span class="hljs-title function_">animateTo</span>({</li><li>              <span class="hljs-attr">duration</span>: <span class="hljs-number">1200</span>,</li><li>              <span class="hljs-attr">iterations</span>: <span class="hljs-number">10</span>,</li><li>              <span class="hljs-attr">playMode</span>: <span class="hljs-title class_">PlayMode</span>.<span class="hljs-property">AlternateReverse</span>,</li><li>              <span class="hljs-attr">expectedFrameRateRange</span>: { <span class="hljs-comment">// 设置显式动画的帧率范围</span></li><li>                <span class="hljs-attr">expected</span>: <span class="hljs-number">30</span>, <span class="hljs-comment">// 设置动画的期望帧率为30hz</span></li><li>                <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// 设置帧率范围</span></li><li>                <span class="hljs-attr">max</span>: <span class="hljs-number">120</span>, <span class="hljs-comment">// 设置帧率范围</span></li><li>              },</li><li>            }, <span class="hljs-function">() =&gt;</span> {</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">translateX1</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">isAnimation</span> ? <span class="hljs-number">100</span> : -<span class="hljs-number">100</span>;</li><li>            })</li><li>
</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">uiContext</span>?.<span class="hljs-title function_">animateTo</span>({</li><li>              <span class="hljs-attr">duration</span>: <span class="hljs-number">1200</span>,</li><li>              <span class="hljs-attr">iterations</span>: <span class="hljs-number">10</span>,</li><li>              <span class="hljs-attr">playMode</span>: <span class="hljs-title class_">PlayMode</span>.<span class="hljs-property">AlternateReverse</span>,</li><li>              <span class="hljs-attr">expectedFrameRateRange</span>: { <span class="hljs-comment">// 设置显式动画的帧率范围</span></li><li>                <span class="hljs-attr">expected</span>: <span class="hljs-number">40</span>, <span class="hljs-comment">// 设置动画的期望帧率为40hz</span></li><li>                <span class="hljs-attr">min</span>: <span class="hljs-number">0</span>, <span class="hljs-comment">// 设置帧率范围</span></li><li>                <span class="hljs-attr">max</span>: <span class="hljs-number">120</span>, <span class="hljs-comment">// 设置帧率范围</span></li><li>              },</li><li>            }, <span class="hljs-function">() =&gt;</span> {</li><li>              <span class="hljs-variable language_">this</span>.<span class="hljs-property">translateX2</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">isAnimation</span> ? <span class="hljs-number">100</span> : -<span class="hljs-number">100</span>;</li><li>            })</li><li>          })</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'40%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>          .<span class="hljs-title function_">shadow</span>(<span class="hljs-title class_">ShadowStyle</span>.<span class="hljs-property">OUTER_DEFAULT_LG</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)</li><li>      .<span class="hljs-title function_">shadow</span>(<span class="hljs-title class_">ShadowStyle</span>.<span class="hljs-property">OUTER_DEFAULT_SM</span>)</li><li>      .<span class="hljs-title function_">alignItems</span>(<span class="hljs-title class_">VerticalAlign</span>.<span class="hljs-property">Bottom</span>)</li><li>      .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span>)</li><li>    .<span class="hljs-title function_">shadow</span>(<span class="hljs-title class_">ShadowStyle</span>.<span class="hljs-property">OUTER_DEFAULT_SM</span>)</li><li>    .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)</li><li>  }</li><li>}</li></ol></pre></div></div>    </div>   </div>   <div></div></div>