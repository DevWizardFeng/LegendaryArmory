<h1 _ngcontent-ads-c119="" class="doc-title ng-star-inserted" title="调试函数"> 调试函数 </h1>

<div _ngcontent-ads-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div id="body0000001613725177"><p id="ZH-CN_TOPIC_0000002179338324__p31955545913">函数开发完成后，您可以对函数进行调试，以验证函数代码运行是否正常。</p> <p id="ZH-CN_TOPIC_0000002179338324__p1571516365463">目前DevEco Studio函数调试支持本地调用和远程调用，请根据实际场景选择使用：</p> <ul id="ZH-CN_TOPIC_0000002179338324__ul14519194510560"><li id="li11408547155617"><a href="/consumer/cn/doc/harmonyos-guides/agc-harmonyos-clouddev-debugfunc#section248615546567">通过本地调用方式调试函数</a>：在DevEco Studio调试本地开发好的函数。支持单个调试和批量调试，并支持Run和Debug两种模式，调试功能丰富，常在函数开发过程或问题定位过程中使用。</li><li id="li85191745205616"><a href="/consumer/cn/doc/harmonyos-guides/agc-harmonyos-clouddev-debugfunc#section123191549587">通过远程调用方式调试函数</a>：先将函数部署至AGC云端，然后直接在DevEco Studio调用云端函数。此方式主要用于测试函数在云端的运行情况、或补充测试因各种因素限制未能在本地调用方式中发现的问题。</li></ul> <div class="tiledSection"><h2 id="section691218160463">前提条件<i class="anchor-icon anchor-icon-link" anchorid="section691218160463" tips="复制节点链接"></i></h2><ul id="ZH-CN_TOPIC_0000002179338324__ul1755814308463"><li id="li555943014614">请确保您已登录。</li><li id="li24011113478">如果您的工程有代码逻辑涉及云函数调用云数据库，您需在调试前先<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/agc-harmonyos-clouddev-deploy">将整个云工程部署到AGC云端</a>，否则云端将没有相关数据及环境变量。</li></ul> </div> <div class="tiledSection"><h2 id="section248615546567">通过本地调用方式调试函数<i class="anchor-icon anchor-icon-link" anchorid="section248615546567" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002179338324__p16182191101912">您可在DevEco Studio调试本地开发好的函数，支持单个调试和批量调试，并支持Run和Debug两种模式。</p> <ul id="ZH-CN_TOPIC_0000002179338324__ul15384101018198"><li id="li53194713192">单个调试和批量调试流程相同，区别仅在于：单个调试是一次只为一个函数启动本地调试，之后只能调用该函数；批量调试是一次为“cloudfunctions”目录下所有函数启动本地调试、然后逐个调用各个函数。</li><li id="li174088554195">Run模式和Debug模式的区别在于：Debug模式支持使用断点来追踪函数的运行情况，Run模式则不支持。</li></ul> <p id="ZH-CN_TOPIC_0000002179338324__p8325713198">下文以Debug模式下调试单个函数“my-cloud-function”为例，介绍如何在DevEco Studio调试本地函数。</p> <ol id="ZH-CN_TOPIC_0000002179338324__ol4301255184915"><li id="li12307559493">右击“my-cloud-function”函数目录，选择“Debug 'my-cloud-function'”。<div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul id="ZH-CN_TOPIC_0000002179338324__ul117861241174913"><li id="li2426194412496">直接从当前路径下Debug，使用的是默认的Debug配置，您也可<a href="/consumer/cn/doc/harmonyos-guides/agc-harmonyos-clouddev-debugfunc#section65830284215">自定义Debug配置</a>。自定义Debug配置后再从此路径下Debug，将优先采用自定义Debug配置。</li><li id="li4676125617567">如需批量调试多个函数，右击“cloudfunctions”目录，选择“Debug Cloud Functions”，即可启动该目录下所有函数。如“cloudfunctions”目录下同时存在云函数和云对象，将会启动所有的云函数和云对象。</li></ul> </div></div></div> <p id="ZH-CN_TOPIC_0000002179338324__p917619598125"></p> <p id="ZH-CN_TOPIC_0000002179338324__p155995817237"><span><img originheight="461" originwidth="599" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104748.41858703683230989837678329193723:50001231000000:2800:A405AAD0F6A7E131A879B6014340E01E41B42959F8B307A438AE362978DCC5C0.png" width="599" height="461"></span></p> </li><li id="li13301955184910">在下方通知栏“cloudfunctions”窗口，查看调试日志。如果出现“Cloud Functions loaded successfully”，表示函数成功加载到本地运行的HTTP Server中，并生成对应的Function URI。<p id="ZH-CN_TOPIC_0000002179338324__p12578529152820"><span><img originheight="593" originwidth="1084" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104748.46592384045187995311214533765805:50001231000000:2800:F06BD64F093E7AAEDA17358F0CAE66A8790133D25390B21E190AC8DFFB69D1F4.png" width="920" height="503.28413284132847"></span></p> </li><li id="li17581396554">如需设置断点调试，在函数代码中选定要设置断点的有效代码行，在行号（如下图行15）后单击鼠标左键设置断点（如下图的红点）。<p id="ZH-CN_TOPIC_0000002179338324__p1770021565715">设置断点后，调试能够在断点处中断，并高亮显示该行。</p> <p id="ZH-CN_TOPIC_0000002179338324__p24629362357"><span><img originheight="494" originwidth="917" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104748.28019818883015939419142978072138:50001231000000:2800:49528AF40D13BA0A3E28A28E04CBA0FD44F43F861D001FBDFF5A608FC688823A.png" width="917" height="494"></span></p> </li><li id="li13025534910">在菜单栏选择“View &gt; Tool Windows &gt; Cloud Functions Requestor”，使用事件模拟器（Cloud Functions Requestor）触发函数调用。<p id="ZH-CN_TOPIC_0000002179338324__p173767378371"><span><img originheight="380" originwidth="676" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104748.77505968410530156717906385210931:50001231000000:2800:2AFED0F091A73BFE976A0D824C51AB18D7AB1DDBDEF0492BE292A2A5D5138E4C.png" width="676" height="380"></span></p> </li><li id="li123005584910">在弹出的“Cloud Functions Requestor”面板，配置触发事件参数。<ul id="ZH-CN_TOPIC_0000002179338324__ul13005504912"><li id="li1178818334166">Cloud Function：选择需要触发的云函数，此处以函数“my-cloud-function”为例。</li><li id="li23065513495">Environment：选择函数调用环境。此处选择“Local”，表示本地调用。</li><li id="li1931155594918">Event：输入事件参数，内容为JSON格式请求体数据。</li></ul> <p id="ZH-CN_TOPIC_0000002179338324__p1755911124404"><span><img originheight="519" originwidth="917" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104748.78600017280286860961692761682650:50001231000000:2800:830A0C8E6F7C30C693EB0250AEE3AF07B3E22F65312808DD172BCA44FC58E260.png" width="917" height="519"></span></p> </li><li id="li288613119118">（可选）点击“Save”，可保存当前触发事件。<p id="ZH-CN_TOPIC_0000002179338324__p7787172211411"><span><img originheight="523" originwidth="915" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104749.07618872909008010552486710235526:50001231000000:2800:A4A28578B1946421F5216F1DC4C6C38FBD75A913811D2AF0310258ADD3121E7B.png" width="915" height="523"></span></p> <p id="ZH-CN_TOPIC_0000002179338324__p1697151341112">点击右上角<span><img originheight="29" originwidth="23" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104749.54272660541870939739545334115286:50001231000000:2800:E5F292B1A900918F24058D2DE42A067FFFC52B48FE790625409329005D647327.png" class="IconPic notEnlarge" width="23" height="29"></span>可展开保存的触发事件，后续可直接点击“Load”加载事件。对于不需要保存的触发事件，也可以点击“Delete”删除。</p> <p id="ZH-CN_TOPIC_0000002179338324__p1938954144211"><span><img originheight="496" originwidth="553" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104749.72189791925190306570261663729880:50001231000000:2800:D4CAA8339CB74A04BCC25FA2B4AFFBA6C43DFADD6C1A4F15DE8306B9625F29B0.png" width="553" height="496"></span></p> </li><li id="li193115520499">点击“Trigger”， 将会触发执行用户函数代码。执行结果将展示在“Result”框内，“cloudfunctions”窗口同时打印调试日志。<div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002179338324__p1920199145120">“Result”框右侧的“Logs”面板仅用于在<a href="/consumer/cn/doc/harmonyos-guides/agc-harmonyos-clouddev-debugfunc#section123191549587">通过远程调用方式调试函数</a>时查看日志。</p> </div></div></div> <p id="ZH-CN_TOPIC_0000002179338324__p7718914205215"></p> <p id="ZH-CN_TOPIC_0000002179338324__p158132915460"><span><img originheight="759" originwidth="1055" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104749.21494138905159647253297929689209:50001231000000:2800:6A32514E28E0799E902D8F0D8A90AD31AC6E82C09D169F2B1D22780945B33C6B.png" width="920" height="661.8767772511849"></span></p> </li><li id="li299313961212">（可选）如<a href="/consumer/cn/doc/harmonyos-guides/agc-harmonyos-clouddev-debugfunc#li15793566149">配置了环境变量</a>，可将变量信息传入到函数执行环境中，用于函数运行时读取。<div _ngcontent-ads-c106="" class="highlight-div"><div _ngcontent-ads-c106="" class="highlight-div-header"><div _ngcontent-ads-c106="" class="highlight-div-header-left"><div _ngcontent-ads-c106="" class="handle-button expand-button"><div _ngcontent-ads-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ads-c106="" class="highlight-div-header-right"><div _ngcontent-ads-c106="" class="handle-button ai-button"></div><div _ngcontent-ads-c106="" class="handle-button line-button"><div _ngcontent-ads-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ads-c106="" class="handle-button theme-button"><div _ngcontent-ads-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ads-c106="" class="handle-button copy-button"><div _ngcontent-ads-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ads-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" id="ZH-CN_TOPIC_0000002179338324__screen847142413465" data-highlighted="yes"><ol class="linenums"><li>logger<span class="hljs-selector-class">.info</span>(<span class="">context.env.</span><em>name</em>);<span class="hljs-comment">//name为环境变量名称</span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002179338324__p10470151004218">如下图，函数“my-cloud-function”配置了环境变量“env1”，可成功访问环境变量“env1”的值“value1”。</p> <p id="ZH-CN_TOPIC_0000002179338324__p172817283425"></p> <p id="ZH-CN_TOPIC_0000002179338324__p198242115466"><span><img originheight="710" originwidth="1032" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104749.24394659697338765017164996457933:50001231000000:2800:EB019EE83693711D24218052CB3D0C43E02B47920088D13252AFBCBE0FAC9BE9.png" width="920" height="632.9457364341085"></span></p> </li><li id="li8222133191017">点击菜单栏<span><img originheight="20" originwidth="25" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104749.01959649850099975028540015575555:50001231000000:2800:96D508933C4DEF9AA0C7FC435DD60242EEA435790119C749328E41026AE13637.png" class="IconPic notEnlarge" width="25" height="20"></span>，可停止调试。</li><li id="li112228315109">根据调试结果修改函数代码后，点击<span><img originheight="19" originwidth="20" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104749.57406833098330576285773754395910:50001231000000:2800:9EF45557FC5D6FCD85F3045D90DCAB8FA5A35A68AAB0B05911CDB9D6877C8035.png" class="IconPic notEnlarge" width="20" height="19"></span>重新以Debug模式启动调试，直至没有问题。</li><li id="li12941103517418">参考步骤5~10，完成其他函数的调试。</li></ol> </div> <div class="tiledSection"><h2 id="section123191549587">通过远程调用方式调试函数<i class="anchor-icon anchor-icon-link" anchorid="section123191549587" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002179338324__p41344318818">您还可以将函数部署至AGC云端，然后在DevEco Studio调用云端函数，以测试函数在云端的运行情况、或补充测试因各种因素限制未能在本地调试中发现的问题。</p> <ol id="ZH-CN_TOPIC_0000002179338324__ol160713464614"><li id="li1560724194611">参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/agc-harmonyos-clouddev-deployfunc">部署函数</a>将需要调试的函数部署至AGC云端。</li><li id="li414794812133">（可选）如函数代码涉及访问环境变量，需在AGC Portal函数列表中点击函数名称，为函数配置环境变量的值，供函数在运行时读取和使用。<p id="ZH-CN_TOPIC_0000002179338324__p12454195751711"><span><img originheight="736" originwidth="905" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104749.06128967663262149046934268367288:50001231000000:2800:3D59C4898F9EF4E37FEEA84DA0D31008B640E566334A1BBAA8CE1FE89D4AFD2B.png" width="905" height="736"></span></p> <p id="ZH-CN_TOPIC_0000002179338324__p19729204211474"></p> </li><li id="li150015295501">在菜单栏选择“View &gt; Tool Windows &gt; Cloud Functions Requestor”，使用事件模拟器（Cloud Functions Requestor）触发函数调用。<p id="ZH-CN_TOPIC_0000002179338324__p13791729475"><span><img originheight="380" originwidth="676" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104749.56372812198761103396146312730304:50001231000000:2800:6A4E533478CFA99FE1CE3D914C0009C4EA24AABE766F3BA6AA1AF59FFE9AB5B6.png" width="676" height="380"></span></p> </li><li id="li55011229165017">在弹出的“Cloud Functions Requestor”面板，配置触发事件参数。<ul id="ZH-CN_TOPIC_0000002179338324__ul9501152975017"><li id="li2501529195014">Cloud Function：选择需要触发的云函数，此处依然以函数“my-cloud-function”为例。</li><li id="li168722268534">Environment：选择函数调用环境。此处选择“Remote”，表示远程调用。</li><li id="li135012295505">Event：输入事件参数，内容为JSON格式请求体数据。</li></ul> <p id="ZH-CN_TOPIC_0000002179338324__p58331311052"><span><img originheight="447" originwidth="817" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104749.14035052479024637005727705372105:50001231000000:2800:346055FE12F3B5A7E197E583511EDECBFCFC42B28A524911633F3CF1E1B3E026.png" width="817" height="447"></span></p> </li><li id="li1120714513563">点击“Trigger”， 将会触发执行用户函数代码，执行结果将展示在“Result”框内。<p id="ZH-CN_TOPIC_0000002179338324__p301323151716"></p> <p id="ZH-CN_TOPIC_0000002179338324__p102227412819"><span><img originheight="601" originwidth="814" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104749.21287310794907692997606447569363:50001231000000:2800:73345533421D4F78B987029B880F3F92666184368C7F0FFFC54DB3534D0A915E.png" width="814" height="601"></span></p> </li><li id="li14685192375916">点击“Logs”页签，可查看打印的日志定位问题。修改函数代码、重新部署函数后再次执行远程调用，直至没有问题。<p id="ZH-CN_TOPIC_0000002179338324__p135715180106"><span><img originheight="634" originwidth="522" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104749.64203992406496097919589201081452:50001231000000:2800:49AAB815DE3D093F4B0035B8AA3DEBB29F3E2C6558602FB4FA6F976D140C78E5.png" width="522" height="634"></span></p> </li><li id="li2685123105918">参考步骤1~5，完成其他函数的调试。</li></ol> </div> <div class="tiledSection"><h2 id="section65830284215">（可选）自定义Run/Debug配置<i class="anchor-icon anchor-icon-link" anchorid="section65830284215" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002179338324__p116811132467">直接启动函数调试采用的是默认的Run/Debug配置。如有特殊需求，您也可使用自定义Run/Debug配置项来进行调试。</p> <ol id="ZH-CN_TOPIC_0000002179338324__ol1343015329111"><li id="li94305325112">在菜单栏选择“Run &gt; Edit Configurations”。<p id="ZH-CN_TOPIC_0000002179338324__p6168692047"><span><img originheight="409" originwidth="690" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104749.15571945316513532208469453094920:50001231000000:2800:AA79EF6085A132A3650F8B8DCB233814B029B664E6C0375B438747533C3E60FD.png" width="690" height="409"></span></p> </li><li id="li201980184517">在“Run/Debug Configurations”窗口，点击<span><img originheight="16" originwidth="20" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104749.88079110745612217648056943499481:50001231000000:2800:4D010AA63112C2E239B39A2C753A0E4A33538C947A77176E90EA91381E7F2342.png" class="IconPic notEnlarge" width="20" height="16"></span>，选择“Cloud Functions”，新增一个Run/Debug配置。<p id="ZH-CN_TOPIC_0000002179338324__p1742291013819"><span><img originheight="667" originwidth="858" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104749.67722481016807972891714247397948:50001231000000:2800:F034175AF4F59F8E15DB80FC8D6C079B5574DDFE5A327A77DBC68063928610F0.png" width="858" height="667"></span></p> </li><li id="li23711814915">自定义Run/Debug配置，完成后点击“Run”或“Debug”即可立即按当前自定义配置启动本地调试。<p id="ZH-CN_TOPIC_0000002179338324__p1814710611436">如当前暂不使用自定义配置，可点击“OK”保存配置。后续有需要时再选择自定义配置，分别点击<span><img originheight="16" originwidth="19" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104749.24993849835098522926302631753341:50001231000000:2800:F35FBEF36F17F68AAF8CE9A7CECA67E392F7CD534CBBF9B29CEE82C7B04B68F4.png" class="IconPic notEnlarge" width="19" height="16"></span>或<span><img originheight="19" originwidth="23" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104749.10614112506712511030233997703828:50001231000000:2800:F21A15AD48F7CE210ACCEFD0D6F3CF9868546640AA37ADD0C2F2C68895B63C70.png" class="IconPic notEnlarge" width="23" height="19"></span>进行Run或Debug。</p> <div class="p" id="ZH-CN_TOPIC_0000002179338324__p12329144916542"><span><img originheight="664" originwidth="852" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104750.21641364217245128151904421311061:50001231000000:2800:FAAC0664CB2D82F5D6DB181C8DF1879D4A5E104BAF84CDA609189A83D17A35E6.png" width="852" height="664"></span><ul id="ZH-CN_TOPIC_0000002179338324__ul379313631416"><li id="li37931365142">Name：Run/Debug配置的名称，如“functions-custom1”。</li><li id="li9793196191412">Server IP Address：HTTP服务端监听IP地址，默认为localhost，支持切换为您的局域网IP地址。</li><li id="li18793166151412">Server Port：HTTP服务端监听端口。默认为“18090”，自定义端口号建议大于1024。勾选“Auto increment”表示如当前端口被占用则端口号自动加“1”。</li><li id="li15793566149">Environment variables：函数运行的环境变量，为key-value形式。<p id="ZH-CN_TOPIC_0000002179338324__p20793176151413">点击“Edit environment variables”按钮，在“Environment Variables”弹窗中点击“+”添加一个环境变量，然后点击“OK”。添加成功后，您便可以将变量配置信息传入到函数执行环境中，用于函数运行时读取。</p> <p id="ZH-CN_TOPIC_0000002179338324__p1167911318115"><span><img originheight="667" originwidth="858" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251212104750.66150744556318906061855349862156:50001231000000:2800:063C1E237080DE659D8150759792699D20B62C950263F00D9C282AE3ACD70877.png" width="858" height="667"></span></p> </li></ul> </div> </li></ol> </div> </div> <div></div></div>