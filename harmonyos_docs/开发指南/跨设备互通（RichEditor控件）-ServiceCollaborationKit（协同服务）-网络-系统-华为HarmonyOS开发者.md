<h1 _ngcontent-cqx-c119="" class="doc-title ng-star-inserted" title="跨设备互通（RichEditor控件）"> 跨设备互通（RichEditor控件） </h1>

<div _ngcontent-cqx-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>富文本控件已经集成跨设备互通能力，通过使用富文本控件<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-components-richeditor" target="_blank">RichEditor</a>的右键菜单即可使用跨设备互通能力。跨设备互通提供跨设备的相机、扫描、图库访问能力，平板或2in1设备可以调用手机的相机、扫描、图库等功能。</p> <div class="tiledSection"><h2 id="section1880231055910">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section1880231055910" tips="复制节点链接"></i></h2><p>您通过此能力实现跨设备交互，可以使用其他设备的相机、扫描和图库功能。</p> </div> <div class="tiledSection"><h2 id="section17575828642">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="section17575828642" tips="复制节点链接"></i></h2><p>需同时满足以下条件，才能使用该功能：</p> <ul><li><strong>设备限制</strong><ul><li>本端设备：HarmonyOS版本为HarmonyOS NEXT及以上的平板或2in1设备。</li><li>远端设备：HarmonyOS版本为HarmonyOS NEXT及以上、具有相机能力的手机或平板设备。</li></ul> </li><li><strong>使用限制</strong><ul><li>双端设备需要登录同一华为账号。</li><li>跨设备互通API支持根据特定调用策略调用设备。调用策略：2in1设备可以调用平板和手机，平板可以调用手机，同类型设备不可调用。</li><li>双端设备需要打开WLAN和蓝牙开关。<p>条件允许时，建议双端设备接入同一个局域网，可提升唤醒相机的速度。</p> </li></ul> </li></ul> </div> <div class="tiledSection"><h2 id="section1471631742617">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section1471631742617" tips="复制节点链接"></i></h2><ul><li>添加<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-components-richeditor" target="_blank">RichEditor</a>富文本组件，即可在富文本组件中右键中选择其他设备进行导入，通过onWillChange属性对回传的照片进行处理。<div _ngcontent-cqx-c106="" class="highlight-div"><div _ngcontent-cqx-c106="" class="highlight-div-header"><div _ngcontent-cqx-c106="" class="highlight-div-header-left"><div _ngcontent-cqx-c106="" class="handle-button expand-button"><div _ngcontent-cqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cqx-c106="" class="highlight-div-header-right"><div _ngcontent-cqx-c106="" class="handle-button ai-button"></div><div _ngcontent-cqx-c106="" class="handle-button line-button"><div _ngcontent-cqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cqx-c106="" class="handle-button theme-button"><div _ngcontent-cqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cqx-c106="" class="handle-button copy-button"><div _ngcontent-cqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cqx-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li>@<span class="hljs-title function_">Entry</span></li><li>@<span class="hljs-title function_">Component</span></li><li><span class="hljs-keyword">struct</span> <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-variable">controller</span>: <span class="hljs-title class_">RichEditorController</span> = <span class="hljs-variable">new</span> <span class="hljs-title function_">RichEditorController</span>()</li><li>  <span class="hljs-variable">options</span>: <span class="hljs-title class_">RichEditorOptions</span> = { <span class="hljs-variable">controller</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">controller</span> }</li><li>
</li><li>  <span class="hljs-title function_">build</span>() {</li><li>    <span class="hljs-title function_">Column</span>() {</li><li>      <span class="hljs-title function_">Column</span>() {</li><li>        <span class="hljs-title function_">RichEditor</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">options</span>)</li><li>          .<span class="hljs-title function_">onWillChange</span>((<span class="hljs-variable">value</span>: <span class="hljs-title class_">RichEditorChangeValue</span>) =&gt; {</li><li>            <span class="hljs-keyword">if</span> (<span class="hljs-variable">value</span>?.<span class="hljs-variable">replacedImageSpans</span>[<span class="hljs-number">0</span>]?.<span class="hljs-variable">imageStyle</span>?.<span class="hljs-variable">objectFit</span> != <span class="hljs-number">0</span>) {</li><li>              <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;</li><li>            }</li><li>            <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> <span class="hljs-variable">item</span> <span class="hljs-variable">of</span> <span class="hljs-variable">value</span>.<span class="hljs-variable">replacedImageSpans</span>) {</li><li>              <span class="hljs-keyword">this</span>.<span class="hljs-variable">controller</span>.<span class="hljs-title function_">addImageSpan</span>(<span class="hljs-variable">item</span>.<span class="hljs-variable">valuePixelMap</span>, {</li><li>                <span class="hljs-variable">imageStyle</span>: {</li><li>                  <span class="hljs-variable">size</span>: [<span class="hljs-string">"500px"</span>, <span class="hljs-string">"500px"</span>],</li><li>                  <span class="hljs-variable">layoutStyle</span>: {</li><li>                    <span class="hljs-variable">borderRadius</span>: <span class="hljs-string">'10px'</span>,</li><li>                  }</li><li>                }</li><li>              })</li><li>            }</li><li>            <span class="hljs-keyword">return</span> <span class="hljs-keyword">false</span>;</li><li>          })</li><li>          .<span class="hljs-title function_">borderWidth</span>(<span class="hljs-number">1</span>)</li><li>          .<span class="hljs-title function_">borderColor</span>(<span class="hljs-variable">Color</span>.<span class="hljs-variable">Green</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">"100%"</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">borderWidth</span>(<span class="hljs-number">1</span>)</li><li>      .<span class="hljs-title function_">borderColor</span>(<span class="hljs-variable">Color</span>.<span class="hljs-variable">Red</span>)</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">"100%"</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">"70%"</span>)</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> </li></ul> <p>使用流程如下：</p> <p>1.在富文本区域右键。</p> <p><span><img originheight="547" originwidth="206" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115018.54875679671372893293913127974156:50001231000000:2800:A7BAC753FD240EB82E10D683519712CB213F4E89AECE023E6F21F7E364834A0F.png" class="notEnlarge" width="206" height="547"></span></p> <p>2.选择想要使用的能力。</p> <p><span><img originheight="550" originwidth="206" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115018.97433212152059265633701744330504:50001231000000:2800:8CEC564B69E530E6584072FDC0C2C03B99F0707A1D3FCDBD8297FCC3D24B1BB1.png" class="notEnlarge" width="206" height="550"></span></p> <p>3.等待对端设备拍照回传。</p> <p><span><img originheight="88" originwidth="273" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115018.56571722049882894925543299487283:50001231000000:2800:D38B1045E78728E8AD216C87D8F2B60077C57DE068324C68EA5A3E7BD5AD27BA.png" class="notEnlarge" width="273" height="88"></span></p> <p>4.图片回传后</p> <p><span><img originheight="245" originwidth="256" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211115018.06512648995824625274552711244815:50001231000000:2800:7AFA6B3E359F862277BEE317CCE0DC9B08A9128B9E6D948B6DBA14FDABF0F304.png" class="notEnlarge" width="256" height="245"></span></p> </div> <div class="tiledSection"><h2 id="section159395516536">关闭富文本跨设备互通能力<i class="anchor-icon anchor-icon-link" anchorid="section159395516536" tips="复制节点链接"></i></h2><p>如果需要关闭富文本右键菜单跨设备互通能力，可通过editMenuOptions属性自定义菜单内容去除跨设备互通菜单项即可规避，示例如下：</p> <div _ngcontent-cqx-c106="" class="highlight-div"><div _ngcontent-cqx-c106="" class="highlight-div-header"><div _ngcontent-cqx-c106="" class="highlight-div-header-left"><div _ngcontent-cqx-c106="" class="handle-button expand-button"><div _ngcontent-cqx-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-cqx-c106="" class="highlight-div-header-right"><div _ngcontent-cqx-c106="" class="handle-button ai-button"></div><div _ngcontent-cqx-c106="" class="handle-button line-button"><div _ngcontent-cqx-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-cqx-c106="" class="handle-button theme-button"><div _ngcontent-cqx-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-cqx-c106="" class="handle-button copy-button"><div _ngcontent-cqx-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-cqx-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-less" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">@Entry</span></li><li><span class="hljs-variable">@Component</span></li><li>struct Index {</li><li>  controller: RichEditorController = new RichEditorController()</li><li>  options: RichEditorOptions = { controller: this.controller }</li><li>
</li><li>  <span class="hljs-selector-tag">build</span>() {</li><li>    <span class="hljs-selector-tag">Column</span>() {</li><li>      <span class="hljs-selector-tag">Column</span>() {</li><li>        <span class="hljs-selector-tag">RichEditor</span>(this.options)</li><li>          <span class="hljs-selector-class">.editMenuOptions</span>({</li><li>            onCreateMenu: (menuItems: Array&lt;TextMenuItem&gt;) =&gt; {</li><li>              if (menuItems.length === 0) {</li><li>                return menuItems;</li><li>              }</li><li>              let <span class="hljs-attribute">newMenuItems</span>: TextMenuItem[] = [];</li><li>              menuItems.<span class="hljs-built_in">forEach</span>((item, index) =&gt; {</li><li>                <span class="hljs-built_in">if</span>(!item.id.<span class="hljs-built_in">equals</span>(TextMenuItemId.COLLABORATION_SERVICE)) {</li><li>                  newMenuItems.<span class="hljs-built_in">push</span>(item);</li><li>                }</li><li>              })</li><li>              return newMenuItems;</li><li>            },</li><li>            <span class="hljs-attribute">onMenuItemClick</span>: (<span class="hljs-attribute">menuItem</span>: TextMenuItem, <span class="hljs-attribute">textRange</span>: TextRange) =&gt; {</li><li>              <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">false</span>;</li><li>            }</li><li>          })</li><li>          <span class="hljs-selector-class">.borderWidth</span>(<span class="hljs-number">1</span>)</li><li>          <span class="hljs-selector-class">.borderColor</span>(Color.Green)</li><li>          <span class="hljs-selector-class">.width</span>(<span class="hljs-string">"100%"</span>)</li><li>          <span class="hljs-selector-class">.height</span>(<span class="hljs-string">"100%"</span>)</li><li>      }</li><li>      <span class="hljs-selector-class">.borderWidth</span>(<span class="hljs-number">1</span>)</li><li>      <span class="hljs-selector-class">.borderColor</span>(Color.Red)</li><li>      <span class="hljs-selector-class">.width</span>(<span class="hljs-string">"100%"</span>)</li><li>      <span class="hljs-selector-class">.height</span>(<span class="hljs-string">"70%"</span>)</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> </div> </div> <div></div></div>