<h1 _ngcontent-lcf-c119="" class="doc-title ng-star-inserted" title="输入法安全模式介绍"> 输入法安全模式介绍 </h1>

<div _ngcontent-lcf-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>为了保护用户数据安全，系统增加了输入法安全模式功能，包括基础模式和完整体验模式。在基础模式下，输入法扩展无法调用任何可能涉及访问或泄漏用户隐私数据的系统能力；而在完整体验模式下，则没有该限制。</p> <p>用户可以在设置应用中切换基础模式和完整体验模式。</p> <div class="tiledSection"><h2 id="section880417319313">基础模式介绍<i class="anchor-icon anchor-icon-link" anchorid="section880417319313" tips="复制节点链接"></i></h2><ol><li>基础模式下，输入法扩展（InputMethodExtensionAbility）进程无法拉起其他UIAbility或ExtensionAbility。</li><li>基础模式下，输入法扩展会受到系统管控，不能使用涉及访问或泄漏用户个人数据的各种接口，同时无法将数据传递出进程。管控功能包括但不限于：网络、短信、电话、麦克风、定位、相机、蓝牙、壁纸、支付、日历、游戏、扬声器、Wi-Fi、剪切板、多媒体、联系人、公共事件、系统账号、健康数据、地图服务、推送服务、融合搜索、共享内存、分布式特性、广告设备标识、振动等。</li><li>基础模式下，输入法扩展可以使用基础输入功能必要的系统能力，例如，IME Kit、ArkUI、窗口、图形、屏幕管理等。</li><li>基础模式下，输入法扩展对<a href="/consumer/cn/doc/harmonyos-guides/ime-kit-security#section4219152220459">共享沙箱</a>只读，对输入法扩展独立沙箱可读写；应用主入口可以对<a href="/consumer/cn/doc/harmonyos-guides/ime-kit-security#section4219152220459">共享沙箱</a>及其独立沙箱读写。</li></ol> </div> <div class="tiledSection"><h2 id="section630182494416">完整体验模式介绍<i class="anchor-icon anchor-icon-link" anchorid="section630182494416" tips="复制节点链接"></i></h2><ol><li>完整体验模式下，输入法扩展不受基础模式相关限制，例如可以拉起其他UIAbility或ExtensionAbility、以调用访问用户数据的接口等。</li><li>完整体验模式下，输入法扩展可以对<a href="/consumer/cn/doc/harmonyos-guides/ime-kit-security#section4219152220459">共享沙箱</a>读写。</li></ol> </div> <div class="tiledSection"><h2 id="section2351956154419">开发指导<i class="anchor-icon anchor-icon-link" anchorid="section2351956154419" tips="复制节点链接"></i></h2><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inputmethod-extension-ability#oncreate" target="_blank">onCreate</a>在输入法扩展的 <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inputmethod-extension-ability#oncreate" target="_blank">onCreate</a>生命周期回调函数中通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inputmethodengine#getsecuritymode11" target="_blank">getSecurityMode</a>接口查询当前输入法应用的安全模式。</p> <ul><li>如果当前处于基础模式，开发者需要调整内部功能的呈现情况，以避免出现功能不可用的情况。</li><li>当处于完整体验模式时，开发者可以使用访问用户数据的接口，但这些接口的使用仅限于提升输入法的用户体验。</li></ul> <p>为了确保输入法功能的稳定性，开发者应当在基础模式下仅使用与基础输入功能相关的能力，并且不得试图绕过系统机制将数据传递到输入法扩展之外。</p> </div> <div class="tiledSection"><h2 id="section4219152220459">共享沙箱介绍<i class="anchor-icon anchor-icon-link" anchorid="section4219152220459" tips="复制节点链接"></i></h2><ol><li>输入法扩展使用独立沙箱，与应用主入口不可互相访问对方的独立沙箱。</li><li>为方便输入法扩展和应用主入口之间数据传递和共享，提供了共享沙箱机制。输入法扩展和应用主入口都能够访问共享沙箱。<div class="fignone"><span class="figcap"><b>图1 </b>共享沙箱</span><br><span><img height="264.33750000000003" originheight="897" originwidth="1776" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114717.75495039417762655880089851851798:50001231000000:2800:F6FA497D32E99BF3AB781020A9E4DAB2DEF4CF217966452BD787534AFEF7160F.png" title="点击放大" width="523.6875"></span></div> </li><li>共享沙箱的配置流程。<p>当应用主入口的<a href="https://developer.huawei.com/consumer/cn/doc/app/agc-help-add-releaseprofile-0000001914714796" target="_blank">profile</a>和输入法扩展的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#extensionabilities标签" target="_blank">dataGroupIds</a>包含相同的data-group-id时，他们就可以使用这个data-group-id对应的共享沙箱。</p> <div class="p">为了使用共享沙箱，需要先申请一个data-group-id，分别配置到应用主入口的<a href="https://developer.huawei.com/consumer/cn/doc/app/agc-help-add-releaseprofile-0000001914714796" target="_blank">profile</a>和输入法扩展的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#extensionabilities标签" target="_blank">dataGroupIds</a>。具体流程如下：<ol><li>申请data-group-id，申请流程如下。<ol class="substepthirdol"><li>按照如下格式发送邮件到agconnect@huawei.com。<ol><li>邮件标题格式：【输入法应用申请应用内数据共享】xxx应用</li><li>邮件内容：<p>应用appid：xxx</p> <p>应用名称：xxx</p> <p>开发者id：xxx</p> <p>邮件附件中提供：</p> <p>①输入法应用安装系统，在设置的输入法列表中该应用的截图。</p> <p>②输入法应用中module.json5的InputMethodExtensionAbility相关配置截图。</p> </li></ol> </li><li>审批完成后，您将收到邮件回复。</li></ol> </li><li>待您收到data-group-id申请成功的邮件回复后，重新生成<a href="https://developer.huawei.com/consumer/cn/doc/app/agc-help-add-releaseprofile-0000001914714796" target="_blank">应用的profile</a>，新生成的profile里面包含本次申请到的data-group-id；并使用DevEco Studio<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-publish-app#section280162182818" target="_blank">配置工程的签名信息</a>，将新的profile配置到工程中。</li><li>按照data-group-id申请成功的回复邮件指导，获取到您本次申请到的data-group-id，并在InputMethodExtensionAbility所在的module.json5中配置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#extensionabilities标签" target="_blank">dataGroupIds</a>。</li></ol> </div> <p><span><img originheight="324" originwidth="753" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114717.37724371646170422261330383201837:50001231000000:2800:418D739A018FE9152DB181A9E4A09ECC3CB4DFAE9E6A9BB1FB682B40722A2B23.png" width="753" height="324"></span></p> </li><li>共享沙箱使用流程。<ol><li>分别在输入法扩展和应用主入口通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-context#getgroupdir10" target="_blank">getGroupDir</a>获取共享沙箱路径。<div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>注意：接口入参dataGroupID应该填写您本次申请到的data-group-id。</p> </div></div></div> </li><li>如果接口调用成功，且能够返回共享沙箱路径，说明您申请并配置的data-group-id已生效，此时您可通过共享沙箱在应用主入口和输入法扩展之间进行数据共享。<div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>注意：基础模式下输入法扩展对共享沙箱是只读权限，不可写入数据；完整体验模式下可读写。</p> </div></div></div> </li></ol> </li></ol> <p></p> </div> </div> <div></div></div>