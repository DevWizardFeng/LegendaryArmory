<h1 _ngcontent-qif-c119="" class="doc-title ng-star-inserted" title="进程模型"> 进程模型 </h1>

<div _ngcontent-qif-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="概述">概述<i class="anchor-icon anchor-icon-link" anchorid="概述" tips="复制节点链接"></i></h2>          <p>进程是系统进行资源分配的基本单位，是操作系统结构的基础。下面从一个应用的全局视角来看下系统的进程模型和线程模型。</p>    </div>    <div class="tiledSection">     <h2 id="进程模型-1">进程模型<i class="anchor-icon anchor-icon-link" anchorid="进程模型-1" tips="复制节点链接"></i></h2>         </div>    <div class="tiledSection">     <h3 id="基本进程类型" class="firsth2">基本进程类型<i class="anchor-icon anchor-icon-link" anchorid="基本进程类型" tips="复制节点链接"></i></h3>          <p>开发者开发一个复杂功能的应用，包含多个<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiability" target="_blank">UIAbility</a>组件和多个ExtensionAbility组件，ExtensionAbility如图1中的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-form-formextensionability" target="_blank">FormExtensionAbility</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-shareextensionability" target="_blank">ShareExtensionAbility</a>。那么在应用运行态，可能存在的进程类型：</p>     <ul>      <li>       <p><strong>主进程</strong>：默认情况下，应用中（同一Bundle名称）的所有UIAbility均是运行在同一个独立进程（主进程）中，即图1中的“Main Process1”。</p></li>      <li>       <p><strong>ExtensionAbility进程</strong>：应用中（同一Bundle名称）的所有同一类型ExtensionAbility均是运行在一个独立进程中，如图1中“FormExtensionAbility Process”、“其他类型ExtensionAbility Process”（其他类型的ExtensionAbility组件）。</p>       <p>特别地，对于继承自<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiextensionability" target="_blank">UIExtensionAbility</a>的ExtensionAbility，可以为每个实例配置独立进程。例如ShareExtensionAbility可以指定每个ShareExtensionAbility实例分别运行在一个独立进程，详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-uiextensionability" target="_blank">UIExtensionAbility</a>。</p></li>      <li>       <p><strong>Render进程</strong>：应用中的Web组件运行时，系统会为之分配一个Render进程，用于渲染。如图1中的“Render Process”。</p></li>     </ul>     <p><strong>图1</strong> 基本进程类型</p>     <p><span><img originheight="623" originwidth="1117" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114736.87783217978325128050581789870561:50001231000000:2800:6ACFDBF80D40526EF6CC2661BB7EF5FEE2A747C336E78915E8FD95F28D04DB62.png" width="920" height="513.1244404655328"></span></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ul>        <li>进程名称的命名无固定规则，而且与进程类型也不存在直接关联，不能用于业务逻辑的判断。例如，开发者开发了一款应用com.example.myapplication，其中有一个输入法组件<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inputmethod-extension-ability" target="_blank">InputMethodExtensionAbility</a>，输入法组件是运行在独立进程中的，通常情况下其进程名是为“com.example.myapplication:input”。但这并不是固定的，该进程名对应的进程不一定是输入法进程，输入法进程也不一定是该进程名。</li>        <li>一个进程可以包含多个AbilityStage，一个AbilityStage可以包含多个Ability。进程的生命周期与Ability生命周期息息相关，当进程内的所有Ability都退出后，进程才会走销毁流程。换句话说，如果想退出进程，需要先退出进程内的所有Ability。</li>       </ul>      </div></div></div>    </div>    <div class="tiledSection">     <h3 id="其他进程类型">其他进程类型<i class="anchor-icon anchor-icon-link" anchorid="其他进程类型" tips="复制节点链接"></i></h3>          <p>在2in1和Tablet设备上，针对UIAbility，还支持如下特殊进程类型：</p>     <ul>      <li><strong>模块独立进程</strong>：对于多HAP的应用，每个HAP的业务相对独立，如果开发者希望不同HAP的UIAbility运行在不同的进程，可以在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#配置文件标签">module.json5配置文件</a>中将isolationMode字段配置为isolationOnly（只在独立进程中运行）或者isolationFirst（优先在独立进程中运行），那么该HAP下的所有UIAbility将运行在统一的独立的进程中。如图2中UIAbilityC运行在“Main Process2”， 而不是“Main Process1”。</li>      <li><strong>动态指定进程</strong>：当同一HAP中的UIAbility实例需要根据运行时状态（如每个进程最多支持5个实例）动态分配到不同进程时，开发者可以在module.json5配置文件中将该UIAbility的isolationProcess字段配置为true，如图2中的UIAbilityD。系统在启动UIAbilityD实例时，回调<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ability-terminology#masterprocess主控进程">主控进程</a>的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-abilitystage#onnewprocessrequest11" target="_blank">onNewProcessRequest</a>，开发者在该回调中返回自定义的一个字符串，如果返回的字符串是开发者曾创建的，则复用该标识所在的进程，否则创建新的进程。如图2中的 “Main Processes3”和“Main Process4”则是UIAbilityD运行的多个进程。</li>      <li><strong>静态指定进程</strong>：当同一应用中的UIAbility或EmbeddedUIExtensionAbility需要运行到不同进程时，开发者可以将module.json5配置文件的<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#abilities标签">abilities标签</a>中的process字段或<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/module-configuration-file#extensionabilities标签">extensionAbilities标签</a>中的process字段配置为不同的字符串。系统在启动UIAbility或EmbeddedUIExtensionAbility时，会根据这个字符串分配进程。如果同一应用的多个UIAbility和多个EmbeddedUIExtensionAbility的process字段都配置了相同的字符串，则这些UIAbility和EmbeddedUIExtensionAbility都会运行在同一个进程内。如图2中的 “Main Process5”。</li>      <li><strong>子进程</strong>： 如果开发者希望开启多进程做一些后台业务，可以调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-childprocessmanager" target="_blank">childProcessManager</a>中的接口创建子进程。子进程的生命周期跟随父进程，父进程消亡，子进程跟随消亡。如图2中的“ArkTS Child Process”和“Native Child Process”是主进程创建的子进程。子进程不支持再创建子进程。</li>     </ul>     <p><strong>图2</strong> 其他进程类型</p>     <p><span><img originheight="606" originwidth="1347" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114736.12101516747409386878508447215042:50001231000000:2800:E5583706D370BA0563BAB7EFC8CC7F392532A9AB40EC755A4AA13D11CB0F6D32.png" width="920" height="413.8975501113586"></span></p>    </div>    <div class="tiledSection">     <h2 id="线程模型">线程模型<i class="anchor-icon anchor-icon-link" anchorid="线程模型" tips="复制节点链接"></i></h2>          <p>系统创建应用进程启动后，会默认创建一个主线程并进入消息循环。应用组件均运行在主线程上。</p>     <p>除了主线程外，应用如果有复杂的耗时逻辑需要处理，开发者可以创建<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-worker" target="_blank">worker</a>线程处理、或者提交任务到<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-taskpool" target="_blank">taskpool</a>。</p>    </div>   </div>   <div></div></div>