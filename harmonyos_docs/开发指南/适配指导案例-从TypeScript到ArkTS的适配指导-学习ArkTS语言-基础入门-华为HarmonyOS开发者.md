<h1 _ngcontent-bft-c119="" class="doc-title ng-star-inserted" title="适配指导案例"> 适配指导案例 </h1>

<div _ngcontent-bft-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted renderOptimization" style="position: relative;"> <div><p>本文通过具体应用场景中的案例，提供在ArkTS语法规则下将TS代码适配成ArkTS代码的建议。各章以ArkTS语法规则的英文名称命名，每个案例展示适配前的TS代码和适配后的ArkTS代码。</p>  <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 913px;"><h2 id="arkts-identifiers-as-prop-names">arkts-identifiers-as-prop-names<i class="anchor-icon anchor-icon-link" anchorid="arkts-identifiers-as-prop-names" tips="复制节点链接"></i></h2><p>当属性名是有效的标识符（即不包含特殊字符、空格等，并且不以数字开头），可以直接使用而无需引号。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">interface</span> W {</li><li>  <span class="hljs-attr">bundleName</span>: <span class="hljs-built_in">string</span></li><li>  <span class="hljs-attr">action</span>: <span class="hljs-built_in">string</span></li><li>  <span class="hljs-attr">entities</span>: <span class="hljs-built_in">string</span>[]</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">wantInfo</span>: W = {</li><li>  <span class="hljs-string">'bundleName'</span>: <span class="hljs-string">'com.huawei.hmos.browser'</span>,</li><li>  <span class="hljs-string">'action'</span>: <span class="hljs-string">'ohos.want.action.viewData'</span>,</li><li>  <span class="hljs-string">'entities'</span>: [<span class="hljs-string">'entity.system.browsable'</span>]</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">interface</span> W {</li><li>  <span class="hljs-attr">bundleName</span>: <span class="hljs-built_in">string</span></li><li>  <span class="hljs-attr">action</span>: <span class="hljs-built_in">string</span></li><li>  <span class="hljs-attr">entities</span>: <span class="hljs-built_in">string</span>[]</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">wantInfo</span>: W = {</li><li>  <span class="hljs-attr">bundleName</span>: <span class="hljs-string">'com.huawei.hmos.browser'</span>,</li><li>  <span class="hljs-attr">action</span>: <span class="hljs-string">'ohos.want.action.viewData'</span>,</li><li>  <span class="hljs-attr">entities</span>: [<span class="hljs-string">'entity.system.browsable'</span>]</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 80px;"><h2 id="arkts-no-any-unknown">arkts-no-any-unknown<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-any-unknown" tips="复制节点链接"></i></h2></div>  <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 517px;"><h3 id="按照业务逻辑将代码中的any-unknown改为具体的类型" class="firsth2">按照业务逻辑，将代码中的any, unknown改为具体的类型<i class="anchor-icon anchor-icon-link" anchorid="按照业务逻辑将代码中的any-unknown改为具体的类型" tips="复制节点链接"></i></h3><div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">printObj</span>(<span class="hljs-params">obj: <span class="hljs-built_in">any</span></span>) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(obj);</li><li>}</li><li>
</li><li><span class="hljs-title function_">printObj</span>(<span class="hljs-string">'abc'</span>); <span class="hljs-comment">// abc</span></li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">printObj</span>(<span class="hljs-params">obj: <span class="hljs-built_in">string</span></span>) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(obj);</li><li>}</li><li>
</li><li><span class="hljs-title function_">printObj</span>(<span class="hljs-string">'abc'</span>); <span class="hljs-comment">// abc</span></li></ol></pre></div></div> </div>  <div class="tiledSection scroll-inwindow" style="contain-intrinsic-size: auto 889px;"><h3 id="标注jsonparse返回值类型">标注JSON.parse返回值类型<i class="anchor-icon anchor-icon-link" anchorid="标注jsonparse返回值类型" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-attr">v</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>  <span class="hljs-attr">s</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span></li><li>  </li><li>  <span class="hljs-title function_">foo</span>(<span class="hljs-params">str: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-keyword">let</span> tmpStr = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(str);</li><li>    <span class="hljs-keyword">if</span> (tmpStr.<span class="hljs-property">add</span> != <span class="hljs-literal">undefined</span>) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">v</span> = tmpStr.<span class="hljs-property">v</span>;</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">s</span> = tmpStr.<span class="hljs-property">s</span>;</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-attr">v</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>  <span class="hljs-attr">s</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span></li><li>  </li><li>  <span class="hljs-title function_">foo</span>(<span class="hljs-params">str: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">tmpStr</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Object</span>&gt; = <span class="hljs-title class_">JSON</span>.<span class="hljs-title function_">parse</span>(str);</li><li>    <span class="hljs-keyword">if</span> (tmpStr.<span class="hljs-property">add</span> != <span class="hljs-literal">undefined</span>) {</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">v</span> = tmpStr.<span class="hljs-property">v</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">number</span>;</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">s</span> = tmpStr.<span class="hljs-property">s</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>;</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 505px;"><h3 id="使用record类型">使用Record类型<i class="anchor-icon anchor-icon-link" anchorid="使用record类型" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">printProperties</span>(<span class="hljs-params">obj: <span class="hljs-built_in">any</span></span>) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(obj.<span class="hljs-property">name</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(obj.<span class="hljs-property">value</span>);</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">printProperties</span>(<span class="hljs-params">obj: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">Object</span>&gt;</span>) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(obj.<span class="hljs-property">name</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(obj.<span class="hljs-property">value</span> <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>);</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 865px;"><h2 id="arkts-no-call-signature">arkts-no-call-signature<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-call-signature" tips="复制节点链接"></i></h2><p>使用函数类型进行替代。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">interface</span> I {</li><li>  (<span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span>): <span class="hljs-built_in">void</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">fn: I</span>) {</li><li>  <span class="hljs-title function_">fn</span>(<span class="hljs-string">'abc'</span>);</li><li>}</li><li>
</li><li><span class="hljs-title function_">foo</span>(<span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(value);</li><li>})</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">type</span> I = <span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span></li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">fn: I</span>) {</li><li>  <span class="hljs-title function_">fn</span>(<span class="hljs-string">'abc'</span>);</li><li>}</li><li>
</li><li><span class="hljs-title function_">foo</span>(<span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(value);</li><li>})</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1561px;"><h2 id="arkts-no-ctor-signatures-type">arkts-no-ctor-signatures-type<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-ctor-signatures-type" tips="复制节点链接"></i></h2><p>使用工厂函数（() =&gt; Instance）替代构造函数签名。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Controller</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span></li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">type</span> <span class="hljs-title class_">ControllerConstructor</span> = {</li><li>  <span class="hljs-keyword">new</span> (<span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Controller</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">testMenu</span> {</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">ControllerConstructor</span> = <span class="hljs-title class_">Controller</span></li><li>  <span class="hljs-title function_">createController</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>) {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">controller</span>(<span class="hljs-string">'123'</span>);</li><li>    }</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> t = <span class="hljs-keyword">new</span> <span class="hljs-title function_">testMenu</span>();</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(t.<span class="hljs-title function_">createController</span>()!.<span class="hljs-property">value</span>);</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Controller</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span></li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">type</span> <span class="hljs-title class_">ControllerConstructor</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Controller</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">testMenu</span> {</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">ControllerConstructor</span> = <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Controller</span>(<span class="hljs-string">'abc'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">createController</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>) {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">controller</span>();</li><li>    }</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">t</span>: testMenu = <span class="hljs-keyword">new</span> <span class="hljs-title function_">testMenu</span>();</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(t.<span class="hljs-title function_">createController</span>()!.<span class="hljs-property">value</span>);</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 625px;"><h2 id="arkts-no-indexed-signatures">arkts-no-indexed-signatures<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-indexed-signatures" tips="复制节点链接"></i></h2><p>使用Record类型进行替代。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">data: { [key: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">string</span> }</span>) {</li><li>  data[<span class="hljs-string">'a'</span>] = <span class="hljs-string">'a'</span>;</li><li>  data[<span class="hljs-string">'b'</span>] = <span class="hljs-string">'b'</span>;</li><li>  data[<span class="hljs-string">'c'</span>] = <span class="hljs-string">'c'</span>;</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">data: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;</span>) {</li><li>  data[<span class="hljs-string">'a'</span>] = <span class="hljs-string">'a'</span>;</li><li>  data[<span class="hljs-string">'b'</span>] = <span class="hljs-string">'b'</span>;</li><li>  data[<span class="hljs-string">'c'</span>] = <span class="hljs-string">'c'</span>;</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 625px;"><h2 id="arkts-no-typing-with-this">arkts-no-typing-with-this<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-typing-with-this" tips="复制节点链接"></i></h2><p>使用具体类型替代this。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> {</li><li>  <span class="hljs-title function_">getInstance</span>(): <span class="hljs-variable language_">this</span> {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;</li><li>  }</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> {</li><li>  <span class="hljs-title function_">getInstance</span>(): C {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>;</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 793px;"><h2 id="arkts-no-ctor-prop-decls">arkts-no-ctor-prop-decls<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-ctor-prop-decls" tips="复制节点链接"></i></h2><p>显式声明类属性，并在构造函数中手动赋值。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params"><span class="hljs-keyword">readonly</span> name: <span class="hljs-built_in">string</span></span>) {}</li><li>
</li><li>  <span class="hljs-title function_">getName</span>(): <span class="hljs-built_in">string</span> {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>;</li><li>  }</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Person</span> {</li><li>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span></li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span> = name;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">getName</span>(): <span class="hljs-built_in">string</span> {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">name</span>;</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1561px;"><h2 id="arkts-no-ctor-signatures-iface">arkts-no-ctor-signatures-iface<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-ctor-signatures-iface" tips="复制节点链接"></i></h2><p>使用type定义工厂函数或普通函数类型。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Controller</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span></li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ControllerConstructor</span> {</li><li>  <span class="hljs-keyword">new</span> (<span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Controller</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">testMenu</span> {</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">ControllerConstructor</span> = <span class="hljs-title class_">Controller</span></li><li>  <span class="hljs-title function_">createController</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>) {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">controller</span>(<span class="hljs-string">'abc'</span>);</li><li>    }</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> t = <span class="hljs-keyword">new</span> <span class="hljs-title function_">testMenu</span>();</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(t.<span class="hljs-title function_">createController</span>()!.<span class="hljs-property">value</span>);</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Controller</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span></li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">type</span> <span class="hljs-title class_">ControllerConstructor</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Controller</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">testMenu</span> {</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">ControllerConstructor</span> = <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Controller</span>(<span class="hljs-string">'abc'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">createController</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>) {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">controller</span>();</li><li>    }</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">t</span>: testMenu = <span class="hljs-keyword">new</span> <span class="hljs-title function_">testMenu</span>();</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(t.<span class="hljs-title function_">createController</span>()!.<span class="hljs-property">value</span>);</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 577px;"><h2 id="arkts-no-props-by-index">arkts-no-props-by-index<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-props-by-index" tips="复制节点链接"></i></h2><p>可以将对象转换为Record类型，以便访问其属性。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">params: <span class="hljs-built_in">Object</span></span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">funNum</span>: <span class="hljs-built_in">number</span> = params[<span class="hljs-string">'funNum'</span>];</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">target</span>: <span class="hljs-built_in">string</span> = params[<span class="hljs-string">'target'</span>];</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">params: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span> | <span class="hljs-built_in">number</span>&gt;</span>) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">funNum</span>: <span class="hljs-built_in">number</span> = params[<span class="hljs-string">'funNum'</span>] <span class="hljs-keyword">as</span> <span class="hljs-built_in">number</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">target</span>: <span class="hljs-built_in">string</span> = params[<span class="hljs-string">'target'</span>] <span class="hljs-keyword">as</span> <span class="hljs-built_in">string</span>;</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 908px;"><h2 id="arkts-no-inferred-generic-params">arkts-no-inferred-generic-params<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-inferred-generic-params" tips="复制节点链接"></i></h2><p>所有泛型调用都应显式标注泛型参数类型，如 Map&lt;string, T&gt;、.map&lt;T&gt;()。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-attr">str</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span></li><li>}</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">A</span> {}</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">A</span> {}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>: <span class="hljs-title class_">Array</span>&lt;A&gt; = [];</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">originMenusMap</span>:<span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, C&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>(arr.<span class="hljs-title function_">map</span>(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> [item.<span class="hljs-property">str</span>, (item <span class="hljs-keyword">instanceof</span> C) ? <span class="hljs-attr">item</span>: <span class="hljs-literal">null</span>]));</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-attr">str</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span></li><li>}</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">B</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">A</span> {}</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_ inherited__">A</span> {}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>: <span class="hljs-title class_">Array</span>&lt;A&gt; = [];</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">originMenusMap</span>: <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, C | <span class="hljs-literal">null</span>&gt; = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, C | <span class="hljs-literal">null</span>&gt;(arr.<span class="hljs-property">map</span>&lt;[<span class="hljs-built_in">string</span>, C | <span class="hljs-literal">null</span>]&gt;(<span class="hljs-function"><span class="hljs-params">item</span> =&gt;</span> [item.<span class="hljs-property">str</span>, (item <span class="hljs-keyword">instanceof</span> C) ? <span class="hljs-attr">item</span>: <span class="hljs-literal">null</span>]));</li></ol></pre></div></div> <p><strong>原因</strong></p> <p>(item instanceof C) ? item: null 需要声明类型为C | null，由于编译器无法推导出map的泛型类型参数，需要显式标注。</p> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 524px;"><h2 id="arkts-no-regexp-literals">arkts-no-regexp-literals<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-regexp-literals" tips="复制节点链接"></i></h2><p>使用new RegExp(pattern, flags) 构造函数替代RegExp字面量。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">regex</span>: <span class="hljs-title class_">RegExp</span> = <span class="hljs-regexp">/\s*/g</span>;</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">regexp</span>: <span class="hljs-title class_">RegExp</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">RegExp</span>(<span class="hljs-string">'\\s*'</span>,<span class="hljs-string">'g'</span>);</li></ol></pre></div></div> <p><strong>原因</strong></p> <p>如果正则表达式中使用了标志符，需要将其作为new RegExp()的参数。</p> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 80px;"><h2 id="arkts-no-untyped-obj-literals">arkts-no-untyped-obj-literals<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-untyped-obj-literals" tips="复制节点链接"></i></h2></div>  <div class="tiledSection" style="contain-intrinsic-size: auto 649px;"><h3 id="从sdk中导入类型标注object-literal类型" class="firsth2">从SDK中导入类型，标注object literal类型<i class="anchor-icon anchor-icon-link" anchorid="从sdk中导入类型标注object-literal类型" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">const</span> area = { <span class="hljs-comment">// 没有写明类型 不方便维护</span></li><li>  <span class="hljs-attr">pixels</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">8</span>),</li><li>  <span class="hljs-attr">offset</span>: <span class="hljs-number">0</span>,</li><li>  <span class="hljs-attr">stride</span>: <span class="hljs-number">8</span>,</li><li>  <span class="hljs-attr">region</span>: { <span class="hljs-attr">size</span>: { <span class="hljs-attr">height</span>: <span class="hljs-number">1</span>,<span class="hljs-attr">width</span>:<span class="hljs-number">2</span> }, <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> }</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ImageKit'</span>;</li><li>
</li><li><span class="hljs-keyword">const</span> <span class="hljs-attr">area</span>: image.<span class="hljs-property">PositionArea</span> = { <span class="hljs-comment">// 写明具体类型</span></li><li>  <span class="hljs-attr">pixels</span>: <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(<span class="hljs-number">8</span>),</li><li>  <span class="hljs-attr">offset</span>: <span class="hljs-number">0</span>,</li><li>  <span class="hljs-attr">stride</span>: <span class="hljs-number">8</span>,</li><li>  <span class="hljs-attr">region</span>: { <span class="hljs-attr">size</span>: { <span class="hljs-attr">height</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">width</span>: <span class="hljs-number">2</span> }, <span class="hljs-attr">x</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">0</span> }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1532px;"><h3 id="用class为object-literal标注类型要求class的构造函数无参数">用class为object literal标注类型，要求class的构造函数无参数<i class="anchor-icon anchor-icon-link" anchorid="用class为object-literal标注类型要求class的构造函数无参数" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span></li><li>  <span class="hljs-comment">// 有构造函数</span></li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">t</span>: <span class="hljs-title class_">Test</span> = { <span class="hljs-attr">value</span>: <span class="hljs-number">2</span> };</li></ol></pre></div></div> <p><strong>建议改法1</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 去除构造函数</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">t</span>: <span class="hljs-title class_">Test</span> = { <span class="hljs-attr">value</span>: <span class="hljs-number">2</span> };</li></ol></pre></div></div> <p><strong>建议改法2</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 使用new</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span></li><li>  </li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">t</span>: <span class="hljs-title class_">Test</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>(<span class="hljs-number">2</span>);</li></ol></pre></div></div> <p><strong>原因</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span></li><li>  </li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">n: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-keyword">if</span> (n &lt; <span class="hljs-number">0</span>) {</li><li>      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Error</span>(<span class="hljs-string">'Negative'</span>);</li><li>    }</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = n;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">s</span>: C = <span class="hljs-keyword">new</span> <span class="hljs-title function_">C</span>(-<span class="hljs-number">2</span>);     <span class="hljs-comment">//抛出异常</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">t</span>: C = { <span class="hljs-attr">value</span>: -<span class="hljs-number">2</span> };    <span class="hljs-comment">//ArkTS不支持</span></li></ol></pre></div></div> <p>如果允许使用C来标注object literal的类型，变量t会导致行为的二义性。ArkTS禁止通过object literal绕过这一行为。</p> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1009px;"><h3 id="用classinterface为object-literal标注类型要求使用identifier作为object-literal的key">用class/interface为object literal标注类型，要求使用identifier作为object literal的key<i class="anchor-icon anchor-icon-link" anchorid="用classinterface为object-literal标注类型要求使用identifier作为object-literal的key" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>: <span class="hljs-title class_">Test</span>[] = [</li><li>  {</li><li>    <span class="hljs-string">'value'</span>: <span class="hljs-number">1</span></li><li>  },</li><li>  {</li><li>    <span class="hljs-string">'value'</span>: <span class="hljs-number">2</span></li><li>  },</li><li>  {</li><li>    <span class="hljs-string">'value'</span>: <span class="hljs-number">3</span></li><li>  }</li><li>]</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>: <span class="hljs-title class_">Test</span>[] = [</li><li>  {</li><li>    <span class="hljs-attr">value</span>: <span class="hljs-number">1</span></li><li>  },</li><li>  {</li><li>    <span class="hljs-attr">value</span>: <span class="hljs-number">2</span></li><li>  },</li><li>  {</li><li>    <span class="hljs-attr">value</span>: <span class="hljs-number">3</span></li><li>  }</li><li>]</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 505px;"><h3 id="使用record类型为object-literal标注类型要求使用字符串作为object-literal的key">使用Record类型为object literal标注类型，要求使用字符串作为object literal的key<i class="anchor-icon anchor-icon-link" anchorid="使用record类型为object-literal标注类型要求使用字符串作为object-literal的key" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">obj</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span> | <span class="hljs-built_in">string</span>&gt; = {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-number">123</span>,</li><li>  <span class="hljs-attr">name</span>: <span class="hljs-string">'abc'</span></li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">obj</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span> | <span class="hljs-built_in">string</span>&gt; = {</li><li>  <span class="hljs-string">'value'</span>: <span class="hljs-number">123</span>,</li><li>  <span class="hljs-string">'name'</span>: <span class="hljs-string">'abc'</span></li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 601px;"><h3 id="函数参数类型包含index-signature">函数参数类型包含index signature<i class="anchor-icon anchor-icon-link" anchorid="函数参数类型包含index-signature" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">obj: { [key: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">string</span>}</span>): <span class="hljs-built_in">string</span> {</li><li>  <span class="hljs-keyword">if</span> (obj != <span class="hljs-literal">undefined</span> &amp;&amp; obj != <span class="hljs-literal">null</span>) {</li><li>    <span class="hljs-keyword">return</span> obj.<span class="hljs-property">value1</span> + obj.<span class="hljs-property">value2</span>;</li><li>  }</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">obj: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;</span>): <span class="hljs-built_in">string</span> {</li><li>  <span class="hljs-keyword">if</span> (obj != <span class="hljs-literal">undefined</span> &amp;&amp; obj != <span class="hljs-literal">null</span>) {</li><li>    <span class="hljs-keyword">return</span> obj.<span class="hljs-property">value1</span> + obj.<span class="hljs-property">value2</span>;</li><li>  }</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-string">''</span>;</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 577px;"><h3 id="函数实参使用了object-literal">函数实参使用了object literal<i class="anchor-icon anchor-icon-link" anchorid="函数实参使用了object-literal" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li>(fn) =&gt; {</li><li>  <span class="hljs-title function_">fn</span>({ <span class="hljs-attr">value</span>: <span class="hljs-number">123</span>, <span class="hljs-attr">name</span>:<span class="hljs-string">''</span> });</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">T</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span></li><li>}</li><li>
</li><li>(<span class="hljs-attr">fn</span>: <span class="hljs-function">(<span class="hljs-params">v: T</span>) =&gt;</span> <span class="hljs-built_in">void</span>) =&gt; {</li><li>  <span class="hljs-title function_">fn</span>({ <span class="hljs-attr">value</span>: <span class="hljs-number">123</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">''</span> });</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 944px;"><h3 id="classinterface-中包含方法">class/interface 中包含方法<i class="anchor-icon anchor-icon-link" anchorid="classinterface-中包含方法" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">interface</span> T {</li><li>  <span class="hljs-title function_">foo</span>(<span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">number</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">t</span>:T = { <span class="hljs-attr">foo</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> { <span class="hljs-keyword">return</span> value } };</li></ol></pre></div></div> <p><strong>建议改法1</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">interface</span> T {</li><li>  <span class="hljs-attr">foo</span>: <span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">number</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">t</span>:T = { <span class="hljs-attr">foo</span>: <span class="hljs-function">(<span class="hljs-params">value</span>) =&gt;</span> { <span class="hljs-keyword">return</span> value } };</li></ol></pre></div></div> <p><strong>建议改法2</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">T</span> {</li><li>  <span class="hljs-attr">foo</span>: <span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">number</span> = <span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">return</span> value;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">t</span>:T = <span class="hljs-keyword">new</span> <span class="hljs-title function_">T</span>();</li></ol></pre></div></div> <p><strong>原因</strong></p> <p>class/interface中声明的方法应被所有实例共享。ArkTS不支持通过object literal改写实例方法。ArkTS支持函数类型的属性。</p> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 745px;"><h3 id="export-default对象">export default对象<i class="anchor-icon anchor-icon-link" anchorid="export-default对象" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// ...</span></li><li>  },</li><li>  <span class="hljs-title function_">onDestroy</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// ...</span></li><li>  }</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-title function_">onCreate</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// ...</span></li><li>  }</li><li>  <span class="hljs-title function_">onDestroy</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-comment">// ...</span></li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>()</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1268px;"><h3 id="通过导入namespace获取类型">通过导入namespace获取类型<i class="anchor-icon anchor-icon-link" anchorid="通过导入namespace获取类型" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// test.d.ets</span></li><li><span class="hljs-keyword">declare</span> <span class="hljs-keyword">namespace</span> test {</li><li>  <span class="hljs-keyword">interface</span> I {</li><li>    <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>;</li><li>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">number</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, option: I</span>): <span class="hljs-built_in">void</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> test;</li><li>
</li><li><span class="hljs-comment">// app.ets</span></li><li><span class="hljs-keyword">import</span> test <span class="hljs-keyword">from</span> <span class="hljs-string">'test'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> option = { <span class="hljs-attr">id</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">type</span>: <span class="hljs-number">0</span> };</li><li>test.<span class="hljs-title function_">foo</span>(<span class="hljs-string">''</span>, option);</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// test.d.ets</span></li><li><span class="hljs-keyword">declare</span> <span class="hljs-keyword">namespace</span> test {</li><li>  <span class="hljs-keyword">interface</span> I {</li><li>    <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>;</li><li>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">number</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">name: <span class="hljs-built_in">string</span>, option: I</span>): <span class="hljs-built_in">void</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> test;</li><li>
</li><li><span class="hljs-comment">// app.ets</span></li><li><span class="hljs-keyword">import</span> test <span class="hljs-keyword">from</span> <span class="hljs-string">'test'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">option</span>: test.<span class="hljs-property">I</span> = { <span class="hljs-attr">id</span>: <span class="hljs-string">''</span>, <span class="hljs-attr">type</span>: <span class="hljs-number">0</span> };</li><li>test.<span class="hljs-title function_">foo</span>(<span class="hljs-string">''</span>, option);</li></ol></pre></div></div> <p><strong>原因</strong></p> <p>对象字面量缺少类型，根据test.foo分析可以得知，option的类型来源于声明文件，那么只需要将类型导入即可。</p> <p>在test.d.ets中，I定义在namespace中。在ets文件中，先导入namespace，再通过名称获取相应的类型。</p> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 649px;"><h3 id="object-literal传参给object类型">object literal传参给Object类型<i class="anchor-icon anchor-icon-link" anchorid="object-literal传参给object类型" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">emit</span>(<span class="hljs-params">event: <span class="hljs-built_in">string</span>, ...args: <span class="hljs-built_in">Object</span>[]</span>): <span class="hljs-built_in">void</span> {}</li><li>
</li><li><span class="hljs-title function_">emit</span>(<span class="hljs-string">''</span>, {</li><li>  <span class="hljs-string">'action'</span>: <span class="hljs-number">11</span>,</li><li>  <span class="hljs-string">'outers'</span>: <span class="hljs-literal">false</span></li><li>});</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">emit</span>(<span class="hljs-params">event: <span class="hljs-built_in">string</span>, ...args: <span class="hljs-built_in">Object</span>[]</span>): <span class="hljs-built_in">void</span> {}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">emitArg</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">number</span> | <span class="hljs-built_in">boolean</span>&gt; = {</li><li>   <span class="hljs-string">'action'</span>: <span class="hljs-number">11</span>,</li><li>   <span class="hljs-string">'outers'</span>: <span class="hljs-literal">false</span></li><li>}</li><li>
</li><li><span class="hljs-title function_">emit</span>(<span class="hljs-string">''</span>, emitArg);</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 505px;"><h2 id="arkts-no-obj-literals-as-types">arkts-no-obj-literals-as-types<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-obj-literals-as-types" tips="复制节点链接"></i></h2><p>使用interface显式定义结构类型。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">type</span> <span class="hljs-title class_">Person</span> = { <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span> }</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Person</span> {</li><li>  <span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>,</li><li>  <span class="hljs-attr">age</span>: <span class="hljs-built_in">number</span></li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 793px;"><h2 id="arkts-no-noninferrable-arr-literals">arkts-no-noninferrable-arr-literals<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-noninferrable-arr-literals" tips="复制节点链接"></i></h2><p>显式声明数组元素的类型（使用interface或class），并为数组变量添加类型注解。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> permissionList = [</li><li>  { <span class="hljs-attr">name</span>: <span class="hljs-string">'设备信息'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'用于分析设备的续航、通话、上网、SIM卡故障等'</span> },</li><li>  { <span class="hljs-attr">name</span>: <span class="hljs-string">'麦克风'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'用于反馈问题单时增加语音'</span> },</li><li>  { <span class="hljs-attr">name</span>: <span class="hljs-string">'存储'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'用于反馈问题单时增加本地文件附件'</span> }</li><li>]</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <p>为对象字面量声明类型。</p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">PermissionItem</span> {</li><li>  name?: <span class="hljs-built_in">string</span></li><li>  value?: <span class="hljs-built_in">string</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">permissionList</span>: <span class="hljs-title class_">PermissionItem</span>[] = [</li><li>  { <span class="hljs-attr">name</span>: <span class="hljs-string">'设备信息'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'用于分析设备的续航、通话、上网、SIM卡故障等'</span> },</li><li>  { <span class="hljs-attr">name</span>: <span class="hljs-string">'麦克风'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'用于反馈问题单时增加语音'</span> },</li><li>  { <span class="hljs-attr">name</span>: <span class="hljs-string">'存储'</span>, <span class="hljs-attr">value</span>: <span class="hljs-string">'用于反馈问题单时增加本地文件附件'</span> }</li><li>]</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 985px;"><h2 id="arkts-no-method-reassignment">arkts-no-method-reassignment<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-method-reassignment" tips="复制节点链接"></i></h2><p>使用函数类型的类字段（class field）代替原型方法。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> {</li><li>  <span class="hljs-title function_">add</span>(<span class="hljs-attr">left</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">right</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">number</span> {</li><li>    <span class="hljs-keyword">return</span> left + right;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">sub</span>(<span class="hljs-params">left: <span class="hljs-built_in">number</span>, right: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {</li><li>  <span class="hljs-keyword">return</span> left - right;</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> c1 = <span class="hljs-keyword">new</span> <span class="hljs-title function_">C</span>();</li><li>c1.<span class="hljs-property">add</span> = sub;</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> {</li><li>  <span class="hljs-attr">add</span>: <span class="hljs-function">(<span class="hljs-params">left: <span class="hljs-built_in">number</span>, right: <span class="hljs-built_in">number</span></span>) =&gt;</span> <span class="hljs-built_in">number</span> =</li><li>    <span class="hljs-function">(<span class="hljs-params">left: <span class="hljs-built_in">number</span>, right: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>      <span class="hljs-keyword">return</span> left + right;</li><li>    }</li><li>}</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">sub</span>(<span class="hljs-params">left: <span class="hljs-built_in">number</span>, right: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {</li><li>  <span class="hljs-keyword">return</span> left - right;</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> c1 = <span class="hljs-keyword">new</span> <span class="hljs-title function_">C</span>();</li><li>c1.<span class="hljs-property">add</span> = sub;</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 577px;"><h2 id="arkts-no-polymorphic-unops">arkts-no-polymorphic-unops<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-polymorphic-unops" tips="复制节点链接"></i></h2><p>使用 Number.parseInt()、new Number() 等显式转换函数。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> a = +<span class="hljs-string">'5'</span>; <span class="hljs-comment">// 使用操作符隐式转换</span></li><li><span class="hljs-keyword">let</span> b = -<span class="hljs-string">'5'</span>;</li><li><span class="hljs-keyword">let</span> c = ~<span class="hljs-string">'5'</span>;</li><li><span class="hljs-keyword">let</span> d = +<span class="hljs-string">'string'</span>;</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> a = <span class="hljs-title class_">Number</span>.<span class="hljs-built_in">parseInt</span>(<span class="hljs-string">'5'</span>); <span class="hljs-comment">// 使用Number.parseInt显示转换</span></li><li><span class="hljs-keyword">let</span> b = -<span class="hljs-title class_">Number</span>.<span class="hljs-built_in">parseInt</span>(<span class="hljs-string">'5'</span>);</li><li><span class="hljs-keyword">let</span> c = ~<span class="hljs-title class_">Number</span>.<span class="hljs-built_in">parseInt</span>(<span class="hljs-string">'5'</span>);</li><li><span class="hljs-keyword">let</span> d = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Number</span>(<span class="hljs-string">'123'</span>);</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 865px;"><h2 id="arkts-no-type-query">arkts-no-type-query<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-type-query" tips="复制节点链接"></i></h2><p>使用类、接口或类型别名替代typeof，避免依赖变量做类型推导。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// module1.ts</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">let</span> c = <span class="hljs-keyword">new</span> <span class="hljs-title function_">C</span>()</li><li>
</li><li><span class="hljs-comment">// module2.ts</span></li><li><span class="hljs-keyword">import</span> { c } <span class="hljs-keyword">from</span> <span class="hljs-string">'./module1'</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">t</span>: <span class="hljs-keyword">typeof</span> c = { <span class="hljs-attr">value</span>: <span class="hljs-number">123</span> };</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// module1.ts</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> { C }</li><li>
</li><li><span class="hljs-comment">// module2.ts</span></li><li><span class="hljs-keyword">import</span> { C } <span class="hljs-keyword">from</span> <span class="hljs-string">'./module1'</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">t</span>: C = { <span class="hljs-attr">value</span>: <span class="hljs-number">123</span> };</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 80px;"><h2 id="arkts-no-in">arkts-no-in<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-in" tips="复制节点链接"></i></h2></div>  <div class="tiledSection" style="contain-intrinsic-size: auto 577px;"><h3 id="使用objectkeys判断属性是否存在" class="firsth2">使用Object.keys判断属性是否存在<i class="anchor-icon anchor-icon-link" anchorid="使用objectkeys判断属性是否存在" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params">str: <span class="hljs-built_in">string</span>, obj: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">Object</span>&gt;</span>) {</li><li>  <span class="hljs-keyword">return</span> str <span class="hljs-keyword">in</span> obj;</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">test</span>(<span class="hljs-params">str: <span class="hljs-built_in">string</span>, obj: Record&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">Object</span>&gt;</span>) {</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj)) {</li><li>    <span class="hljs-keyword">if</span> (i == str) {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</li><li>    }</li><li>  }</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 721px;"><h2 id="arkts-no-destruct-assignment">arkts-no-destruct-assignment<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-destruct-assignment" tips="复制节点链接"></i></h2><p>使用索引访问元素或手动赋值代替解构赋值。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;([[<span class="hljs-string">'a'</span>, <span class="hljs-string">'a'</span>], [<span class="hljs-string">'b'</span>, <span class="hljs-string">'b'</span>]]);</li><li><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> [key, value] <span class="hljs-keyword">of</span> map) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(key);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(value);</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <p>使用数组。</p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt;([[<span class="hljs-string">'a'</span>, <span class="hljs-string">'a'</span>], [<span class="hljs-string">'b'</span>, <span class="hljs-string">'b'</span>]]);</li><li><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> arr <span class="hljs-keyword">of</span> map) {</li><li>  <span class="hljs-keyword">let</span> key = arr[<span class="hljs-number">0</span>];</li><li>  <span class="hljs-keyword">let</span> value = arr[<span class="hljs-number">1</span>];</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(key);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(value);</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 745px;"><h2 id="arkts-no-types-in-catch">arkts-no-types-in-catch<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-types-in-catch" tips="复制节点链接"></i></h2><p>使用无类型 catch (error)，然后通过类型断言处理。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span></li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// ...</span></li><li>} <span class="hljs-keyword">catch</span> (<span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span>) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(e.<span class="hljs-property">message</span>, e.<span class="hljs-property">code</span>);</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span></li><li>
</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-comment">// ...</span></li><li>} <span class="hljs-keyword">catch</span> (error) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(e.<span class="hljs-property">message</span>, e.<span class="hljs-property">code</span>);</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 841px;"><h2 id="arkts-no-for-in">arkts-no-for-in<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-for-in" tips="复制节点链接"></i></h2><p>使用 Object.entries(obj) + for of 替代 for in。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">Person</span> {</li><li>  [<span class="hljs-attr">name</span>: <span class="hljs-built_in">string</span>]: <span class="hljs-built_in">string</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">p</span>: <span class="hljs-title class_">Person</span> = {</li><li>  <span class="hljs-attr">name</span>: <span class="hljs-string">'tom'</span>,</li><li>  <span class="hljs-attr">age</span>: <span class="hljs-string">'18'</span></li><li>};</li><li>
</li><li><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> t <span class="hljs-keyword">in</span> p) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(p[t]);  <span class="hljs-comment">// info: "tom", "18"</span></li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">p</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-built_in">string</span>&gt; = {</li><li>  <span class="hljs-string">'name'</span>: <span class="hljs-string">'tom'</span>,</li><li>  <span class="hljs-string">'age'</span>: <span class="hljs-string">'18'</span></li><li>};</li><li>
</li><li><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> ele <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">entries</span>(p)) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(ele[<span class="hljs-number">1</span>]);  <span class="hljs-comment">// info: "tom", "18"</span></li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 745px;"><h2 id="arkts-no-mapped-types">arkts-no-mapped-types<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-mapped-types" tips="复制节点链接"></i></h2><p>使用 Record&lt;K, T&gt; 替代映射类型。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> {</li><li>  <span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>  <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>  <span class="hljs-attr">c</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>}</li><li><span class="hljs-keyword">type</span> <span class="hljs-title class_">OptionsFlags</span> = {</li><li>  [<span class="hljs-title class_">Property</span> <span class="hljs-keyword">in</span> keyof C]: <span class="hljs-built_in">string</span></li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">C</span> {</li><li>  <span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>  <span class="hljs-attr">b</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>  <span class="hljs-attr">c</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">type</span> <span class="hljs-title class_">OptionsFlags</span> = <span class="hljs-title class_">Record</span>&lt;keyof C, <span class="hljs-built_in">string</span>&gt;</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 716px;"><h2 id="arkts-limited-throw">arkts-limited-throw<i class="anchor-icon anchor-icon-link" anchorid="arkts-limited-throw" tips="复制节点链接"></i></h2><p>将对象转换为Error，或创建新的Error实例抛出。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span></li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">ThrowError</span>(<span class="hljs-params">error: BusinessError</span>) {</li><li>  <span class="hljs-keyword">throw</span> error;</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span></li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">ThrowError</span>(<span class="hljs-params">error: BusinessError</span>) {</li><li>  <span class="hljs-keyword">throw</span> error <span class="hljs-keyword">as</span> <span class="hljs-title class_">Error</span>;</li><li>}</li></ol></pre></div></div> <p><strong>原因</strong></p> <p>throw语句中值的类型必须为Error或者其继承类，如果继承类是一个泛型，会有编译期报错。建议使用as将类型转换为Error。</p> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 80px;"><h2 id="arkts-no-standalone-this">arkts-no-standalone-this<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-standalone-this" tips="复制节点链接"></i></h2></div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1657px;"><h3 id="函数内使用this" class="firsth2">函数内使用this<i class="anchor-icon anchor-icon-link" anchorid="函数内使用this" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> obj = { <span class="hljs-attr">value</span>: <span class="hljs-string">'abc'</span> };</li><li>foo.<span class="hljs-title function_">apply</span>(obj);</li></ol></pre></div></div> <p><strong>建议改法1</strong></p> <p>使用类的方法实现,如果该方法被多个类使用,可以考虑采用继承的机制。</p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span></li><li>  <span class="hljs-title function_">constructor</span> (<span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value</li><li>  }</li><li>  </li><li>  <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">obj</span>: <span class="hljs-title class_">Test</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>(<span class="hljs-string">'abc'</span>);</li><li>obj.<span class="hljs-title function_">foo</span>();</li></ol></pre></div></div> <p><strong>建议改法2</strong></p> <p>将this作为参数传入。</p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">obj: Test</span>) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(obj.<span class="hljs-property">value</span>);</li><li>}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">obj</span>: <span class="hljs-title class_">Test</span> = { <span class="hljs-attr">value</span>: <span class="hljs-string">'abc'</span> };</li><li><span class="hljs-title function_">foo</span>(obj);</li></ol></pre></div></div> <p><strong>建议改法3</strong></p> <p>将属性作为参数传入。</p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(value);</li><li>}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">obj</span>: <span class="hljs-title class_">Test</span> = { <span class="hljs-attr">value</span>: <span class="hljs-string">'abc'</span> };</li><li><span class="hljs-title function_">foo</span>(obj.<span class="hljs-property">value</span>);</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 601px;"><h3 id="class的静态方法内使用this">class的静态方法内使用this<i class="anchor-icon anchor-icon-link" anchorid="class的静态方法内使用this" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">123</span></li><li>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">foo</span>(): <span class="hljs-built_in">number</span> {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span></li><li>  }</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">123</span></li><li>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">foo</span>(): <span class="hljs-built_in">number</span> {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">Test</span>.<span class="hljs-property">value</span></li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1364px;"><h2 id="arkts-no-spread">arkts-no-spread<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-spread" tips="复制节点链接"></i></h2><p>使用Object.assign()、手动赋值或数组方法替代扩展运算符。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// test.d.ets</span></li><li><span class="hljs-keyword">declare</span> <span class="hljs-keyword">namespace</span> test {</li><li>  <span class="hljs-keyword">interface</span> I {</li><li>    <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>;</li><li>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">number</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>): I;</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> test</li><li>
</li><li><span class="hljs-comment">// app.ets</span></li><li><span class="hljs-keyword">import</span> test <span class="hljs-keyword">from</span> <span class="hljs-string">'test'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">t</span>: test.<span class="hljs-property">I</span> = {</li><li>  ...test.<span class="hljs-title function_">foo</span>(),</li><li>  <span class="hljs-attr">type</span>: <span class="hljs-number">0</span></li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// test.d.ets</span></li><li><span class="hljs-keyword">declare</span> <span class="hljs-keyword">namespace</span> test {</li><li>  <span class="hljs-keyword">interface</span> I {</li><li>    <span class="hljs-attr">id</span>: <span class="hljs-built_in">string</span>;</li><li>    <span class="hljs-attr">type</span>: <span class="hljs-built_in">number</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>): I;</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> test</li><li>
</li><li><span class="hljs-comment">// app.ets</span></li><li><span class="hljs-keyword">import</span> test <span class="hljs-keyword">from</span> <span class="hljs-string">'test'</span>;</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">t</span>: test.<span class="hljs-property">I</span> = test.<span class="hljs-title function_">foo</span>();</li><li>t.<span class="hljs-property">type</span> = <span class="hljs-number">0</span>;</li></ol></pre></div></div> <p><strong>原因</strong></p> <p>ArkTS中，对象布局在编译期是确定的。如果需要将一个对象的所有属性展开赋值给另一个对象可以通过逐个属性赋值语句完成。在本例中，需要展开的对象和赋值的目标对象类型恰好相同，可以通过改变该对象属性的方式重构代码。</p> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1393px;"><h2 id="arkts-no-ctor-signatures-funcs">arkts-no-ctor-signatures-funcs<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-ctor-signatures-funcs" tips="复制节点链接"></i></h2><p>在class内声明属性，而不是在构造函数上。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Controller</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span></li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">type</span> <span class="hljs-title class_">ControllerConstructor</span> = <span class="hljs-keyword">new</span> (<span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span>) =&gt; <span class="hljs-title class_">Controller</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">testMenu</span> {</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">ControllerConstructor</span> = <span class="hljs-title class_">Controller</span></li><li>  <span class="hljs-title function_">createController</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>) {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">controller</span>(<span class="hljs-string">'abc'</span>);</li><li>    }</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> t = <span class="hljs-keyword">new</span> <span class="hljs-title function_">testMenu</span>()</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(t.<span class="hljs-title function_">createController</span>()!.<span class="hljs-property">value</span>)</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Controller</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span></li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">type</span> <span class="hljs-title class_">ControllerConstructor</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Controller</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">testMenu</span> {</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">ControllerConstructor</span> = <span class="hljs-function">() =&gt;</span> { <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Controller</span>(<span class="hljs-string">'abc'</span>) }</li><li>  <span class="hljs-title function_">createController</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>) {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">controller</span>();</li><li>    }</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">t</span>: testMenu = <span class="hljs-keyword">new</span> <span class="hljs-title function_">testMenu</span>();</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(t.<span class="hljs-title function_">createController</span>()!.<span class="hljs-property">value</span>);</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1821px;"><h2 id="arkts-no-globalthis">arkts-no-globalthis<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-globalthis" tips="复制节点链接"></i></h2><p>ArkTS不支持globalThis。一方面无法为globalThis添加静态类型，只能通过查找方式访问其属性，导致额外性能开销。另一方面，无法为globalThis的属性标记类型，无法保证操作的安全性和高性能。</p> <ol><li><p>建议按照业务逻辑根据import/export语法实现数据在不同模块的传递。</p>  </li><li><p>必要情况下，可以通过构造的<strong>单例对象</strong>来实现全局对象的功能。(<strong>说明：</strong> 不能在har中定义单例对象，har在打包时会在不同的hap中打包两份，无法实现单例。)</p>  </li></ol> <p><strong>构造单例对象</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 构造单例对象</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GlobalContext</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">constructor</span>(<span class="hljs-params"></span>) {}</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">instance</span>: <span class="hljs-title class_">GlobalContext</span>;</li><li>  <span class="hljs-keyword">private</span> _objects = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Object</span>&gt;();</li><li>
</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title function_">getContext</span>(): <span class="hljs-title class_">GlobalContext</span> {</li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-title class_">GlobalContext</span>.<span class="hljs-property">instance</span>) {</li><li>      <span class="hljs-title class_">GlobalContext</span>.<span class="hljs-property">instance</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">GlobalContext</span>();</li><li>    }</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">GlobalContext</span>.<span class="hljs-property">instance</span>;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">getObject</span>(<span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Object</span> | <span class="hljs-literal">undefined</span> {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-property">_objects</span>.<span class="hljs-title function_">get</span>(value);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">setObject</span>(<span class="hljs-attr">key</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">objectClass</span>: <span class="hljs-title class_">Object</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">_objects</span>.<span class="hljs-title function_">set</span>(key, objectClass);</li><li>  }</li><li>}</li></ol></pre></div></div> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// file1.ts</span></li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-title function_">foo</span>(): <span class="hljs-built_in">void</span> {</li><li>    globalThis.<span class="hljs-property">value</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-comment">// file2.ts</span></li><li>
</li><li>globalThis.<span class="hljs-property">value</span>;</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// file1.ts</span></li><li>
</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">GlobalContext</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../GlobalContext'</span></li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-title function_">foo</span>(): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-title class_">GlobalContext</span>.<span class="hljs-title function_">getContext</span>().<span class="hljs-title function_">setObject</span>(<span class="hljs-string">'value'</span>, <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-comment">// file2.ts</span></li><li>
</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">GlobalContext</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../GlobalContext'</span></li><li>
</li><li><span class="hljs-title class_">GlobalContext</span>.<span class="hljs-title function_">getContext</span>().<span class="hljs-title function_">getObject</span>(<span class="hljs-string">'value'</span>);</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 80px;"><h2 id="arkts-no-func-apply-bind-call">arkts-no-func-apply-bind-call<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-func-apply-bind-call" tips="复制节点链接"></i></h2></div>  <div class="tiledSection" style="contain-intrinsic-size: auto 409px;"><h3 id="使用标准库中接口" class="firsth2">使用标准库中接口<i class="anchor-icon anchor-icon-link" anchorid="使用标准库中接口" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>];</li><li><span class="hljs-keyword">let</span> str = <span class="hljs-title class_">String</span>.<span class="hljs-property">fromCharCode</span>.<span class="hljs-title function_">apply</span>(<span class="hljs-literal">null</span>, <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(arr));</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">arr</span>: <span class="hljs-built_in">number</span>[] = [<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>];</li><li><span class="hljs-keyword">let</span> str = <span class="hljs-title class_">String</span>.<span class="hljs-title function_">fromCharCode</span>(...<span class="hljs-title class_">Array</span>.<span class="hljs-title function_">from</span>(arr));</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1573px;"><h3 id="bind定义方法">bind定义方法<i class="anchor-icon anchor-icon-link" anchorid="bind定义方法" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span></li><li>  <span class="hljs-attr">foo</span>: <span class="hljs-title class_">Function</span> = <span class="hljs-function">() =&gt;</span> {}</li><li>}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'1234'</span></li><li>  <span class="hljs-attr">obj</span>: A = {</li><li>    <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>,</li><li>    <span class="hljs-attr">foo</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">foo</span>.<span class="hljs-title function_">bind</span>(<span class="hljs-variable language_">this</span>)</li><li>  }</li><li>  </li><li>  <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);</li><li>  }</li><li>}</li></ol></pre></div></div> <p><strong>建议改法1</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span></li><li>  <span class="hljs-attr">foo</span>: <span class="hljs-title class_">Function</span> = <span class="hljs-function">() =&gt;</span> {}</li><li>}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'1234'</span></li><li>  <span class="hljs-attr">obj</span>: A = {</li><li>    <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>,</li><li>    <span class="hljs-attr">foo</span>: (): <span class="hljs-function"><span class="hljs-params">void</span> =&gt;</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">foo</span>()</li><li>  }</li><li>  </li><li>  <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);</li><li>  }</li><li>}</li></ol></pre></div></div> <p><strong>建议改法2</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span></li><li>  <span class="hljs-attr">foo</span>: <span class="hljs-title class_">Function</span> = <span class="hljs-function">() =&gt;</span> {}</li><li>}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'1234'</span></li><li>  <span class="hljs-attr">foo</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span> = <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);</li><li>  }</li><li>  <span class="hljs-attr">obj</span>: A = {</li><li>    <span class="hljs-attr">value</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>,</li><li>    <span class="hljs-attr">foo</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">foo</span></li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1177px;"><h3 id="使用apply">使用apply<i class="anchor-icon anchor-icon-link" anchorid="使用apply" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-title function_">constructor</span> (<span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> a1 = <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>(<span class="hljs-string">'1'</span>);</li><li><span class="hljs-keyword">let</span> a2 = <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>(<span class="hljs-string">'2'</span>);</li><li>
</li><li>a1.<span class="hljs-title function_">foo</span>();</li><li>a1.<span class="hljs-property">foo</span>.<span class="hljs-title function_">apply</span>(a2);</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-title function_">constructor</span> (<span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">fooApply</span>(<span class="hljs-variable language_">this</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">fooApply</span>(<span class="hljs-params">a: A</span>) {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(a.<span class="hljs-property">value</span>);</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> a1 = <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>(<span class="hljs-string">'1'</span>);</li><li><span class="hljs-keyword">let</span> a2 = <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>(<span class="hljs-string">'2'</span>);</li><li>
</li><li>a1.<span class="hljs-title function_">foo</span>();</li><li>a1.<span class="hljs-title function_">fooApply</span>(a2);</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 80px;"><h2 id="arkts-limited-stdlib">arkts-limited-stdlib<i class="anchor-icon anchor-icon-link" anchorid="arkts-limited-stdlib" tips="复制节点链接"></i></h2></div>  <div class="tiledSection" style="contain-intrinsic-size: auto 721px;"><h3 id="objectfromentries" class="firsth2">Object.fromEntries()<i class="anchor-icon anchor-icon-link" anchorid="objectfromentries" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> entries = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>([</li><li>  [<span class="hljs-string">'foo'</span>, <span class="hljs-number">123</span>],</li><li>  [<span class="hljs-string">'bar'</span>, <span class="hljs-number">456</span>]</li><li>]);</li><li>
</li><li><span class="hljs-keyword">let</span> obj = <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">fromEntries</span>(entries);</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> entries = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Map</span>([</li><li>  [<span class="hljs-string">'foo'</span>, <span class="hljs-number">123</span>],</li><li>  [<span class="hljs-string">'bar'</span>, <span class="hljs-number">456</span>]</li><li>]);</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">obj</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Object</span>&gt; = {};</li><li>entries.<span class="hljs-title function_">forEach</span>(<span class="hljs-function">(<span class="hljs-params">key, value</span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (key != <span class="hljs-literal">undefined</span> &amp;&amp; key != <span class="hljs-literal">null</span>) {</li><li>    obj[key] = value;</li><li>  }</li><li>})</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 80px;"><h2 id="严格模式检查strictmodeerror">严格模式检查(StrictModeError)<i class="anchor-icon anchor-icon-link" anchorid="严格模式检查strictmodeerror" tips="复制节点链接"></i></h2></div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1057px;"><h3 id="strictpropertyinitialization" class="firsth2">strictPropertyInitialization<i class="anchor-icon anchor-icon-link" anchorid="strictpropertyinitialization" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">interface</span> I {</li><li>  <span class="hljs-attr">name</span>:<span class="hljs-built_in">string</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span>;</li><li>  <span class="hljs-attr">b</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-attr">c</span>: <span class="hljs-built_in">boolean</span>;</li><li>  <span class="hljs-attr">d</span>: I;</li><li>  <span class="hljs-attr">e</span>: A;</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">interface</span> I {</li><li>  <span class="hljs-attr">name</span>:<span class="hljs-built_in">string</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span>;</li><li>  <span class="hljs-attr">b</span>: <span class="hljs-built_in">string</span>;</li><li>  <span class="hljs-attr">c</span>: <span class="hljs-built_in">boolean</span>;</li><li>  <span class="hljs-attr">d</span>: I = { <span class="hljs-attr">name</span>:<span class="hljs-string">'abc'</span> };</li><li>  <span class="hljs-attr">e</span>: A | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">a:<span class="hljs-built_in">number</span>, b:<span class="hljs-built_in">string</span>, c:<span class="hljs-built_in">boolean</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">a</span> = a;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">b</span> = b;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">c</span> = c;</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1009px;"><h3 id="type---null-is-not-assignable-to-type-">Type *** | null is not assignable to type ***<i class="anchor-icon anchor-icon-link" anchorid="type---null-is-not-assignable-to-type-" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-title function_">bar</span>(<span class="hljs-params"></span>) {}</li><li>}</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">n: <span class="hljs-built_in">number</span></span>) {</li><li>  <span class="hljs-keyword">if</span> (n === <span class="hljs-number">0</span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</li><li>  }</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>();</li><li>}</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">getNumber</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-number">5</span>;</li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>:A = <span class="hljs-title function_">foo</span>(<span class="hljs-title function_">getNumber</span>());</li><li>a.<span class="hljs-title function_">bar</span>();</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-title function_">bar</span>(<span class="hljs-params"></span>) {}</li><li>}</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">n: <span class="hljs-built_in">number</span></span>) {</li><li>  <span class="hljs-keyword">if</span> (n === <span class="hljs-number">0</span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</li><li>  }</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>();</li><li>}</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">getNumber</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-number">5</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>: A | <span class="hljs-literal">null</span> = <span class="hljs-title function_">foo</span>(<span class="hljs-title function_">getNumber</span>());</li><li>a?.<span class="hljs-title function_">bar</span>();</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1072px;"><h3 id="严格属性初始化检查">严格属性初始化检查<i class="anchor-icon anchor-icon-link" anchorid="严格属性初始化检查" tips="复制节点链接"></i></h3><p>在class中，如果一个属性没有初始化，且没有在构造函数中被赋值，ArkTS将报错。</p> <p><strong>建议改法</strong></p> <p>1.一般情况下，<strong>建议按照业务逻辑</strong>在声明时初始化属性，或者在构造函数中为属性赋值。如：</p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">//code with error</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span></li><li>  <span class="hljs-attr">flag</span>: <span class="hljs-built_in">boolean</span></li><li>}</li><li>
</li><li><span class="hljs-comment">//方式一，在声明时初始化</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>  <span class="hljs-attr">flag</span>: <span class="hljs-built_in">boolean</span> = <span class="hljs-literal">false</span></li><li>}</li><li>
</li><li><span class="hljs-comment">//方式二，在构造函数中赋值</span></li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span></li><li>  <span class="hljs-attr">flag</span>: <span class="hljs-built_in">boolean</span></li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value: <span class="hljs-built_in">number</span>, flag: <span class="hljs-built_in">boolean</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">flag</span> = flag;</li><li>  }</li><li>}</li></ol></pre></div></div> <p>2.对于对象类型（包括函数类型）A，如果不确定如何初始化，建议按照以下方式之一进行初始化：</p> <p>​ 方式(i) prop: A | null = null</p> <p>​ 方式(ii) prop?: A</p> <p>​ 方式三(iii) prop： A | undefined = undefined</p> <ul><li>从性能角度看，null类型仅用于编译期的类型检查，不会影响虚拟机性能。而undefined | A被视为联合类型，运行时可能产生额外开销。</li><li>从代码可读性、简洁性的角度来说，prop?:A是prop： A | undefined = undefined的语法糖，<strong>推荐使用可选属性的写法</strong>。</li></ul> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 896px;"><h3 id="严格函数类型检查">严格函数类型检查<i class="anchor-icon anchor-icon-link" anchorid="严格函数类型检查" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">fn: (value?: <span class="hljs-built_in">string</span>) =&gt; <span class="hljs-built_in">void</span>, value: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">void</span> {}</li><li>
</li><li><span class="hljs-title function_">foo</span>(<span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) =&gt;</span> {}, <span class="hljs-string">''</span>); <span class="hljs-comment">//error</span></li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">fn: (value?: <span class="hljs-built_in">string</span>) =&gt; <span class="hljs-built_in">void</span>, value: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">void</span> {}</li><li>
</li><li><span class="hljs-title function_">foo</span>(<span class="hljs-function">(<span class="hljs-params">value?: <span class="hljs-built_in">string</span></span>) =&gt;</span> {}, <span class="hljs-string">''</span>);</li></ol></pre></div></div> <p><strong>原因</strong></p> <p>例如，在以下的例子中，如果编译期不开启严格函数类型的检查，那么该段代码可以编译通过，但是在运行时会产生非预期的行为。具体来看，在foo的函数体中，一个undefined被传入fn（这是可以的，因为fn可以接受undefined），但是在代码第6行foo的调用点，传入的(value: string) =&gt; { console.info(value.toUpperCase()) }的函数实现中，始终将参数value当做string类型，允许其调用toUpperCase方法。如果不开启严格函数类型的检查，那么这段代码在运行时，会出现在undefined上无法找到属性的错误。</p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">fn: (value?: <span class="hljs-built_in">string</span>) =&gt; <span class="hljs-built_in">void</span>, value: <span class="hljs-built_in">string</span></span>): <span class="hljs-built_in">void</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">v</span>: <span class="hljs-built_in">string</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span>;</li><li>  <span class="hljs-title function_">fn</span>(v);</li><li>}</li><li>
</li><li><span class="hljs-title function_">foo</span>(<span class="hljs-function">(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) =&gt;</span> { <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(value.<span class="hljs-title function_">toUpperCase</span>()) }, <span class="hljs-string">''</span>); <span class="hljs-comment">// Cannot read properties of undefined (reading 'toUpperCase')</span></li></ol></pre></div></div> <p>为了避免运行时的非预期行为，开启严格类型检查时，这段代码将无法编译通过，需要提醒开发者修改代码，确保程序安全。</p> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1081px;"><h3 id="严格空值检查">严格空值检查<i class="anchor-icon anchor-icon-link" anchorid="严格空值检查" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-keyword">private</span> value?: <span class="hljs-built_in">string</span>;</li><li>  </li><li>  <span class="hljs-keyword">public</span> printValue () {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">toLowerCase</span>());</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> t = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();</li><li>t.<span class="hljs-title function_">printValue</span>();</li></ol></pre></div></div> <p><strong>应用代码运行时错误原因</strong></p> <p>编译期不开启严格空值检查，应用代码可以通过编译，但是在运行时会报错。</p> <p>因为t的属性value为undefined，在调用printValue方法时，由于在该方法内未对this.value的值进行空值检查，直接按照string类型访问其属性，导致了运行时的错误。</p> <p><strong>建议改法</strong></p> <p>在编写代码时，建议减少可空类型的使用。如果对变量、属性标记了可空类型，那么在使用它们之前，需要进行空值的判断，根据是否为空值处理不同的逻辑。</p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-keyword">private</span> value?: <span class="hljs-built_in">string</span>;</li><li>
</li><li>  <span class="hljs-keyword">public</span> printValue () {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>) {</li><li>      <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>.<span class="hljs-title function_">toLowerCase</span>());</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> t = <span class="hljs-keyword">new</span> <span class="hljs-title class_">Test</span>();</li><li>t.<span class="hljs-title function_">printValue</span>();</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 505px;"><h3 id="函数返回类型不匹配">函数返回类型不匹配<i class="anchor-icon anchor-icon-link" anchorid="函数返回类型不匹配" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">handleClick</span>: <span class="hljs-function">(<span class="hljs-params">action: <span class="hljs-built_in">string</span>, externInfo?: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <p>在这种写法下，函数返回类型被解析为 void | undefined，需要添加括号用来区分union类型。</p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">handleClick</span>: (<span class="hljs-function">(<span class="hljs-params">action: <span class="hljs-built_in">string</span>, externInfo?: <span class="hljs-built_in">string</span></span>) =&gt;</span> <span class="hljs-built_in">void</span>) | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1765px;"><h3 id="type---null-is-not-assignable-to-type--1">Type '*** | null' is not assignable to type '***'<i class="anchor-icon anchor-icon-link" anchorid="type---null-is-not-assignable-to-type--1" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span></li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">v: <span class="hljs-built_in">number</span></span>): A | <span class="hljs-literal">null</span> {</li><li>  <span class="hljs-keyword">if</span> (v &gt; <span class="hljs-number">0</span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>(v);</li><li>  }</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>: A = <span class="hljs-title function_">foo</span>();</li></ol></pre></div></div> <p><strong>建议改法1</strong></p> <p>修改变量a的类型：let a: A | null = foo()。</p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span></li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">v: <span class="hljs-built_in">number</span></span>): A | <span class="hljs-literal">null</span> {</li><li>  <span class="hljs-keyword">if</span> (v &gt; <span class="hljs-number">0</span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>(v);</li><li>  }</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>: A | <span class="hljs-literal">null</span> = <span class="hljs-title function_">foo</span>(<span class="hljs-number">123</span>);</li><li>
</li><li><span class="hljs-keyword">if</span> (a != <span class="hljs-literal">null</span>) {</li><li>  <span class="hljs-comment">// 非空分支</span></li><li>} <span class="hljs-keyword">else</span> {</li><li>  <span class="hljs-comment">// 处理null</span></li><li>}</li></ol></pre></div></div> <p><strong>建议改法2</strong></p> <p>如果确定此处调用foo一定返回非空值，可以使用非空断言!。</p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">A</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span></li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value: <span class="hljs-built_in">number</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">v: <span class="hljs-built_in">number</span></span>): A | <span class="hljs-literal">null</span> {</li><li>  <span class="hljs-keyword">if</span> (v &gt; <span class="hljs-number">0</span>) {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title function_">A</span>(v);</li><li>  }</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>: A = <span class="hljs-title function_">foo</span>(<span class="hljs-number">123</span>)!;</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1016px;"><h3 id="cannot-invoke-an-object-which-is-possibly-undefined">Cannot invoke an object which is possibly 'undefined'<i class="anchor-icon anchor-icon-link" anchorid="cannot-invoke-an-object-which-is-possibly-undefined" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">interface</span> A {</li><li>  foo?: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>:A = { <span class="hljs-attr">foo</span>: <span class="hljs-function">() =&gt;</span> {} };</li><li>a.<span class="hljs-title function_">foo</span>();</li></ol></pre></div></div> <p><strong>建议改法1</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">interface</span> A {</li><li>  <span class="hljs-attr">foo</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span></li><li>}</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>: A = { <span class="hljs-attr">foo</span>: <span class="hljs-function">() =&gt;</span> {} };</li><li>a.<span class="hljs-title function_">foo</span>();</li></ol></pre></div></div> <p><strong>建议改法2</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">interface</span> A {</li><li>  foo?: <span class="hljs-function">() =&gt;</span> <span class="hljs-built_in">void</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>: A = { <span class="hljs-attr">foo</span>: <span class="hljs-function">() =&gt;</span> {} };</li><li><span class="hljs-keyword">if</span> (a.<span class="hljs-property">foo</span>) {</li><li>  a.<span class="hljs-title function_">foo</span>();</li><li>}</li></ol></pre></div></div> <p><strong>原因</strong></p> <p>在原先代码的定义中，foo是可选属性，可能为undefined，对undefined的调用会导致报错。建议根据业务逻辑判断是否需要将foo设为可选属性。如果确实需要，那么在访问该属性后需要进行空值检查。</p> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1100px;"><h3 id="variable--is-used-before-being-assigned">Variable '***' is used before being assigned<i class="anchor-icon anchor-icon-link" anchorid="variable--is-used-before-being-assigned" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>: <span class="hljs-title class_">Test</span></li><li><span class="hljs-keyword">try</span> {</li><li>  a = { <span class="hljs-attr">value</span>: <span class="hljs-number">1</span>};</li><li>} <span class="hljs-keyword">catch</span> (e) {</li><li>  a.<span class="hljs-property">value</span>;</li><li>}</li><li>a.<span class="hljs-property">value</span>;</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Test</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">0</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>: <span class="hljs-title class_">Test</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li><span class="hljs-keyword">try</span> {</li><li>  a = { <span class="hljs-attr">value</span>:<span class="hljs-number">1</span> };</li><li>} <span class="hljs-keyword">catch</span> (e) {</li><li>  <span class="hljs-keyword">if</span> (a) {</li><li>    a.<span class="hljs-property">value</span>;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">if</span> (a) {</li><li>  a.<span class="hljs-property">value</span>;</li><li>}</li></ol></pre></div></div> <p><strong>原因</strong></p> <p>对于primitive types，可以根据业务逻辑赋值，例如0，''，false。</p> <p>对于对象类型，可以将其类型修改为与null的联合类型，并赋值为null。使用时需要进行非空检查。</p> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 673px;"><h3 id="function-lacks-ending-return-statement-and-return-type-does-not-include-undefined">Function lacks ending return statement and return type does not include 'undefined'.<i class="anchor-icon anchor-icon-link" anchorid="function-lacks-ending-return-statement-and-return-type-does-not-include-undefined" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> {</li><li>  <span class="hljs-keyword">if</span> (a &gt; <span class="hljs-number">0</span>) {</li><li>    <span class="hljs-keyword">return</span> a;</li><li>  }</li><li>}</li></ol></pre></div></div> <p><strong>建议改法1</strong></p> <p>根据业务逻辑，在else分支中返回合适的数值。</p> <p><strong>建议改法2</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">a: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">number</span> | <span class="hljs-literal">undefined</span> {</li><li>  <span class="hljs-keyword">if</span> (a &gt; <span class="hljs-number">0</span>) {</li><li>    <span class="hljs-keyword">return</span> a;</li><li>  }</li><li>  <span class="hljs-keyword">return</span></li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 572px;"><h2 id="arkts-strict-typing-required">arkts-strict-typing-required<i class="anchor-icon anchor-icon-link" anchorid="arkts-strict-typing-required" tips="复制节点链接"></i></h2><p>删除忽略注释，为所有变量显式声明类型。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// @ts-ignore</span></li><li><span class="hljs-keyword">var</span> <span class="hljs-attr">a</span>: <span class="hljs-built_in">any</span> = <span class="hljs-number">123</span>;</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-attr">a</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">123</span>;</li></ol></pre></div></div> <p><strong>原因</strong></p> <p>ArkTS不支持通过注释的方式绕过严格类型检查。首先将注释（// @ts-nocheck或者// @ts-ignore）删去，再根据报错信息修改其他代码。</p> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 80px;"><h2 id="importing-arkts-files-to-js-and-ts-files-is-not-allowed">Importing ArkTS files to JS and TS files is not allowed<i class="anchor-icon anchor-icon-link" anchorid="importing-arkts-files-to-js-and-ts-files-is-not-allowed" tips="复制节点链接"></i></h2></div>  <div class="tiledSection" style="contain-intrinsic-size: auto 260px;"><h2 id="arkts-no-tsdeps">arkts-no-tsdeps<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-tsdeps" tips="复制节点链接"></i></h2><p>不允许.ts、.js文件import.ets文件源码。</p> <p><strong>建议改法</strong></p> <p>方式1.将.ts文件的后缀修改为ets，并按ArkTS语法规则适配代码。</p> <p>方式2.将.ets文件中被.ts文件依赖的代码单独抽取到.ts文件中。</p> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 433px;"><h2 id="arkts-no-special-imports">arkts-no-special-imports<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-special-imports" tips="复制节点链接"></i></h2><p>改为使用普通import { ... } from '...' 导入类型。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> <span class="hljs-keyword">type</span> {A, B, C, D } <span class="hljs-keyword">from</span> <span class="hljs-string">'***'</span></li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> {A, B, C, D } <span class="hljs-keyword">from</span> <span class="hljs-string">'***'</span></li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 80px;"><h2 id="arkts-no-classes-as-obj">arkts-no-classes-as-obj<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-classes-as-obj" tips="复制节点链接"></i></h2></div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1465px;"><h3 id="使用class构造实例" class="firsth2">使用class构造实例<i class="anchor-icon anchor-icon-link" anchorid="使用class构造实例" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Controller</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span></li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">interface</span> <span class="hljs-title class_">ControllerConstructor</span> {</li><li>  <span class="hljs-keyword">new</span> (<span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span>): <span class="hljs-title class_">Controller</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestMenu</span> {</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">ControllerConstructor</span> = <span class="hljs-title class_">Controller</span></li><li>  <span class="hljs-title function_">createController</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>) {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">controller</span>(<span class="hljs-string">'abc'</span>);</li><li>    }</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> t = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TestMenu</span>();</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(t.<span class="hljs-title function_">createController</span>()!.<span class="hljs-property">value</span>);</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Controller</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span></li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">type</span> <span class="hljs-title class_">ControllerConstructor</span> = <span class="hljs-function">() =&gt;</span> <span class="hljs-title class_">Controller</span>;</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">TestMenu</span> {</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">ControllerConstructor</span> = <span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Controller</span>(<span class="hljs-string">'abc'</span>);</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">createController</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>) {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">controller</span>();</li><li>    }</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">t</span>: <span class="hljs-title class_">TestMenu</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">TestMenu</span>();</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(t.<span class="hljs-title function_">createController</span>()!.<span class="hljs-property">value</span>);</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1081px;"><h3 id="访问静态属性">访问静态属性<i class="anchor-icon anchor-icon-link" anchorid="访问静态属性" tips="复制节点链接"></i></h3><p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">C1</span> {</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'abc'</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">C2</span> {</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'def'</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">getValue</span>(<span class="hljs-params">obj: <span class="hljs-built_in">any</span></span>) {</li><li>  <span class="hljs-keyword">return</span> obj[<span class="hljs-string">'value'</span>];</li><li>}</li><li>
</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-title function_">getValue</span>(<span class="hljs-variable constant_">C1</span>));</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-title function_">getValue</span>(<span class="hljs-variable constant_">C2</span>));</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">C1</span> {</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'abc'</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">C2</span> {</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'def'</span></li><li>}</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">getC1Value</span>(<span class="hljs-params"></span>): <span class="hljs-built_in">string</span> {</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-variable constant_">C1</span>.<span class="hljs-property">value</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">getC2Value</span>(<span class="hljs-params"></span>): <span class="hljs-built_in">string</span> {</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-variable constant_">C2</span>.<span class="hljs-property">value</span>;</li><li>}</li><li>
</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-title function_">getC1Value</span>());</li><li><span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-title function_">getC2Value</span>());</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 433px;"><h2 id="arkts-no-side-effects-imports">arkts-no-side-effects-imports<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-side-effects-imports" tips="复制节点链接"></i></h2><p>改用动态import。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> <span class="hljs-string">'module'</span></li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span>(<span class="hljs-string">'module'</span>)</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 961px;"><h2 id="arkts-no-func-props">arkts-no-func-props<i class="anchor-icon anchor-icon-link" anchorid="arkts-no-func-props" tips="复制节点链接"></i></h2><p>使用class来组织多个相关函数。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params">value: <span class="hljs-built_in">number</span></span>): <span class="hljs-built_in">void</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(value.<span class="hljs-title function_">toString</span>());</li><li>}</li><li>
</li><li>foo.<span class="hljs-property">add</span> = <span class="hljs-function">(<span class="hljs-params">left: <span class="hljs-built_in">number</span>, right: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">return</span> left + right;</li><li>}</li><li>
</li><li>foo.<span class="hljs-property">sub</span> = <span class="hljs-function">(<span class="hljs-params">left: <span class="hljs-built_in">number</span>, right: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">return</span> left - right;</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Foo</span> {</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">foo</span>(<span class="hljs-attr">value</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(value.<span class="hljs-title function_">toString</span>());</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">add</span>(<span class="hljs-attr">left</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">right</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">number</span> {</li><li>    <span class="hljs-keyword">return</span> left + right;</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">sub</span>(<span class="hljs-attr">left</span>: <span class="hljs-built_in">number</span>, <span class="hljs-attr">right</span>: <span class="hljs-built_in">number</span>): <span class="hljs-built_in">number</span> {</li><li>    <span class="hljs-keyword">return</span> left - right;</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 1129px;"><h2 id="arkts-limited-esobj">arkts-limited-esobj<i class="anchor-icon anchor-icon-link" anchorid="arkts-limited-esobj" tips="复制节点链接"></i></h2><p>使用具体类型（如number, string）或接口代替不明确的ESObject。</p> <p><strong>应用代码</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// testa.ts</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>): <span class="hljs-built_in">any</span> {</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</li><li>}</li><li>
</li><li><span class="hljs-comment">// main.ets</span></li><li><span class="hljs-keyword">import</span> {foo} <span class="hljs-keyword">from</span> <span class="hljs-string">'./testa'</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">e0</span>: <span class="hljs-title class_">ESObject</span> = <span class="hljs-title function_">foo</span>();</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">f</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">let</span> e1 = <span class="hljs-title function_">foo</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">e2</span>: <span class="hljs-title class_">ESObject</span> = <span class="hljs-number">1</span>;</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">e3</span>: <span class="hljs-title class_">ESObject</span> = {};</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">e4</span>: <span class="hljs-title class_">ESObject</span> = <span class="hljs-string">''</span>;</li><li>}</li></ol></pre></div></div> <p><strong>建议改法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// testa.ts</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> <span class="hljs-title function_">foo</span>(<span class="hljs-params"></span>): <span class="hljs-built_in">any</span> {</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;</li><li>}</li><li>
</li><li><span class="hljs-comment">// main.ets</span></li><li><span class="hljs-keyword">import</span> {foo} <span class="hljs-keyword">from</span> <span class="hljs-string">'./testa'</span></li><li><span class="hljs-keyword">interface</span> I {}</li><li>
</li><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">f</span>(<span class="hljs-params"></span>) {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">e0</span>: <span class="hljs-title class_">ESObject</span> = <span class="hljs-title function_">foo</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">e1</span>: <span class="hljs-title class_">ESObject</span> = <span class="hljs-title function_">foo</span>();</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">e2</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">1</span>;</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">e3</span>: I = {};</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">e4</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 80px;"><h2 id="拷贝">拷贝<i class="anchor-icon anchor-icon-link" anchorid="拷贝" tips="复制节点链接"></i></h2></div>  <div class="tiledSection" style="contain-intrinsic-size: auto 601px;"><h3 id="浅拷贝" class="firsth2">浅拷贝<i class="anchor-icon anchor-icon-link" anchorid="浅拷贝" tips="复制节点链接"></i></h3><p><strong>TypeScript</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">shallowCopy</span>(<span class="hljs-params">obj: <span class="hljs-built_in">object</span></span>): <span class="hljs-built_in">object</span> {</li><li>  <span class="hljs-keyword">let</span> newObj = {};</li><li>  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">assign</span>(newObj, obj);</li><li>  <span class="hljs-keyword">return</span> newObj;</li><li>}</li></ol></pre></div></div> <p><strong>ArkTS</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">shallowCopy</span>(<span class="hljs-params">obj: <span class="hljs-built_in">object</span></span>): <span class="hljs-built_in">object</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">newObj</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Object</span>&gt; = {};</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj)) {</li><li>    newObj[key] = obj[key];</li><li>  }</li><li>  <span class="hljs-keyword">return</span> newObj;</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 841px;"><h3 id="深拷贝">深拷贝<i class="anchor-icon anchor-icon-link" anchorid="深拷贝" tips="复制节点链接"></i></h3><p><strong>TypeScript</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">deepCopy</span>(<span class="hljs-params">obj: <span class="hljs-built_in">object</span></span>): <span class="hljs-built_in">object</span> {</li><li>  <span class="hljs-keyword">let</span> newObj = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(obj) ? [] : {};</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> obj) {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj[key] === <span class="hljs-string">'object'</span>) {</li><li>      newObj[key] = <span class="hljs-title function_">deepCopy</span>(obj[key]);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      newObj[key] = obj[key];</li><li>    }</li><li>  }</li><li>  <span class="hljs-keyword">return</span> newObj;</li><li>}</li></ol></pre></div></div> <p><strong>ArkTS</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">function</span> <span class="hljs-title function_">deepCopy</span>(<span class="hljs-params">obj: <span class="hljs-built_in">object</span></span>): <span class="hljs-built_in">object</span> {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-attr">newObj</span>: <span class="hljs-title class_">Record</span>&lt;<span class="hljs-built_in">string</span>, <span class="hljs-title class_">Object</span>&gt; | <span class="hljs-title class_">Object</span>[] = <span class="hljs-title class_">Array</span>.<span class="hljs-title function_">isArray</span>(obj) ? [] : {};</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> key <span class="hljs-keyword">of</span> <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(obj)) {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> obj[key] === <span class="hljs-string">'object'</span>) {</li><li>      newObj[key] = <span class="hljs-title function_">deepCopy</span>(obj[key]);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      newObj[key] = obj[key];</li><li>    }</li><li>  }</li><li>  <span class="hljs-keyword">return</span> newObj;</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 80px;"><h2 id="状态管理使用典型场景">状态管理使用典型场景<i class="anchor-icon anchor-icon-link" anchorid="状态管理使用典型场景" tips="复制节点链接"></i></h2></div>  <div class="tiledSection" style="contain-intrinsic-size: auto 2689px;"><h3 id="struct组件外使用状态变量" class="firsth2">Struct组件外使用状态变量<i class="anchor-icon anchor-icon-link" anchorid="struct组件外使用状态变量" tips="复制节点链接"></i></h3><p>由于struct和class的不同，不建议将this作为参数传递到struct外部使用，以避免实例引用无法释放，导致内存泄露。建议传递状态变量对象到struct外部使用，通过修改对象的属性来触发UI刷新。</p> <p><strong>不推荐用法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyComponentController</span> {</li><li>  <span class="hljs-attr">item</span>: <span class="hljs-title class_">MyComponent</span> = <span class="hljs-literal">null</span>;</li><li>
</li><li>  <span class="hljs-title function_">setItem</span>(<span class="hljs-params">item: MyComponent</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">item</span> = item;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">changeText</span>(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">item</span>.<span class="hljs-property">value</span> = value;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> struct <span class="hljs-title class_">MyComponent</span> {</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-attr">controller</span>: <span class="hljs-title class_">MyComponentController</span> = <span class="hljs-literal">null</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'Hello World'</span>;</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">50</span>)</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>)</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-variable language_">this</span>); <span class="hljs-comment">// 不建议把this作为参数传递到struct外部使用</span></li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">ObjThisOldPage</span> {</li><li>  controller = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyComponentController</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">MyComponent</span>({ <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change value'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">changeText</span>(<span class="hljs-string">'Text'</span>);</li><li>      })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> <p><strong>推荐用法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">CC</span> {</li><li>  <span class="hljs-attr">value</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'1'</span>;</li><li>
</li><li>  <span class="hljs-title function_">constructor</span>(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span> = value;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">MyComponentController</span> {</li><li>  <span class="hljs-attr">item</span>: <span class="hljs-variable constant_">CC</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_">CC</span>(<span class="hljs-string">'1'</span>);</li><li>
</li><li>  <span class="hljs-title function_">setItem</span>(<span class="hljs-params">item: CC</span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">item</span> = item;</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">changeText</span>(<span class="hljs-params">value: <span class="hljs-built_in">string</span></span>) {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">item</span>.<span class="hljs-property">value</span> = value;</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> struct <span class="hljs-title class_">MyComponent</span> {</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-attr">controller</span>: <span class="hljs-title class_">MyComponentController</span> | <span class="hljs-literal">null</span> = <span class="hljs-literal">null</span>;</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">value</span>: <span class="hljs-variable constant_">CC</span> = <span class="hljs-keyword">new</span> <span class="hljs-title function_">CC</span>(<span class="hljs-string">'Hello World'</span>);</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Text</span>(<span class="hljs-string">`<span class="hljs-subst">${<span class="hljs-variable language_">this</span>.value.value}</span>`</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">50</span>)</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">aboutToAppear</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>)</li><li>      <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">setItem</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">value</span>);</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">StyleExample</span> {</li><li>  <span class="hljs-attr">controller</span>: <span class="hljs-title class_">MyComponentController</span> = <span class="hljs-keyword">new</span> <span class="hljs-title class_">MyComponentController</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">MyComponent</span>({ <span class="hljs-attr">controller</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span> })</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'change value'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">controller</span>.<span class="hljs-title function_">changeText</span>(<span class="hljs-string">'Text'</span>);</li><li>      })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> </div>  <div class="tiledSection" style="contain-intrinsic-size: auto 2665px;"><h3 id="struct支持联合类型的方案">Struct支持联合类型的方案<i class="anchor-icon anchor-icon-link" anchorid="struct支持联合类型的方案" tips="复制节点链接"></i></h3><p>下面这段代码有arkts-no-any-unknown的报错，由于struct不支持泛型，建议使用联合类型，实现自定义组件类似泛型的功能。</p> <p><strong>不推荐用法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Data</span> {</li><li>  <span class="hljs-attr">aa</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">11</span>;</li><li>}</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">DatauionOldPage</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">array</span>: <span class="hljs-title class_">Data</span>[] = [<span class="hljs-keyword">new</span> <span class="hljs-title class_">Data</span>(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Data</span>(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Data</span>()];</li><li>
</li><li>  <span class="hljs-meta">@Builder</span></li><li>  <span class="hljs-title function_">componentCloser</span>(<span class="hljs-params">data: Data</span>) {</li><li>    <span class="hljs-title class_">Text</span>(data.<span class="hljs-property">aa</span> + <span class="hljs-string">''</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">50</span>)</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">ForEachCom</span>({ <span class="hljs-attr">arrayList</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">array</span>, <span class="hljs-attr">closer</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">componentCloser</span> })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li><span class="hljs-keyword">export</span> struct <span class="hljs-title class_">ForEachCom</span> {</li><li>  <span class="hljs-attr">arrayList</span>: <span class="hljs-built_in">any</span>[]; <span class="hljs-comment">// struct不支持泛型，有arkts-no-any-unknown报错</span></li><li>  <span class="hljs-meta">@BuilderParam</span> <span class="hljs-attr">closer</span>: <span class="hljs-function">(<span class="hljs-params">data: <span class="hljs-built_in">any</span></span>) =&gt;</span> <span class="hljs-built_in">void</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">componentCloser</span>; <span class="hljs-comment">// struct不支持泛型，有arkts-no-any-unknown报错</span></li><li>
</li><li>  <span class="hljs-meta">@Builder</span></li><li>  <span class="hljs-title function_">componentCloser</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayList</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">any</span></span>) =&gt;</span> { <span class="hljs-comment">// struct不支持泛型，有arkts-no-any-unknown报错</span></li><li>        <span class="hljs-title class_">Row</span>() {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">closer</span>(item)</li><li>        }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#eee'</span>)</li><li>      })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> <p><strong>推荐用法</strong></p> <div _ngcontent-bft-c106="" class="highlight-div"><div _ngcontent-bft-c106="" class="highlight-div-header"><div _ngcontent-bft-c106="" class="highlight-div-header-left"><div _ngcontent-bft-c106="" class="handle-button expand-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bft-c106="" class="highlight-div-header-right"><div _ngcontent-bft-c106="" class="handle-button ai-button"></div><div _ngcontent-bft-c106="" class="handle-button line-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bft-c106="" class="handle-button theme-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bft-c106="" class="handle-button copy-button"><div _ngcontent-bft-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bft-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Data</span> {</li><li>  <span class="hljs-attr">aa</span>: <span class="hljs-built_in">number</span> = <span class="hljs-number">11</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">class</span> <span class="hljs-title class_">Model</span> {</li><li>  <span class="hljs-attr">aa</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'11'</span>;</li><li>}</li><li>
</li><li><span class="hljs-keyword">type</span> <span class="hljs-title class_">UnionData</span> = <span class="hljs-title class_">Data</span> | <span class="hljs-title class_">Model</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">DatauionPage</span> {</li><li>  <span class="hljs-attr">array</span>: <span class="hljs-title class_">UnionData</span>[] = [<span class="hljs-keyword">new</span> <span class="hljs-title class_">Data</span>(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Data</span>(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Data</span>()];</li><li>
</li><li>  <span class="hljs-meta">@Builder</span></li><li>  <span class="hljs-title function_">componentCloser</span>(<span class="hljs-params">data: UnionData</span>) {</li><li>    <span class="hljs-keyword">if</span> (data <span class="hljs-keyword">instanceof</span> <span class="hljs-title class_">Data</span>) {</li><li>      <span class="hljs-title class_">Text</span>(data.<span class="hljs-property">aa</span> + <span class="hljs-string">''</span>).<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">50</span>)</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Row</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">ForEachCom</span>({ <span class="hljs-attr">arrayList</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">array</span>, <span class="hljs-attr">closer</span>: <span class="hljs-variable language_">this</span>.<span class="hljs-property">componentCloser</span> })</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-meta">@Component</span></li><li><span class="hljs-keyword">export</span> struct <span class="hljs-title class_">ForEachCom</span> {</li><li>  <span class="hljs-attr">arrayList</span>: <span class="hljs-title class_">UnionData</span>[] = [<span class="hljs-keyword">new</span> <span class="hljs-title class_">Data</span>(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Data</span>(), <span class="hljs-keyword">new</span> <span class="hljs-title class_">Data</span>()];</li><li>  <span class="hljs-meta">@BuilderParam</span> <span class="hljs-attr">closer</span>: <span class="hljs-function">(<span class="hljs-params">data: UnionData</span>) =&gt;</span> <span class="hljs-built_in">void</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">componentCloser</span>;</li><li>
</li><li>  <span class="hljs-meta">@Builder</span></li><li>  <span class="hljs-title function_">componentCloser</span>(<span class="hljs-params"></span>) {</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">arrayList</span>, <span class="hljs-function">(<span class="hljs-params">item: UnionData</span>) =&gt;</span> {</li><li>        <span class="hljs-title class_">Row</span>() {</li><li>          <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">closer</span>(item)</li><li>        }.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">200</span>).<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#eee'</span>)</li><li>      })</li><li>    }</li><li>  }</li><li>}</li></ol></pre></div></div> </div> </div> <div></div></div>