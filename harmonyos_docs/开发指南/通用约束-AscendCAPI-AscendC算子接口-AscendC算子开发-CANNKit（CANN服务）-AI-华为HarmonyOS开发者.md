<h1 _ngcontent-foq-c119="" class="doc-title ng-star-inserted" title="通用约束"> 通用约束 </h1>

<div _ngcontent-foq-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>AscendC管理不同层级的物理内存时，用一种抽象的逻辑位置（TPosition）来表达各级别的存储，代替了片上物理存储的概念，达到隐藏硬件架构的目的。TPosition类型包括：VECIN、VECOUT、VECCALC、A1、A2、B1、B2、CO1、CO2，具体介绍请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cannkit-tposition">TPosition</a>。TPosition与物理内存的映射关系如表1所示。</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><caption><b>表1 </b>TPosition与物理内存映射关系</caption><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.2.2.3.1.1" valign="top" width="50%"><p>TPosition</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.2.3.1.2" valign="top" width="50%"><p>物理内存</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="50%"><p>GM</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>Global Memory</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>VECIN</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>Unified Buffer</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>VECCALC</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>Unified Buffer</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>VECOUT</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>Unified Buffer</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>A1</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>L1 Buffer</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>A2</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>L0A Buffer</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>B1</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>L1 Buffer</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>B2</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>L0B Buffer</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>C1</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>Kirin9020系列处理器，L1 Buffer</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>C1</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>KirinX90系列处理器，L1Buffer</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>C2</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>Kirin9020系列处理器，BT Buffer</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>C2</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>KirinX90系列处理器，BT Buffer</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>CO1</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>L0C Buffer</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>CO2</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>Kirin9020系列处理器，Global Memory</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>CO2</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>KirinX90系列处理器，Global Memory</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>TSCM</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>L1 Buffer</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>SPM</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>Kirin9020系列处理器，Global Memory</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="50%"><p>SPM</p> </td> <td class="cellrowborder" valign="top" width="50%"><p>KirinX90系列处理器，Global Memory</p> </td> </tr>  </tbody></table></div> </div> <p>AscendC内存管理模块在进行内存分配时会对起始地址进行对齐。各类存储单元的对齐要求如表2所示。</p> <p>使用AscendC数据计算和数据搬运接口时，目的操作数和源操作数地址偏移对齐要求和表2保持一致，<strong>如果AscendC指令接口中已说明操作数起始地址对齐要求，则以具体指令中的说明为准。</strong></p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><caption><b>表2 </b>不同存储单元的对齐要求</caption><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.5.2.3.1.1" valign="top" width="24%"><p>存储单元</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.2.3.1.2" valign="top" width="76%"><p>对齐要求</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="24%"><p>Global Memory</p> </td> <td class="cellrowborder" valign="top" width="76%"><p>暂无对齐要求。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="24%"><p>Unified Buffer</p> </td> <td class="cellrowborder" valign="top" width="76%"><p>32Byte对齐。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="24%"><p>L1 Buffer</p> </td> <td class="cellrowborder" valign="top" width="76%"><p>32Byte对齐。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="24%"><p>L0A Buffer/L0B Buffer</p> </td> <td class="cellrowborder" valign="top" width="76%"><p>512Byte对齐。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="24%"><p>L0C Buffer</p> </td> <td class="cellrowborder" valign="top" width="76%"><p>64Byte对齐。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="24%"><p>BT Buffer</p> </td> <td class="cellrowborder" valign="top" width="76%"><p>64Byte对齐。</p> </td> </tr>  </tbody></table></div> </div> </div> <div></div></div>