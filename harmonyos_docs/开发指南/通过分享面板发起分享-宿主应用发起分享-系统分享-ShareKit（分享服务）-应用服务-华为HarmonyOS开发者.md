<h1 _ngcontent-msj-c119="" class="doc-title ng-star-inserted" title="通过分享面板发起分享"> 通过分享面板发起分享 </h1>

<div _ngcontent-msj-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section1577313555446">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section1577313555446" tips="复制节点链接"></i></h2>          <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <caption>        <b>表1 </b>宿主应用发起分享接口功能介绍       </caption>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.1.2.2.4.1.1" valign="top" width="20.45%">          <p>类名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.1.2.2.4.1.2" valign="top" width="55.60000000000001%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.1.2.2.4.1.3" valign="top" width="23.95%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" rowspan="3" valign="top" width="20.45%">          <p>SharedData</p></td>         <td class="cellrowborder" valign="top" width="55.60000000000001%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/share-system-share#section12493192913448" target="_blank">constructor</a>(record: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/share-system-share#section20696483813" target="_blank">SharedRecord</a>)</p></td>         <td class="cellrowborder" valign="top" width="23.95%">          <p>SharedData构造函数</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/share-system-share#section11132201919101" target="_blank">addRecord</a>(record: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/share-system-share#section20696483813" target="_blank">SharedRecord</a>): void</p></td>         <td class="cellrowborder" valign="top">          <p>添加分享记录</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/share-system-share#section14943101911111" target="_blank">getRecords</a>(): Array&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/share-system-share#section20696483813" target="_blank">SharedRecord</a>&gt;</p></td>         <td class="cellrowborder" valign="top">          <p>获取分享记录</p></td>        </tr>        <tr>         <td class="cellrowborder" rowspan="4" valign="top" width="20.45%">          <p>ShareController</p></td>         <td class="cellrowborder" valign="top" width="55.60000000000001%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/share-system-share#section1834181561418" target="_blank">constructor</a>(data: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/share-system-share#section816451553012" target="_blank">SharedData</a>)</p></td>         <td class="cellrowborder" valign="top" width="23.95%">          <p>ShareController构造函数</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/share-system-share#section3392161117158" target="_blank">show</a>(context: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext" target="_blank">common.UIAbilityContext</a>, options: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/share-system-share#section107934816010" target="_blank">ShareControllerOptions</a>): Promise&lt;void&gt;</p></td>         <td class="cellrowborder" valign="top">          <p>显示分享面板</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/share-system-share#section107214125161" target="_blank">on</a>(event: 'dismiss', callback: () =&gt; void): void</p></td>         <td class="cellrowborder" valign="top">          <p>注册分享面板关闭事件监听</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/share-system-share#section774510361177" target="_blank">off</a>(event: 'dismiss', callback: () =&gt; void): void</p></td>         <td class="cellrowborder" valign="top">          <p>取消分享面板关闭事件监听</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section8909161014458">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section8909161014458" tips="复制节点链接"></i></h2>          <div class="p">      根据不同的分享场景，参考下表：       <div class="tablenoborder">       <div class="tbBox"><table class="layoutFixed idpTab">        <thead>         <tr>          <th align="left" class="cellrowborder" id="mcps1.3.2.2.1.1.3.1.1" valign="top" width="35.85%">           <p>分享场景</p></th>          <th align="left" class="cellrowborder" id="mcps1.3.2.2.1.1.3.1.2" valign="top" width="64.14999999999999%">           <p>参考链接</p></th>         </tr>        </thead>                 <tbody><tr>          <td class="cellrowborder" valign="top" width="35.85%">           <p>分享App Linking直达应用</p></td>          <td class="cellrowborder" valign="top" width="64.14999999999999%">           <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/share-utd-link#section195231314185618">分享App Linking直达应用</a></p></td>         </tr>         <tr>          <td class="cellrowborder" valign="top" width="35.85%">           <p>分享图片</p></td>          <td class="cellrowborder" valign="top" width="64.14999999999999%">           <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/share-utd-image">分享图片</a></p></td>         </tr>         <tr>          <td class="cellrowborder" valign="top" width="35.85%">           <p>分享视频</p></td>          <td class="cellrowborder" valign="top" width="64.14999999999999%">           <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/share-utd-video">分享视频</a></p></td>         </tr>         <tr>          <td class="cellrowborder" valign="top" width="35.85%">           <p>分享普通链接直达浏览器</p></td>          <td class="cellrowborder" valign="top" width="64.14999999999999%">           <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/share-utd-link#section10921210165819">分享普通链接直达浏览器</a></p></td>         </tr>         <tr>          <td class="cellrowborder" valign="top" width="35.85%">           <p>分享文本</p></td>          <td class="cellrowborder" valign="top" width="64.14999999999999%">           <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/share-utd-text">分享文本</a></p></td>         </tr>               </tbody></table></div>      </div>     </div>     <p><strong>2in1设备可通过配置的方式决定分享面板的显示位置。</strong>参考如下：</p>     <ol>      <li>导入相关模块。       <div _ngcontent-msj-c106="" class="highlight-div"><div _ngcontent-msj-c106="" class="highlight-div-header"><div _ngcontent-msj-c106="" class="highlight-div-header-left"><div _ngcontent-msj-c106="" class="handle-button expand-button"><div _ngcontent-msj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-msj-c106="" class="highlight-div-header-right"><div _ngcontent-msj-c106="" class="handle-button ai-button"></div><div _ngcontent-msj-c106="" class="handle-button line-button"><div _ngcontent-msj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-msj-c106="" class="handle-button theme-button"><div _ngcontent-msj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-msj-c106="" class="handle-button copy-button"><div _ngcontent-msj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-msj-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li><span class="hljs-keyword">import</span> { systemShare } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ShareKit'</span>;</li><li><span class="hljs-keyword">import</span> { uniformTypeDescriptor <span class="hljs-keyword">as</span> utd } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ArkData'</span>;</li></ol></pre></div></div></li>      <li>构造分享数据，可添加多条分享记录。       <div _ngcontent-msj-c106="" class="highlight-div"><div _ngcontent-msj-c106="" class="highlight-div-header"><div _ngcontent-msj-c106="" class="highlight-div-header-left"><div _ngcontent-msj-c106="" class="handle-button expand-button"><div _ngcontent-msj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-msj-c106="" class="highlight-div-header-right"><div _ngcontent-msj-c106="" class="handle-button ai-button"></div><div _ngcontent-msj-c106="" class="handle-button line-button"><div _ngcontent-msj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-msj-c106="" class="handle-button theme-button"><div _ngcontent-msj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-msj-c106="" class="handle-button copy-button"><div _ngcontent-msj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-msj-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 构造ShareData，需配置一条有效数据信息</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">data</span>: systemShare.<span class="hljs-property">SharedData</span> = <span class="hljs-keyword">new</span> systemShare.<span class="hljs-title class_">SharedData</span>({</li><li>  <span class="hljs-attr">utd</span>: utd.<span class="hljs-property">UniformDataType</span>.<span class="hljs-property">PLAIN_TEXT</span>,</li><li>  <span class="hljs-attr">content</span>: <span class="hljs-string">'Hello HarmonyOS'</span></li><li>});</li></ol></pre></div></div></li>      <li>启动分享面板时，配置分享面板显示的位置信息或关联的组件ID，面板将以Popup形式展示。       <div _ngcontent-msj-c106="" class="highlight-div"><div _ngcontent-msj-c106="" class="highlight-div-header"><div _ngcontent-msj-c106="" class="highlight-div-header-left"><div _ngcontent-msj-c106="" class="handle-button expand-button"><div _ngcontent-msj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-msj-c106="" class="highlight-div-header-right"><div _ngcontent-msj-c106="" class="handle-button ai-button"></div><div _ngcontent-msj-c106="" class="handle-button line-button"><div _ngcontent-msj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-msj-c106="" class="handle-button theme-button"><div _ngcontent-msj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-msj-c106="" class="handle-button copy-button"><div _ngcontent-msj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-msj-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 构建ShareController</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">controller</span>: systemShare.<span class="hljs-property">ShareController</span> = <span class="hljs-keyword">new</span> systemShare.<span class="hljs-title class_">ShareController</span>(data);</li><li><span class="hljs-comment">// 获取UIAbility上下文对象</span></li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">uiContext</span>: <span class="hljs-title class_">UIContext</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>();</li><li><span class="hljs-keyword">let</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span> = uiContext.<span class="hljs-title function_">getHostContext</span>() <span class="hljs-keyword">as</span> common.<span class="hljs-property">UIAbilityContext</span>;</li><li><span class="hljs-comment">// 注册分享面板关闭监听</span></li><li>controller.<span class="hljs-title function_">on</span>(<span class="hljs-string">'dismiss'</span>, <span class="hljs-function">() =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">'Share panel closed'</span>);</li><li>  <span class="hljs-comment">// 分享结束，可处理其他业务。</span></li><li>});</li><li>
</li><li><span class="hljs-comment">// 进行分享面板显示</span></li><li><span class="hljs-comment">// 方法一：配置分享面板关联的控件ID </span></li><li>controller.<span class="hljs-title function_">show</span>(context, {</li><li>  <span class="hljs-attr">anchor</span>: <span class="hljs-string">'shareButtonId'</span></li><li>});</li><li><span class="hljs-comment">// 方法二：配置分享面板显示的坐标</span></li><li>controller.<span class="hljs-title function_">show</span>(context, {</li><li>  <span class="hljs-attr">anchor</span>: {</li><li>    <span class="hljs-comment">// 必选 相对锚点的窗体偏移值</span></li><li>    <span class="hljs-attr">windowOffset</span>: { <span class="hljs-attr">x</span>: <span class="hljs-number">100</span>, <span class="hljs-attr">y</span>: <span class="hljs-number">100</span> },</li><li>    <span class="hljs-comment">// 可选 组件的宽高 配置后会综合计算组件的大小</span></li><li>    <span class="hljs-attr">size</span>: { <span class="hljs-attr">width</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">height</span>: <span class="hljs-number">0</span> }</li><li>  }</li><li>});</li></ol></pre></div></div></li>     </ol>    </div>   </div>   <div></div></div>