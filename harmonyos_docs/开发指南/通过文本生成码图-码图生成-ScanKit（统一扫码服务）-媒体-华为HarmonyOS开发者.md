<h1 _ngcontent-qrr-c119="" class="doc-title ng-star-inserted" title="通过文本生成码图"> 通过文本生成码图 </h1>

<div _ngcontent-qrr-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section16522171851016">基本概念<i class="anchor-icon anchor-icon-link" anchorid="section16522171851016" tips="复制节点链接"></i></h2>          <p>码图生成能力支持将字符串转换为自定义格式的码图。</p>    </div>    <div class="tiledSection">     <h2 id="section1451011513134">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section1451011513134" tips="复制节点链接"></i></h2>          <p>码图生成能力支持将字符串转换为自定义格式的码图，包含条形码、二维码生成。</p>     <p>可以将字符串转成联系人码图，手机克隆码图，例如将"HUAWEI"字符串生成码图使用。</p>    </div>    <div class="tiledSection">     <h2 id="section9684181513312">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="section9684181513312" tips="复制节点链接"></i></h2>          <ul>      <li>码图生成能力支持Phone、Tablet，并且从5.1.0(18)版本开始，新增支持Wearable设备；从5.1.1(19)版本开始，新增支持2in1、TV设备。</li>      <li>支持十三种码图生成，每种码图对生成参数有不同的要求，码图限制可见下表，具体接口参数限制信息请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/scan-generatebarcode#section87678254617" target="_blank">CreateOptions</a>。        <div class="tablenoborder">        <div class="tbBox"><table class="layoutFixed idpTab">         <thead>          <tr id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_row143321143018">           <th align="left" class="cellrowborder" id="mcps1.3.3.2.2.2.1.3.1.1" valign="top" width="17.88%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p124331111173015">生成码类型</p></th>           <th align="left" class="cellrowborder" id="mcps1.3.3.2.2.2.1.3.1.2" valign="top" width="82.12%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p743391193018">参数建议内容</p></th>          </tr>         </thead>                   <tbody><tr id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_row1143312114305">           <td class="cellrowborder" valign="top" width="17.88%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p643331133020">QR Code</p></td>           <td class="cellrowborder" valign="top" width="82.12%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p11433211123019">支持中文，不超过512字符长度，如果内容过长会导致码复杂，影响识别。</p></td>          </tr>          <tr id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_row114331611133017">           <td class="cellrowborder" valign="top" width="17.88%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p74333113302">Aztec</p></td>           <td class="cellrowborder" valign="top" width="82.12%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p1943317114308">支持中文，不超过512字符长度，如果内容过长会导致码复杂，影响识别。</p></td>          </tr>          <tr id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_row4433111153017">           <td class="cellrowborder" valign="top" width="17.88%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p16433131110303">PDF417</p></td>           <td class="cellrowborder" valign="top" width="82.12%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p1643351115309">支持中文，不超过512字符长度，如果内容过长会导致码复杂，影响识别。</p></td>          </tr>          <tr id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_row184331811163020">           <td class="cellrowborder" valign="top" width="17.88%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p134333114305">Data Matrix</p></td>           <td class="cellrowborder" valign="top" width="82.12%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p34334112309">不超过512字符长度，如果内容过长会导致码复杂，影响识别。</p></td>          </tr>          <tr id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_row1243321173016">           <td class="cellrowborder" valign="top" width="17.88%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p943310114301">UPC-A</p></td>           <td class="cellrowborder" valign="top" width="82.12%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p114334115308">支持11位数字输入，只支持数字，生成包含12位数字的码图，包含最后一位校验数字。</p></td>          </tr>          <tr id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_row16433171118300">           <td class="cellrowborder" valign="top" width="17.88%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p124333111305">UPC-E</p></td>           <td class="cellrowborder" valign="top" width="82.12%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p18433111123016">支持7位数字输入，只支持数字，首位需要是0或1，生成包含8位数字的码图，包含最后一位校验数字。</p></td>          </tr>          <tr id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_row2433711143011">           <td class="cellrowborder" valign="top" width="17.88%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p443371114305">ITF-14</p></td>           <td class="cellrowborder" valign="top" width="82.12%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p184335114307">支持80位以内数字输入，并且需要是偶数位，只支持数字，生成包含偶数位数字的码图，如果内容过长会导致码复杂，影响识别。</p></td>          </tr>          <tr id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_row24338118301">           <td class="cellrowborder" valign="top" width="17.88%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p443361163017">EAN-8</p></td>           <td class="cellrowborder" valign="top" width="82.12%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p443311103013">支持7位数字输入，只支持数字，生成包含8位数字的码图，包含最后一位校验数字。</p></td>          </tr>          <tr id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_row1243311123015">           <td class="cellrowborder" valign="top" width="17.88%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p174341011103017">EAN-13</p></td>           <td class="cellrowborder" valign="top" width="82.12%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p5434611143018">支持12位数字输入，只支持数字，首位不可以是0，生成包含13位数字的码图，包含最后一位校验数字</p></td>          </tr>          <tr id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_row1343471110303">           <td class="cellrowborder" valign="top" width="17.88%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p4434411163013">Code 39</p></td>           <td class="cellrowborder" valign="top" width="82.12%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p943419111306">不超过80字节长度，字符集可以是数字、大小写字母和- . $ / + % * SPACE英文格式符号（请注意：一个小写字母占用2个字节）。</p></td>          </tr>          <tr id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_row1434191173015">           <td class="cellrowborder" valign="top" width="17.88%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p204347114308">Code 93</p></td>           <td class="cellrowborder" valign="top" width="82.12%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p1743481115301">不超过80字节长度，字符集可以是数字、大小写字母和- . $ / + % * SPACE英文格式符号（请注意：一个小写字母占用2个字节）。</p></td>          </tr>          <tr id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_row3434141117302">           <td class="cellrowborder" valign="top" width="17.88%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p3434131183016">Code 128</p></td>           <td class="cellrowborder" valign="top" width="82.12%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p124341011123010">不超过80字节长度，字符集可以是数字、大小写字母和- . $ / + % * SPACE英文格式符号（请注意：一个小写字母占用1个字节）。</p></td>          </tr>          <tr id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_row1243418118309">           <td class="cellrowborder" valign="top" width="17.88%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p1643416115309">Codabar</p></td>           <td class="cellrowborder" valign="top" width="82.12%">            <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p12434121117305">不超过512字符长度，起始/终止符可以是ABCD中的任一个（特殊情况下，TN*E也会编码成ABCD，推荐使用ABCD）。其他字符可以是数字和- . $ / : +英文格式符号。</p></td>          </tr>                 </tbody></table></div>       </div>       <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">         <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p1770525665">生成码参数建议：</p>         <ul id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_ul127703251614">          <li id="zh-cn_topic_0000002340623313_li677011258611">码图颜色和背景           <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p10770152514612">建议使用默认颜色和背景：黑色码图、白色背景。如果码图颜色和背景对比度较小会影响识别率。</p></li>          <li id="zh-cn_topic_0000002340623313_li13770142519611">码图边距           <p id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_p127702256611">建议使用默认边距1，单位：px，取值范围：[1, 10]。</p></li>          <li id="zh-cn_topic_0000002340623313_li16770112518618">码图大小           <ol id="ZH-CN_TOPIC_0000002306664350__zh-cn_topic_0000002340623313_ol5770425864">            <li id="zh-cn_topic_0000002340623313_li877011251961">生成QR Code、Data Matrix、Aztec类型的码图时，输入的width和height值相同且均大于等于200小于等于4096，单位：px，否则生成的码图过小会影响识别。</li>            <li id="zh-cn_topic_0000002340623313_li1177042510610">生成EAN-8、EAN-13、UPC-A、UPC-E、Codabar、Code 39、Code 93、Code 128、ITF-14、PDF417类型的码图时，建议输入的width和height值比例为2:1，并且width值需大于400，单位：px，否则生成的码图会过小影响识别。</li>           </ol></li>         </ul>        </div></div></div></li>     </ul>    </div>    <div class="tiledSection">     <h2 id="section1850284851018">业务流程<i class="anchor-icon anchor-icon-link" anchorid="section1850284851018" tips="复制节点链接"></i></h2>          <p><span><img height="383.19960000000003" originheight="1028" originwidth="1784" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114423.91647757719912503313649994049494:50001231000000:2800:55A6AD067EA237A51F9D9DE7B8702437DDBB6BE9978B5EFA0A23FC7B0537599B.png" title="点击放大" width="665"></span></p>     <ol>      <li>用户向应用发起生成码请求后，输入需要生成的码的信息，包括码的类型、宽高等。</li>      <li>应用通过调用Scan Kit的createBarcode接口启动码图生成能力。</li>      <li>Scan Kit通过将字符串转换为所需格式的码图并返回给应用。</li>      <li>应用向用户返回生成码结果。</li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section8401194118505">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section8401194118505" tips="复制节点链接"></i></h2>          <p>接口返回值有两种返回形式：Callback和Promise回调。下表中为码图生成能力的Callback和Promise形式接口，Callback和Promise只是返回值方式不一样，功能相同。具体API说明详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/scan-generatebarcode" target="_blank">接口文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.3.1.1" valign="top" width="46.589999999999996%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.3.1.2" valign="top" width="53.410000000000004%">          <p>接口描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="46.589999999999996%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/scan-generatebarcode#section1841142919352" target="_blank">createBarcode</a>(content: string, options: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/scan-generatebarcode#section87678254617" target="_blank">CreateOptions</a>): Promise&lt;image.<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-image-pixelmap" target="_blank">PixelMap</a>&gt;</p></td>         <td class="cellrowborder" valign="top" width="53.410000000000004%">          <p>码图生成接口，返回image.PixelMap类型的参数，可以使用Image组件渲染成图片。使用Promise异步回调返回生成的码图。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="46.589999999999996%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/scan-generatebarcode#section129941731103410" target="_blank">createBarcode</a>(content: string, options: CreateOptions, callback: AsyncCallback&lt;image.PixelMap&gt;): void</p></td>         <td class="cellrowborder" valign="top" width="53.410000000000004%">          <p>码图生成接口，返回image.PixelMap类型的参数，可以使用Image组件渲染成图片。使用Callback异步回调返回生成的码图。</p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="section13428103844311">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section13428103844311" tips="复制节点链接"></i></h2>          <p>码图生成根据传参内容直接生成所需码图，需要传入固定参数和可选参数。</p>     <p>为了方便开发者接入，我们提供了详细的样例工程供参考，推荐参考<a href="https://gitcode.com/HarmonyOS_Samples/scan-kit_-sample-code_-clientdemo_-arkts" target="_blank">示例工程</a>接入。</p>     <p>以下示例为调用码图生成能力的createBarcode接口实现码图生成。</p>     <ol>      <li>导入码图生成接口模块，该模块提供了码图生成的参数和方法，导入方法如下。       <div _ngcontent-qrr-c106="" class="highlight-div"><div _ngcontent-qrr-c106="" class="highlight-div-header"><div _ngcontent-qrr-c106="" class="highlight-div-header-left"><div _ngcontent-qrr-c106="" class="handle-button expand-button"><div _ngcontent-qrr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qrr-c106="" class="highlight-div-header-right"><div _ngcontent-qrr-c106="" class="handle-button ai-button"></div><div _ngcontent-qrr-c106="" class="handle-button line-button"><div _ngcontent-qrr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qrr-c106="" class="handle-button theme-button"><div _ngcontent-qrr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qrr-c106="" class="handle-button copy-button"><div _ngcontent-qrr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qrr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 导入码图生成需要的图片模块、错误码模块</span></li><li><span class="hljs-keyword">import</span> { scanCore, generateBarcode } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ScanKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { image } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ImageKit'</span>;</li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li></ol></pre></div></div></li>      <li>调用码图生成能力的createBarcode接口实现码图生成。       <ul>        <li>通过Promise方式回调，获取生成的码图。         <div _ngcontent-qrr-c106="" class="highlight-div"><div _ngcontent-qrr-c106="" class="highlight-div-header"><div _ngcontent-qrr-c106="" class="highlight-div-header-left"><div _ngcontent-qrr-c106="" class="handle-button expand-button"><div _ngcontent-qrr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qrr-c106="" class="highlight-div-header-right"><div _ngcontent-qrr-c106="" class="handle-button ai-button"></div><div _ngcontent-qrr-c106="" class="handle-button line-button"><div _ngcontent-qrr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qrr-c106="" class="handle-button theme-button"><div _ngcontent-qrr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qrr-c106="" class="handle-button copy-button"><div _ngcontent-qrr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qrr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">pixelMap</span>: image.<span class="hljs-property">PixelMap</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span></li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Flex</span>({ <span class="hljs-attr">direction</span>: <span class="hljs-title class_">FlexDirection</span>.<span class="hljs-property">Column</span>, <span class="hljs-attr">alignItems</span>: <span class="hljs-title class_">ItemAlign</span>.<span class="hljs-property">Center</span>, <span class="hljs-attr">justifyContent</span>: <span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span> }) {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'generateBarcode Promise'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-comment">// 以QR码为例，码图生成参数</span></li><li>        <span class="hljs-variable language_">this</span>.<span class="hljs-property">pixelMap</span> = <span class="hljs-literal">undefined</span>;</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">content</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'huawei'</span>;</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: generateBarcode.<span class="hljs-property">CreateOptions</span> = {</li><li>          <span class="hljs-attr">scanType</span>: scanCore.<span class="hljs-property">ScanType</span>.<span class="hljs-property">QR_CODE</span>,</li><li>          <span class="hljs-attr">height</span>: <span class="hljs-number">400</span>,</li><li>          <span class="hljs-attr">width</span>: <span class="hljs-number">400</span></li><li>        }</li><li>        <span class="hljs-keyword">try</span> {</li><li>          <span class="hljs-comment">// 码图生成接口，成功返回PixelMap格式图片</span></li><li>          generateBarcode.<span class="hljs-title function_">createBarcode</span>(content, options).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">pixelMap: image.PixelMap</span>) =&gt;</span> {</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">pixelMap</span> = pixelMap;</li><li>          }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>            hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[generateBarcode]'</span>,</li><li>              <span class="hljs-string">`Failed to get PixelMap by promise with options. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>          })</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>          hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[generateBarcode]'</span>,</li><li>            <span class="hljs-string">`Failed to createBarcode by promise with options. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>        }</li><li>
</li><li>      })</li><li>      <span class="hljs-comment">// 获取生成码后显示</span></li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">pixelMap</span>) {</li><li>        <span class="hljs-title class_">Image</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">pixelMap</span>).<span class="hljs-title function_">width</span>(<span class="hljs-number">300</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">300</span>).<span class="hljs-title function_">objectFit</span>(<span class="hljs-title class_">ImageFit</span>.<span class="hljs-property">Contain</span>)</li><li>      }</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div></li>        <li>通过Callback方式回调，获取生成的码图。         <div _ngcontent-qrr-c106="" class="highlight-div"><div _ngcontent-qrr-c106="" class="highlight-div-header"><div _ngcontent-qrr-c106="" class="highlight-div-header-left"><div _ngcontent-qrr-c106="" class="handle-button expand-button"><div _ngcontent-qrr-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qrr-c106="" class="highlight-div-header-right"><div _ngcontent-qrr-c106="" class="handle-button ai-button"></div><div _ngcontent-qrr-c106="" class="handle-button line-button"><div _ngcontent-qrr-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qrr-c106="" class="handle-button theme-button"><div _ngcontent-qrr-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qrr-c106="" class="handle-button copy-button"><div _ngcontent-qrr-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qrr-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">pixelMap</span>: image.<span class="hljs-property">PixelMap</span> | <span class="hljs-literal">undefined</span> = <span class="hljs-literal">undefined</span></li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Flex</span>({ <span class="hljs-attr">direction</span>: <span class="hljs-title class_">FlexDirection</span>.<span class="hljs-property">Column</span>, <span class="hljs-attr">alignItems</span>: <span class="hljs-title class_">ItemAlign</span>.<span class="hljs-property">Center</span>, <span class="hljs-attr">justifyContent</span>: <span class="hljs-title class_">FlexAlign</span>.<span class="hljs-property">Center</span> }) {</li><li>      <span class="hljs-title class_">Button</span>(<span class="hljs-string">'generateBarcode Callback'</span>).<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-comment">// 以QR码为例，码图生成参数</span></li><li>        <span class="hljs-keyword">let</span> content = <span class="hljs-string">'huawei'</span>;</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: generateBarcode.<span class="hljs-property">CreateOptions</span> = {</li><li>          <span class="hljs-attr">scanType</span>: scanCore.<span class="hljs-property">ScanType</span>.<span class="hljs-property">QR_CODE</span>,</li><li>          <span class="hljs-attr">height</span>: <span class="hljs-number">400</span>,</li><li>          <span class="hljs-attr">width</span>: <span class="hljs-number">400</span></li><li>        }</li><li>        <span class="hljs-keyword">try</span> {</li><li>          <span class="hljs-comment">// 码图生成接口，成功返回PixelMap格式图片</span></li><li>          generateBarcode.<span class="hljs-title function_">createBarcode</span>(content, options, <span class="hljs-function">(<span class="hljs-params">error: BusinessError, pixelMap: image.PixelMap</span>) =&gt;</span> {</li><li>            <span class="hljs-keyword">if</span> (error) {</li><li>              hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[generateBarcode]'</span>,</li><li>                <span class="hljs-string">`Failed to get PixelMap by callback with options. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>              <span class="hljs-keyword">return</span>;</li><li>            }</li><li>            <span class="hljs-variable language_">this</span>.<span class="hljs-property">pixelMap</span> = pixelMap;</li><li>          })</li><li>        } <span class="hljs-keyword">catch</span> (error) {</li><li>          hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[generateBarcode]'</span>,</li><li>            <span class="hljs-string">`Failed to createBarcode by callback with options. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>        }</li><li>      })</li><li>      <span class="hljs-comment">// 获取生成码后显示</span></li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">pixelMap</span>) {</li><li>        <span class="hljs-title class_">Image</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">pixelMap</span>).<span class="hljs-title function_">width</span>(<span class="hljs-number">300</span>).<span class="hljs-title function_">height</span>(<span class="hljs-number">300</span>).<span class="hljs-title function_">objectFit</span>(<span class="hljs-title class_">ImageFit</span>.<span class="hljs-property">Contain</span>)</li><li>      }</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div></li>       </ul></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section8793479155">模拟器开发<i class="anchor-icon anchor-icon-link" anchorid="section8793479155" tips="复制节点链接"></i></h2>          <p>暂不支持模拟器使用，调用会返回错误信息“Emulator is not supported.”</p>    </div>   </div>   <div></div></div>