<h1 _ngcontent-scp-c119="" class="doc-title ng-star-inserted" title="通过直达应用市场能力跳转至应用市场下载详情页"> 通过直达应用市场能力跳转至应用市场下载详情页 </h1>

<div _ngcontent-scp-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section3415172434719">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section3415172434719" tips="复制节点链接"></i></h2><p>从5.0.3(15)版本开始，新增支持直达应用市场能力。</p> <p>当成功配置App Linking应用链接后，可以构建App Linking直达应用市场下载详情页链接。当应用已安装时，点击链接直接跳转应用；当应用未安装时，点击链接跳转应用市场下载详情页，引导用户下载应用。</p>  <div class="tablenoborder"><div class="tbBox"><table style="border-style: none;" class="layoutFixed idpTab"><tbody><tr><td align="center" class="nocellnorowborder" style="border: none;" valign="top" width="50%"><p><span><img height="527.6243" originheight="720" originwidth="363" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114515.53854489373539568124576302825722:50001231000000:2800:2FAF43465C9DDDCDF6F599116B4CCB236F7695C15EA5E3FE75A65B33404F1DEC.gif" title="点击放大" width="266"></span></p> </td> <td align="center" class="cell-norowborder" style="border: none;" valign="top" width="50%"><p><span><img height="527.6243" originheight="720" originwidth="363" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114515.46001177697481793750260903654698:50001231000000:2800:09352B21A57EB35906B86A603B0888A40E32E61FCF01C3F73C585EE79753B25E.gif" title="点击放大" width="266"></span></p> </td> </tr> <tr><td align="center" class="row-nocellborder" style="border: none;" valign="top" width="50%"><p><strong>华为分享打开场景</strong></p> </td> <td align="center" class="cellrowborder" style="border: none;" valign="top" width="50%"><p><strong>其他社交APP打开场景</strong></p> </td> </tr>  </tbody></table></div> </div> </div> <div class="tiledSection"><h2 id="section122355919457">原理机制<i class="anchor-icon anchor-icon-link" anchorid="section122355919457" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section1928659151514" class="firsth2">链接生效机制<i class="anchor-icon anchor-icon-link" anchorid="section1928659151514" tips="复制节点链接"></i></h3><p>直达应用市场链接配置后不是即时生效的，一般要24小时生效，也有可能出现48小时生效的情况。</p> </div> <div class="tiledSection"><h2 id="section18969904501">前提条件<i class="anchor-icon anchor-icon-link" anchorid="section18969904501" tips="复制节点链接"></i></h2><ol><li>目标方应用已<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-linking-startupapp">配置App Linking应用链接</a>。</li><li>目标方HarmonyOS应用必须已上架，具体可参见“<a href="https://developer.huawei.com/consumer/cn/doc/app/agc-help-release-app-0000002271695230" target="_blank">发布HarmonyOS应用</a>”。</li></ol> </div> <div class="tiledSection"><h2 id="section293104811534">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="section293104811534" tips="复制节点链接"></i></h2><p>只能获取通过App Linking域名校验的应用链接，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-linking-startupapp#section1101111611317">在AGC为应用创建关联的网址域名</a>。</p> </div> <div class="tiledSection"><h2 id="section019121832614">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section019121832614" tips="复制节点链接"></i></h2><ol><li>目标方应用配置直达应用市场能力。<ol><li>登录<a href="https://developer.huawei.com/consumer/cn/service/josp/agc/index.html" target="_blank">AppGallery Connect</a>，点击“开发与服务”。</li><li>在项目列表中点击目标方应用所在的项目。</li><li>在左侧导航栏中选择“增长 &gt; App Linking”，选择“应用链接（API&gt;=12适用）”页签，点击“操作”列的“直达应用市场”。<div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>只有<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-linking-startupapp#section1101111611317">在AGC创建关联的网址域名</a>状态为“成功”时，才支持配置直达应用市场链接。</p> </div></div></div> <p><span><img originheight="474" originwidth="1441" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114515.93605067517451000895410443360696:50001231000000:2800:01CBA0A1DBE7FE84C462EE97BA12B3999740B759550ABF5072900024C46302DE.png" width="920" height="302.6231783483692"></span></p> </li><li>在配置页面，下拉选择与该域名关联的在架应用，为应用配置直达应用市场链接。<div class="p"><span><img originheight="294" originwidth="1319" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114515.11980565645463524719636284184725:50001231000000:2800:4FE0397DC8EBD4BA00063706B237A571B0225DB11655278D1D220C4C70D5362A.png" width="920" height="205.06444275966643"></span><ul><li>可以点击“添加应用”为多个应用配置直达链接，当该域名下关联的在架应用全部配置后，无法再添加应用。</li><li>可以根据以下规则配置直达链接。 <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.6.2.1.1.4.1.2.2.1.1.3.1.1" valign="top" width="26.810000000000002%"><p>路径</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.6.2.1.1.4.1.2.2.1.1.3.1.2" valign="top" width="73.19%"><p>匹配规则</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="26.810000000000002%"><p>path</p> </td> <td class="cellrowborder" valign="top" width="73.19%"><p>精确匹配</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="26.810000000000002%"><p>pathStartWith</p> </td> <td class="cellrowborder" valign="top" width="73.19%"><p>前缀匹配</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="26.810000000000002%"><p>pathRegex</p> </td> <td class="cellrowborder" valign="top" width="73.19%"><p>正则表达式匹配</p> </td> </tr>  </tbody></table></div> </div> <ul><li>如果<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-linking-startupapp#section13808113610362">在module.json5中配置关联的网址域名</a>时，未配置path、pathStartWith或pathRegex，必须是如下匹配规则之一：<p>pathRegex，匹配路径：.*</p> <p>path，手动输入精确匹配的路径（不允许以“/”开头，不允许出现双斜杠“//”和“..”，允许包含字母（a-z、A-Z）、数字（0-9）、正斜杠“/”、点“.”、下划线“_”和连字符“-”）</p> </li><li>（不推荐）如果<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-linking-startupapp#section13808113610362">在module.json5中配置关联的网址域名</a>时，path匹配规则中配置了pathRegex，且值为.*，可以包含如下匹配规则：<p>pathRegex，匹配路径：.*</p> <p>path，手动输入精确匹配的路径（不允许以“/”开头，不允许出现双斜杠“//”和“..”，允许包含字母（a-z、A-Z）、数字（0-9）、正斜杠“/”、点“.”、下划线“_”和连字符“-”）</p> </li><li>其他场景需要根据<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/app-linking-startupapp#section13808113610362">在module.json5中配置关联的网址域名</a>时配置的path匹配规则进行选择。</li></ul> </li><li>可以点击“删除链接”删除当前关联应用的直达应用市场链接。</li></ul> </div> </li><li>配置完成后，点击页面顶部的“发布”，会跳转到“应用链接”列表页面。<p>如下图，“是否配置直达应用市场”显示“是”，表示链接配置成功。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>链接配置成功后，一般需要24~48小时才能生效，请耐心等待。</p> </div></div></div> <p><span><img originheight="474" originwidth="1441" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114515.08249496660835039315123340562595:50001231000000:2800:9909E7195029F33F7F2C8EA060BB963DECE61C1321EAF1EBD1C544FDCC92D21F.png" width="920" height="302.6231783483692"></span></p> </li></ol> </li><li>拉起方应用跳转实现。<p>拉起方应用需调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#openlink12" target="_blank">UIAbilityContext.openLink()</a>接口，并将appLinkingOnly参数设为false或者不传，以App Linking优先的方式打开应用。</p> <ol><li>在“entry/src/main/ets/common”目录下添加GlobalContext.ets文件，开发初始化和获取应用上下文的接口。<div _ngcontent-scp-c106="" class="highlight-div"><div _ngcontent-scp-c106="" class="highlight-div-header"><div _ngcontent-scp-c106="" class="highlight-div-header-left"><div _ngcontent-scp-c106="" class="handle-button expand-button"><div _ngcontent-scp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-scp-c106="" class="highlight-div-header-right"><div _ngcontent-scp-c106="" class="handle-button ai-button"></div><div _ngcontent-scp-c106="" class="handle-button line-button"><div _ngcontent-scp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-scp-c106="" class="handle-button theme-button"><div _ngcontent-scp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-scp-c106="" class="handle-button copy-button"><div _ngcontent-scp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-scp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { common } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.AbilityKit'</span>;</li><li>
</li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">GlobalContext</span> {</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span>;</li><li>
</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title function_">initContext</span>(<span class="hljs-attr">context</span>: common.<span class="hljs-property">UIAbilityContext</span>): <span class="hljs-built_in">void</span> {</li><li>    <span class="hljs-title class_">GlobalContext</span>.<span class="hljs-property">context</span> = context;</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-title function_">getContext</span>(): common.<span class="hljs-property">UIAbilityContext</span> {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-title class_">GlobalContext</span>.<span class="hljs-property">context</span>;</li><li>  }</li><li>}</li></ol></pre></div></div> </li><li>在“entry/src/main/ets/entryability/EntryAbility.ets”文件中导入GlobalContext，在onCreate方法中使用GlobalContext.initContext(this.context)初始化全局应用上下文。</li><li>在“entry/src/main/ets/pages/Index.ets”文件中，使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-inner-application-uiabilitycontext#openlink12" target="_blank">UIAbilityContext.openLink()</a>接口配置跳转链接。<div _ngcontent-scp-c106="" class="highlight-div"><div _ngcontent-scp-c106="" class="highlight-div-header"><div _ngcontent-scp-c106="" class="highlight-div-header-left"><div _ngcontent-scp-c106="" class="handle-button expand-button"><div _ngcontent-scp-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-scp-c106="" class="highlight-div-header-right"><div _ngcontent-scp-c106="" class="handle-button ai-button"></div><div _ngcontent-scp-c106="" class="handle-button line-button"><div _ngcontent-scp-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-scp-c106="" class="handle-button theme-button"><div _ngcontent-scp-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-scp-c106="" class="handle-button copy-button"><div _ngcontent-scp-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-scp-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">GlobalContext</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../common/GlobalContext'</span>;</li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Button</span>(<span class="hljs-string">'start link'</span>, { <span class="hljs-attr">type</span>: <span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>, <span class="hljs-attr">stateEffect</span>: <span class="hljs-literal">true</span> })</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'87%'</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'5%'</span>)</li><li>      .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">bottom</span>: <span class="hljs-string">'12vp'</span> })</li><li>      .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>        <span class="hljs-keyword">let</span> context = <span class="hljs-title class_">GlobalContext</span>.<span class="hljs-title function_">getContext</span>();</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-attr">link</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">"https://www.example.com/product?pageName=productDetail"</span>;</li><li>        context.<span class="hljs-title function_">openLink</span>(link, { <span class="hljs-attr">appLinkingOnly</span>: <span class="hljs-literal">false</span> })</li><li>          .<span class="hljs-title function_">then</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`Succeeded in opening link.`</span>);</li><li>          })</li><li>          .<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>            hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'testTag'</span>, <span class="hljs-string">`Failed to open link, code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>          })</li><li>      })</li><li>  }</li><li>}</li></ol></pre></div></div> </li></ol> </li><li>安装拉起方应用，<span style="color: rgb(36,39,40);">点击拉起方应用中的跳转按钮</span>。<p>此时目标应用未安装，若有App Linking相匹配的应用，点击链接会跳转应用市场下载详情页，引导用户安装应用；若无App Linking相匹配的应用，则继续尝试以浏览器打开链接的方式打开应用。</p> </li><li>安装目标方应用后，点击拉起方应用的跳转按钮，会直接打开应用。</li></ol> </div> <div class="tiledSection"><h2 id="section119393352115">FAQ<i class="anchor-icon anchor-icon-link" anchorid="section119393352115" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section15470181832218" class="firsth2">使用ArkWeb拉起目标应用，当目标应用未安装时，会直接跳转到应用市场下载详情页面吗？<i class="anchor-icon anchor-icon-link" anchorid="section15470181832218" tips="复制节点链接"></i></h3><p>当开发者通过系统浏览器或ArkWeb拉起目标应用时，如果目标应用未安装，不会直接跳转应用市场，需要开发者根据自身业务自行实现跳转应用市场的能力。详细可参见“Web和应用的跳转与拉起”开发实践中的《<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-web-app-jump-and-pull-up#section37419543116" target="_blank">ArkWeb页面指定应用跳转</a>》章节。</p> </div> <div class="tiledSection"><h3 id="section967662711196">哪些服务支持接入App Linking Kit的直达应用市场能力？<i class="anchor-icon anchor-icon-link" anchorid="section967662711196" tips="复制节点链接"></i></h3><p>支持的服务如下：</p> <p>华为分享、碰一碰分享、短信、畅联以及其他支持openLink API的场景。</p> <p>不支持的服务如下：</p> <p>浏览器、扫码（规划中，上线后自动生效，无需适配）。</p> </div> <div class="tiledSection"><h3 id="section208411642193320">直达链接的路径（path、pathStartWith或pathRegex）可以配置多少条？<i class="anchor-icon anchor-icon-link" anchorid="section208411642193320" tips="复制节点链接"></i></h3><p>每个应用默认支持配置1条。</p> </div> </div> <div></div></div>