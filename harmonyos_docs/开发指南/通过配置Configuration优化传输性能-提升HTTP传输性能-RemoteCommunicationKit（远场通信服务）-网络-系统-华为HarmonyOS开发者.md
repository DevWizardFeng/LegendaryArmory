<h1 _ngcontent-ipl-c119="" class="doc-title ng-star-inserted" title="通过配置Configuration优化传输性能"> 通过配置Configuration优化传输性能 </h1>

<div _ngcontent-ipl-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section15385135185019">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="section15385135185019" tips="复制节点链接"></i></h2><p>通过配置Configuration优化传输性能能力支持Phone、2in1、Tablet、Wearable设备。并且从5.1.1(19)开始，新增支持TV设备。</p> </div> <div class="tiledSection"><h2 id="section10709112144913">请求预处理阶段<i class="anchor-icon anchor-icon-link" anchorid="section10709112144913" tips="复制节点链接"></i></h2><ul><li>基于Session抽象的高并发网络框架</li><li>支持创建多个Session</li><li>支持请求动态取消</li><li>支持关闭Session</li><li>Session中的资源互相独立、互不影响</li><li>应用可以通过使用Session来获取最佳的网络性能体验<div _ngcontent-ipl-c106="" class="highlight-div"><div _ngcontent-ipl-c106="" class="highlight-div-header"><div _ngcontent-ipl-c106="" class="highlight-div-header-left"><div _ngcontent-ipl-c106="" class="handle-button expand-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ipl-c106="" class="highlight-div-header-right"><div _ngcontent-ipl-c106="" class="handle-button ai-button"></div><div _ngcontent-ipl-c106="" class="handle-button line-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ipl-c106="" class="handle-button theme-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ipl-c106="" class="handle-button copy-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ipl-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">const</span> session1 = rcp.<span class="hljs-title function_">createSession</span>({</li><li>  <span class="hljs-attr">requestConfiguration</span>: {</li><li>    <span class="hljs-attr">transfer</span>: {</li><li>      <span class="hljs-attr">timeout</span>: {</li><li>        <span class="hljs-attr">connectMs</span>: <span class="hljs-number">5000</span>,</li><li>        <span class="hljs-attr">transferMs</span>: <span class="hljs-number">5000</span></li><li>      }</li><li>    }</li><li>  }</li><li>});</li><li>
</li><li><span class="hljs-keyword">const</span> request1 = <span class="hljs-keyword">new</span> rcp.<span class="hljs-title class_">Request</span>(<span class="hljs-string">'https://example.com'</span>);</li><li><span class="hljs-keyword">const</span> request2 = <span class="hljs-keyword">new</span> rcp.<span class="hljs-title class_">Request</span>(<span class="hljs-string">'https://example.com'</span>);</li><li>session1.<span class="hljs-title function_">fetch</span>(request1).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Request1 succeeded, message is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(response)}</span>`</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`err1: err code is <span class="hljs-subst">${err.code}</span>, err message is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>});</li><li>session1.<span class="hljs-title function_">fetch</span>(request2).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Request2 succeeded, message is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(response)}</span>`</span>);</li><li>  session1.<span class="hljs-title function_">close</span>();</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`err2: err code is <span class="hljs-subst">${err.code}</span>, err message is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>  session1.<span class="hljs-title function_">close</span>();</li><li>});</li><li>session1.<span class="hljs-title function_">cancel</span>(request1); <span class="hljs-comment">// 取消request1请求</span></li></ol></pre></div></div> </li></ul> </div> <div class="tiledSection"><h2 id="section16466365911">DNS阶段<i class="anchor-icon anchor-icon-link" anchorid="section16466365911" tips="复制节点链接"></i></h2><p>应用可<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/remote-communication-customdnsconfig#section5676104731714">定制DNS</a>请求规则，如定制DNS服务器、重写DNS解析函数，从而获取最佳的DNS性能体验。</p> <div _ngcontent-ipl-c106="" class="highlight-div"><div _ngcontent-ipl-c106="" class="highlight-div-header"><div _ngcontent-ipl-c106="" class="highlight-div-header-left"><div _ngcontent-ipl-c106="" class="handle-button expand-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ipl-c106="" class="highlight-div-header-right"><div _ngcontent-ipl-c106="" class="handle-button ai-button"></div><div _ngcontent-ipl-c106="" class="handle-button line-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ipl-c106="" class="handle-button theme-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ipl-c106="" class="handle-button copy-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ipl-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 定制DNS解析函数</span></li><li><span class="hljs-keyword">const</span> session = rcp.<span class="hljs-title function_">createSession</span>();</li><li><span class="hljs-keyword">const</span> request = <span class="hljs-keyword">new</span> rcp.<span class="hljs-title class_">Request</span>(<span class="hljs-string">'https://example.com'</span>);</li><li>request.<span class="hljs-property">configuration</span> = {</li><li>  <span class="hljs-attr">dns</span>: {</li><li>    <span class="hljs-attr">dnsRules</span>: (<span class="hljs-attr">host</span>: <span class="hljs-built_in">string</span>, <span class="hljs-attr">port</span>: <span class="hljs-built_in">number</span>): rcp.<span class="hljs-property">IpAddress</span>[] =&gt; {</li><li>      <span class="hljs-keyword">if</span> (host === <span class="hljs-string">'example.com'</span>) {</li><li>        <span class="hljs-keyword">return</span> [<span class="hljs-string">'7.128.8.45'</span>, <span class="hljs-string">'7.128.8.46'</span>];</li><li>      }</li><li>      <span class="hljs-keyword">return</span> [];</li><li>    }</li><li>  }</li><li>};</li><li>session.<span class="hljs-title function_">fetch</span>(request).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Request succeeded, message is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(response)}</span>`</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`err: err code is <span class="hljs-subst">${err.code}</span>, err message is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>});</li></ol></pre></div></div> <div _ngcontent-ipl-c106="" class="highlight-div"><div _ngcontent-ipl-c106="" class="highlight-div-header"><div _ngcontent-ipl-c106="" class="highlight-div-header-left"><div _ngcontent-ipl-c106="" class="handle-button expand-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ipl-c106="" class="highlight-div-header-right"><div _ngcontent-ipl-c106="" class="handle-button ai-button"></div><div _ngcontent-ipl-c106="" class="handle-button line-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ipl-c106="" class="handle-button theme-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ipl-c106="" class="handle-button copy-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ipl-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 定制DNS服务器</span></li><li><span class="hljs-keyword">const</span> session = rcp.<span class="hljs-title function_">createSession</span>();</li><li><span class="hljs-keyword">const</span> request = <span class="hljs-keyword">new</span> rcp.<span class="hljs-title class_">Request</span>(<span class="hljs-string">'https://example.com'</span>);</li><li>request.<span class="hljs-property">configuration</span> = {</li><li>  <span class="hljs-attr">dns</span>: {</li><li>    <span class="hljs-attr">dnsRules</span>: [</li><li>      {</li><li>        <span class="hljs-attr">ip</span>: <span class="hljs-string">'7.128.8.45'</span>,</li><li>        <span class="hljs-attr">port</span>: <span class="hljs-number">53</span>,</li><li>      },</li><li>    ]</li><li>  }</li><li>};</li><li>session.<span class="hljs-title function_">fetch</span>(request).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Request succeeded, message is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(response)}</span>`</span>);</li><li>}).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`err: err code is <span class="hljs-subst">${err.code}</span>, err message is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>});</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section1092020453316">连接阶段<i class="anchor-icon anchor-icon-link" anchorid="section1092020453316" tips="复制节点链接"></i></h2><p>根据资源特征动态调整连接池大小</p> <div _ngcontent-ipl-c106="" class="highlight-div"><div _ngcontent-ipl-c106="" class="highlight-div-header"><div _ngcontent-ipl-c106="" class="highlight-div-header-left"><div _ngcontent-ipl-c106="" class="handle-button expand-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ipl-c106="" class="highlight-div-header-right"><div _ngcontent-ipl-c106="" class="handle-button ai-button"></div><div _ngcontent-ipl-c106="" class="handle-button line-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ipl-c106="" class="handle-button theme-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ipl-c106="" class="handle-button copy-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ipl-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">const</span> session = rcp.<span class="hljs-title function_">createSession</span>({</li><li>  <span class="hljs-attr">connectionConfiguration</span>: {</li><li>    <span class="hljs-attr">maxConnectionsPerHost</span>: <span class="hljs-number">16</span>,</li><li>    <span class="hljs-attr">maxTotalConnections</span>: <span class="hljs-number">1024</span>,</li><li>  }</li><li>});</li><li><span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">1024</span>; ++i) {</li><li>  session.<span class="hljs-title function_">get</span>(<span class="hljs-string">'https://example'</span> + i.<span class="hljs-title function_">toString</span>() + <span class="hljs-string">'.com/image.png'</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Request succeeded, message is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(response)}</span>`</span>);</li><li>  }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">err: BusinessError</span>) =&gt;</span> {</li><li>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`err: err code is <span class="hljs-subst">${err.code}</span>, err message is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>  });</li><li>}</li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="section12218163721116">HTTP请求阶段<i class="anchor-icon anchor-icon-link" anchorid="section12218163721116" tips="复制节点链接"></i></h2><ul><li>支持响应体分段返回，以节省内存</li><li>支持直接将响应写入文件，以节省内存</li><li>支持请求体分段上传，以节省内存<div _ngcontent-ipl-c106="" class="highlight-div"><div _ngcontent-ipl-c106="" class="highlight-div-header"><div _ngcontent-ipl-c106="" class="highlight-div-header-left"><div _ngcontent-ipl-c106="" class="handle-button expand-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ipl-c106="" class="highlight-div-header-right"><div _ngcontent-ipl-c106="" class="handle-button ai-button"></div><div _ngcontent-ipl-c106="" class="handle-button line-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ipl-c106="" class="handle-button theme-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ipl-c106="" class="handle-button copy-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ipl-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 使用响应体直接写入文件</span></li><li><span class="hljs-keyword">const</span> session = rcp.<span class="hljs-title function_">createSession</span>();</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> session.<span class="hljs-title function_">get</span>(<span class="hljs-string">'https://example.com/video.mp4'</span>, {</li><li>    <span class="hljs-attr">kind</span>: <span class="hljs-string">'file'</span>,</li><li>    <span class="hljs-attr">file</span>: <span class="hljs-string">'./video.mp4'</span>,</li><li>  });</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Request succeeded, message is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(response)}</span>`</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`err: err code is <span class="hljs-subst">${err.code}</span>, err message is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>} <span class="hljs-keyword">finally</span> {</li><li>  session.<span class="hljs-title function_">close</span>();</li><li>}</li></ol></pre></div></div> <div _ngcontent-ipl-c106="" class="highlight-div"><div _ngcontent-ipl-c106="" class="highlight-div-header"><div _ngcontent-ipl-c106="" class="highlight-div-header-left"><div _ngcontent-ipl-c106="" class="handle-button expand-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ipl-c106="" class="highlight-div-header-right"><div _ngcontent-ipl-c106="" class="handle-button ai-button"></div><div _ngcontent-ipl-c106="" class="handle-button line-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ipl-c106="" class="handle-button theme-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ipl-c106="" class="handle-button copy-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ipl-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 分段上传数据</span></li><li><span class="hljs-keyword">const</span> session = rcp.<span class="hljs-title function_">createSession</span>();</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> session.<span class="hljs-title function_">post</span>(<span class="hljs-string">'https://example.com/video.mp4'</span>, <span class="hljs-function">(<span class="hljs-params">maxSize: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>    <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayBuffer</span>(maxSize);</li><li>  });</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(<span class="hljs-string">`Request succeeded, message is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(response)}</span>`</span>);</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`err: err code is <span class="hljs-subst">${err.code}</span>, err message is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>} <span class="hljs-keyword">finally</span> {</li><li>  session.<span class="hljs-title function_">close</span>();</li><li>}</li></ol></pre></div></div> </li></ul> </div> <div class="tiledSection"><h2 id="section184318374148">HTTP响应阶段<i class="anchor-icon anchor-icon-link" anchorid="section184318374148" tips="复制节点链接"></i></h2><p>获取响应各阶段耗时动态判断网络质量，动态调整请求（请求不同质量的资源、降低资源缓存数量）。更详细的示例请移步<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/remote-communication-tpms#section143821143125014">HTTP请求过程中各时间点详解</a>。</p> <div _ngcontent-ipl-c106="" class="highlight-div"><div _ngcontent-ipl-c106="" class="highlight-div-header"><div _ngcontent-ipl-c106="" class="highlight-div-header-left"><div _ngcontent-ipl-c106="" class="handle-button expand-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ipl-c106="" class="highlight-div-header-right"><div _ngcontent-ipl-c106="" class="handle-button ai-button"></div><div _ngcontent-ipl-c106="" class="handle-button line-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ipl-c106="" class="handle-button theme-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ipl-c106="" class="handle-button copy-button"><div _ngcontent-ipl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ipl-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// 获取各个阶段的耗时信息</span></li><li><span class="hljs-keyword">const</span> session = rcp.<span class="hljs-title function_">createSession</span>();</li><li><span class="hljs-keyword">try</span> {</li><li>  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> session.<span class="hljs-title function_">get</span>(<span class="hljs-string">'https://example.com'</span>);</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(response.<span class="hljs-property">timeInfo</span>?.<span class="hljs-property">nameLookupTimeMs</span>.<span class="hljs-title function_">toString</span>());</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(response.<span class="hljs-property">timeInfo</span>?.<span class="hljs-property">connectTimeMs</span>.<span class="hljs-title function_">toString</span>());</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(response.<span class="hljs-property">timeInfo</span>?.<span class="hljs-property">tlsHandshakeTimeMs</span>.<span class="hljs-title function_">toString</span>());</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(response.<span class="hljs-property">timeInfo</span>?.<span class="hljs-property">preTransferTimeMs</span>.<span class="hljs-title function_">toString</span>());</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(response.<span class="hljs-property">timeInfo</span>?.<span class="hljs-property">startTransferTimeMs</span>.<span class="hljs-title function_">toString</span>());</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(response.<span class="hljs-property">timeInfo</span>?.<span class="hljs-property">totalTimeMs</span>.<span class="hljs-title function_">toString</span>());</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">info</span>(response.<span class="hljs-property">timeInfo</span>?.<span class="hljs-property">redirectTimeMs</span>.<span class="hljs-title function_">toString</span>());</li><li>} <span class="hljs-keyword">catch</span> (err) {</li><li>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">error</span>(<span class="hljs-string">`err: err code is <span class="hljs-subst">${err.code}</span>, err message is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(err)}</span>`</span>);</li><li>} <span class="hljs-keyword">finally</span> {</li><li>  session.<span class="hljs-title function_">close</span>();</li><li>}</li></ol></pre></div></div> </div> </div> <div></div></div>