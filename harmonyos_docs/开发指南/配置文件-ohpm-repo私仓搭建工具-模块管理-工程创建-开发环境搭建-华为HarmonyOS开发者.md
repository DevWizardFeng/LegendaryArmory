<h1 _ngcontent-bpb-c119="" class="doc-title ng-star-inserted" title="配置文件"> 配置文件 </h1>

<div _ngcontent-bpb-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div id="body0000001796516529"><p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p1295678364171146">config.yaml是ohpm-repo的重要文件，可以在其中修改默认参数配置，启动插件和扩展功能。ohpm-repo私仓解压目录中的conf目录下带有一个默认配置文件config.yaml，ohpm-repo执行install命令时默认读取该文件。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002478173752__p4486152772015"><strong>ohpm-repo成功启动后修改配置文件方法</strong>：</p> <ul id="ZH-CN_TOPIC_0000002478173752__ul0861185218217"><li id="li148611352182119">首次启动ohpm-repo时执行<strong>install</strong>命令时已指定配置文件：找到指定的配置文件进行文件内容修改，然后重新执行install指定修改后的配置文件，再执行start启动ohpm-repo。</li><li id="li71852426122">首次启动ohpm-repo时执行<strong>install</strong>命令未指定配置文件：默认使用ohpm-repo压缩包解压路径下conf目录中的配置文件，修改该文件内容，然后重新执行install和start操作。</li></ul> </div></div></div> <div class="tiledSection"><h2 id="zh-cn_topic_0000001745376470_默认配置">默认配置<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745376470_默认配置" tips="复制节点链接"></i></h2><div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_screen303967613171146" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">##### server configuration section #####</span></li><li><span class="hljs-attr">listen:</span> <span class="hljs-string">localhost:8088</span>        <span class="hljs-comment"># 建议修改为具体的ip/域名</span></li><li><span class="hljs-comment"># listen:</span></li><li><span class="hljs-comment"># - localhost:8088            # 监听本机环回地址</span></li><li><span class="hljs-comment"># - http://localhost:8088     # 监听本机环回地址</span></li><li><span class="hljs-comment"># - 0.0.0.0:8088              # 监听本机所有地址 (INADDR_ANY)</span></li><li><span class="hljs-comment"># 协议可配置 http 或者 https，默认为 http</span></li><li><span class="hljs-comment"># port: 1-65535(Windows系统)/ 1024-65535(Linux或Mac系统）</span></li><li>
</li><li><span class="hljs-comment"># 可选 (listen 为 https 协议时必须配置)</span></li><li><span class="hljs-attr">https_key:</span> <span class="hljs-string">''</span>                 <span class="hljs-comment"># https 服务使用的 key 的路径  (不配置默认为'')</span></li><li><span class="hljs-attr">https_cert:</span> <span class="hljs-string">''</span>                <span class="hljs-comment"># https 服务使用的 crt 的路径  (不配置默认为'')</span></li><li>
</li><li><span class="hljs-comment">##### server deploy root section #####</span></li><li><span class="hljs-attr">deploy_root:</span> <span class="hljs-string">''</span>                <span class="hljs-comment"># 安装根目录，只支持绝对路径，且目录必须存在</span></li><li>
</li><li><span class="hljs-comment">##### server numeric limit section #####</span></li><li><span class="hljs-attr">max_package_size:</span> <span class="hljs-number">500</span>          <span class="hljs-comment"># 上传包大小限制，单位是MB (0, 500]，不配置或配置为0默认为 500</span></li><li><span class="hljs-attr">max_extract_size:</span> <span class="hljs-number">800</span>          <span class="hljs-comment"># 压缩包解压后大小限制，单位是MB ，不配置或配置为0默认为 800</span></li><li><span class="hljs-attr">max_extract_file_num:</span> <span class="hljs-number">30000</span>    <span class="hljs-comment"># 压缩包解压后文件个数限制，不配置或配置为0默认为30000个</span></li><li><span class="hljs-attr">user_rate_limit:</span> <span class="hljs-number">100</span>           <span class="hljs-comment"># 用户访问频率控制，单位是次/小时 (0, 10000]，不配置或配置为0默认为 100</span></li><li><span class="hljs-attr">fetch_timeout:</span> <span class="hljs-number">60</span>              <span class="hljs-comment"># 请求/响应的超时时间，单位是秒 (0, 3600]，不配置或配置为0默认为 60</span></li><li><span class="hljs-attr">keep_alive_timeout:</span> <span class="hljs-number">60</span>         <span class="hljs-comment"># TCP 保持连接的超时时间，单位是秒 (0, 3600]，不配置或配置为0默认为 60</span></li><li><span class="hljs-attr">api_timeout:</span> <span class="hljs-number">60</span>                <span class="hljs-comment"># api超时时间，单位是秒(0, 3600]，不配置或配置为0默认为 60</span></li><li><span class="hljs-attr">upload_api_timeout:</span> <span class="hljs-number">300</span>        <span class="hljs-comment"># 上传三方包api超时时间，单位是秒(0, 3600]，不配置或配置为0默认为 300</span></li><li><span class="hljs-attr">upload_lock_hour:</span> <span class="hljs-number">24</span>           <span class="hljs-comment"># 下架某一三方包所有版本后，限时禁止同名三方包上传，单位是小时 (0, 168]，不配置或配置为0默认为 24</span></li><li><span class="hljs-attr">upload_max_times:</span> <span class="hljs-number">100</span>          <span class="hljs-comment"># 单用户24小时内上传次数限制 (0, 100000]，不配置或配置为0默认为 100</span></li><li><span class="hljs-attr">operation_log_retention:</span> <span class="hljs-number">100</span>   <span class="hljs-comment"># 数据库中操作日志保留时间，单位是天，不配置或配置为0默认为 100</span></li><li>
</li><li><span class="hljs-comment">##### metadata storage section #####</span></li><li><span class="hljs-comment">## 数据存储类型 filedb 和 mysql 二选一，不可都配置</span></li><li><span class="hljs-attr">db:</span>                         <span class="hljs-comment"># 必须用 yaml 数组形式写法</span></li><li>  <span class="hljs-attr">type:</span> <span class="hljs-string">filedb</span></li><li>  <span class="hljs-attr">config:</span>                   <span class="hljs-comment"># 如果想修改存储路径且保留旧的数据，则需要把旧路径下的数据文件迁移至新路径</span></li><li>    <span class="hljs-attr">path:</span> <span class="hljs-string">./db</span>              <span class="hljs-comment"># 本地数据存储路径，不配置默认为&lt;deploy_root&gt;/db;</span></li><li>
</li><li><span class="hljs-comment">#db:                        # 必须用yaml数组形式写法</span></li><li><span class="hljs-comment">#  type: mysql</span></li><li><span class="hljs-comment">#  config:</span></li><li><span class="hljs-comment">#    host: "localhost"      # 数据库主机地址</span></li><li><span class="hljs-comment">#    port: 3306             # 数据库端口 (0,65535]</span></li><li><span class="hljs-comment">#    username: tctAdmin         # 数据库的用户名</span></li><li><span class="hljs-comment">#    password: "password"   # 数据库的用户密码（请配置明文, 最终在部署目录中会转换为密文）</span></li><li><span class="hljs-comment">#    database: "repo"       # 数据库名</span></li><li>
</li><li><span class="hljs-comment">##### storage section #####</span></li><li><span class="hljs-comment">## 文件存储类型fs,sftp 和 custom 三选一，不可多选。</span></li><li>
</li><li><span class="hljs-attr">store:</span>                               <span class="hljs-comment"># 必须用 yaml 数组形式写法</span></li><li>  <span class="hljs-attr">type:</span> <span class="hljs-string">fs</span></li><li>  <span class="hljs-attr">config:</span>                            <span class="hljs-comment"># 上传资源后如若要修改存储路径，则需要把旧路径下的数据迁移至新路径中</span></li><li>    <span class="hljs-attr">path:</span> <span class="hljs-string">./storage</span>                  <span class="hljs-comment"># 已上架三方库存储路径，不配置默认为 &lt;deploy_root&gt;/storage;</span></li><li>    <span class="hljs-comment">#server: http://localhost:8088   # 仓库下载链接地址，不配置取默认值</span></li><li>
</li><li><span class="hljs-comment"># 文件存储类型为 sftp 时，最多配置三个 sftp</span></li><li><span class="hljs-comment">#store:                               # 必须用 yaml 数组形式写法</span></li><li><span class="hljs-comment">#  type: sftp                         # 当且仅当 db 的类型为 mysql 时，store 的类型才能为 sftp</span></li><li><span class="hljs-comment">#  config:</span></li><li><span class="hljs-comment">#    location:</span></li><li><span class="hljs-comment">#      -</span></li><li><span class="hljs-comment">#        name: test_one_sftp          # 主机名字不能与其他sftp配置重复</span></li><li><span class="hljs-comment">#        host: "localhost"            # 主机地址</span></li><li><span class="hljs-comment">#        port: 22                     # 主机端口 (0,65535]</span></li><li><span class="hljs-comment">#        read_username: "read"        # 主机有读权限的用户名字</span></li><li><span class="hljs-comment">#        read_password: "password"    # 主机有读权限的用户密码（请配置明文, 最终在部署目录中会转换为密文）</span></li><li><span class="hljs-comment">#        write_username: "write"      # 主机有写权限的用户名字</span></li><li><span class="hljs-comment">#        write_password: "password"   # 主机有写权限的用户密码（请配置明文, 最终在部署目录中会转换为密文）</span></li><li><span class="hljs-comment">#        path: /source22              # 相对 sftp 根目录的文件路径，仅限/开头，且路径文件夹必须存在</span></li><li><span class="hljs-comment">#      -</span></li><li><span class="hljs-comment">#        name: test_two_sftp</span></li><li><span class="hljs-comment">#        host: "localhost"</span></li><li><span class="hljs-comment">#        port: 24</span></li><li><span class="hljs-comment">#        read_username: "read"</span></li><li><span class="hljs-comment">#        read_password: "password"</span></li><li><span class="hljs-comment">#        write_username: "write"</span></li><li><span class="hljs-comment">#        write_password: "password"</span></li><li><span class="hljs-comment">#        path: /source24</span></li><li><span class="hljs-comment">#    #server: http://localhost:8088   # 仓库下载链接地址，不配置取默认值</span></li><li>
</li><li><span class="hljs-comment">#store:</span></li><li><span class="hljs-comment">#  type: custom                                            # custom是自定义存储插件类型，自定义存储插件开发流程见</span><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-storageplugin"><span class="hljs-comment">指导文档</span></a></li><li><span class="hljs-comment">#  config:</span></li><li><span class="hljs-comment">#    export_name: CustomStorage                            # 插件export的类名</span></li><li><span class="hljs-comment">#    plugin_path: plugins/CustomStorage.js                 # 插件的绝对路径或者相对于ohpm-repo软件包的路径，建议将插件放在软件包的plugins目录下</span></li><li><span class="hljs-comment">#    custom_field: "test"                                  # 自定义字段，通过引入libs/common/getStorageConfigInfo.js的getStorageConfigInfo方法获取自定义字段的值</span></li><li><span class="hljs-comment">#    #server: http://localhost:8088                        # 仓库下载链接地址，不配置取默认值</span></li><li>
</li><li><span class="hljs-comment">##### 是否使用反向代理 #####</span></li><li><span class="hljs-comment"># 可选项:true,false, 默认：false。如果使用反向代理，需要配置为true，客户端IP地址将从请求头中的x-forwarded-for字段获取</span></li><li><span class="hljs-attr">use_reverse_proxy:</span> <span class="hljs-literal">false</span></li><li>
</li><li><span class="hljs-comment">##### uplink section #####</span></li><li><span class="hljs-attr">uplink_cache_path:</span> <span class="hljs-string">./uplink</span>      <span class="hljs-comment"># 缓存路径，不配置默认为 &lt;deploy_root&gt;/uplink</span></li><li><span class="hljs-attr">uplink_cache_time:</span> <span class="hljs-number">168</span>           <span class="hljs-comment"># 远程包 metadata 缓存时间，单位为小时，默认 168 小时，取值范围为 (0, 8760]</span></li><li>
</li><li><span class="hljs-comment">##### log section #####</span></li><li><span class="hljs-attr">logs_path:</span> <span class="hljs-string">./logs</span>                <span class="hljs-comment"># 日志路径，不配置默认为 &lt;deploy_root&gt;/logs</span></li><li>
</li><li><span class="hljs-comment">##### log level section #####</span></li><li><span class="hljs-comment"># 日志级别: 级别由低到高分别是 all、trace、debug、info、warn、error、fatal、mark、off</span></li><li><span class="hljs-comment"># run，operate 和 access 不配置或者配置错误，默认为 info</span></li><li><span class="hljs-attr">loglevel_run:</span> <span class="hljs-string">info</span></li><li><span class="hljs-attr">loglevel_operate:</span> <span class="hljs-string">info</span></li><li><span class="hljs-attr">loglevel_access:</span> <span class="hljs-string">info</span></li><li>
</li><li><span class="hljs-comment">##### auth plugin section #####</span></li><li><span class="hljs-comment"># 可选项，自定义认证插件配置</span></li><li><span class="hljs-comment">#auth_plugin:</span></li><li><span class="hljs-comment">#  name: CustomAuth              # 认证插件的名字</span></li><li><span class="hljs-comment">#  path: plugins/CustomAuth.js   # 插件的绝对路径或者相对于ohpm-repo软件包的路径，建议将插件放在软件包的plugins目录下</span></li><li>
</li><li><span class="hljs-comment">##### fieldCheck plugin section #####</span></li><li><span class="hljs-comment"># 可选项，自定义元数据规则检验插件配置</span></li><li><span class="hljs-comment">#field_check_plugin:</span></li><li><span class="hljs-comment">#  config_file_path:  plugins/fieldCheckPlugin/CustomExtensionValidationConfig.json  # 字段校验配置文件的绝对路径或者相对于ohpm-repo软件包的路径，建议将文件放在软件包的plugins/fieldCheckPlugin目录下</span></li><li><span class="hljs-comment">#  check_func_dir: plugins/fieldCheckPlugin                                          # 字段校验函数文件所在目录的绝对路径或者相对于ohpm-repo软件包的路径，建议将目录设置为plugins/fieldCheckPlugin文件夹</span></li><li>
</li><li><span class=""><span><span class="hljs-comment">##### content check plugin #####</span></span></span></li><li><span class=""><span><span class="hljs-comment"># </span></span><span><span class="hljs-comment">可选项，包内容规则检测插件配置</span></span></span></li><li><span class=""><span><span class="hljs-comment">#content_check_plugin:</span></span></span></li><li><span class=""><span>  <span class="hljs-comment"># </span></span><span><span class="hljs-comment">该校验要求环境变量中有</span></span><span><span class="hljs-comment">ark_disasm</span></span><span><span class="hljs-comment">可执行文件</span></span><span><span class="hljs-comment">、tar</span></span><span><span class="hljs-comment">命令行工具</span></span></span></li><li><span class="">  <span><span class="hljs-comment"># </span></span><span><span class="hljs-comment">检查范围：上架的字节码</span></span><span><span class="hljs-comment">har</span></span><span><span class="hljs-comment">、</span></span><span><span class="hljs-comment">hsp</span></span></span></li><li><span class=""><span><span class="hljs-comment">#  name: 'OHMUrlCheck'</span></span></span></li><li>
</li><li><span class="hljs-comment">##### compatibleSdkVersion等兼容性字段检测日志等级 #####</span></li><li><span class="hljs-comment"># 可选值：close、info、warn、error，默认：warn</span></li><li><span class="hljs-attr">compability_log_level:</span> <span class="hljs-string">warn</span></li><li>
</li><li><span class="hljs-comment">##### 是否允许下架被其他组件依赖的包 #####</span></li><li><span class="hljs-comment"># 可选项:true,false, 默认：false</span></li><li><span class="hljs-attr">allow_remove_depended_packages:</span> <span class="hljs-literal">false</span></li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="zh-cn_topic_0000001745376470_配置项说明">配置项说明<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745376470_配置项说明" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="zh-cn_topic_0000001745376470_listen" class="firsth2">listen<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745376470_listen" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p931122970171146">格式为三段式，即&lt;proto&gt;://&lt;host&gt;:&lt;port&gt;，其中&lt;proto&gt;可以不填，默认为http，如：</p> <ul id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_ul2146096967171146"><li id="zh-cn_topic_0000001745376470_li1944056354171146"><p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p1721149795171146">监听本机回环地址（默认）：</p> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_screen10403576171146" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">listen:</span> <span class="hljs-string">localhost:8088</span></li><li><span class="hljs-comment"># 或 listen: http://localhost:8088</span></li></ol></pre></div></div> </li><li id="li146761718065"><p id="ZH-CN_TOPIC_0000002478173752__p56769181966">监听具体地址（建议）：</p> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__screen867614181667" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">listen:</span> <span class="hljs-string">https://&lt;ohpm-repo部署机器ip&gt;:8088</span></li></ol></pre></div></div> </li><li id="zh-cn_topic_0000001745376470_li679305661171146"><p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p225240343171146">监听所有地址（当选择监听所有地址时，配置项<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_store">store</a>中server值必须配置）：</p> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_screen1533191518171146" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">listen:</span> <span class="hljs-number">0.0</span><span class="hljs-number">.0</span><span class="hljs-number">.0</span><span class="hljs-string">:8088</span></li><li><span class="hljs-comment"># 或 listen: http://0.0.0.0:8088</span></li></ol></pre></div></div> </li></ul> </div> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p11190141817511">listen值建议监听具体的地址。proto支持http和https协议，支持缺省，缺省时默认为http。为了确保ohpm-repo链接的安全，建议选择使用https协议，如果配置为https协议，则需要完善<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_https">https</a>相关配置。</p> </div></div></div> <div class="tiledSection"><h3 id="zh-cn_topic_0000001745376470_https">https<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745376470_https" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p91959977171146">当配置<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_listen">listen</a>时选择使用https协议，则需要配置https_key和https_cert：</p> <ul id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_ul772166977171146"><li id="zh-cn_topic_0000001745376470_li582622505171146">https_key：ssl证书私钥文件。</li><li id="zh-cn_topic_0000001745376470_li1757940467171146">https_cert：ssl证书文件。</li></ul> <p id="ZH-CN_TOPIC_0000002478173752__p179811448172612">参考配置如下：</p> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__screen14981174832615" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">https_key:</span> <span class="hljs-string">./ssl/server.key</span></li><li><span class="hljs-attr">https_cert:</span> <span class="hljs-string">./ssl/server.crt</span></li></ol></pre></div></div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002478173752__p123141053102219">生产环境必须使用受信任CA颁发的证书，避免因使用自签名证书导致浏览器安全警告。</p> </div></div></div> </div> <div class="tiledSection"><h3 id="zh-cn_topic_0000001745376470_deploy_root">deploy_root<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745376470_deploy_root" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p18783151618351">ohpm-repo的部署目录，存储运行时生成的文件数据。</p> <ul id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_ul551375944171146"><li id="zh-cn_topic_0000001745376470_li815866884171146"><p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p755664544171146">如果&lt;deploy_root&gt;字段为空，则默认路径为：</p> <p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p232044450171146">windows系统: ~/AppData/Roaming/Huawei/ohpm-repo</p> <p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p1392554495171146">其他操作系统：~/ohpm-repo</p> </li><li id="zh-cn_topic_0000001745376470_li44670867171146"><p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p1916061673171146">如果&lt;deploy_root&gt;字段不为空，则路径必须为<strong>绝对路径</strong>，且路径所指向文件夹<strong>必须存在</strong>。</p> </li><li id="li1871916336574">该路径不允许配置为ohpm-repo安装包解压根目录。</li></ul> <p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p1217181035171146">参考配置如下：</p> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_screen1008726029171146" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">deploy_root:</span> <span class="hljs-string">''</span></li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="zh-cn_topic_0000001745376470_server">server<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745376470_server" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p1069388108171146">服务相关配置，具体为：</p> <ul id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_ul477748552171146"><li id="zh-cn_topic_0000001745376470_li1561067242171146"><strong>max_package_size</strong>: 上传包大小限制，单位为MB， 不配置或配置为0取默认值500MB，取值范围为 (0, 500] 。</li><li id="zh-cn_topic_0000001745376470_li1995977348171146"><strong>max_extract_size</strong>: 压缩包解压后大小限制，单位为MB，不配置或配置为0取默认值800MB。</li><li id="zh-cn_topic_0000001745376470_li1474744806171146"><strong>max_extract_file_num</strong>: 压缩包解压后文件个数限制，不配置或配置为0取默认值30000个。</li><li id="zh-cn_topic_0000001745376470_li470692050171146"><strong>user_rate_limit</strong>: 用户访问频率控制，单位为次/秒，不配置或配置为0取默认值100 次/秒，取值范围为 (0, 10000]。</li><li id="zh-cn_topic_0000001745376470_li1051886481171146"><strong>fetch_timeout</strong>: 当使用<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_uplink">uplink</a>时，请求uplink数据的请求/响应超时时间，单位为秒，不配置或配置为0取默认值60秒，取值范围为 (0, 3600]。</li><li id="zh-cn_topic_0000001745376470_li1327680403171146"><strong>keep_alive_timeout</strong>: TCP 保持连接的超时时间，单位为秒，不配置或配置为0取默认值60秒，取值范围为 (0, 3600]。</li><li id="zh-cn_topic_0000001745376470_li2063989074171146"><strong>api_timeout</strong>: 接口请求与响应超时时间，单位为秒，不配置或配置为0取默认值60秒，取值范围(0, 3600]。</li><li id="li713919426367"><strong>upload_api_timeout</strong>: 上传三方包接口请求与响应超时时间，单位为秒，不配置或配置为0取默认值300秒，取值范围(0, 3600]。</li><li id="zh-cn_topic_0000001745376470_li1173172126171146"><strong>upload_lock_hour</strong>: 下架某个三方包所有版本后，限时禁止同名三方包上传，单位为小时，不配置或配置为0取默认值24小时，取值范围为 (0, 168]。</li><li id="zh-cn_topic_0000001745376470_li1809840992171146"><strong>upload_max_times</strong>: 单用户24小时内上传次数限制，不配置或配置为0取默认值100次，取值范围为 (0, 100000]。</li><li id="li38847353322"><strong>operation_log_retention</strong>：数据库中操作日志保留时间，单位是天，不配置或配置为0取默认值100天。</li></ul> <p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p774033047171146">参考配置如下：</p> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_screen26709028171146" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">max_package_size:</span> <span class="hljs-number">500</span></li><li><span class="hljs-attr">max_extract_size:</span> <span class="hljs-number">800</span></li><li><span class="hljs-attr">max_extract_file_num:</span> <span class="hljs-number">30000</span></li><li><span class="hljs-attr">user_rate_limit:</span> <span class="hljs-number">100</span></li><li><span class="hljs-attr">fetch_timeout:</span> <span class="hljs-number">60</span></li><li><span class="hljs-attr">keep_alive_timeout:</span> <span class="hljs-number">60</span></li><li><span class="hljs-attr">api_timeout:</span> <span class="hljs-number">60</span></li><li><span class="hljs-attr">upload_api_timeout:</span> <span class="hljs-number">300</span></li><li><span class="hljs-attr">upload_lock_hour:</span> <span class="hljs-number">24</span></li><li><span class="hljs-attr">upload_max_times:</span> <span class="hljs-number">100</span></li><li><span class="hljs-attr">operation_log_retention:</span> <span class="hljs-number">100</span>   </li></ol></pre></div></div> </div> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p id="ZH-CN_TOPIC_0000002478173752__p14768122714416">db是元数据存储的配置项，store是文件存储的配置项。db支持fileDB本地存储和mysql数据库存储；store支持file storage存储，sftp存储和custom storage 自定义插件存储。db和store不能随意搭配，需要符合表1的匹配规范：</p> </div></div></div>  <div class="tablenoborder"><div class="tbBox"><table id="table7377205612280" class="layoutFixed idpTab"><caption><b>表1 </b>db配置项与store配置项的搭配选择</caption><thead><tr id="ZH-CN_TOPIC_0000002478173752__row237775662812"><th align="left" class="cellrowborder" id="mcps1.3.11.2.3.1.1" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002478173752__p17481841105618">db：元数据存储</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.11.2.3.1.2" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002478173752__p1048114116564"><strong>与db所适配的store：三方包文件存储</strong></p> </th> </tr> </thead> <tbody><tr id="ZH-CN_TOPIC_0000002478173752__row1037855611281"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002478173752__p134811417564">filedb</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002478173752__p1481154111567">file storage</p> </td> </tr> <tr id="ZH-CN_TOPIC_0000002478173752__row1378756172816"><td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002478173752__p19481741165612">mysql(ohpm-repo 1.1.0开始支持）</p> </td> <td class="cellrowborder" valign="top" width="50%"><p id="ZH-CN_TOPIC_0000002478173752__p24812417564">file storage，sftp storage(ohpm-repo 1.1.0开始支持），custom storage(ohpm-repo 2.2.0开始支持）</p> </td> </tr>  </tbody></table></div> </div> <div class="tiledSection"><h3 id="zh-cn_topic_0000001745376470_db">db<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745376470_db" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p433590769171146">ohpm-repo运行过程产生的用户信息，运行状态等元数据存储配置，支持本地磁盘存储filedb和mysql数据库存储。</p> </div> <p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p384540046171146"><strong>本地磁盘存储</strong></p> <p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p1120504125171146">默认使用本地磁盘存储，配置如下：</p> <ul id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_ul1829572517171146"><li id="zh-cn_topic_0000001745376470_li1797516542171146">type: 存储插件名称，为filedb。</li><li id="zh-cn_topic_0000001745376470_li1208591692171146">config: 插件配置，具体为：<ul id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_ul1543294840171146"><li id="zh-cn_topic_0000001745376470_li372869818171146">path: 数据库文件存储地址，默认值为./db，支持相对和绝对路径配置，当配置为相对路径时，则以<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_关于-deploy_root">deploy_root</a>为根目录。</li></ul> </li></ul> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p id="ZH-CN_TOPIC_0000002478173752__p13250142935210">如果想修改数据库文件存储路径同时保留旧的数据，则需要把旧路径下的数据文件迁移至新路径。</p> </div></div></div> <p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p1887921559171146">参考配置如下：</p> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_screen310166463171146" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">db:</span>                </li><li>  <span class="hljs-attr">type:</span> <span class="hljs-string">filedb</span>     </li><li>  <span class="hljs-attr">config:</span></li><li>    <span class="hljs-attr">path:</span> <span class="hljs-string">./db</span>     </li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p95171522201013"></p> <p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p2057571770171146"><strong>Mysql存储</strong></p> <ul id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_ul1159195053171146"><li id="zh-cn_topic_0000001745376470_li1552633682171146"><a name="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_li1552633682171146"></a><a name="zh-cn_topic_0000001745376470_li1552633682171146"></a>type: 插件名称，配置为mysql。</li><li id="zh-cn_topic_0000001745376470_li1377775477171146">config: 插件配置，具体为：<ul id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_ul127784455171146"><li id="zh-cn_topic_0000001745376470_li53645056171146">host: 数据库主机地址。</li><li id="zh-cn_topic_0000001745376470_li1025901731171146">port: 数据库端口。</li><li id="zh-cn_topic_0000001745376470_li1702363664171146">username: 数据库的用户名。</li><li id="zh-cn_topic_0000001745376470_li1521344984171146">password: 数据库的用户密码（请配置明文, 最终在部署目录中会转换为密文）。</li><li id="zh-cn_topic_0000001745376470_li1690557596171146">database: 数据库名。</li></ul> </li></ul> <p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p1933504320171146">参考配置如下：</p> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_screen1795155211171146" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">db:</span>                         </li><li>  <span class="hljs-attr">type:</span> <span class="hljs-string">mysql</span></li><li>  <span class="hljs-attr">config:</span></li><li>    <span class="hljs-attr">host:</span> <span class="hljs-string">"localhost"</span></li><li>    <span class="hljs-attr">port:</span> <span class="hljs-number">3306</span></li><li>    <span class="hljs-attr">username:</span> <span class="hljs-string">"tctAdmin"</span></li><li>    <span class="hljs-attr">password:</span> <span class="hljs-string">"password"</span></li><li>    <span class="hljs-attr">database:</span> <span class="hljs-string">"repo"</span></li></ol></pre></div></div> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p id="ZH-CN_TOPIC_0000002478173752__p15806919685">为了避免潜在的安全风险，建议使用非最高权限的数据库账户进行连接。</p> </div></div></div> <div class="tiledSection"><h3 id="zh-cn_topic_0000001745376470_store">store<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745376470_store" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p1931651962171146">三方库及其元数据等资源文件存储配置，支持本地磁盘存储，sftp存储和自定义插件存储。</p> </div> <p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p271907306171146"><strong>本地磁盘存储</strong></p> <p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p1060586775171146">默认使用本地磁盘存储文件，具体配置为：</p> <ul id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_ul565638337171146"><li id="zh-cn_topic_0000001745376470_li1207981853171146">type: 插件名称，为fs。</li><li id="zh-cn_topic_0000001745376470_li382253706171146">config: 插件配置，具体为：<ul id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_ul838390529171146"><li id="zh-cn_topic_0000001745376470_li782965506171146">path: 存储根目录路径，默认为./storage，支持相对和绝对路径配置，当配置为相对路径时，则以<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_关于-deploy_root">deploy_root</a>为根目录。</li><li id="zh-cn_topic_0000001745376470_li922300957171146"><a name="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_li922300957171146"></a><a name="zh-cn_topic_0000001745376470_li922300957171146"></a>server: 仓库内容的下载地址，当<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_listen">listen</a>的host为0.0.0.0且本机存在多个网络接口时，<strong>必须配置</strong>。<ul id="ZH-CN_TOPIC_0000002478173752__ul142881818153816"><li id="li14969195681913">server的格式如下：&lt;<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_listen">listen</a>的proto&gt;://&lt;host&gt;:&lt;<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_listen">listen</a>的port&gt;；</li><li id="li18288151883819">当配置项<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_listen">listen</a>的host不为0.0.0.0时，则server<strong>默认</strong>取listen的完整格式，例如listen为127.0.0.1:8088，故server默认值为http://127.0.0.1:8088；</li><li id="li1528831819381">当配置项<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_listen">listen</a>的host为0.0.0.0时，如果本机仅存在一个网络接口，则server中的host默认为本机网络接口的ipv4地址；如果本机存在多个网络接口，则server中的host默认为本机获取到的第一个网络接口的ipv4地址，建议手动修改host为指定的本机ip/域名，例如listen为0.0.0.0:8088，故server需配置为http://&lt;本机ip/域名&gt;:8088；</li><li id="li1128831818389"><a name="ZH-CN_TOPIC_0000002478173752__li1128831818389"></a><a name="li1128831818389"></a>如果需要通过反向代理来访问ohpm-repo服务，则该字段须配置为反向代理服务器的域名地址，且需要配置<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#section1074004784011">use_reverse_proxy</a>值为true。</li></ul> </li></ul> </li></ul> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p486014015261">上传资源后如若要修改存储路径，则需要把旧路径下的数据迁移至新路径中。</p> </div></div></div> <p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p303238708171146">参考配置如下：</p> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_screen1532525701171146" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">store:</span></li><li>  <span class="hljs-attr">type:</span> <span class="hljs-string">fs</span></li><li>  <span class="hljs-attr">config:</span></li><li>    <span class="hljs-attr">path:</span> <span class="hljs-string">./storage</span></li><li>    <span class="hljs-comment">#server: http://localhost:8088</span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002478173752__p1158054145915"></p> <p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p1545234170171146"><strong>sftp 存储</strong></p> <p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p152875321268">支持使用sftp存储文件，仅当数据存储为mysql存储时才能使用sftp存储，具体配置为：</p> <ul id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_ul2125474251171146"><li id="zh-cn_topic_0000001745376470_li1431492430171146">type: 插件名称，其名称为sftp。</li><li id="zh-cn_topic_0000001745376470_li673739519171146">config: 插件配置。<ul id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_ul1070563927171146"><li id="zh-cn_topic_0000001745376470_li1940880991171146">location: 支持配置最多3个sftp服务，必须用yaml的数组形式写法，详细配置如下；<ul id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_ul1107326151171146"><li id="zh-cn_topic_0000001745376470_li145616132171146">name: sftp服务名，名字不能与其他sftp配置重复。</li><li id="zh-cn_topic_0000001745376470_li2100477840171146">host: sftp服务主机地址。</li><li id="zh-cn_topic_0000001745376470_li1688241697171146">port：sftp服务端口。</li><li id="zh-cn_topic_0000001745376470_li1187339125171146">read_username：有读权限的用户名。</li><li id="zh-cn_topic_0000001745376470_li2107038783171146">read_password：有读权限的用户密码（请配置明文, 最终在部署目录中会转换为密文)。</li><li id="zh-cn_topic_0000001745376470_li632982831171146">write_username：有写权限的用户名。</li><li id="zh-cn_topic_0000001745376470_li1845843311171146">write_password：有写权限的用户密码（请配置明文, 最终在部署目录中会转换为密文)。</li><li id="zh-cn_topic_0000001745376470_li1275312401171146"><a name="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_li1275312401171146"></a><a name="zh-cn_topic_0000001745376470_li1275312401171146"></a>path：相对 sftp 根目录的文件路径，仅限/开头，且路径所指向的文件夹必须存在。</li></ul> </li><li id="zh-cn_topic_0000001745376470_li635916564171146">server: 仓库内容的下载地址，当<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_listen">listen</a>的host为0.0.0.0且本机存在多个网络接口时，<strong>必须配置</strong>。<ul id="ZH-CN_TOPIC_0000002478173752__ul259571182619"><li id="li559551142616">server的格式如下：&lt;<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_listen">listen</a>的proto&gt;://&lt;host&gt;:&lt;<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_listen">listen</a>的port&gt;</li><li id="li3595101172614">当配置项<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_listen">listen</a>的host不为0.0.0.0时，则server<strong>默认</strong>取listen的完整格式，例如listen为127.0.0.1:8088，故server默认值为 http://127.0.0.1:8088；</li><li id="li75957119264">当配置项<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_listen">listen</a>的host为0.0.0.0时，如果本机仅存在一个网络接口，则server中的host默认为本机网络接口的ipv4地址；如果本机存在多个网络接口，则server中的host默认为本机获取到的第一个网络接口的ipv4地址，建议手动修改host为指定的本机ip/域名，例如listen为0.0.0.0:8088，故server需配置为http://&lt;本机ip/域名&gt;:8088；</li><li id="li145961511112619">如果需要通过反向代理来访问ohpm-repo服务，则该字段须配置为反向代理服务器的域名地址，且需要配置<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#section1074004784011">use_reverse_proxy</a>值为true。</li></ul> </li></ul> </li></ul> <p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p137356635171146">参考配置如下：</p> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_screen1830714194171146" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">store:</span>                               </li><li>  <span class="hljs-attr">type:</span> <span class="hljs-string">sftp</span>                         </li><li>  <span class="hljs-attr">config:</span></li><li>    <span class="hljs-attr">location:</span></li><li>      <span class="hljs-bullet">-</span> </li><li>        <span class="hljs-attr">name:</span> <span class="hljs-string">test_one_sftp</span>          </li><li>        <span class="hljs-attr">host:</span> <span class="hljs-string">"localhost"</span>           </li><li>        <span class="hljs-attr">port:</span> <span class="hljs-number">22</span>                     </li><li>        <span class="hljs-attr">read_username:</span> <span class="hljs-string">"read"</span>   </li><li>        <span class="hljs-attr">read_password:</span> <span class="hljs-string">"password"</span> </li><li>        <span class="hljs-attr">write_username:</span> <span class="hljs-string">"write"</span>   </li><li>        <span class="hljs-attr">write_password:</span> <span class="hljs-string">"password"</span> </li><li>        <span class="hljs-attr">path:</span> <span class="hljs-string">/source22</span></li><li>      <span class="hljs-bullet">-</span></li><li>        <span class="hljs-attr">name:</span> <span class="hljs-string">test_two_sftp</span></li><li>        <span class="hljs-attr">host:</span> <span class="hljs-string">"localhost"</span></li><li>        <span class="hljs-attr">port:</span> <span class="hljs-number">24</span></li><li>        <span class="hljs-attr">read_username:</span> <span class="hljs-string">"read"</span></li><li>        <span class="hljs-attr">read_password:</span> <span class="hljs-string">"password"</span></li><li>        <span class="hljs-attr">write_username:</span> <span class="hljs-string">"write"</span></li><li>        <span class="hljs-attr">write_password:</span> <span class="hljs-string">"password"</span></li><li>        <span class="hljs-attr">path:</span> <span class="hljs-string">/source24</span></li><li>    <span class="hljs-comment">#server: http://localhost:8088</span></li></ol></pre></div></div> <p id="ZH-CN_TOPIC_0000002478173752__p137594975913"></p> <p id="ZH-CN_TOPIC_0000002478173752__p178391539181320"><strong>custom存储</strong></p> <p id="ZH-CN_TOPIC_0000002478173752__p82061737121310">使用自定义插件存储，具体配置为：</p> <ul id="ZH-CN_TOPIC_0000002478173752__ul16206163712134"><li id="li620610378133"><a name="ZH-CN_TOPIC_0000002478173752__li620610378133"></a><a name="li620610378133"></a>type: 插件名称，为custom。custom是自定义存储插件类型，自定义存储插件<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-storageplugin">开发流程见官方文档</a>。</li><li id="li112061537101311">config: 插件配置，具体为：<ul id="ZH-CN_TOPIC_0000002478173752__ul379919141515"><li id="li879915115152">export_name：待书写插件export的类名。</li><li id="li167452311150">plugin_path：插件的绝对路径或者相对于ohpm-repo软件包的路径，建议将插件放在软件包的plugins目录下。</li><li id="li1811167141811">custom_field：自定义字段，通过引入ohpm-repo解压包中libs/common/getStorageConfigInfo.js的getStorageConfigInfo方法获取自定义字段的值。</li><li id="li139751735171917">server: 本地仓库下载地址：<ul id="ZH-CN_TOPIC_0000002478173752__ul297513359194"><li id="li149758353193">当配置项<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_listen">listen</a>的host不为0.0.0.0时，则<strong>默认</strong>取listen的完整格式，例如listen为127.0.0.1:8088，故server默认值为http://127.0.0.1:8088；</li><li id="li17975183518192">如果配置项<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_listen">listen</a>的host为0.0.0.0，则server中的host默认为localhost，如http://localhost:8088。建议手动修改host为本机的ip/域名，例如listen为 0.0.0.0:8088，故server需配置为http://&lt;本机ip/域名&gt;:8088；</li><li id="li2975143541914">如果需要通过反向代理来访问ohpm-repo服务，则该字段须配置为反向代理服务器的域名地址。多实例部署ohpm-repo时必须配置反向代理服务器，且需要配置<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#section1074004784011">use_reverse_proxy</a>值为true。</li></ul> </li></ul> </li></ul> <p id="ZH-CN_TOPIC_0000002478173752__p77741655102012">参考配置如下：</p> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__screen732416183213" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">store:</span></li><li>  <span class="hljs-attr">type:</span> <span class="hljs-string">custom</span>                                            </li><li>  <span class="hljs-attr">config:</span></li><li>    <span class="hljs-attr">export_name:</span> <span class="hljs-string">"MyStorage"</span>                              </li><li>    <span class="hljs-attr">plugin_path:</span> <span class="hljs-string">"plugins/storagePlugin/MyStorage.js"</span>        </li><li>    <span class="hljs-attr">custom_field:</span> <span class="hljs-string">"test"</span>                                  </li><li>    <span class="hljs-comment">#server: http://localhost:8088</span></li></ol></pre></div></div> <div class="tiledSection"><h3 id="section1074004784011">use_reverse_proxy<i class="anchor-icon anchor-icon-link" anchorid="section1074004784011" tips="复制节点链接"></i></h3></div> <ul id="ZH-CN_TOPIC_0000002478173752__ul3740247124015"><li id="li874004716406">use_reverse_proxy: 是否使用反向代理选项。可选项：true/false， 默认：false。如果使用反向代理，必须配置为true，客户端IP地址将从请求头中的x-forwarded-for字段获取。</li></ul> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__screen0740547114012" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">use_reverse_proxy:</span> <span class="hljs-literal">false</span></li></ol></pre></div></div> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p id="ZH-CN_TOPIC_0000002478173752__p654764310446">当use_reverse_proxy配置为true时，必须在反向代理配置时刷新x-forwarded-for值（如果存在多级代理，只需要在最外层代理配置刷新），如果不刷新将存在x-forwarded-for数据被篡改风险，反向代理配置刷新x-forwarded-for命令如下：</p> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__screen12249185016467" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-string">proxy_set_header</span> <span class="hljs-string">x-forwarded-for</span> <span class="hljs-string">$remote_addr</span></li></ol></pre></div></div> </div></div></div> <div class="tiledSection"><h3 id="zh-cn_topic_0000001745376470_uplink">uplink<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745376470_uplink" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_ul223581457171146"><li id="zh-cn_topic_0000001745376470_li1052982768171146">uplink_cache_path：远程包缓存路径，默认路径为./uplink，支持相对和绝对路径配置，当配置为相对路径时，则以<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_关于-deploy_root">deploy_root</a>为基准目录。</li><li id="zh-cn_topic_0000001745376470_li1046205357171146">uplink_cache_time：远程包metadata缓存时间，单位为小时，默认168小时，取值范围为(0, 8760]。</li></ul> <p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p612843848171146">参考配置如下：</p> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_screen2085808883171146" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">uplink_cache_path:</span> <span class="hljs-string">./uplink</span></li><li><span class="hljs-attr">uplink_cache_time:</span> <span class="hljs-number">168</span></li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="zh-cn_topic_0000001745376470_logs">logs<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745376470_logs" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_ul91563906171146"><li id="zh-cn_topic_0000001745376470_li1697068025171146">logs_path: 日志存储，默认路径为./logs，支持相对路径和绝对路径配置，当配置为相对路径时，以<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_关于-deploy_root">deploy_root</a>为基准目录。</li></ul> <p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p2091826698171146">参考配置如下：</p> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_screen42718015171146" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">logs_path:</span> <span class="hljs-string">./logs</span> </li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="zh-cn_topic_0000001745376470_loglevel">loglevel<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745376470_loglevel" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p506940283171146">loglevel自定义配置，具体配置为：</p> <ul id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_ul862635382171146"><li id="zh-cn_topic_0000001745376470_li1264425510171146">loglevel_run：run日志文件的存储级别，默认级别为info，输出的日志信息级别高于设定的日志级别才会存储到run日志文件中。</li><li id="zh-cn_topic_0000001745376470_li826439443171146">loglevel_operate：operate日志文件的存储级别，默认级别为info，输出的日志信息级别高于设定的日志级别才会存储到operate日志文件中。</li><li id="zh-cn_topic_0000001745376470_li1387858429171146">loglevel_access：access日志文件的存储级别，默认级别为info，输出的日志信息级别高于设定的日志级别才会存储到access日志文件中。</li></ul> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_ul147489268291"><li id="zh-cn_topic_0000001745376470_li1874811261299">日志级别由低到高分别是all、trace、debug、info、warn、error、fatal、mark 和 off。</li><li id="zh-cn_topic_0000001745376470_li1274842619294">run、operate和access，日志级别不配置或者配置错误，默认为info。</li></ul> </div></div></div> <p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p920974313171146">参考配置如下：</p> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_screen1822662296171146" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">loglevel_run:</span> <span class="hljs-string">info</span></li><li><span class="hljs-attr">loglevel_operate:</span> <span class="hljs-string">info</span></li><li><span class="hljs-attr">loglevel_access:</span> <span class="hljs-string">info</span></li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="section1529975104417">auth_plugin<i class="anchor-icon anchor-icon-link" anchorid="section1529975104417" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002478173752__p122971047114820">ohpm-repo从2.3.0版本开始支持自定义认证插件（需配套使用1.8.0及以上版本ohpm命令行工具），允许您开发定制化的认证插件来对接您自己的用户信息系统。自定义认证插件开发流程见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-custom-auth-plugin">认证插件说明文档</a>。</p> <p id="ZH-CN_TOPIC_0000002478173752__p1727625917477">参数说明：</p> <ul id="ZH-CN_TOPIC_0000002478173752__ul7652028164616"><li id="li86532815462">name: 插件名称，自定义插件文件CustomAuth.js中定义的实现类名称，如果实现类为CustomAuth，故此处值为：CustomAuth 。</li><li id="li56517288467">path: 编译后插件文件CustomAuth.js的存储位置。支持绝对路径和相对路径，相对路径的基准为ohpm-repo解压根目录。</li></ul> <p id="ZH-CN_TOPIC_0000002478173752__p108611740164611">参考配置如下（默认不开启）：</p> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__screen152987583464" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">#auth_plugin:</span></li><li><span class="hljs-comment">#  name: CustomAuth              </span></li><li><span class="hljs-comment">#  path: plugins/CustomAuth.js   </span></li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="section102113555913">field_check_plugin<i class="anchor-icon anchor-icon-link" anchorid="section102113555913" tips="复制节点链接"></i></h3><p id="ZH-CN_TOPIC_0000002478173752__p16243575918">ohpm-repo从5.1.3版本开始支持自定义元数据规则校验，可以对oh-package.json5中部分字段开发定制化的校验规则。自定义元数据规则校验插件开发流程见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-custom-metadata-rule-validation-config">自定义元数据规则校验插件说明文档</a>。</p> <p id="ZH-CN_TOPIC_0000002478173752__p8219359594">参数说明：</p> <ul id="ZH-CN_TOPIC_0000002478173752__ul162935135913"><li id="li1128355598">config_file_path：字段校验配置文件路径，支持绝对路径和相对路径，相对路径的基准为ohpm-repo解压根目录，建议将文件存放在软件包的plugins/fieldCheckPlugin目录下，默认值为plugins/fieldCheckPlugin/CustomExtensionValidationConfig.json。</li><li id="li5243565914">check_func_dir：字段校验函数文件所在目录路径，支持绝对路径和相对路径，相对路径的基准为ohpm-repo解压根目录，建议将目录设置为plugins/fieldCheckPlugin文件夹，默认值为plugins/fieldCheckPlugin。</li></ul> <p id="ZH-CN_TOPIC_0000002478173752__p4203575919">参考配置如下（默认不开启）：</p> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__screen157064217010" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">#field_check_plugin:</span></li><li><span class="hljs-comment">#  config_file_path:  plugins/fieldCheckPlugin/CustomExtensionValidationConfig.json   </span></li><li><span class="hljs-comment">#  check_func_dir: plugins/fieldCheckPlugin                                           </span></li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="section1216516278174">content_check_plugin<i class="anchor-icon anchor-icon-link" anchorid="section1216516278174" tips="复制节点链接"></i></h3></div> <p id="ZH-CN_TOPIC_0000002478173752__p89589529373">ohpm-repo从5.2.0版本开始支持三方库字节码文件的OHMUrl版本一致性校验，可以对字节码har文件中module.abc文件中的OHMUrl的版本号与har文件中实际的版本号进行一致性校验，阻止不一致包的上传，以防止运行时崩溃。</p> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p id="ZH-CN_TOPIC_0000002478173752__p9583141342710">一致性检查将用到ark_disasm工具及系统自带的tar解压工具。ark_disasm工具位于命令行工具中，用于反编译module.abc文件，请先下载<a href="https://developer.huawei.com/consumer/cn/download/command-line-tools-for-hmos" target="_blank">命令行工具</a>，并将ark_disasm工具所在路径（默认路径为command-line-tools/sdk/default/openharmony/toolchains）及tar解压工具的所在路径添加到系统环境变量中（对于Linux/macOS系统，请将bsdtar解压工具所在路径添加到系统环境变量中）。如在上传三方库过程中发现ark_disasm导致报错，请联系管理员，确保您使用的DevEco Studio与ark_disasm工具配套。</p> </div></div></div> <p id="ZH-CN_TOPIC_0000002478173752__p856610107274">参数说明：</p> <ul id="ZH-CN_TOPIC_0000002478173752__ul899512016276"><li id="li49951420172720">name：固定为"OHMUrlCheck"</li></ul> <p id="ZH-CN_TOPIC_0000002478173752__p172631415112812">参考配置如下（默认不开启）：</p> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__screen1026321515280" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">#content_check_plugin:</span></li><li><span class="hljs-comment">#  name: 'OHMUrlCheck'     </span></li></ol></pre></div></div> <div class="tiledSection"><h3 id="section77641227123">compability_log_level<i class="anchor-icon anchor-icon-link" anchorid="section77641227123" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002478173752__ul15764422151218"><li id="li13764172216126">compability_log_level: compatibleSdkVersion等兼容性字段检测日志等级，可选值：close、info、warn、error，默认为warn，参考配置如下：</li></ul> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__screen2076452218122" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">compability_log_level:</span> <span class="hljs-string">warn</span></li></ol></pre></div></div> </div> <div class="tiledSection"><h3 id="section118451636181612">allow_remove_depended_packages<i class="anchor-icon anchor-icon-link" anchorid="section118451636181612" tips="复制节点链接"></i></h3><ul id="ZH-CN_TOPIC_0000002478173752__ul68451736161616"><li id="li1684583619165">allow_remove_depended_packages: 是否允许下架被其他组件依赖的包，可选项：true，false，默认为false，参考配置如下：</li></ul> <div _ngcontent-bpb-c106="" class="highlight-div"><div _ngcontent-bpb-c106="" class="highlight-div-header"><div _ngcontent-bpb-c106="" class="highlight-div-header-left"><div _ngcontent-bpb-c106="" class="handle-button expand-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-bpb-c106="" class="highlight-div-header-right"><div _ngcontent-bpb-c106="" class="handle-button ai-button"></div><div _ngcontent-bpb-c106="" class="handle-button line-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-bpb-c106="" class="handle-button theme-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-bpb-c106="" class="handle-button copy-button"><div _ngcontent-bpb-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-bpb-c106="" class="highlight-scroll-div"><pre class="yaml prettyprint linenums hljs language-yaml" id="ZH-CN_TOPIC_0000002478173752__screen2084518364166" hw-language="yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-attr">allow_remove_depended_packages:</span> <span class="hljs-literal">false</span></li></ol></pre></div></div> </div> <div class="tiledSection"><h2 id="zh-cn_topic_0000001745376470_关于-deploy_root">关于 deploy_root<i class="anchor-icon anchor-icon-link" anchorid="zh-cn_topic_0000001745376470_关于-deploy_root" tips="复制节点链接"></i></h2><p id="ZH-CN_TOPIC_0000002478173752__zh-cn_topic_0000001745376470_p1163530817171146">deploy_root为ohpm-repo的部署目录，通过配置文件中字段&lt;<a href="/consumer/cn/doc/harmonyos-guides/ide-ohpm-repo-configuration#zh-cn_topic_0000001745376470_deploy_root">deploy_root</a>&gt;可进行配置。</p> </div> </div> <div></div></div>