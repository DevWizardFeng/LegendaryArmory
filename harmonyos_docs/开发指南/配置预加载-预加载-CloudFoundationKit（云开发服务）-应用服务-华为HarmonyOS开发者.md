<h1 _ngcontent-qcl-c119="" class="doc-title ng-star-inserted" title="配置预加载"> 配置预加载 </h1>

<div _ngcontent-qcl-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>安装预加载和周期性预加载需分别进行配置，且两者均可通过云函数和开发者服务器（即HTTPS请求）两种数据来源方式来实现。</p> <p>对于不同类型的开发者，支持的数据来源方式有所不同：</p> <ul><li>个人开发者：数据来源默认选择云函数，且仅支持通过云函数来实现预加载。需要开通云函数服务并创建函数才可以配置。</li><li>非个人开发者：数据来源支持云函数和开发者服务器两种。可根据实际需要进行选择。</li></ul> <p>下文介绍如何配置两种数据来源方式的预加载实现。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>当前“开发者服务器”数据来源方式仅对外受限开放，如有需求，请发送邮件申请开通，华为方收到邮件后，将在1~3个工作日内安排对接人员并邮件回复。</p> <p>邮件格式要求如下：</p> <ul><li>邮箱地址：<a href="mailto:agconnect@huawei.com" target="_blank">agconnect@huawei.com</a></li><li>邮件标题：【预加载】【申请开通开发者服务器权限】</li></ul> <ul><li>邮件内容： 需包含Developer ID、项目ID、应用ID、预加载使用场景。其中，Developer ID等信息查询方法请参见<a href="https://developer.huawei.com/consumer/cn/doc/app/agc-help-view-app-info-0000002282674569" target="_blank">查看应用信息</a>。</li></ul> </div></div></div> <div class="tiledSection"><h2 id="section33413593423">数据来源为云函数<i class="anchor-icon anchor-icon-link" anchorid="section33413593423" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section119091837174513" class="firsth2">前提条件<i class="anchor-icon anchor-icon-link" anchorid="section119091837174513" tips="复制节点链接"></i></h3><ul><li>已<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cloudfoundation-enable-prefetch">开通预加载服务</a>。</li><li>已<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cloudfoundation-create-and-config-function">创建函数</a>。</li></ul> </div> <div class="tiledSection"><h3 id="section1716541834614">绑定云函数<i class="anchor-icon anchor-icon-link" anchorid="section1716541834614" tips="复制节点链接"></i></h3><ol><li id="zh-cn_topic_0000002166964980_zh-cn_topic_0000002131919472_zh-cn_topic_0000001658990478_li56180274343">登录<a href="https://developer.huawei.com/consumer/cn/service/josp/agc/index.html" target="_blank">AppGallery Connect</a>，点击“开发与服务”。</li><li id="zh-cn_topic_0000002166964980_zh-cn_topic_0000002131919472_zh-cn_topic_0000001658990478_li55644519413"><p id="ZH-CN_TOPIC_0000002474174405__zh-cn_topic_0000002166964980_zh-cn_topic_0000002131919472_zh-cn_topic_0000001658990478_p1656184584117">在项目列表中点击您的项目，在项目下的应用列表中选择需要配置预加载的HarmonyOS应用/元服务。</p> </li><li>在左侧导航栏选择“云开发（Serverless）&gt; 预加载”，进入预加载页面。<p><span><img originheight="639" originwidth="1196" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114555.09798824541970292210570390185939:50001231000000:2800:128864A0CBDD5D3EDF7B022A10F7A644868F5F229B9ECA653067B08A90D04FD4.png" width="920" height="491.53846153846155"></span></p> </li><li id="zh-cn_topic_0000002166964980_zh-cn_topic_0000002131919472_li2842728132811">根据实际需要，在“周期性预加载”或者“安装预加载”区域，“数据来源”选择“云函数”，然后点击“函数名称”后的“修改”。<p><span><img originheight="541" originwidth="720" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114555.44836503881611060432635796723367:50001231000000:2800:047172116F2F091D5C00B5EEB88C7C07C0C6C3794D1BF65D7F5CBACFF78174B6.png" width="720" height="541"></span></p> </li><li>以“周期性预加载”为例，在“函数名称”下拉框选择实现周期性预加载的函数名称。<p><span><img originheight="440" originwidth="806" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114555.02885448402309772567716598795512:50001231000000:2800:BD6BE69C29F2FC3155058E1C832FCB39BEA1A37C494D83EAE737D00A10E1B955.png" width="806" height="440"></span></p> </li><li id="zh-cn_topic_0000002166964980_zh-cn_topic_0000002131919472_li17782763116">点击“保存”完成周期性预加载配置。<p><span><img originheight="449" originwidth="806" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114555.41185770216401350297591034311681:50001231000000:2800:4AF145E79BC9392933DADB2E08C367303FD2608FEAC3157CC0169F4645CCA834.png" width="806" height="449"></span></p> </li><li>若配置“安装预加载”，重复步骤<a href="/consumer/cn/doc/harmonyos-guides/cloudfoundation-prefetch-config#zh-cn_topic_0000002166964980_zh-cn_topic_0000002131919472_li2842728132811">4</a>-<a href="/consumer/cn/doc/harmonyos-guides/cloudfoundation-prefetch-config#zh-cn_topic_0000002166964980_zh-cn_topic_0000002131919472_li17782763116">6</a>即可。</li><li>（可选）后续若需要修改绑定的云函数，点击“函数名称”后的“修改”更新即可。<p><span><img originheight="453" originwidth="806" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114555.82296017727558569580670392891120:50001231000000:2800:F7FE8DAD23A7B6038574D19FAC0AFBF26363F6468F787CBF9FB30C1D375C949E.png" width="806" height="453"></span></p> </li></ol> </div> <div class="tiledSection"><h2 id="section2354253184518">数据来源为开发者服务器<i class="anchor-icon anchor-icon-link" anchorid="section2354253184518" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section1524610516468" class="firsth2">前提条件<i class="anchor-icon anchor-icon-link" anchorid="section1524610516468" tips="复制节点链接"></i></h3><ul><li>已申请开通开发者服务器权限。</li><li>已<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cloudfoundation-enable-prefetch">开通预加载服务</a>。</li></ul> </div> <div class="tiledSection"><h3 id="section182540279228">配置服务器地址<i class="anchor-icon anchor-icon-link" anchorid="section182540279228" tips="复制节点链接"></i></h3><ol><li>登录<a href="https://developer.huawei.com/consumer/cn/service/josp/agc/index.html" target="_blank">AppGallery Connect</a>，点击“开发与服务”。</li><li><p id="ZH-CN_TOPIC_0000002474174405__zh-cn_topic_0000002474174405_zh-cn_topic_0000002166964980_zh-cn_topic_0000002131919472_zh-cn_topic_0000001658990478_p1656184584117">在项目列表中点击您的项目，在项目下的应用列表中选择需要配置预加载的HarmonyOS应用/元服务。</p> </li><li>在左侧导航栏选择“云开发（Serverless）&gt; 预加载”，进入预加载页面。<p><span><img originheight="642" originwidth="1196" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114555.50302929155722831902807108426335:50001231000000:2800:5D3D3674F6E9FA0133C3668314BA07CCF34B4CD2FCE167E56F89B30BA335749A.png" width="920" height="493.84615384615387"></span></p> </li><li id="zh-cn_topic_0000002166964980_zh-cn_topic_0000002131919472_li36291744112217">在“周期性预加载”或者“安装预加载”区域，“数据来源”选择“开发者服务器”。<p><span><img originheight="452" originwidth="806" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114555.59031037237762416544006518681807:50001231000000:2800:6F300C3ECAF47C9F155889D8A1A4018BAC75D5275525C8E5DB5E8220E038D706.png" width="806" height="452"></span></p> </li><li>点击“下载地址”后的“修改”。<p><span><img originheight="452" originwidth="806" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114555.05981526641545226076048616072452:50001231000000:2800:7B3AD5D9AC819C0063BED5D06F18DBF15511E8BBB1D49AC268BBEA0FF25A4588.png" width="806" height="452"></span></p> </li><li id="zh-cn_topic_0000002166964980_zh-cn_topic_0000002131919472_li41341137143420">以“周期性预加载”为例，“下载地址”以“https://”开头，输入框中输入服务器地址，配置完成后点击“保存”。<p>需要注意以下几点：</p> <ul><li>仅支持填写一个服务器地址，需包含预加载资源接口路径，如图中示例：prefetchData。</li><li>域名：须填写完整的域名。例如www.example.com，不可写为example.com。</li></ul> <ul><li>IP地址：须填写准确的IP地址，确保没有输入错误。</li><li>端口号：如果要指定端口号，可在服务器地址后面以冒号分隔，例如https://www.example.com:443。HTTPS协议的默认端口号（443）可以省略。</li></ul> <p><span><img originheight="449" originwidth="836" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114555.59731645416436474087372380328374:50001231000000:2800:ADA02463A400B3453A51F8AE67D8A3913ED3CEFA9AB782B82D175F4D2FBFE855.png" width="836" height="449"></span></p> <p>后续AGC会周期性地向该处配置的开发者服务器（即下载地址）发起一个HTTP GET请求，其中包含的query参数请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/cloudfoundation-prefetch-cloud-interdev#section83701164150">开发者服务器接口规范</a>，获取到数据后会将整个HTTP body缓存在本地。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ul><li>开发者服务器接口返回的数据内容需仅包含文本、图片、视频、音频等供页面展示的静态资源，不支持包含代码、脚本等动态数据。</li><li>开发者服务器接口返回的数据类型为其自定义格式的JSON或字符串数据，大小需限定在3MB以内。</li></ul> </div></div></div> </li><li>若配置“安装预加载”，重复步骤<a href="/consumer/cn/doc/harmonyos-guides/cloudfoundation-prefetch-config#zh-cn_topic_0000002166964980_zh-cn_topic_0000002131919472_li36291744112217">4</a>-<a href="/consumer/cn/doc/harmonyos-guides/cloudfoundation-prefetch-config#zh-cn_topic_0000002166964980_zh-cn_topic_0000002131919472_li41341137143420">6</a>即可。</li><li>（可选）后续若需要修改下载地址，点击“下载地址”后的“修改”更新即可。<p><span><img originheight="451" originwidth="806" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114556.71576585244176338818862038689859:50001231000000:2800:F8106493ECE6BE190334D5A15041FB98B52C41CC7D84488379BD5FE731DECC86.png" width="806" height="451"></span></p> </li></ol> </div> </div> <div></div></div>