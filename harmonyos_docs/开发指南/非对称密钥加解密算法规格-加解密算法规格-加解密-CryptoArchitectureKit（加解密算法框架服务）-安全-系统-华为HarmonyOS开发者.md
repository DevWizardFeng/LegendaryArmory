<h1 _ngcontent-jkf-c119="" class="doc-title ng-star-inserted" title="非对称密钥加解密算法规格"> 非对称密钥加解密算法规格 </h1>

<div _ngcontent-jkf-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>本章说明系统支持的算法及其规格。</p>    <p>每种算法支持的加密模式在具体规格中介绍。</p>    <div class="tiledSection">     <h2 id="rsa">RSA<i class="anchor-icon anchor-icon-link" anchorid="rsa" tips="复制节点链接"></i></h2>          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/crypto-asym-key-generation-conversion-spec#rsa">RSA</a>为非对称加密算法，加密长度需要在固定长度进行，在实际应用中，如果数据量无法达到固定的长度要求，可以通过不同的填充模式进行数据填充。</p>     <p>算法库目前提供了RSA加解密常用的三种模式。</p>     <ul>      <li>       <p><a href="/consumer/cn/doc/harmonyos-guides/crypto-asym-encrypt-decrypt-spec#填充模式为nopadding">NoPadding</a>：不带填充，输入的数据必须与RSA密钥字节长度一样长；输出数据长度与RSA密钥字节长度一样长。</p></li>      <li>       <p><a href="/consumer/cn/doc/harmonyos-guides/crypto-asym-encrypt-decrypt-spec#填充模式为pkcs1">PKCS1</a>：即RFC3447规范中的RSAES-PKCS1-V1_5模式，对应OpenSSL中的RSA_PKCS1_PADDING。</p>       <p>RSA运算时，源数据D转化为Encryption block（EB），加密时，输入数据最大长度 &lt;= RSA密钥字节长度 - 11；输出数据长度与RSA密钥字节长度相同。</p></li>      <li>       <p><a href="/consumer/cn/doc/harmonyos-guides/crypto-asym-encrypt-decrypt-spec#填充模式为pkcs1_oaep">PKCS1_OAEP</a>：即RFC3447规范中的RSAES-OAEP模式，对应OpenSSL中的RSA_PKCS1_OAEP_PADDING。</p>       <p>此模式需要设置两个摘要（md和mgf1_md），加密时，输入数据长度必须小于RSA密钥字节长度 - 2 *md摘要字节长度 - 2；输出数据长度与RSA密钥字节长度相同。</p>       <p>此模式可设置pSource字节流以定义OAEP填充的编码输入，并获取PKCS1_OAEP的相关参数。</p>       <div class="tablenoborder">        <div class="tbBox"><table class="layoutFixed idpTab">         <thead>          <tr>           <th align="left" class="cellrowborder" id="mcps1.3.3.4.3.4.1.3.1.1" valign="top" width="50%">PKCS1_OAEP的相关参数</th>           <th align="left" class="cellrowborder" id="mcps1.3.3.4.3.4.1.3.1.2" valign="top" width="50%">说明</th>          </tr>         </thead>                   <tbody><tr>           <td class="cellrowborder" valign="top" width="50%">md</td>           <td class="cellrowborder" valign="top" width="50%">摘要算法。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="50%">mgf</td>           <td class="cellrowborder" valign="top" width="50%">掩码生成算法，目前仅支持MGF1。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="50%">mgf1_md</td>           <td class="cellrowborder" valign="top" width="50%">MGF1算法中使用的摘要算法。</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="50%">pSource</td>           <td class="cellrowborder" valign="top" width="50%">字节流，用于编码输入。</td>          </tr>                 </tbody></table></div>       </div></li>      <li>       <p>以RSA2048|SHA256举例说明输入数据长度与算法之间的关系。</p>       <div class="tablenoborder">        <div class="tbBox"><table class="layoutFixed idpTab">         <thead>          <tr>           <th align="left" class="cellrowborder" id="mcps1.3.3.4.4.2.1.4.1.1" valign="top" width="33.33333333333333%">填充模式</th>           <th align="left" class="cellrowborder" id="mcps1.3.3.4.4.2.1.4.1.2" valign="top" width="33.33333333333333%">输入数据的最大字节长度</th>           <th align="left" class="cellrowborder" id="mcps1.3.3.4.4.2.1.4.1.3" valign="top" width="33.33333333333333%">输出数据的最大字节长度</th>          </tr>         </thead>                   <tbody><tr>           <td class="cellrowborder" valign="top" width="33.33333333333333%">NoPadding</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">256(RSA密钥字节长度)</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">256</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="33.33333333333333%">PKCS1</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">245(RSA密钥字节长度 - 11)</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">256</td>          </tr>          <tr>           <td class="cellrowborder" valign="top" width="33.33333333333333%">PKCS1_OAEP</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">190(RSA密钥字节长度 - 2 * md摘要字节长度 - 2)</td>           <td class="cellrowborder" valign="top" width="33.33333333333333%">256</td>          </tr>                 </tbody></table></div>       </div></li>     </ul>     <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content">       <p>使用同步接口生成RSA2048、RSA3072、RSA4096、RSA8192非对称密钥或明文长度超过2048均会增加耗时。</p>       <p>系统对主线程有时间限制，耗时较长会导致失败。建议生成大位数密钥时，使用异步接口或<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/multi-thread-concurrency-overview">使用多线程并发能力</a>。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h3 id="填充模式为nopadding" class="firsth2">填充模式为NoPadding<i class="anchor-icon anchor-icon-link" anchorid="填充模式为nopadding" tips="复制节点链接"></i></h3>          <p>以字符串参数完成RSA加解密。字符串参数由“非对称密钥类型”和“填充模式 NoPadding”使用符号“|”拼接而成，用于在创建非对称加解密实例时指定算法规格。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.4.3.1.4.1.1" valign="top" width="33.33333333333333%">非对称密钥类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.3.1.4.1.2" valign="top" width="33.33333333333333%">字符串参数</th>         <th align="left" class="cellrowborder" id="mcps1.3.4.3.1.4.1.3" valign="top" width="33.33333333333333%">API版本</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA512</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA512|NoPadding</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA768</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA768|NoPadding</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA1024</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA1024|NoPadding</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA2048</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA2048|NoPadding</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA3072</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA3072|NoPadding</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA4096</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA4096|NoPadding</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA8192</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA8192|NoPadding</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA|NoPadding</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">10+</td>        </tr>             </tbody></table></div>     </div>     <p>如表中最后一行所示，为了兼容由密钥参数生成的密钥，RSA加解密参数输入密钥类型时支持不带长度，加解密运算依据实际输入的密钥长度。</p>    </div>    <div class="tiledSection">     <h3 id="填充模式为pkcs1">填充模式为PKCS1<i class="anchor-icon anchor-icon-link" anchorid="填充模式为pkcs1" tips="复制节点链接"></i></h3>          <p>以字符串参数完成RSA加解密，具体的“字符串参数”由“非对称密钥类型”和“填充模式 PKCS1”使用符号“|”拼接而成，用于在创建非对称加解密实例时指定算法规格。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.4.1.1" valign="top" width="33.33333333333333%">非对称密钥类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.4.1.2" valign="top" width="33.33333333333333%">字符串参数</th>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.4.1.3" valign="top" width="33.33333333333333%">API版本</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA512</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA512|PKCS1</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA768</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA768|PKCS1</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA1024</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA1024|PKCS1</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA2048</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA2048|PKCS1</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA3072</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA3072|PKCS1</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA4096</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA4096|PKCS1</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA8192</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA8192|PKCS1</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">RSA|PKCS1</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">10+</td>        </tr>             </tbody></table></div>     </div>     <p>如表中最后一行所示，为了兼容由密钥参数生成的密钥，RSA加解密参数输入密钥类型时支持不带长度，加解密运算取决于实际输入的密钥长度。</p>    </div>    <div class="tiledSection">     <h3 id="填充模式为pkcs1_oaep">填充模式为PKCS1_OAEP<i class="anchor-icon anchor-icon-link" anchorid="填充模式为pkcs1_oaep" tips="复制节点链接"></i></h3>          <p>以字符串参数完成RSA加解密。字符串参数由“非对称密钥类型”、“填充模式 PKCS1_OAEP”、摘要和掩码摘要组成，使用符号“|”拼接，用于在创建非对称加解密实例时指定算法规格。</p>     <p>如表所示，各取值范围（即[]中的内容）中，只能选取一项完成字符串拼接。</p>     <p>举例说明，当需要非对称密钥类型为RSA2048、填充模式为PKCS1_OAEP、摘要算法为SHA256、掩码摘要为MGF1_SHA256的RSA密钥，其字符串参数为"RSA2048|PKCS1_OAEP|SHA256|MGF1_SHA256"。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>输入的数据必须小于RSA密钥字节长度 - md摘要长度 - mgf1_md摘要长度 - 2。比如，当RSA密钥为512位时，不支持SHA512。</p>      </div></div></div>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.6.6.1.6.1.1" valign="top" width="20%">非对称密钥类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.6.1.6.1.2" valign="top" width="20%">填充模式</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.6.1.6.1.3" valign="top" width="20%">摘要</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.6.1.6.1.4" valign="top" width="20%">掩码摘要</th>         <th align="left" class="cellrowborder" id="mcps1.3.6.6.1.6.1.5" valign="top" width="20%">API版本</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="20%">RSA512</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">MD5</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA512</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA1</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA512</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA224</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA768</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">MD5</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA768</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA1</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA768</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA224</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA768</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA256</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA1024</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">MD5</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA1024</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA1</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA1024</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA224</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA1024</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA256</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA1024</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA384</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA2048</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">MD5</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA2048</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA1</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA2048</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA224</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA2048</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA256</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA2048</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA384</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA2048</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA512</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA3072</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">MD5</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA3072</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA1</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA3072</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA224</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA3072</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA256</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA3072</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA384</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA3072</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA512</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA4096</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">MD5</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA4096</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA1</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA4096</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA224</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA4096</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA256</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA4096</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA384</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA4096</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA512</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA8192</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">MD5</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA8192</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA1</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA8192</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA224</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA8192</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA256</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA8192</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA384</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA8192</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">SHA512</td>         <td class="cellrowborder" valign="top" width="20%">[MGF1_MD5|MGF1_SHA1|MGF1_SHA224|MGF1_SHA256|MGF1_SHA384|MGF1_SHA512]</td>         <td class="cellrowborder" valign="top" width="20%">9+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="20%">RSA</td>         <td class="cellrowborder" valign="top" width="20%">PKCS1_OAEP</td>         <td class="cellrowborder" valign="top" width="20%">符合长度要求的摘要算法</td>         <td class="cellrowborder" valign="top" width="20%">MGF1_符合长度要求的摘要算法</td>         <td class="cellrowborder" valign="top" width="20%">10+</td>        </tr>             </tbody></table></div>     </div>     <p>如表中最后一行所示，为了兼容由密钥参数生成的密钥，RSA加解密参数输入密钥类型时支持不带长度。加解密运算取决于实际输入的密钥长度。</p>    </div>    <div class="tiledSection">     <h3 id="获取设置oaep填充模式的参数">获取/设置OAEP填充模式的参数<i class="anchor-icon anchor-icon-link" anchorid="获取设置oaep填充模式的参数" tips="复制节点链接"></i></h3>          <p>从API版本10开始，支持RSA使用PKCS1_OAEP填充模式时获取和设置相关参数，“√”表示支持获取或设置该参数。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.7.3.1.5.1.1" valign="top" width="25%">OAEP参数</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.3.1.5.1.2" valign="top" width="25%">枚举值</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.3.1.5.1.3" valign="top" width="25%">获取</th>         <th align="left" class="cellrowborder" id="mcps1.3.7.3.1.5.1.4" valign="top" width="25%">设置</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="25%">md</td>         <td class="cellrowborder" valign="top" width="25%">OAEP_MD_NAME_STR</td>         <td class="cellrowborder" valign="top" width="25%">√</td>         <td class="cellrowborder" valign="top" width="25%">-</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="25%">mgf</td>         <td class="cellrowborder" valign="top" width="25%">OAEP_MGF_NAME_STR</td>         <td class="cellrowborder" valign="top" width="25%">√</td>         <td class="cellrowborder" valign="top" width="25%">-</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="25%">mgf1_md</td>         <td class="cellrowborder" valign="top" width="25%">OAEP_MGF1_MD_STR</td>         <td class="cellrowborder" valign="top" width="25%">√</td>         <td class="cellrowborder" valign="top" width="25%">-</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="25%">pSource</td>         <td class="cellrowborder" valign="top" width="25%">OAEP_MGF1_PSRC_UINT8ARR</td>         <td class="cellrowborder" valign="top" width="25%">√</td>         <td class="cellrowborder" valign="top" width="25%">√</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h2 id="sm2">SM2<i class="anchor-icon anchor-icon-link" anchorid="sm2" tips="复制节点链接"></i></h2>          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/crypto-asym-key-generation-conversion-spec#sm2">SM2</a>为非对称加密算法，加密长度需要在固定长度进行。算法库目前支持以GM/T 0009-2012定义的格式加密或解密数据。</p>     <p>SM2非对称加密的结果由C1、C2、C3三部分组成。其中C1是根据生成的随机数计算出的椭圆曲线点，C2是密文数据，C3是通过指定的摘要算法计算的值。</p>     <p>当前支持以字符串参数完成SM2加解密，具体的“字符串参数”由“非对称密钥类型（加解密算法+密钥长度）”、“摘要算法”使用符号“|”拼接而成，用于在创建非对称加解密实例时，指定算法规格。</p>     <p>如表所示，各取值范围（即[]中的内容）中，只能选取一项完成字符串拼接。SM2算法和密钥长度之间采用符号“_”进行拼接。</p>     <p>举例说明，当密钥长度为256bit、摘要算法为MD5的SM2密钥，其字符串参数为"SM2_256|MD5"。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.4.1.1" valign="top" width="33.33333333333333%">非对称密钥类型</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.4.1.2" valign="top" width="33.33333333333333%">摘要算法</th>         <th align="left" class="cellrowborder" id="mcps1.3.8.7.1.4.1.3" valign="top" width="33.33333333333333%">API版本</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">SM2_256</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">[MD5|SHA1|SHA224|SHA256|SHA384|SHA512|SM3]</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">10+</td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">SM2</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">[MD5|SHA1|SHA224|SHA256|SHA384|SHA512|SM3]</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">10+</td>        </tr>             </tbody></table></div>     </div>     <p>如表中最后一行所示，为了兼容由密钥参数生成的密钥，SM2加解密参数在输入密钥类型时支持不带长度。加解密运算取决于实际输入的密钥长度。</p>    </div>    <div class="tiledSection">     <h3 id="获取sm2摘要算法参数" class="firsth2">获取SM2摘要算法参数<i class="anchor-icon anchor-icon-link" anchorid="获取sm2摘要算法参数" tips="复制节点链接"></i></h3>          <p>从API版本11开始，支持SM2获取摘要算法参数，“√”表示支持获取或设置该参数。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.9.3.1.5.1.1" valign="top" width="25%">SM2加解密参数</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.3.1.5.1.2" valign="top" width="25%">枚举值</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.3.1.5.1.3" valign="top" width="25%">获取</th>         <th align="left" class="cellrowborder" id="mcps1.3.9.3.1.5.1.4" valign="top" width="25%">设置</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="25%">md</td>         <td class="cellrowborder" valign="top" width="25%">SM2_MD_NAME_STR</td>         <td class="cellrowborder" valign="top" width="25%">√</td>         <td class="cellrowborder" valign="top" width="25%">-</td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="转换sm2密文格式">转换SM2密文格式<i class="anchor-icon anchor-icon-link" anchorid="转换sm2密文格式" tips="复制节点链接"></i></h3>          <p>从API版本12开始，支持SM2格式转换。当前支持的SM2密文格式为国密标准的ASN.1格式，其中各参数组合顺序为C1C3C2。</p>     <p>开发者可指定SM2密文参数，转换为符合国密标准的ASN.1格式密文。同样，可以从国密标准的ASN.1格式密文中提取SM2密文参数，便于重新组合成其他格式的SM2密文。</p>     <p>SM2密文参数，包括：</p>     <ul>      <li>       <p>xCoordinate：x分量，即C1_X。</p></li>      <li>       <p>yCoordinate：y分量，即C1_Y。xCoordinate和yCoordinate可以转换成C1。</p></li>      <li>       <p>cipherTextData：密文，即C2。</p></li>      <li>       <p>hashData：杂凑值，即C3。</p></li>     </ul>     <p>当前支持以字符串参数指定SM2密文格式转换的模式，如下表所示，“√”表示支持获取或设置该参数。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.4.1.1" valign="top" width="33.33333333333333%">SM2密文格式转换模式</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.4.1.2" valign="top" width="33.33333333333333%">基于参数生成SM2密文</th>         <th align="left" class="cellrowborder" id="mcps1.3.10.7.1.4.1.3" valign="top" width="33.33333333333333%">从SM2密文中获取参数</th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.33333333333333%">C1C3C2</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">√</td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">√</td>        </tr>             </tbody></table></div>     </div>    </div>   </div>   <div></div></div>