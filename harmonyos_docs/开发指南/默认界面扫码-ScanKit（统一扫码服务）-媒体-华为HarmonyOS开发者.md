<h1 _ngcontent-yne-c119="" class="doc-title ng-star-inserted" title="默认界面扫码"> 默认界面扫码 </h1>

<div _ngcontent-yne-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section16522171851016">基本概念<i class="anchor-icon anchor-icon-link" anchorid="section16522171851016" tips="复制节点链接"></i></h2>          <p>默认界面扫码能力提供系统级体验一致的扫码界面，包含相机预览流，相册扫码入口，暗光环境闪光灯开启提示。Scan Kit默认界面扫码对系统相机权限进行了预授权且调用期间处于安全访问状态，无需开发者再次申请相机权限。适用于不同扫码场景的应用开发。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>通过默认界面扫码可以实现应用内的扫码功能，为了应用更好的体验，推荐同时<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/scan-directservice">接入“扫码直达”服务</a>，应用可以同时支持系统扫码入口（控制中心扫一扫）和应用内扫码两种方式跳转到指定服务页面。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="section1880231055910">场景介绍<i class="anchor-icon anchor-icon-link" anchorid="section1880231055910" tips="复制节点链接"></i></h2>          <p>默认界面扫码能力提供了系统级体验一致的扫码界面以及相册扫码入口，支持单码和多码识别，支持多种识码类型，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/scan-scancore#section113371139123212" target="_blank">ScanType</a>。无需使用三方库就可帮助开发者的应用快速处理各种扫码场景。</p>     <p>默认扫码界面UX：</p>     <p><span><img height="497.29165500000005" originheight="662" originwidth="320" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114419.02354286501331097588544170078450:50001231000000:2800:07B1BABD675E23E3D4C617C41C5AC704DB9D039E0D560E2F73003BFB18480622.png" title="点击放大" width="240.38260400000001"></span></p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ol>        <li>系统首次使用默认界面扫码功能时，会向用户弹出隐私横幅提醒。</li>        <li>用户可以点击“进一步了解”查看安全访问相机说明，也可以关闭隐私横幅，关闭后重新打开应用的扫码界面将不再显示隐私横幅提醒，显示安全访问提示，3s后消失。</li>       </ol>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="section9684181513312">约束与限制<i class="anchor-icon anchor-icon-link" anchorid="section9684181513312" tips="复制节点链接"></i></h2>          <ul>      <li>从6.0.0(20)版本开始，默认界面扫码能力支持悬浮屏、分屏场景。</li>      <li>相册扫码只支持单码识别。</li>      <li>不支持界面UX添加自定义设置。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="section1818915573916">业务流程<i class="anchor-icon anchor-icon-link" anchorid="section1818915573916" tips="复制节点链接"></i></h2>          <p>使用默认界面扫码的主要业务流程如下：</p>     <p><span><img height="426.6773" originheight="564" originwidth="882" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211114419.77979433770912150033977519071612:50001231000000:2800:3C9E680CCDAA5C611BF6B1EFFC8CD0207365A8AAFB7B02E10EDCFB1B53DA9FB8.png" title="点击放大" width="665"></span></p>     <ol>      <li>用户向开发者的应用发起扫码请求。</li>      <li>开发者的应用通过调用Scan Kit的startScanForResult接口启动扫码界面。</li>      <li>系统首次使用默认界面扫码功能时，会向用户弹出隐私横幅提醒。</li>      <li>用户可以点击关闭隐私横幅，重新打开应用的扫码界面将不再显示隐私横幅提醒，显示安全访问提示，3s后消失。</li>      <li>Scan Kit通过Callback回调函数或Promise方式返回扫码结果。</li>      <li>用户进行多码扫描时，需点击选择其中一个码图获取扫码结果返回。单码扫描则可直接返回扫码结果。</li>      <li>解析码值结果跳转应用服务页。</li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section1451724123520">接口说明<i class="anchor-icon anchor-icon-link" anchorid="section1451724123520" tips="复制节点链接"></i></h2>          <p>接口返回值有两种返回形式：Callback和Promise回调。下表中为默认界面扫码Callback和Promise形式接口，Callback和Promise只是返回值方式不一样，功能相同。startScanForResult接口打开的是应用内呈现的扫码界面样式。具体API说明详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/scan-scanbarcode-api" target="_blank">接口文档</a>。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.3.1.1" valign="top" width="50%">          <p>接口名</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.5.3.1.3.1.2" valign="top" width="50%">          <p>描述</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="50%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/scan-scanbarcode-api#section829511911349" target="_blank">startScanForResult</a>(context: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-app-ability-common#context" target="_blank">common.Context</a>, options?: <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/scan-scanbarcode-api#section1285191073117" target="_blank">ScanOptions</a>): Promise&lt;<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/scan-scanbarcode-api#section10614317162112" target="_blank">ScanResult</a>&gt;</p></td>         <td class="cellrowborder" valign="top" width="50%">          <p>启动默认界面扫码，通过ScanOptions进行扫码参数设置，使用Promise异步回调返回扫码结果。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/scan-scanbarcode-api#section1738211373353" target="_blank">startScanForResult</a>(context: common.Context, options: ScanOptions, callback: AsyncCallback&lt;ScanResult&gt;): void</p></td>         <td class="cellrowborder" valign="top" width="50%">          <p>启动默认界面扫码，通过ScanOptions进行扫码参数设置，使用Callback异步回调返回扫码结果。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="50%">          <p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/scan-scanbarcode-api#section399311216327" target="_blank">startScanForResult</a>(context: common.Context, callback: AsyncCallback&lt;ScanResult&gt;): void</p></td>         <td class="cellrowborder" valign="top" width="50%">          <p>启动默认界面扫码，使用Callback异步回调返回扫码结果。</p></td>        </tr>             </tbody></table></div>     </div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>startScanForResult接口需要在页面和组件的生命周期内调用。若需要设置扫码页面为全屏或沉浸式，请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-develop-apply-immersive-effects" target="_blank">开发应用沉浸式效果</a>。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="section891520551175">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section891520551175" tips="复制节点链接"></i></h2>          <p>Scan Kit提供了默认界面扫码的能力，由扫码接口直接控制相机实现最优的相机放大控制、自适应的曝光调节、自适应对焦调节等操作，保障流畅的扫码体验，减少开发者的工作量。</p>     <p>为了方便开发者接入，我们提供了详细的样例工程供参考，推荐参考<a href="https://gitcode.com/HarmonyOS_Samples/scan-kit_-sample-code_-clientdemo_-arkts" target="_blank">示例工程</a>接入。</p>     <p>以下示例为调用Scan Kit的startScanForResult接口跳转扫码页面。</p>     <ol>      <li>导入默认界面扫码模块，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/scan-scancore" target="_blank">scanCore</a>提供扫码类型定义，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/scan-scanbarcode-api" target="_blank">scanBarcode</a>提供拉起默认界面扫码的方法和参数，导入方法如下。       <div _ngcontent-yne-c106="" class="highlight-div"><div _ngcontent-yne-c106="" class="highlight-div-header"><div _ngcontent-yne-c106="" class="highlight-div-header-left"><div _ngcontent-yne-c106="" class="handle-button expand-button"><div _ngcontent-yne-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yne-c106="" class="highlight-div-header-right"><div _ngcontent-yne-c106="" class="handle-button ai-button"></div><div _ngcontent-yne-c106="" class="handle-button line-button"><div _ngcontent-yne-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yne-c106="" class="handle-button theme-button"><div _ngcontent-yne-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yne-c106="" class="handle-button copy-button"><div _ngcontent-yne-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yne-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { scanCore, scanBarcode } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.ScanKit'</span>;</li><li><span class="hljs-comment">// 导入默认界面扫码需要的日志模块和错误码模块</span></li><li><span class="hljs-keyword">import</span> { hilog } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.PerformanceAnalysisKit'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">BusinessError</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'@kit.BasicServicesKit'</span>;</li></ol></pre></div></div></li>      <li>调用startScanForResult方法拉起默认界面扫码。       <ul>        <li>通过Promise方式得到扫码结果。         <div _ngcontent-yne-c106="" class="highlight-div"><div _ngcontent-yne-c106="" class="highlight-div-header"><div _ngcontent-yne-c106="" class="highlight-div-header-left"><div _ngcontent-yne-c106="" class="handle-button expand-button"><div _ngcontent-yne-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yne-c106="" class="highlight-div-header-right"><div _ngcontent-yne-c106="" class="handle-button ai-button"></div><div _ngcontent-yne-c106="" class="handle-button line-button"><div _ngcontent-yne-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yne-c106="" class="handle-button theme-button"><div _ngcontent-yne-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yne-c106="" class="handle-button copy-button"><div _ngcontent-yne-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yne-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">ScanBarCodePage</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">"Promise with options"</span>)</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#0D9FFB'</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>          .<span class="hljs-title function_">fontColor</span>($r(<span class="hljs-string">'sys.color.comp_background_list_card'</span>))</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Normal</span>)</li><li>          .<span class="hljs-title function_">align</span>(<span class="hljs-title class_">Alignment</span>.<span class="hljs-property">Center</span>)</li><li>          .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">5</span> })</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-comment">// 定义扫码参数options</span></li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: scanBarcode.<span class="hljs-property">ScanOptions</span> = {</li><li>              <span class="hljs-attr">scanTypes</span>: [scanCore.<span class="hljs-property">ScanType</span>.<span class="hljs-property">ALL</span>],</li><li>              <span class="hljs-attr">enableMultiMode</span>: <span class="hljs-literal">true</span>,</li><li>              <span class="hljs-attr">enableAlbum</span>: <span class="hljs-literal">true</span></li><li>            };</li><li>            <span class="hljs-keyword">try</span> {</li><li>              <span class="hljs-comment">// 可调用getHostContext接口获取当前页面关联的Context</span></li><li>              scanBarcode.<span class="hljs-title function_">startScanForResult</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>(), options).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">result: scanBarcode.ScanResult</span>) =&gt;</span> {</li><li>                <span class="hljs-comment">// 解析码值结果跳转应用服务页</span></li><li>                hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[Scan CPSample]'</span>, <span class="hljs-string">`Succeeded in getting ScanResult by promise with options, result is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(result)}</span>`</span>);</li><li>              }).<span class="hljs-title function_">catch</span>(<span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>                hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[Scan CPSample]'</span>,</li><li>                  <span class="hljs-string">`Failed to get ScanResult by promise with options. Code:<span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>              });</li><li>            } <span class="hljs-keyword">catch</span> (error) {</li><li>              hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[Scan CPSample]'</span>,</li><li>                <span class="hljs-string">`Failed to start the scanning service. Code:<span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>            }</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div></li>        <li>通过Callback回调函数得到扫码结果。         <div _ngcontent-yne-c106="" class="highlight-div"><div _ngcontent-yne-c106="" class="highlight-div-header"><div _ngcontent-yne-c106="" class="highlight-div-header-left"><div _ngcontent-yne-c106="" class="handle-button expand-button"><div _ngcontent-yne-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-yne-c106="" class="highlight-div-header-right"><div _ngcontent-yne-c106="" class="handle-button ai-button"></div><div _ngcontent-yne-c106="" class="handle-button line-button"><div _ngcontent-yne-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-yne-c106="" class="handle-button theme-button"><div _ngcontent-yne-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-yne-c106="" class="handle-button copy-button"><div _ngcontent-yne-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-yne-c106="" class="highlight-scroll-div"><pre class="typescript prettyprint linenums hljs language-typescript" hw-language="typescript" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">ScanBarCodePage</span> {</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Row</span>() {</li><li>        <span class="hljs-title class_">Button</span>(<span class="hljs-string">'Callback with options'</span>)</li><li>          .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#0D9FFB'</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">20</span>)</li><li>          .<span class="hljs-title function_">fontColor</span>($r(<span class="hljs-string">'sys.color.comp_background_list_card'</span>))</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Normal</span>)</li><li>          .<span class="hljs-title function_">align</span>(<span class="hljs-title class_">Alignment</span>.<span class="hljs-property">Center</span>)</li><li>          .<span class="hljs-title function_">type</span>(<span class="hljs-title class_">ButtonType</span>.<span class="hljs-property">Capsule</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'90%'</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">5</span>, <span class="hljs-attr">bottom</span>: <span class="hljs-number">5</span> })</li><li>          .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>            <span class="hljs-comment">// 定义扫码参数options</span></li><li>            <span class="hljs-keyword">let</span> <span class="hljs-attr">options</span>: scanBarcode.<span class="hljs-property">ScanOptions</span> = {</li><li>              <span class="hljs-attr">scanTypes</span>: [scanCore.<span class="hljs-property">ScanType</span>.<span class="hljs-property">ALL</span>],</li><li>              <span class="hljs-attr">enableMultiMode</span>: <span class="hljs-literal">true</span>,</li><li>              <span class="hljs-attr">enableAlbum</span>: <span class="hljs-literal">true</span></li><li>            };</li><li>            <span class="hljs-keyword">try</span> {</li><li>              <span class="hljs-comment">// 可调用getHostContext接口获取当前页面关联的Context</span></li><li>              scanBarcode.<span class="hljs-title function_">startScanForResult</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getHostContext</span>(), options,</li><li>                <span class="hljs-function">(<span class="hljs-params">error: BusinessError, result: scanBarcode.ScanResult</span>) =&gt;</span> {</li><li>                  <span class="hljs-keyword">if</span> (error) {</li><li>                    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[Scan CPSample]'</span>,</li><li>                      <span class="hljs-string">`Failed to get ScanResult by callback with options. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>                    <span class="hljs-keyword">return</span>;</li><li>                  }</li><li>                  <span class="hljs-comment">// 解析码值结果跳转应用服务页</span></li><li>                  hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[Scan CPSample]'</span>, <span class="hljs-string">`Succeeded in getting ScanResult by callback with options, result is <span class="hljs-subst">${<span class="hljs-built_in">JSON</span>.stringify(result)}</span>`</span>);</li><li>                })</li><li>            } <span class="hljs-keyword">catch</span> (error) {</li><li>              hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0001</span>, <span class="hljs-string">'[Scan CPSample]'</span>,</li><li>                <span class="hljs-string">`Failed to start the scanning service. Code:<span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>            }</li><li>          })</li><li>      }</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre></div></div></li>       </ul></li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section8793479155">模拟器开发<i class="anchor-icon anchor-icon-link" anchorid="section8793479155" tips="复制节点链接"></i></h2>          <p>从6.0.0(20)版本开始，支持模拟器开发，使用指导请参见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-run-emulator" target="_blank">使用模拟器运行应用</a>。</p>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <ol>        <li>模拟器中，默认界面扫码相机流处于镜像状态，真机中不存在该现象。</li>        <li>模拟器上由于相机流的分辨率仅支持固定比例，默认界面扫码的画面上下存在黑边，真机上不存在该现象。</li>       </ol>      </div></div></div>    </div>   </div>   <div></div></div>