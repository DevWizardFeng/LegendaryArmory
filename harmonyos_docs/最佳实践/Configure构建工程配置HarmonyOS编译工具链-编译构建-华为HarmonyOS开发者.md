<h1 _ngcontent-gki-c119="" class="doc-title ng-star-inserted" title="Configure构建工程配置HarmonyOS编译工具链"> Configure构建工程配置HarmonyOS编译工具链 </h1>

<div _ngcontent-gki-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section147591111162820">概述<i class="anchor-icon anchor-icon-link" anchorid="section147591111162820" tips="复制节点链接"></i></h2><p>Configure是一个用于自动化软件编译和安装的工具，它可以帮助开发者编译和安装源代码，以便生成可执行文件和库文件。在编译和安装软件时，通常需要一系列步骤，例如设置编译选项、检查依赖库、生成配置文件等，Configure可以通过读取软件的源代码，自动化这些步骤，简化软件的编译和安装过程。其原理是根据系统环境和用户设置来生成Makefile文件，Makefile文件是一个包含编译选项和依赖关系的脚本，可以自动化编译和安装软件。</p> <p>Configure工具的主要作用：</p> <ul><li>配置检查：Configure脚本会检查系统是否具有编译软件所需的所有依赖项，如编译器、库文件等。</li><li>生成Makefile：根据系统的配置情况，Configure生成相应的Makefile，确保编译过程能够顺利进行。</li><li>提供命令行选项：Configure脚本支持大量的命令行选项，这些选项允许用户自定义编译选项，如安装路径、优化级别等。通过执行./configure --help可以查看所有可用的选项。</li><li>缓存机制：为提高后续配置的效率，Configure支持将测试结果缓存到一个文件中，避免重复进行相同的测试。</li></ul> </div> <div class="tiledSection"><h2 id="section5465154911336">Configure构建三方库适配流程<i class="anchor-icon anchor-icon-link" anchorid="section5465154911336" tips="复制节点链接"></i></h2><p>本小节介绍如何在Linux环境下，使用Configure构建工具通过ohos sdk编译jpeg三方库源码，生成ohos平台三方库的so及二进制文件。</p> </div> <div class="tiledSection"><h2 id="section1339951182">环境准备<i class="anchor-icon anchor-icon-link" anchorid="section1339951182" tips="复制节点链接"></i></h2><ol><li>Linux编译环境及HarmonyOS SDK下载请参考：<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-cmake-adapts-to-harmonyos#section197241001402">环境准备</a>。</li><li>获取三方库源码（“/mnt/e/configure”中configure表示创建的文件夹名称，用于存放三方库源码文件，开发者可自行选择创建与否）。<div _ngcontent-gki-c106="" class="highlight-div"><div _ngcontent-gki-c106="" class="highlight-div-header"><div _ngcontent-gki-c106="" class="highlight-div-header-left"><div _ngcontent-gki-c106="" class="handle-button expand-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gki-c106="" class="highlight-div-header-right"><div _ngcontent-gki-c106="" class="handle-button ai-button"></div><div _ngcontent-gki-c106="" class="handle-button line-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gki-c106="" class="handle-button theme-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gki-c106="" class="handle-button copy-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gki-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-ruby" data-highlighted="yes"><ol class="linenums"><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure</span><span class="hljs-variable">$ </span>wget <span class="hljs-symbol">http:</span>/<span class="hljs-regexp">/www.ijg.org/files</span><span class="hljs-regexp">/jpegsrc.v9e.tar.gz       # 下载三方库源码包</span></li></ol></pre></div></div> </li><li>解压源码包。<div _ngcontent-gki-c106="" class="highlight-div"><div _ngcontent-gki-c106="" class="highlight-div-header"><div _ngcontent-gki-c106="" class="highlight-div-header-left"><div _ngcontent-gki-c106="" class="handle-button expand-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gki-c106="" class="highlight-div-header-right"><div _ngcontent-gki-c106="" class="handle-button ai-button"></div><div _ngcontent-gki-c106="" class="handle-button line-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gki-c106="" class="handle-button theme-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gki-c106="" class="handle-button copy-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gki-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-ruby" data-highlighted="yes"><ol class="linenums"><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure</span><span class="hljs-variable">$ </span>tar -zxvf jpegsrc.v9e.tar.gz                           <span class="hljs-comment"># 解压源码包</span></li></ol></pre></div></div> </li></ol> </div> <div class="tiledSection"><h2 id="section9705710099">编译三方库<i class="anchor-icon anchor-icon-link" anchorid="section9705710099" tips="复制节点链接"></i></h2><ol><li>查看Configure配置。<div class="p">cd进入jpeg-9e目录，执行Configure配置，如若对Configure配置项不熟悉，可以通过运行./configure --help命令查看：<div _ngcontent-gki-c106="" class="highlight-div"><div _ngcontent-gki-c106="" class="highlight-div-header"><div _ngcontent-gki-c106="" class="highlight-div-header-left"><div _ngcontent-gki-c106="" class="handle-button expand-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gki-c106="" class="highlight-div-header-right"><div _ngcontent-gki-c106="" class="handle-button ai-button"></div><div _ngcontent-gki-c106="" class="handle-button line-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gki-c106="" class="handle-button theme-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gki-c106="" class="handle-button copy-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gki-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-sql" data-highlighted="yes"><ol class="linenums"><li>owner<span class="hljs-variable">@ubuntu</span>:<span class="hljs-operator">/</span>mnt<span class="hljs-operator">/</span>e<span class="hljs-operator">/</span>configure<span class="hljs-operator">/</span>$ cd jpeg<span class="hljs-number">-9</span>e</li><li>owner<span class="hljs-variable">@ubuntu</span>:<span class="hljs-operator">/</span>mnt<span class="hljs-operator">/</span>e<span class="hljs-operator">/</span>configure<span class="hljs-operator">/</span>jpeg<span class="hljs-number">-9</span>e$ .<span class="hljs-operator">/</span>configure <span class="hljs-comment">--help                             # 查看configure配置项</span></li><li>`configure` configures libjpeg <span class="hljs-number">9.5</span><span class="hljs-number">.0</span> <span class="hljs-keyword">to</span> adapt <span class="hljs-keyword">to</span> many kinds <span class="hljs-keyword">of</span> systems.</li><li>Usage: .<span class="hljs-operator">/</span>configure [OPTION]... [VAR<span class="hljs-operator">=</span><span class="hljs-keyword">VALUE</span>]...</li><li>...</li><li># 配置安装选项</li><li>Installation directories:</li><li>  <span class="hljs-comment">--prefix=PREFIX         install architecture-independent files in PREFIX</span></li><li>[<span class="hljs-operator">/</span>usr<span class="hljs-operator">/</span><span class="hljs-keyword">local</span>]</li><li>...</li><li># 配置编译的主机选项(<span class="hljs-comment">--host)，默认配置为linux</span></li><li><span class="hljs-keyword">System</span> types:</li><li>  <span class="hljs-comment">--build=BUILD     configure for building on BUILD [guessed]</span></li><li>  <span class="hljs-comment">--host=HOST       cross-compile to build programs to run on HOST [BUILD]</span></li><li>  <span class="hljs-comment">--target=TARGET   configure for building compilers for TARGET [HOST]</span></li><li># cJSON库配置可选项</li><li>Optional Features:</li><li>  <span class="hljs-comment">--disable-option-checking  ignore unrecognized --enable/--with options</span></li><li><span class="hljs-comment">--disable-FEATURE       do not include FEATURE (same as --enable-FEATURE=no)</span></li><li><span class="hljs-comment">--enable-FEATURE[=ARG]  include FEATURE [ARG=yes]</span></li><li><span class="hljs-comment">--enable-silent-rules   less verbose build output (undo: "make V=1")</span></li><li><span class="hljs-comment">--disable-silent-rules  verbose build output (undo: "make V=0")</span></li><li><span class="hljs-comment">--enable-maintainer-mode</span></li><li>enable make rules <span class="hljs-keyword">and</span> dependencies <span class="hljs-keyword">not</span> useful (<span class="hljs-keyword">and</span></li><li>sometimes confusing) <span class="hljs-keyword">to</span> the casual installer</li><li><span class="hljs-comment">--enable-dependency-tracking</span></li><li>do <span class="hljs-keyword">not</span> reject slow dependency extractors</li><li><span class="hljs-comment">--disable-dependency-tracking</span></li><li>speeds up <span class="hljs-keyword">one</span><span class="hljs-operator">-</span><span class="hljs-type">time</span> build</li><li><span class="hljs-comment">--enable-ld-version-script</span></li><li>enable linker version script (<span class="hljs-keyword">default</span> <span class="hljs-keyword">is</span> enabled</li><li><span class="hljs-keyword">when</span> possible)</li><li><span class="hljs-comment">--enable-shared[=PKGS]  build shared libraries [default=yes]</span></li><li><span class="hljs-comment">--enable-static[=PKGS]  build static libraries [default=yes]</span></li><li><span class="hljs-comment">--enable-fast-install[=PKGS]</span></li><li>optimize <span class="hljs-keyword">for</span> fast installation [<span class="hljs-keyword">default</span><span class="hljs-operator">=</span>yes]</li><li><span class="hljs-comment">--disable-libtool-lock  avoid locking (might break parallel builds)</span></li><li><span class="hljs-comment">--enable-maxmem=N     enable use of temp files, set max mem usage to N MB</span></li><li>...</li><li># 配置编译命令(默认使用linux gcc相关配置)</li><li><span class="hljs-keyword">Some</span> influential environment variables:</li><li>  CC          C compiler command</li><li>CFLAGS      C compiler flags</li><li>LDFLAGS     linker flags, e.g. <span class="hljs-operator">-</span>L<span class="hljs-operator">&lt;</span>lib dir<span class="hljs-operator">&gt;</span> if you have libraries <span class="hljs-keyword">in</span> a</li><li>nonstandard directory <span class="hljs-operator">&lt;</span>lib dir<span class="hljs-operator">&gt;</span></li><li>  LIBS        libraries <span class="hljs-keyword">to</span> pass <span class="hljs-keyword">to</span> the linker, e.g. <span class="hljs-operator">-</span>l<span class="hljs-operator">&lt;</span>library<span class="hljs-operator">&gt;</span></li><li>CPPFLAGS    (Objective) C<span class="hljs-operator">/</span>C<span class="hljs-operator">+</span><span class="hljs-operator">+</span> preprocessor flags, e.g. <span class="hljs-operator">-</span>I<span class="hljs-operator">&lt;</span>include dir<span class="hljs-operator">&gt;</span> if</li><li>you have headers <span class="hljs-keyword">in</span> a nonstandard directory <span class="hljs-operator">&lt;</span>include dir<span class="hljs-operator">&gt;</span></li><li>  CPP         C preprocessor</li><li>LT_SYS_LIBRARY_PATH</li><li><span class="hljs-keyword">User</span><span class="hljs-operator">-</span>defined run<span class="hljs-operator">-</span><span class="hljs-type">time</span> library <span class="hljs-keyword">search</span> path.</li><li>
</li><li>Use these variables <span class="hljs-keyword">to</span> override the choices made <span class="hljs-keyword">by</span> `configure` <span class="hljs-keyword">or</span> <span class="hljs-keyword">to</span> help</li><li>it <span class="hljs-keyword">to</span> find libraries <span class="hljs-keyword">and</span> programs <span class="hljs-keyword">with</span> nonstandard names<span class="hljs-operator">/</span>locations.</li><li>Report bugs <span class="hljs-keyword">to</span> the package provider.</li></ol></pre></div></div> </div> <p>由Configure的帮助信息可以知道，jpeg交叉编译需要配置主机（编译完后需要运行的系统机器）、交叉编译命令以及配置安装路径等选项。</p> </li><li>配置交叉编译命令。<div _ngcontent-gki-c106="" class="highlight-div"><div _ngcontent-gki-c106="" class="highlight-div-header"><div _ngcontent-gki-c106="" class="highlight-div-header-left"><div _ngcontent-gki-c106="" class="handle-button expand-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gki-c106="" class="highlight-div-header-right"><div _ngcontent-gki-c106="" class="handle-button ai-button"></div><div _ngcontent-gki-c106="" class="handle-button line-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gki-c106="" class="handle-button theme-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gki-c106="" class="handle-button copy-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gki-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-ruby" data-highlighted="yes"><ol class="linenums"><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure/jpeg-</span>9e<span class="hljs-variable">$ </span>export <span class="hljs-variable constant_">OHOS_SDK</span>=<span class="hljs-regexp">/xxx/ohos</span>-sdk/linux/                                          <span class="hljs-comment"># 配置SDK路径，此处需配置成自己的sdk解压目录</span></li><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure/jpeg-</span>9e<span class="hljs-variable">$ </span>export <span class="hljs-variable constant_">AS</span>=<span class="hljs-variable">${</span><span class="hljs-variable constant_">OHOS_SDK</span>}/native/llvm/bin/llvm-as</li><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure/jpeg-</span>9e<span class="hljs-variable">$ </span>export <span class="hljs-variable constant_">CC</span>=<span class="hljs-string">"${OHOS_SDK}/native/llvm/bin/clang --target=aarch64-linux-ohos"</span>     <span class="hljs-comment"># 32bit的target需要配置成 --target=arm-linux-ohos</span></li><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure/jpeg-</span>9e<span class="hljs-variable">$ </span>export <span class="hljs-variable constant_">CXX</span>=<span class="hljs-string">"${OHOS_SDK}/native/llvm/bin/clang++ --target=aarch64-linux-ohos"</span>  <span class="hljs-comment"># 32bit的target需要配置成 --target=arm-linux-ohos</span></li><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure/jpeg-</span>9e<span class="hljs-variable">$ </span>export <span class="hljs-variable constant_">LD</span>=<span class="hljs-variable">${</span><span class="hljs-variable constant_">OHOS_SDK</span>}/native/llvm/bin/ld.lld</li><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure/jpeg-</span>9e<span class="hljs-variable">$ </span>export <span class="hljs-variable constant_">STRIP</span>=<span class="hljs-variable">${</span><span class="hljs-variable constant_">OHOS_SDK</span>}/native/llvm/bin/llvm-strip</li><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure/jpeg-</span>9e<span class="hljs-variable">$ </span>export <span class="hljs-variable constant_">RANLIB</span>=<span class="hljs-variable">${</span><span class="hljs-variable constant_">OHOS_SDK</span>}/native/llvm/bin/llvm-ranlib</li><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure/jpeg-</span>9e<span class="hljs-variable">$ </span>export <span class="hljs-variable constant_">OBJDUMP</span>=<span class="hljs-variable">${</span><span class="hljs-variable constant_">OHOS_SDK</span>}/native/llvm/bin/llvm-objdump</li><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure/jpeg-</span>9e<span class="hljs-variable">$ </span>export <span class="hljs-variable constant_">OBJCOPY</span>=<span class="hljs-variable">${</span><span class="hljs-variable constant_">OHOS_SDK</span>}/native/llvm/bin/llvm-objcopy</li><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure/jpeg-</span>9e<span class="hljs-variable">$ </span>export <span class="hljs-variable constant_">NM</span>=<span class="hljs-variable">${</span><span class="hljs-variable constant_">OHOS_SDK</span>}/native/llvm/bin/llvm-nm</li><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure/jpeg-</span>9e<span class="hljs-variable">$ </span>export <span class="hljs-variable constant_">AR</span>=<span class="hljs-variable">${</span><span class="hljs-variable constant_">OHOS_SDK</span>}/native/llvm/bin/llvm-ar</li><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure/jpeg-</span>9e<span class="hljs-variable">$ </span>export <span class="hljs-variable constant_">CFLAGS</span>=<span class="hljs-string">"-fPIC -D__MUSL__=1"</span>                                             <span class="hljs-comment"># 32bit需要增加配置 -march=armv7a</span></li><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure/jpeg-</span>9e<span class="hljs-variable">$ </span>export <span class="hljs-variable constant_">CXXFLAGS</span>=<span class="hljs-string">"-fPIC -D__MUSL__=1"</span>                                           <span class="hljs-comment"># 32bit需要增加配置 -march=armv7a</span></li></ol></pre></div></div> </li><li>执行Configure命令。<p>安装路径以及host配置可以在./configure时执行（xxx表示自定义安装路径），host此处以配置arm64位为例。</p> <div _ngcontent-gki-c106="" class="highlight-div"><div _ngcontent-gki-c106="" class="highlight-div-header"><div _ngcontent-gki-c106="" class="highlight-div-header-left"><div _ngcontent-gki-c106="" class="handle-button expand-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gki-c106="" class="highlight-div-header-right"><div _ngcontent-gki-c106="" class="handle-button ai-button"></div><div _ngcontent-gki-c106="" class="handle-button line-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gki-c106="" class="handle-button theme-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gki-c106="" class="handle-button copy-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gki-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">owner</span>@<span class="hljs-title function_">ubuntu</span>:/<span class="hljs-variable">mnt</span>/<span class="hljs-variable">e</span>/<span class="hljs-variable">configure</span>/<span class="hljs-variable">jpeg</span>-<span class="hljs-number">9</span><span class="hljs-variable">e</span>$ ./<span class="hljs-variable">configure</span> --<span class="hljs-variable">prefix</span>=<span class="hljs-variable">xxx</span>/<span class="hljs-variable">jpeg</span> --<span class="hljs-variable">host</span>=<span class="hljs-variable">aarch64</span>-<span class="hljs-variable">linux</span>       # <span class="hljs-variable">执行configure命令配置交叉编译信息</span></li><li><span class="hljs-variable">checking</span> <span class="hljs-variable">build</span> <span class="hljs-variable">system</span> <span class="hljs-keyword">type</span>... <span class="hljs-variable">x86_64</span>-<span class="hljs-variable">pc</span>-<span class="hljs-variable">linux</span>-<span class="hljs-variable">gnu</span></li><li><span class="hljs-variable">checking</span> <span class="hljs-variable">host</span> <span class="hljs-variable">system</span> <span class="hljs-keyword">type</span>... <span class="hljs-variable">x86_64</span>-<span class="hljs-variable">pc</span>-<span class="hljs-variable">linux</span>-<span class="hljs-variable">gnu</span></li><li><span class="hljs-variable">checking</span> <span class="hljs-variable">target</span> <span class="hljs-variable">system</span> <span class="hljs-keyword">type</span>... <span class="hljs-variable">x86_64</span>-<span class="hljs-variable">pc</span>-<span class="hljs-variable">linux</span>-<span class="hljs-variable">gnu</span></li><li>...</li><li># <span class="hljs-variable">省略部分configure信息</span></li><li>...</li><li><span class="hljs-variable">configure</span>: <span class="hljs-title class_">creating</span> ./<span class="hljs-variable">config</span>.<span class="hljs-variable">status</span></li><li><span class="hljs-variable">config</span>.<span class="hljs-variable">status</span>: <span class="hljs-title class_">creating</span> <span class="hljs-title class_">Makefile</span></li><li><span class="hljs-variable">config</span>.<span class="hljs-variable">status</span>: <span class="hljs-title class_">creating</span> <span class="hljs-title class_">libjpeg</span>.<span class="hljs-title class_">pc</span></li><li><span class="hljs-variable">config</span>.<span class="hljs-variable">status</span>: <span class="hljs-title class_">creating</span> <span class="hljs-title class_">jconfig</span>.<span class="hljs-title class_">h</span></li><li><span class="hljs-variable">config</span>.<span class="hljs-variable">status</span>: <span class="hljs-title class_">executing</span> <span class="hljs-title class_">depfiles</span> <span class="hljs-title class_">commands</span></li><li><span class="hljs-variable">config</span>.<span class="hljs-variable">status</span>: <span class="hljs-title class_">executing</span> <span class="hljs-title class_">libtool</span> <span class="hljs-title class_">commands</span></li></ol></pre></div></div> <p>执行完./configure未提示任何错误，即说明配置成功，在当前目录会生成Makefile文件。</p> </li><li>执行make编译命令，进行交叉编译。<div _ngcontent-gki-c106="" class="highlight-div"><div _ngcontent-gki-c106="" class="highlight-div-header"><div _ngcontent-gki-c106="" class="highlight-div-header-left"><div _ngcontent-gki-c106="" class="handle-button expand-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gki-c106="" class="highlight-div-header-right"><div _ngcontent-gki-c106="" class="handle-button ai-button"></div><div _ngcontent-gki-c106="" class="handle-button line-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gki-c106="" class="handle-button theme-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gki-c106="" class="handle-button copy-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gki-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-ruby" data-highlighted="yes"><ol class="linenums"><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure/jpeg-</span>9e<span class="hljs-variable">$ </span>make                       <span class="hljs-comment"># 执行make编译命令</span></li><li>make  all-am</li><li>make[<span class="hljs-number">1</span>]: <span class="hljs-title class_">Entering</span> directory <span class="hljs-string">'/home/owner/workspace/jpeg-9e'</span></li><li><span class="hljs-variable constant_">CC</span>       cjpeg.o</li><li><span class="hljs-variable constant_">CC</span>       rdppm.o</li><li>...</li><li><span class="hljs-comment"># 省略部分make信息</span></li><li>...</li><li><span class="hljs-variable constant_">CC</span>       rdcolmap.o</li><li><span class="hljs-variable constant_">CCLD</span>     djpeg</li><li><span class="hljs-variable constant_">CC</span>       jpegtran.o</li><li><span class="hljs-variable constant_">CC</span>       transupp.o</li><li><span class="hljs-variable constant_">CCLD</span>     jpegtran</li><li><span class="hljs-variable constant_">CC</span>       rdjpgcom.o</li><li><span class="hljs-variable constant_">CCLD</span>     rdjpgcom</li><li><span class="hljs-variable constant_">CC</span>       wrjpgcom.o</li><li><span class="hljs-variable constant_">CCLD</span>     wrjpgcom</li><li>make[<span class="hljs-number">1</span>]: <span class="hljs-title class_">Leaving</span> directory <span class="hljs-string">'/home/owner/workspace/jpeg-9e'</span></li></ol></pre></div></div> </li><li>执行安装命令。<div _ngcontent-gki-c106="" class="highlight-div"><div _ngcontent-gki-c106="" class="highlight-div-header"><div _ngcontent-gki-c106="" class="highlight-div-header-left"><div _ngcontent-gki-c106="" class="handle-button expand-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gki-c106="" class="highlight-div-header-right"><div _ngcontent-gki-c106="" class="handle-button ai-button"></div><div _ngcontent-gki-c106="" class="handle-button line-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gki-c106="" class="handle-button theme-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gki-c106="" class="handle-button copy-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gki-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-swift" data-highlighted="yes"><ol class="linenums"><li>owner<span class="hljs-meta">@ubuntu</span>:<span class="hljs-regexp">/mnt/</span>e<span class="hljs-regexp">/configure/</span>jpeg<span class="hljs-operator">-</span>9e$ make install</li><li>make[<span class="hljs-number">1</span>]: <span class="hljs-type">Entering</span> directory '<span class="hljs-regexp">/mnt/</span>e<span class="hljs-regexp">/configure/</span>jpeg<span class="hljs-operator">-</span>9e'</li><li>  <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/mkdir -p '/</span>mnt<span class="hljs-regexp">/e/</span>configure<span class="hljs-regexp">/jpeg-9e/</span>jpeg<span class="hljs-operator">/</span>lib'</li><li>  <span class="hljs-regexp">/bin/</span>bash <span class="hljs-operator">./</span>libtool   <span class="hljs-operator">--</span>mode<span class="hljs-operator">=</span>install <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/install -c   libjpeg.la '/</span>mnt<span class="hljs-regexp">/e/</span>configure<span class="hljs-regexp">/jpeg-9e/</span>jpeg<span class="hljs-operator">/</span>lib'</li><li>libtool: install: <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/install -c .libs/</span>libjpeg.so.<span class="hljs-number">9.5</span>.<span class="hljs-number">0</span> <span class="hljs-regexp">/mnt/</span>e<span class="hljs-regexp">/configure/</span>jpeg<span class="hljs-operator">-</span>9e<span class="hljs-regexp">/jpeg/</span>lib<span class="hljs-operator">/</span>libjpeg.so.<span class="hljs-number">9.5</span>.<span class="hljs-number">0</span></li><li><span class="hljs-operator">...</span></li><li># 省略部分make install信息</li><li><span class="hljs-operator">...</span></li><li>libtool: install: <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/install -c wrjpgcom /</span>mnt<span class="hljs-regexp">/e/</span>configure<span class="hljs-regexp">/jpeg-9e/</span>jpeg<span class="hljs-regexp">/bin/</span>wrjpgcom</li><li>  <span class="hljs-regexp">/bin/</span>bash <span class="hljs-regexp">/mnt/</span>e<span class="hljs-regexp">/configure/</span>jpeg<span class="hljs-operator">-</span>9e<span class="hljs-regexp">/install-sh -d /</span>mnt<span class="hljs-regexp">/e/</span>configure<span class="hljs-regexp">/jpeg-9e/</span>jpeg<span class="hljs-operator">/</span>include</li><li>  <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/install -c -m 644 jconfig.h /</span>mnt<span class="hljs-regexp">/e/</span>configure<span class="hljs-regexp">/jpeg-9e/</span>jpeg<span class="hljs-regexp">/include/</span>jconfig.h</li><li>  <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/mkdir -p '/</span>mnt<span class="hljs-regexp">/e/</span>configure<span class="hljs-regexp">/jpeg-9e/</span>jpeg<span class="hljs-operator">/</span>include'</li><li>  <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/install -c -m 644 jerror.h jmorecfg.h jpeglib.h '/</span>mnt<span class="hljs-regexp">/e/</span>configure<span class="hljs-regexp">/jpeg-9e/</span>jpeg<span class="hljs-operator">/</span>include'</li><li>  <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/mkdir -p '/</span>mnt<span class="hljs-regexp">/e/</span>configure<span class="hljs-regexp">/jpeg-9e/</span>jpeg<span class="hljs-regexp">/share/</span>man<span class="hljs-operator">/</span>man1'</li><li>  <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/install -c -m 644 cjpeg.1 djpeg.1 jpegtran.1 rdjpgcom.1 wrjpgcom.1 '/</span>mnt<span class="hljs-regexp">/e/</span>configure<span class="hljs-regexp">/jpeg-9e/</span>jpeg<span class="hljs-regexp">/share/</span>man<span class="hljs-operator">/</span>man1'</li><li>  <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/mkdir -p '/</span>mnt<span class="hljs-regexp">/e/</span>configure<span class="hljs-regexp">/jpeg-9e/</span>jpeg<span class="hljs-regexp">/lib/</span>pkgconfig'</li><li>  <span class="hljs-regexp">/usr/</span>bin<span class="hljs-regexp">/install -c -m 644 libjpeg.pc '/</span>mnt<span class="hljs-regexp">/e/</span>configure<span class="hljs-regexp">/jpeg-9e/</span>jpeg<span class="hljs-regexp">/lib/</span>pkgconfig'</li></ol></pre></div></div> </li><li>执行完后对应的文件安装到prefix配置的路径。<div class="p">cd进入配置的路径，ls查看对应文件：<div _ngcontent-gki-c106="" class="highlight-div"><div _ngcontent-gki-c106="" class="highlight-div-header"><div _ngcontent-gki-c106="" class="highlight-div-header-left"><div _ngcontent-gki-c106="" class="handle-button expand-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gki-c106="" class="highlight-div-header-right"><div _ngcontent-gki-c106="" class="handle-button ai-button"></div><div _ngcontent-gki-c106="" class="handle-button line-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gki-c106="" class="handle-button theme-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gki-c106="" class="handle-button copy-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gki-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-ruby" data-highlighted="yes"><ol class="linenums"><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure/jpeg-</span>9e<span class="hljs-variable">$ </span>cd xxx/jpeg</li><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure/jpeg-</span>9e/jpeg<span class="hljs-variable">$ </span>ls</li><li>bin  <span class="hljs-keyword">include</span>  lib  share</li><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure/jpeg-</span>9e/jpeg<span class="hljs-variable">$ </span>ls lib</li><li>libjpeg.a  libjpeg.la  libjpeg.so  libjpeg.so.<span class="hljs-number">9</span>  libjpeg.so.<span class="hljs-number">9.5</span>.<span class="hljs-number">0</span>  pkgconfig</li><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure/jpeg-</span>9e/jpeg<span class="hljs-variable">$ </span>ls <span class="hljs-keyword">include</span>/</li><li>jconfig.h  jerror.h  jmorecfg.h  jpeglib.h</li><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure/jpeg-</span>9e/jpeg<span class="hljs-variable">$ </span>file lib/libjpeg.so.<span class="hljs-number">9.5</span>.<span class="hljs-number">0</span></li><li>lib/libjpeg.so.<span class="hljs-number">9.5</span>.<span class="hljs-number">0</span>: <span class="hljs-variable constant_">ELF</span> <span class="hljs-number">64</span>-bit <span class="hljs-variable constant_">LSB</span> shared object, <span class="hljs-variable constant_">ARM</span> aarch64, version <span class="hljs-number">1</span> (<span class="hljs-variable constant_">SYSV</span>), dynamically linked, with debug_info, <span class="hljs-keyword">not</span> stripped</li></ol></pre></div></div> </div> </li><li>安装完成后，将jpeg中生成的bin目录下的文件移动至三方库jpeg-9e目录下。<div _ngcontent-gki-c106="" class="highlight-div"><div _ngcontent-gki-c106="" class="highlight-div-header"><div _ngcontent-gki-c106="" class="highlight-div-header-left"><div _ngcontent-gki-c106="" class="handle-button expand-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-gki-c106="" class="highlight-div-header-right"><div _ngcontent-gki-c106="" class="handle-button ai-button"></div><div _ngcontent-gki-c106="" class="handle-button line-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-gki-c106="" class="handle-button theme-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-gki-c106="" class="handle-button copy-button"><div _ngcontent-gki-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-gki-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-ruby" data-highlighted="yes"><ol class="linenums"><li>owner<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:/mnt/e/configure</span><span class="hljs-variable">$ </span>mv jpeg-9e/jpeg/bin/* jpeg-9e/</li></ol></pre></div></div> </li><li>至此，使用Configure通过ohos sdk编译三方库jpeg源码完成。</li></ol> </div> <div class="tiledSection"><h2 id="section947993195511">应用中集成使用三方库<i class="anchor-icon anchor-icon-link" anchorid="section947993195511" tips="复制节点链接"></i></h2><p>请参考：<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-dynamic-link-library" target="_blank">三方动态链接库（.so）集成开发实践</a>。</p> </div> </div> <div></div></div>