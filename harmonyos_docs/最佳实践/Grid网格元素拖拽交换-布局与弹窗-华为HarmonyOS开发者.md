<h1 _ngcontent-lbi-c119="" class="doc-title ng-star-inserted" title="Grid网格元素拖拽交换"> Grid网格元素拖拽交换 </h1>

<div _ngcontent-lbi-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section580010194206">概述<i class="anchor-icon anchor-icon-link" anchorid="section580010194206" tips="复制节点链接"></i></h2><p>Grid网格元素拖拽交换功能在应用中经常会被使用，如当编辑九宫格图片需要拖拽图片改变排序时，就会使用到该功能。当网格中图片进行拖拽交换时，元素排列会跟随图片拖拽的位置而发生变化，并且会有对应的动画效果，以达到良好的用户体验。</p> <p>Grid网格布局一般由<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid" target="_blank">Grid</a>容器组件和子组件<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-griditem" target="_blank">GridItem</a>构建组成，Grid用于设置网格布局相关参数，GridItem定义子组件相关特征。网格布局中含有网格元素，当给Grid容器组件设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid#editmode8" target="_blank">editMode</a>属性为true时，可开启Grid组件的编辑模式。首先，开启编辑模式。然后，给<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-griditem" target="_blank">GridItem</a>组件绑定<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-gestures-longpressgesture" target="_blank">长按</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-gestures-pangesture" target="_blank">拖拽</a>等手势。最后，需要添加动画属性<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-uicontext#animateto" target="_blank">animateTo</a>，并设置相应的动画效果。最终，呈现出网格元素拖拽交换的动效过程，如下示意图。</p> <p><span><img height="545.5261" originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211162908.48167867213799027468091178716305:50001231000000:2800:0D45625DAAA75ACB71AF68C736590D1D93054AAD000A6381BD218E7C012DC0F0.gif" title="点击放大" width="266"></span></p> <p></p> </div> <div class="tiledSection"><h2 id="section11450532135319">实现原理<i class="anchor-icon anchor-icon-link" anchorid="section11450532135319" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section154473579555" class="firsth2">关键技术<i class="anchor-icon anchor-icon-link" anchorid="section154473579555" tips="复制节点链接"></i></h3><p>Grid网格元素拖拽交换功能实现是通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid" target="_blank">Grid</a>容器组件、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-combined-gestures" target="_blank">组合手势</a>、动画属性<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-uicontext#animateto" target="_blank">animateTo</a>结合来实现的。</p> <ul><li>Grid组件可以构建网格元素布局。</li><li>组合手势可以实现元素拖拽交换的效果。</li><li>显式动画可以给元素拖拽交换的过程中，添加动画效果。</li></ul> <div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>Grid组件当前支持GridItem拖拽动画，通过给Grid容器组件设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid#supportanimation8" target="_blank">supportAnimation</a>为true，即可开启动画效果。但仅支持在滚动模式下（设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid#rowstemplate" target="_blank">rowsTemplate</a>、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid#columnstemplate" target="_blank">columnsTemplate</a>其中一个）支持动画。且仅在大小规则的Grid中支持拖拽动画，跨行或跨列场景不支持。因此，在跨行或跨列场景下，需要通过自定义Grid布局、自定义手势和显式动画来实现拖拽交换的效果。</p> </div></div></div> </div> <div class="tiledSection"><h3 id="section94391345195518">开发流程<i class="anchor-icon anchor-icon-link" anchorid="section94391345195518" tips="复制节点链接"></i></h3><p>在需要拖拽交换的场景中：</p> <ul><li>实现Grid布局，启动<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid#editmode8" target="_blank">editMode</a>编辑模式，进入编辑模式可以拖拽Grid组件内部<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-griditem" target="_blank">GridItem</a>。</li><li>给网格元素<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-griditem" target="_blank">GridItem</a>绑定相关手势，实现可拖拽操作。</li><li>使用显式动画<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-uicontext-uicontext#animateto" target="_blank">animateTo</a>，实现<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-griditem" target="_blank">GridItem</a>拖拽过程中的动画效果。</li></ul> </div> <div class="tiledSection"><h2 id="section20614345172715">相同大小网格元素，长按拖拽<i class="anchor-icon anchor-icon-link" anchorid="section20614345172715" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section13346161502814" class="firsth2">场景描述<i class="anchor-icon anchor-icon-link" anchorid="section13346161502814" tips="复制节点链接"></i></h3></div> <p>在编辑九宫格等多图的场景中，长按图片（网格元素）可以拖拽交换排序，拖拽图片的过程中，旁边的图片也会即时移动，以产生新的宫格排布。</p> <p>示意效果图如下。</p> <p><span><img height="545.5261" originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211162908.95253416563108823239966685550699:50001231000000:2800:032A6EDC81A6CA02F0E883518C3BFC580BD17772CDA6CA3F5E872B552D5FCA8D.gif" title="点击放大" width="266"></span></p> <p></p> <div class="tiledSection"><h3 id="section1619233512815">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section1619233512815" tips="复制节点链接"></i></h3></div> <ol><li>Grid布局及相同大小的GridItem界面开发。其中，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid#scrollbar" target="_blank">scrollBar</a>可设置滚动条状态，值为BarState.Off时，表示不显示滚动条；<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid#columnstemplate" target="_blank">columnsTemplate</a>可设置当前网格布局列的数量、固定列宽或最小列宽值；<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid#columnsgap" target="_blank">columnsGap</a>可设置列与列的间距；<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid#rowsgap" target="_blank">rowsGap</a>可设置行与行的间距。<div class="screenLinkPre"><div _ngcontent-lbi-c106="" class="highlight-div"><div _ngcontent-lbi-c106="" class="highlight-div-header"><div _ngcontent-lbi-c106="" class="highlight-div-header-left"><div _ngcontent-lbi-c106="" class="handle-button expand-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lbi-c106="" class="highlight-div-header-right"><div _ngcontent-lbi-c106="" class="handle-button ai-button"></div><div _ngcontent-lbi-c106="" class="handle-button line-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lbi-c106="" class="handle-button theme-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lbi-c106="" class="handle-button copy-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lbi-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-typescript" codehub="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/SameItemDrag.ets#L116-L132" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title class_">Grid</span>() {</li><li>  <span class="hljs-title class_">ForEach</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">numbers</span>, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>    <span class="hljs-title class_">GridItem</span>() {</li><li>      <span class="hljs-title class_">Image</span>($r(<span class="hljs-string">`app.media.image<span class="hljs-subst">${item}</span>`</span>))</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">curBp</span> === <span class="hljs-string">'md'</span> ? <span class="hljs-number">131</span> : <span class="hljs-number">105</span>)</li><li>        .<span class="hljs-title function_">draggable</span>(<span class="hljs-literal">false</span>)</li><li>        .<span class="hljs-title function_">animation</span>({ <span class="hljs-attr">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-property">Sharp</span>, <span class="hljs-attr">duration</span>: <span class="hljs-number">300</span> })</li><li>    }</li><li>  }, <span class="hljs-function">(<span class="hljs-params">item: <span class="hljs-built_in">number</span></span>) =&gt;</span> item.<span class="hljs-title function_">toString</span>())</li><li>}</li><li>.<span class="hljs-title function_">width</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">curBp</span> === <span class="hljs-string">'md'</span> ? <span class="hljs-string">'66%'</span> : <span class="hljs-string">'100%'</span>)</li><li>.<span class="hljs-title function_">scrollBar</span>(<span class="hljs-title class_">BarState</span>.<span class="hljs-property">Off</span>)</li><li>.<span class="hljs-title function_">columnsTemplate</span>(<span class="hljs-string">'1fr 1fr 1fr'</span>)</li><li>.<span class="hljs-title function_">columnsGap</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">curBp</span> === <span class="hljs-string">'md'</span> ? <span class="hljs-number">6</span> : <span class="hljs-number">4</span>)</li><li>.<span class="hljs-title function_">rowsGap</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">curBp</span> === <span class="hljs-string">'md'</span> ? <span class="hljs-number">6</span> : <span class="hljs-number">4</span>)</li><li>.<span class="hljs-title function_">height</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">curBp</span> === <span class="hljs-string">'md'</span> ? <span class="hljs-number">406</span> : <span class="hljs-number">323</span>)</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/SameItemDrag.ets#L116-L132" target="_blank">SameItemDrag.ets</a></div></div></div></div> </li><li>给Grid组件设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid#editmode8" target="_blank">editMode</a>为true，即Grid进入编辑模式，进入编辑模式可以拖拽Grid组件内部<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-griditem" target="_blank">GridItem</a>。设置<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid#supportanimation8" target="_blank">supportAnimation</a>为true，即Grid拖拽元素时支持动画。<div class="screenLinkPre"><div _ngcontent-lbi-c106="" class="highlight-div"><div _ngcontent-lbi-c106="" class="highlight-div-header"><div _ngcontent-lbi-c106="" class="highlight-div-header-left"><div _ngcontent-lbi-c106="" class="handle-button expand-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lbi-c106="" class="highlight-div-header-right"><div _ngcontent-lbi-c106="" class="handle-button ai-button"></div><div _ngcontent-lbi-c106="" class="handle-button line-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lbi-c106="" class="handle-button theme-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lbi-c106="" class="handle-button copy-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lbi-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-bash" codehub="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/SameItemDrag.ets#L136-L137" data-highlighted="yes"><ol class="linenums"><li>.editMode(<span class="hljs-literal">true</span>)</li><li>.supportAnimation(<span class="hljs-literal">true</span>)</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/SameItemDrag.ets#L136-L137" target="_blank">SameItemDrag.ets</a></div></div></div></div> </li><li>定义拖拽过程中的数组交换逻辑。<div class="screenLinkPre"><div _ngcontent-lbi-c106="" class="highlight-div"><div _ngcontent-lbi-c106="" class="highlight-div-header"><div _ngcontent-lbi-c106="" class="highlight-div-header-left"><div _ngcontent-lbi-c106="" class="handle-button expand-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lbi-c106="" class="highlight-div-header-right"><div _ngcontent-lbi-c106="" class="handle-button ai-button"></div><div _ngcontent-lbi-c106="" class="handle-button line-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lbi-c106="" class="handle-button theme-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lbi-c106="" class="handle-button copy-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lbi-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-typescript" codehub="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/SameItemDrag.ets#L49-L52" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title function_">changeIndex</span>(<span class="hljs-params">index1: <span class="hljs-built_in">number</span>, index2: <span class="hljs-built_in">number</span></span>) {</li><li>  <span class="hljs-keyword">let</span> tmp = <span class="hljs-variable language_">this</span>.<span class="hljs-property">numbers</span>.<span class="hljs-title function_">splice</span>(index1, <span class="hljs-number">1</span>);</li><li>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">numbers</span>.<span class="hljs-title function_">splice</span>(index2, <span class="hljs-number">0</span>, tmp[<span class="hljs-number">0</span>])</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/SameItemDrag.ets#L49-L52" target="_blank">SameItemDrag.ets</a></div></div></div></div> </li><li>给Grid组件绑定<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid#onitemdragstart8" target="_blank">onItemDragStart</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid#onitemdrop8" target="_blank">onItemDrop</a>事件，在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid#onitemdragstart8" target="_blank">onItemDragStart</a>回调中设置拖拽过程中显示的图片，并在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid#onitemdrop8" target="_blank">onItemDrop</a>中完成交换数组位置的逻辑。<div class="p"><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid#onitemdragstart8" target="_blank">onItemDragStart</a>回调在开始拖拽网格元素时触发，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid#onitemdrop8" target="_blank">onItemDrop</a>回调当在网格元素内停止拖拽时触发。<div class="screenLinkPre"><div _ngcontent-lbi-c106="" class="highlight-div"><div _ngcontent-lbi-c106="" class="highlight-div-header"><div _ngcontent-lbi-c106="" class="highlight-div-header-left"><div _ngcontent-lbi-c106="" class="handle-button expand-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lbi-c106="" class="highlight-div-header-right"><div _ngcontent-lbi-c106="" class="handle-button ai-button"></div><div _ngcontent-lbi-c106="" class="handle-button line-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lbi-c106="" class="handle-button theme-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lbi-c106="" class="handle-button copy-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lbi-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-typescript" codehub="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/SameItemDrag.ets#L141-L150" data-highlighted="yes"><ol class="linenums"><li>.<span class="hljs-title function_">onItemDragStart</span>(<span class="hljs-function">(<span class="hljs-params">_, itemIndex: <span class="hljs-built_in">number</span></span>) =&gt;</span> {</li><li>  <span class="hljs-variable language_">this</span>.<span class="hljs-property">imageNum</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">numbers</span>[itemIndex];</li><li>  <span class="hljs-keyword">return</span> <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">pixelMapBuilder</span>();</li><li>})</li><li>.<span class="hljs-title function_">onItemDrop</span>(<span class="hljs-function">(<span class="hljs-params">_, itemIndex: <span class="hljs-built_in">number</span>, insertIndex: <span class="hljs-built_in">number</span>, isSuccess: <span class="hljs-built_in">boolean</span></span>) =&gt;</span> {</li><li>  <span class="hljs-keyword">if</span> (!isSuccess || insertIndex &gt;= <span class="hljs-variable language_">this</span>.<span class="hljs-property">numbers</span>.<span class="hljs-property">length</span>) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-variable language_">this</span>.<span class="hljs-title function_">changeIndex</span>(itemIndex, insertIndex);</li><li>})</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/SameItemDrag.ets#L141-L150" target="_blank">SameItemDrag.ets</a></div></div></div></div> </div> </li></ol> <div class="tiledSection"><h2 id="section31371041171912">不同大小网格元素，长按拖拽<i class="anchor-icon anchor-icon-link" anchorid="section31371041171912" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section9447194816195" class="firsth2">场景描述<i class="anchor-icon anchor-icon-link" anchorid="section9447194816195" tips="复制节点链接"></i></h3></div> <p>在一些展示设备的场景中，会有大小不同的网格元素。当用户想改变设备排序时，可以长按设备图片（网格元素）拖拽交换排序，拖拽的过程中，也会改变排列顺序，以产生新的宫格排布。</p> <p>示意效果图如下。</p> <p><span><img height="550.3407000000001" originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211162909.59681754708354301531977765524853:50001231000000:2800:E799882C58EAC73244973A2926E47A21642BE19C7BE5C994EDD9EE6679617178.gif" title="点击放大" width="266"></span></p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>当前方案仅适用于页面包含一个较大网格元素的布局。</p> </div></div></div> <div class="tiledSection"><h3 id="section1859914317203">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section1859914317203" tips="复制节点链接"></i></h3></div> <ol><li>Grid布局及不同大小的GridItem界面开发。<div class="screenLinkPre"><div _ngcontent-lbi-c106="" class="highlight-div"><div _ngcontent-lbi-c106="" class="highlight-div-header"><div _ngcontent-lbi-c106="" class="highlight-div-header-left"><div _ngcontent-lbi-c106="" class="handle-button expand-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lbi-c106="" class="highlight-div-header-right"><div _ngcontent-lbi-c106="" class="handle-button ai-button"></div><div _ngcontent-lbi-c106="" class="handle-button line-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lbi-c106="" class="handle-button theme-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lbi-c106="" class="handle-button copy-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lbi-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/DifferentItemDrag.ets#L266-L351" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title function_">Grid</span>() {</li><li>  <span class="hljs-title function_">ForEach</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">numbers</span>, (<span class="hljs-variable">item</span>: <span class="hljs-title class_">number</span>) =&gt; {</li><li>    <span class="hljs-title function_">GridItem</span>() {</li><li>      <span class="hljs-title function_">Stack</span>({ <span class="hljs-variable">alignContent</span>: <span class="hljs-title class_">Alignment</span>.<span class="hljs-title class_">TopEnd</span> }) {</li><li>        <span class="hljs-title function_">Image</span>(<span class="hljs-keyword">this</span>.<span class="hljs-title function_">changeImage</span>(<span class="hljs-variable">item</span>))</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>          .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">16</span>)</li><li>          .<span class="hljs-title function_">objectFit</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">curBp</span> === <span class="hljs-string">'md'</span> ? <span class="hljs-variable">ImageFit</span>.<span class="hljs-variable">Fill</span> : <span class="hljs-title class_">ImageFit</span>.<span class="hljs-title class_">Cover</span>)</li><li>          .<span class="hljs-title function_">draggable</span>(<span class="hljs-keyword">false</span>)</li><li>          .<span class="hljs-title function_">animation</span>({ <span class="hljs-variable">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-title class_">Sharp</span>, <span class="hljs-variable">duration</span>: <span class="hljs-number">300</span> })</li><li>      }</li><li>    }</li><li>    .<span class="hljs-title function_">rowStart</span>(<span class="hljs-number">0</span>)</li><li>    .<span class="hljs-title function_">rowEnd</span>(<span class="hljs-keyword">this</span>.<span class="hljs-title function_">getRowEnd</span>(<span class="hljs-variable">item</span>))</li><li>    .<span class="hljs-title function_">scale</span>({ <span class="hljs-variable">x</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">scaleItem</span> === <span class="hljs-variable">item</span> ? <span class="hljs-number">1.02</span> : <span class="hljs-number">1</span>, <span class="hljs-variable">y</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">scaleItem</span> === <span class="hljs-variable">item</span> ? <span class="hljs-number">1.02</span> : <span class="hljs-number">1</span> })</li><li>    .<span class="hljs-title function_">zIndex</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">dragItem</span> === <span class="hljs-variable">item</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>)</li><li>    .<span class="hljs-title function_">translate</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">dragItem</span> === <span class="hljs-variable">item</span> ? { <span class="hljs-variable">x</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">offsetX</span>, <span class="hljs-variable">y</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">offsetY</span> } : { <span class="hljs-variable">x</span>: <span class="hljs-number">0</span>, <span class="hljs-variable">y</span>: <span class="hljs-number">0</span> })</li><li>    .<span class="hljs-title function_">hitTestBehavior</span>(<span class="hljs-keyword">this</span>.<span class="hljs-title function_">isDraggable</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">numbers</span>.<span class="hljs-title function_">indexOf</span>(<span class="hljs-variable">item</span>)) ? <span class="hljs-variable">HitTestMode</span>.<span class="hljs-variable">Default</span> : <span class="hljs-title class_">HitTestMode</span>.<span class="hljs-title class_">None</span>)</li><li>    <span class="hljs-comment">// ...</span></li><li>  }, (<span class="hljs-variable">item</span>: <span class="hljs-title class_">number</span>) =&gt; <span class="hljs-variable">item</span>.<span class="hljs-title function_">toString</span>())</li><li>}</li><li>.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>.<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>.<span class="hljs-title function_">editMode</span>(<span class="hljs-keyword">true</span>)</li><li>.<span class="hljs-title function_">scrollBar</span>(<span class="hljs-variable">BarState</span>.<span class="hljs-variable">Off</span>)</li><li>.<span class="hljs-title function_">columnsTemplate</span>(<span class="hljs-string">'1fr 1fr'</span>)</li><li>.<span class="hljs-title function_">supportAnimation</span>(<span class="hljs-keyword">true</span>)</li><li>.<span class="hljs-title function_">columnsGap</span>(<span class="hljs-number">12</span>)</li><li>.<span class="hljs-title function_">rowsGap</span>(<span class="hljs-number">12</span>)</li><li>.<span class="hljs-title function_">enableScrollInteraction</span>(<span class="hljs-keyword">true</span>)</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/DifferentItemDrag.ets#L266-L351" target="_blank">DifferentItemDrag.ets</a></div></div></div></div> </li><li>定义网格元素移动过程中的相关计算函数，其中itemMove()方法是实现元素交换重新排序的方法。<div class="screenLinkPre"><div _ngcontent-lbi-c106="" class="highlight-div"><div _ngcontent-lbi-c106="" class="highlight-div-header"><div _ngcontent-lbi-c106="" class="highlight-div-header-left"><div _ngcontent-lbi-c106="" class="handle-button expand-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lbi-c106="" class="highlight-div-header-right"><div _ngcontent-lbi-c106="" class="handle-button ai-button"></div><div _ngcontent-lbi-c106="" class="handle-button line-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lbi-c106="" class="handle-button theme-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lbi-c106="" class="handle-button copy-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lbi-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/DifferentItemDrag.ets#L68-L172" data-highlighted="yes"><ol class="linenums"><li>itemMove(index: number, newIndex: number): void {</li><li>  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isDraggable(newIndex)) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  let tmp = <span class="hljs-keyword">this</span>.numbers.splice(index, <span class="hljs-number">1</span>);</li><li>  <span class="hljs-keyword">this</span>.numbers.splice(newIndex, <span class="hljs-number">0</span>, tmp[<span class="hljs-number">0</span>]);</li><li>  <span class="hljs-keyword">this</span>.bigItemIndex = <span class="hljs-keyword">this</span>.numbers.findIndex((item) =&gt; item === <span class="hljs-number">0</span>);</li><li>}</li><li>
</li><li>isInLeft(index: number) {</li><li>  <span class="hljs-keyword">if</span> (index === <span class="hljs-keyword">this</span>.bigItemIndex) {</li><li>    <span class="hljs-keyword">return</span> index % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>;</li><li>  }</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.bigItemIndex % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>) {</li><li>    <span class="hljs-keyword">if</span> (index - <span class="hljs-keyword">this</span>.bigItemIndex === <span class="hljs-number">2</span> || index - <span class="hljs-keyword">this</span>.bigItemIndex === <span class="hljs-number">1</span>) {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</li><li>    }</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-keyword">if</span> (index - <span class="hljs-keyword">this</span>.bigItemIndex === <span class="hljs-number">1</span>) {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;</li><li>    }</li><li>  }</li><li>  <span class="hljs-keyword">if</span> (index &gt; <span class="hljs-keyword">this</span>.bigItemIndex) {</li><li>    <span class="hljs-keyword">return</span> index % <span class="hljs-number">2</span> == <span class="hljs-number">1</span>;</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-keyword">return</span> index % <span class="hljs-number">2</span> == <span class="hljs-number">0</span>;</li><li>  }</li><li>}</li><li>
</li><li>down(index: number): void {</li><li>  <span class="hljs-keyword">if</span> ([<span class="hljs-keyword">this</span>.numbers.length - <span class="hljs-number">1</span>, <span class="hljs-keyword">this</span>.numbers.length - <span class="hljs-number">2</span>].includes(index)) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.bigItemIndex - index === <span class="hljs-number">1</span>) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-keyword">if</span> ([<span class="hljs-number">14</span>, <span class="hljs-number">15</span>].includes(<span class="hljs-keyword">this</span>.bigItemIndex) &amp;&amp; <span class="hljs-keyword">this</span>.bigItemIndex === index) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-keyword">this</span>.offsetY -= <span class="hljs-keyword">this</span>.FIX_VP_Y;</li><li>  <span class="hljs-keyword">this</span>.dragRefOffSetY += <span class="hljs-keyword">this</span>.FIX_VP_Y;</li><li>  <span class="hljs-keyword">if</span> (index - <span class="hljs-number">1</span> === <span class="hljs-keyword">this</span>.bigItemIndex) {</li><li>    <span class="hljs-keyword">this</span>.itemMove(index, index + <span class="hljs-number">1</span>);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-keyword">this</span>.itemMove(index, index + <span class="hljs-number">2</span>);</li><li>  }</li><li>}</li><li>
</li><li>up(index: number): void {</li><li>  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isDraggable(index - <span class="hljs-number">2</span>)) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-keyword">if</span> (index - <span class="hljs-keyword">this</span>.bigItemIndex === <span class="hljs-number">3</span>) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-keyword">this</span>.offsetY += <span class="hljs-keyword">this</span>.FIX_VP_Y;</li><li>  <span class="hljs-keyword">this</span>.dragRefOffSetY -= <span class="hljs-keyword">this</span>.FIX_VP_Y;</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.bigItemIndex === index) {</li><li>    <span class="hljs-keyword">this</span>.itemMove(index, index - <span class="hljs-number">2</span>);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-keyword">if</span> (index - <span class="hljs-number">2</span> === <span class="hljs-keyword">this</span>.bigItemIndex) {</li><li>      <span class="hljs-keyword">this</span>.itemMove(index, index - <span class="hljs-number">1</span>);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-keyword">this</span>.itemMove(index, index - <span class="hljs-number">2</span>);</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li>left(index: number): void {</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.bigItemIndex % <span class="hljs-number">2</span> === <span class="hljs-number">0</span>) {</li><li>    <span class="hljs-keyword">if</span> (index - <span class="hljs-keyword">this</span>.bigItemIndex === <span class="hljs-number">2</span>) {</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>  }</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isInLeft(index)) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isDraggable(index - <span class="hljs-number">1</span>)) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-keyword">this</span>.offsetX += <span class="hljs-keyword">this</span>.FIX_VP_X;</li><li>  <span class="hljs-keyword">this</span>.dragRefOffSetX -= <span class="hljs-keyword">this</span>.FIX_VP_X;</li><li>  <span class="hljs-keyword">this</span>.itemMove(index, index - <span class="hljs-number">1</span>)</li><li>}</li><li>
</li><li>right(index: number): void {</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.bigItemIndex % <span class="hljs-number">2</span> === <span class="hljs-number">1</span>) {</li><li>    <span class="hljs-keyword">if</span> (index - <span class="hljs-keyword">this</span>.bigItemIndex === <span class="hljs-number">1</span>) {</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>  }</li><li>  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isInLeft(index)) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isDraggable(index + <span class="hljs-number">1</span>)) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-keyword">this</span>.offsetX -= <span class="hljs-keyword">this</span>.FIX_VP_X;</li><li>  <span class="hljs-keyword">this</span>.dragRefOffSetX += <span class="hljs-keyword">this</span>.FIX_VP_X;</li><li>  <span class="hljs-keyword">this</span>.itemMove(index, index + <span class="hljs-number">1</span>)</li><li>}</li><li>
</li><li>isDraggable(index: number): boolean {</li><li>  <span class="hljs-keyword">return</span> index &gt;= <span class="hljs-number">0</span>;</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/DifferentItemDrag.ets#L68-L172" target="_blank">DifferentItemDrag.ets</a></div></div></div></div> </li><li>GridItem绑定组合手势：长按，拖拽。并在手势的回调函数中设置显式动画。<div class="screenLinkPre"><div _ngcontent-lbi-c106="" class="highlight-div"><div _ngcontent-lbi-c106="" class="highlight-div-header"><div _ngcontent-lbi-c106="" class="highlight-div-header-left"><div _ngcontent-lbi-c106="" class="handle-button expand-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lbi-c106="" class="highlight-div-header-right"><div _ngcontent-lbi-c106="" class="handle-button ai-button"></div><div _ngcontent-lbi-c106="" class="handle-button line-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lbi-c106="" class="handle-button theme-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lbi-c106="" class="handle-button copy-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lbi-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/DifferentItemDrag.ets#L286-L338" data-highlighted="yes"><ol class="linenums"><li>.gesture(</li><li>  GestureGroup(GestureMode.Sequence,</li><li>    LongPressGesture({ repeat: <span class="hljs-literal">true</span> })</li><li>      .onAction(() =&gt; {</li><li>        <span class="hljs-keyword">this</span>.getUIContext().animateTo({ curve: Curve.Friction, duration: <span class="hljs-number">300</span> }, () =&gt; {</li><li>          <span class="hljs-keyword">this</span>.scaleItem = item;</li><li>        })</li><li>      })</li><li>      .onActionEnd(() =&gt; {</li><li>        <span class="hljs-keyword">this</span>.getUIContext().animateTo({ curve: Curve.Friction, duration: <span class="hljs-number">300</span> }, () =&gt; {</li><li>          <span class="hljs-keyword">this</span>.scaleItem = -<span class="hljs-number">1</span>;</li><li>        })</li><li>      }),</li><li>    PanGesture({ fingers: <span class="hljs-number">1</span>, direction: <span class="hljs-literal">null</span>, distance: <span class="hljs-number">0</span> })</li><li>      .onActionStart(() =&gt; {</li><li>        <span class="hljs-keyword">this</span>.dragItem = item;</li><li>        <span class="hljs-keyword">this</span>.dragRefOffSetX = <span class="hljs-number">0</span>;</li><li>        <span class="hljs-keyword">this</span>.dragRefOffSetY = <span class="hljs-number">0</span>;</li><li>      })</li><li>      .onActionUpdate((event: GestureEvent) =&gt; {</li><li>        <span class="hljs-keyword">this</span>.offsetX = event.offsetX - <span class="hljs-keyword">this</span>.dragRefOffSetX;</li><li>        <span class="hljs-keyword">this</span>.offsetY = event.offsetY - <span class="hljs-keyword">this</span>.dragRefOffSetY;</li><li>        <span class="hljs-keyword">this</span>.getUIContext().animateTo({ curve: curves.interpolatingSpring(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">400</span>, <span class="hljs-number">38</span>) }, () =&gt; {</li><li>          let index = <span class="hljs-keyword">this</span>.numbers.indexOf(<span class="hljs-keyword">this</span>.dragItem);</li><li>          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetY &gt;= <span class="hljs-keyword">this</span>.FIX_VP_Y / <span class="hljs-number">2</span> &amp;&amp; (<span class="hljs-keyword">this</span>.offsetX &lt;= <span class="hljs-number">44</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetX &gt;= -<span class="hljs-number">44</span>)) {</li><li>            <span class="hljs-keyword">this</span>.down(index);</li><li>          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetY &lt;= -<span class="hljs-keyword">this</span>.FIX_VP_Y / <span class="hljs-number">2</span> &amp;&amp; (<span class="hljs-keyword">this</span>.offsetX &lt;= <span class="hljs-number">44</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetX &gt;= -<span class="hljs-number">44</span>)) {</li><li>            <span class="hljs-keyword">this</span>.up(index);</li><li>          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetX &gt;= <span class="hljs-keyword">this</span>.FIX_VP_X / <span class="hljs-number">2</span> &amp;&amp; (<span class="hljs-keyword">this</span>.offsetY &lt;= <span class="hljs-number">50</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetY &gt;= -<span class="hljs-number">50</span>)) {</li><li>            <span class="hljs-keyword">this</span>.right(index);</li><li>          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetX &lt;= -<span class="hljs-keyword">this</span>.FIX_VP_Y / <span class="hljs-number">2</span> &amp;&amp; (<span class="hljs-keyword">this</span>.offsetY &lt;= <span class="hljs-number">50</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetY &gt;= -<span class="hljs-number">50</span>)) {</li><li>            <span class="hljs-keyword">this</span>.left(index);</li><li>          }</li><li>        })</li><li>      })</li><li>      .onActionEnd(() =&gt; {</li><li>        <span class="hljs-keyword">this</span>.getUIContext().animateTo({ curve: curves.interpolatingSpring(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">400</span>, <span class="hljs-number">38</span>) }, () =&gt; {</li><li>          <span class="hljs-keyword">this</span>.dragItem = -<span class="hljs-number">1</span>;</li><li>        })</li><li>        <span class="hljs-keyword">this</span>.getUIContext().animateTo({ curve: curves.interpolatingSpring(<span class="hljs-number">14</span>, <span class="hljs-number">1</span>, <span class="hljs-number">170</span>, <span class="hljs-number">17</span>), delay: <span class="hljs-number">150</span> }, () =&gt; {</li><li>          <span class="hljs-keyword">this</span>.scaleItem = -<span class="hljs-number">1</span>;</li><li>        })</li><li>      })</li><li>  )</li><li>    .onCancel(() =&gt; {</li><li>      <span class="hljs-keyword">this</span>.getUIContext().animateTo({ curve: curves.interpolatingSpring(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">400</span>, <span class="hljs-number">38</span>) }, () =&gt; {</li><li>        <span class="hljs-keyword">this</span>.dragItem = -<span class="hljs-number">1</span>;</li><li>      })</li><li>      <span class="hljs-keyword">this</span>.getUIContext().animateTo({ curve: curves.interpolatingSpring(<span class="hljs-number">14</span>, <span class="hljs-number">1</span>, <span class="hljs-number">170</span>, <span class="hljs-number">17</span>), delay: <span class="hljs-number">150</span> }, () =&gt; {</li><li>        <span class="hljs-keyword">this</span>.scaleItem = -<span class="hljs-number">1</span>;</li><li>      })</li><li>    })</li><li>)</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/DifferentItemDrag.ets#L286-L338" target="_blank">DifferentItemDrag.ets</a></div></div></div></div> </li></ol> <div class="tiledSection"><h2 id="section9734142382016">两个Grid之间网格元素交换<i class="anchor-icon anchor-icon-link" anchorid="section9734142382016" tips="复制节点链接"></i></h2></div> <p>当场景涉及两个Grid之间的网格元素交换时，可使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ohos-arkui-advanced-gridobjectsortcomponent" target="_blank">GridObjectSortComponent</a>组件来实现。可以点击添加或者移除按钮，对网格元素进行交换。详细实现步骤请参见：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ohos-arkui-advanced-gridobjectsortcomponent#示例" target="_blank">示例</a>。开发者也可以在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ohos-arkui-advanced-gridobjectsortcomponent" target="_blank">GridObjectSortComponent</a>组件的<a href="https://gitee.com/openharmony/arkui_ace_engine/blob/master/advanced_ui_component/gridobjectsortcomponent/source/GridObjectSortComponent.ets" target="_blank">源码</a>基础上进行相应修改，实现更加丰富的功能。</p> <div class="tiledSection"><h2 id="section928371317219">网格元素直接拖拽，不需长按<i class="anchor-icon anchor-icon-link" anchorid="section928371317219" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section17491184512210" class="firsth2">场景描述<i class="anchor-icon anchor-icon-link" anchorid="section17491184512210" tips="复制节点链接"></i></h3></div> <p>在不需要长按拖拽的场景下，开发者可以将元素设置成直接拖拽，无需长按，即可完成元素的拖拽交换。</p> <p>示意效果图如下。</p> <p><span><img height="550.3407000000001" originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211162909.86426403523158518679922627625002:50001231000000:2800:D5E39DAA18423ED80763615830DF0A272BDE7E207890F8D74C8FA5941198E7DD.gif" title="点击放大" width="266"></span></p> <div class="tiledSection"><h3 id="section1589621228">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section1589621228" tips="复制节点链接"></i></h3></div> <ol><li>使用Grid布局及GridItem界面开发。<div class="screenLinkPre"><div _ngcontent-lbi-c106="" class="highlight-div"><div _ngcontent-lbi-c106="" class="highlight-div-header"><div _ngcontent-lbi-c106="" class="highlight-div-header-left"><div _ngcontent-lbi-c106="" class="handle-button expand-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lbi-c106="" class="highlight-div-header-right"><div _ngcontent-lbi-c106="" class="handle-button ai-button"></div><div _ngcontent-lbi-c106="" class="handle-button line-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lbi-c106="" class="handle-button theme-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lbi-c106="" class="handle-button copy-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lbi-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/DirectDragItem.ets#L227-L314" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title function_">Grid</span>() {</li><li>  <span class="hljs-title function_">ForEach</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">numbers</span>, (<span class="hljs-variable">item</span>: <span class="hljs-title class_">number</span>) =&gt; {</li><li>    <span class="hljs-title function_">GridItem</span>() {</li><li>      <span class="hljs-title function_">Column</span>() {</li><li>        <span class="hljs-title function_">Image</span>($<span class="hljs-title function_">r</span>(`<span class="hljs-variable">app</span>.<span class="hljs-variable">media</span>.<span class="hljs-variable">space</span>${<span class="hljs-variable">item</span>}`))</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-number">44</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">44</span>)</li><li>          .<span class="hljs-title function_">draggable</span>(<span class="hljs-keyword">false</span>)</li><li>        <span class="hljs-title function_">Image</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.media.space_bottom'</span>))</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-number">16</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">16</span>)</li><li>          .<span class="hljs-title function_">draggable</span>(<span class="hljs-keyword">false</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-number">73</span>)</li><li>      .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-variable">FlexAlign</span>.<span class="hljs-variable">Center</span>)</li><li>      .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">10</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F1F3F5'</span>)</li><li>      .<span class="hljs-title function_">animation</span>({ <span class="hljs-variable">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-title class_">Sharp</span>, <span class="hljs-variable">duration</span>: <span class="hljs-number">300</span> })</li><li>    }</li><li>    .<span class="hljs-title function_">scale</span>({ <span class="hljs-variable">x</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">scaleItem</span> === <span class="hljs-variable">item</span> ? <span class="hljs-number">1.05</span> : <span class="hljs-number">1</span>, <span class="hljs-variable">y</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">scaleItem</span> === <span class="hljs-variable">item</span> ? <span class="hljs-number">1.05</span> : <span class="hljs-number">1</span> })</li><li>    .<span class="hljs-title function_">zIndex</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">dragItem</span> === <span class="hljs-variable">item</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>)</li><li>    .<span class="hljs-title function_">translate</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">dragItem</span> === <span class="hljs-variable">item</span> ? { <span class="hljs-variable">x</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">offsetX</span>, <span class="hljs-variable">y</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">offsetY</span> } : { <span class="hljs-variable">x</span>: <span class="hljs-number">0</span>, <span class="hljs-variable">y</span>: <span class="hljs-number">0</span> })</li><li>    <span class="hljs-comment">// ...</span></li><li>  }, (<span class="hljs-variable">item</span>: <span class="hljs-title class_">number</span>) =&gt; <span class="hljs-variable">item</span>.<span class="hljs-title function_">toString</span>())</li><li>}</li><li>.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>.<span class="hljs-title function_">editMode</span>(<span class="hljs-keyword">true</span>)</li><li>.<span class="hljs-title function_">scrollBar</span>(<span class="hljs-variable">BarState</span>.<span class="hljs-variable">Off</span>)</li><li>.<span class="hljs-title function_">columnsTemplate</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">curBp</span> === <span class="hljs-string">'md'</span> ? <span class="hljs-string">'1fr 1fr 1fr 1fr 1fr'</span> : <span class="hljs-string">'1fr 1fr 1fr 1fr'</span>)</li><li>.<span class="hljs-title function_">columnsGap</span>(<span class="hljs-number">12</span>)</li><li>.<span class="hljs-title function_">rowsGap</span>(<span class="hljs-number">12</span>)</li><li>.<span class="hljs-title function_">margin</span>({ <span class="hljs-variable">top</span>: <span class="hljs-number">5</span> })</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/DirectDragItem.ets#L227-L314" target="_blank">DirectDragItem.ets</a></div></div></div></div> </li><li>定义网格元素移动过程中的相关计算函数。<div class="screenLinkPre"><div _ngcontent-lbi-c106="" class="highlight-div"><div _ngcontent-lbi-c106="" class="highlight-div-header"><div _ngcontent-lbi-c106="" class="highlight-div-header-left"><div _ngcontent-lbi-c106="" class="handle-button expand-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lbi-c106="" class="highlight-div-header-right"><div _ngcontent-lbi-c106="" class="handle-button ai-button"></div><div _ngcontent-lbi-c106="" class="handle-button line-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lbi-c106="" class="handle-button theme-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lbi-c106="" class="handle-button copy-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lbi-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/DirectDragItem.ets#L67-L166" data-highlighted="yes"><ol class="linenums"><li>itemMove(index: number, newIndex: number): void {</li><li>  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isDraggable(newIndex)) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  let tmp = <span class="hljs-keyword">this</span>.numbers.splice(index, <span class="hljs-number">1</span>);</li><li>  <span class="hljs-keyword">this</span>.numbers.splice(newIndex, <span class="hljs-number">0</span>, tmp[<span class="hljs-number">0</span>]);</li><li>}</li><li>
</li><li>down(index: number): void {</li><li>  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isDraggable(index + <span class="hljs-number">5</span>)) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-keyword">this</span>.offsetY -= <span class="hljs-keyword">this</span>.FIX_VP_Y;</li><li>  <span class="hljs-keyword">this</span>.dragRefOffSetY += <span class="hljs-keyword">this</span>.FIX_VP_Y;</li><li>  <span class="hljs-keyword">this</span>.itemMove(index, index + <span class="hljs-number">5</span>)</li><li>}</li><li>
</li><li>up(index: number): void {</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.curBp === <span class="hljs-string">'md'</span>) {</li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isDraggable(index - <span class="hljs-number">5</span>)) {</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-keyword">this</span>.offsetY += <span class="hljs-keyword">this</span>.FIX_VP_Y;</li><li>    <span class="hljs-keyword">this</span>.dragRefOffSetY -= <span class="hljs-keyword">this</span>.FIX_VP_Y;</li><li>    <span class="hljs-keyword">this</span>.itemMove(index, index - <span class="hljs-number">5</span>)</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isDraggable(index - <span class="hljs-number">4</span>)) {</li><li>      <span class="hljs-keyword">return</span>;</li><li>    }</li><li>    <span class="hljs-keyword">this</span>.offsetY += <span class="hljs-keyword">this</span>.FIX_VP_Y;</li><li>    <span class="hljs-keyword">this</span>.dragRefOffSetY -= <span class="hljs-keyword">this</span>.FIX_VP_Y;</li><li>    <span class="hljs-keyword">this</span>.itemMove(index, index - <span class="hljs-number">4</span>)</li><li>  }</li><li>}</li><li>
</li><li>left(index: number): void {</li><li>  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isDraggable(index - <span class="hljs-number">1</span>)) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-keyword">this</span>.offsetX += <span class="hljs-keyword">this</span>.FIX_VP_X;</li><li>  <span class="hljs-keyword">this</span>.dragRefOffSetX -= <span class="hljs-keyword">this</span>.FIX_VP_X;</li><li>  <span class="hljs-keyword">this</span>.itemMove(index, index - <span class="hljs-number">1</span>)</li><li>}</li><li>
</li><li>right(index: number): void {</li><li>  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isDraggable(index + <span class="hljs-number">1</span>)) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-keyword">this</span>.offsetX -= <span class="hljs-keyword">this</span>.FIX_VP_X;</li><li>  <span class="hljs-keyword">this</span>.dragRefOffSetX += <span class="hljs-keyword">this</span>.FIX_VP_X;</li><li>  <span class="hljs-keyword">this</span>.itemMove(index, index + <span class="hljs-number">1</span>)</li><li>}</li><li>
</li><li>lowerRight(index: number): void {</li><li>  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isDraggable(index + <span class="hljs-number">3</span>)) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-keyword">this</span>.offsetX -= <span class="hljs-keyword">this</span>.FIX_VP_X;</li><li>  <span class="hljs-keyword">this</span>.dragRefOffSetX += <span class="hljs-keyword">this</span>.FIX_VP_X;</li><li>  <span class="hljs-keyword">this</span>.offsetY -= <span class="hljs-keyword">this</span>.FIX_VP_Y;</li><li>  <span class="hljs-keyword">this</span>.dragRefOffSetY += <span class="hljs-keyword">this</span>.FIX_VP_Y;</li><li>  <span class="hljs-keyword">this</span>.itemMove(index, index + <span class="hljs-number">3</span>);</li><li>}</li><li>
</li><li>upperRight(index: number): void {</li><li>  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isDraggable(index - <span class="hljs-number">3</span>)) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-keyword">this</span>.offsetX -= <span class="hljs-keyword">this</span>.FIX_VP_X;</li><li>  <span class="hljs-keyword">this</span>.dragRefOffSetX += <span class="hljs-keyword">this</span>.FIX_VP_X;</li><li>  <span class="hljs-keyword">this</span>.offsetY += <span class="hljs-keyword">this</span>.FIX_VP_Y;</li><li>  <span class="hljs-keyword">this</span>.dragRefOffSetY -= <span class="hljs-keyword">this</span>.FIX_VP_Y;</li><li>  <span class="hljs-keyword">this</span>.itemMove(index, index - <span class="hljs-number">3</span>);</li><li>}</li><li>
</li><li>lowerLeft(index: number): void {</li><li>  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isDraggable(index + <span class="hljs-number">3</span>)) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-keyword">this</span>.offsetX += <span class="hljs-keyword">this</span>.FIX_VP_X;</li><li>  <span class="hljs-keyword">this</span>.dragRefOffSetX -= <span class="hljs-keyword">this</span>.FIX_VP_X;</li><li>  <span class="hljs-keyword">this</span>.offsetY -= <span class="hljs-keyword">this</span>.FIX_VP_Y;</li><li>  <span class="hljs-keyword">this</span>.dragRefOffSetY += <span class="hljs-keyword">this</span>.FIX_VP_Y;</li><li>  <span class="hljs-keyword">this</span>.itemMove(index, index + <span class="hljs-number">3</span>);</li><li>}</li><li>
</li><li>upperLeft(index: number): void {</li><li>  <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isDraggable(index - <span class="hljs-number">3</span>)) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-keyword">this</span>.offsetX += <span class="hljs-keyword">this</span>.FIX_VP_X;</li><li>  <span class="hljs-keyword">this</span>.dragRefOffSetX -= <span class="hljs-keyword">this</span>.FIX_VP_X;</li><li>  <span class="hljs-keyword">this</span>.offsetY += <span class="hljs-keyword">this</span>.FIX_VP_Y;</li><li>  <span class="hljs-keyword">this</span>.dragRefOffSetY -= <span class="hljs-keyword">this</span>.FIX_VP_Y;</li><li>  <span class="hljs-keyword">this</span>.itemMove(index, index - <span class="hljs-number">3</span>);</li><li>}</li><li>
</li><li>isDraggable(index: number): boolean {</li><li>  <span class="hljs-keyword">return</span> index &gt;= <span class="hljs-number">0</span>;</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/DirectDragItem.ets#L67-L166" target="_blank">DirectDragItem.ets</a></div></div></div></div> </li><li>GridItem绑定拖拽手势，并在手势的回调函数中设置显式动画。<div class="screenLinkPre"><div _ngcontent-lbi-c106="" class="highlight-div"><div _ngcontent-lbi-c106="" class="highlight-div-header"><div _ngcontent-lbi-c106="" class="highlight-div-header-left"><div _ngcontent-lbi-c106="" class="handle-button expand-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lbi-c106="" class="highlight-div-header-right"><div _ngcontent-lbi-c106="" class="handle-button ai-button"></div><div _ngcontent-lbi-c106="" class="handle-button line-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lbi-c106="" class="handle-button theme-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lbi-c106="" class="handle-button copy-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lbi-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/DirectDragItem.ets#L252-L303" data-highlighted="yes"><ol class="linenums"><li>.gesture(</li><li>  PanGesture({ fingers: <span class="hljs-number">1</span>, direction: <span class="hljs-literal">null</span>, distance: <span class="hljs-number">0</span> })</li><li>    .onActionStart(() =&gt; {</li><li>      <span class="hljs-keyword">this</span>.dragItem = item;</li><li>      <span class="hljs-keyword">this</span>.dragRefOffSetX = <span class="hljs-number">0</span>;</li><li>      <span class="hljs-keyword">this</span>.dragRefOffSetY = <span class="hljs-number">0</span>;</li><li>    })</li><li>    .onActionUpdate((event: GestureEvent) =&gt; {</li><li>      <span class="hljs-keyword">this</span>.offsetX = event.offsetX - <span class="hljs-keyword">this</span>.dragRefOffSetX;</li><li>      <span class="hljs-keyword">this</span>.offsetY = event.offsetY - <span class="hljs-keyword">this</span>.dragRefOffSetY;</li><li>      <span class="hljs-keyword">this</span>.getUIContext().animateTo({ curve: curves.interpolatingSpring(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">400</span>, <span class="hljs-number">38</span>) }, () =&gt; {</li><li>        let index = <span class="hljs-keyword">this</span>.numbers.indexOf(<span class="hljs-keyword">this</span>.dragItem);</li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.curBp === <span class="hljs-string">'md'</span>) {</li><li>          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetX &gt;= <span class="hljs-keyword">this</span>.FIX_VP_X / <span class="hljs-number">2</span> &amp;&amp; (<span class="hljs-keyword">this</span>.offsetY &lt;= <span class="hljs-number">50</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetY &gt;= -<span class="hljs-number">50</span>) &amp;&amp;</li><li>            ![<span class="hljs-number">4</span>].includes(index)) {</li><li>            <span class="hljs-keyword">this</span>.right(index);</li><li>          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetX &lt;= -<span class="hljs-keyword">this</span>.FIX_VP_X / <span class="hljs-number">2</span> &amp;&amp; (<span class="hljs-keyword">this</span>.offsetY &lt;= <span class="hljs-number">50</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetY &gt;= -<span class="hljs-number">50</span>)) {</li><li>            <span class="hljs-keyword">this</span>.left(index);</li><li>          }</li><li>        } <span class="hljs-keyword">else</span> {</li><li>          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetY &gt;= <span class="hljs-keyword">this</span>.FIX_VP_Y / <span class="hljs-number">2</span> &amp;&amp; (<span class="hljs-keyword">this</span>.offsetX &lt;= <span class="hljs-number">44</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetX &gt;= -<span class="hljs-number">44</span>) &amp;&amp;</li><li>            ![<span class="hljs-number">1</span>, <span class="hljs-number">2</span>, <span class="hljs-number">3</span>, <span class="hljs-number">4</span>].includes(index)) {</li><li>            <span class="hljs-keyword">this</span>.down(index);</li><li>          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetY &lt;= -<span class="hljs-keyword">this</span>.FIX_VP_Y / <span class="hljs-number">2</span> &amp;&amp; (<span class="hljs-keyword">this</span>.offsetX &lt;= <span class="hljs-number">44</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetX &gt;= -<span class="hljs-number">44</span>)) {</li><li>            <span class="hljs-keyword">this</span>.up(index);</li><li>          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetX &gt;= <span class="hljs-keyword">this</span>.FIX_VP_X / <span class="hljs-number">2</span> &amp;&amp; (<span class="hljs-keyword">this</span>.offsetY &lt;= <span class="hljs-number">50</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetY &gt;= -<span class="hljs-number">50</span>) &amp;&amp;</li><li>            ![<span class="hljs-number">3</span>, <span class="hljs-number">4</span>].includes(index)) {</li><li>            <span class="hljs-keyword">this</span>.right(index);</li><li>          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetX &lt;= -<span class="hljs-keyword">this</span>.FIX_VP_Y / <span class="hljs-number">2</span> &amp;&amp; (<span class="hljs-keyword">this</span>.offsetY &lt;= <span class="hljs-number">50</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetY &gt;= -<span class="hljs-number">50</span>) &amp;&amp;</li><li>            ![<span class="hljs-number">4</span>].includes(index)) {</li><li>            <span class="hljs-keyword">this</span>.left(index);</li><li>          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetX &gt;= <span class="hljs-keyword">this</span>.FIX_VP_X / <span class="hljs-number">2</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetY &gt;= <span class="hljs-keyword">this</span>.FIX_VP_Y / <span class="hljs-number">2</span>) {</li><li>            <span class="hljs-keyword">this</span>.lowerRight(index);</li><li>          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetX &gt;= <span class="hljs-keyword">this</span>.FIX_VP_X / <span class="hljs-number">2</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetY &lt;= -<span class="hljs-keyword">this</span>.FIX_VP_Y / <span class="hljs-number">2</span>) {</li><li>            <span class="hljs-keyword">this</span>.upperRight(index);</li><li>          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetX &lt;= -<span class="hljs-keyword">this</span>.FIX_VP_X / <span class="hljs-number">2</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetY &gt;= <span class="hljs-keyword">this</span>.FIX_VP_Y / <span class="hljs-number">2</span>) {</li><li>            <span class="hljs-keyword">this</span>.lowerLeft(index);</li><li>          } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetX &lt;= -<span class="hljs-keyword">this</span>.FIX_VP_X / <span class="hljs-number">2</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetY &lt;= -<span class="hljs-keyword">this</span>.FIX_VP_Y / <span class="hljs-number">2</span>) {</li><li>            <span class="hljs-keyword">this</span>.upperLeft(index);</li><li>          }</li><li>        }</li><li>      })</li><li>    })</li><li>    .onActionEnd(() =&gt; {</li><li>      <span class="hljs-keyword">this</span>.getUIContext().animateTo({ curve: curves.interpolatingSpring(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">400</span>, <span class="hljs-number">38</span>) }, () =&gt; {</li><li>        <span class="hljs-keyword">this</span>.dragItem = -<span class="hljs-number">1</span>;</li><li>      })</li><li>      <span class="hljs-keyword">this</span>.getUIContext().animateTo({ curve: curves.interpolatingSpring(<span class="hljs-number">14</span>, <span class="hljs-number">1</span>, <span class="hljs-number">170</span>, <span class="hljs-number">17</span>), delay: <span class="hljs-number">150</span> }, () =&gt; {</li><li>        <span class="hljs-keyword">this</span>.scaleItem = -<span class="hljs-number">1</span>;</li><li>      })</li><li>    })</li><li>)</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/DirectDragItem.ets#L252-L303" target="_blank">DirectDragItem.ets</a></div></div></div></div> </li></ol> <div class="tiledSection"><h2 id="section11248202382219">网格元素长按后，显示抖动动画<i class="anchor-icon anchor-icon-link" anchorid="section11248202382219" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section4344438162219" class="firsth2">场景描述<i class="anchor-icon anchor-icon-link" anchorid="section4344438162219" tips="复制节点链接"></i></h3></div> <p>在设备列表页面时，如果想要移除设备，在选中设备并长按后，可对网格元素进行编辑。此时，设备图片会有抖动的效果。</p> <p>示意效果图如下。</p> <p><span><img height="545.5261" originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211162909.69355589397660079864252041845891:50001231000000:2800:C5C8F7FC3DD1D781EFC1AD7578E1D1DE69E3076B086C570C44380D7FECE0CA69.gif" title="点击放大" width="266"></span></p> <div class="tiledSection"><h3 id="section195201151122218">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section195201151122218" tips="复制节点链接"></i></h3></div> <ol><li>使用Grid布局及GridItem界面开发。<div class="screenLinkPre"><div _ngcontent-lbi-c106="" class="highlight-div"><div _ngcontent-lbi-c106="" class="highlight-div-header"><div _ngcontent-lbi-c106="" class="highlight-div-header-left"><div _ngcontent-lbi-c106="" class="handle-button expand-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lbi-c106="" class="highlight-div-header-right"><div _ngcontent-lbi-c106="" class="handle-button ai-button"></div><div _ngcontent-lbi-c106="" class="handle-button line-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lbi-c106="" class="handle-button theme-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lbi-c106="" class="handle-button copy-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lbi-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/JitterAnimation.ets#L234-L365" data-highlighted="yes"><ol class="linenums"><li>Grid() {</li><li>  ForEach(<span class="hljs-keyword">this</span>.numbers, (item: number) =&gt; {</li><li>    GridItem() {</li><li>      Stack({ alignContent: Alignment.TopEnd }) {</li><li>        Column() {</li><li>          Image($r(`app.media.space${item}`))</li><li>            .width(<span class="hljs-number">44</span>)</li><li>            .height(<span class="hljs-number">44</span>)</li><li>            .draggable(<span class="hljs-literal">false</span>)</li><li>          Image($r(<span class="hljs-string">'app.media.space_bottom'</span>))</li><li>            .width(<span class="hljs-number">16</span>)</li><li>            .height(<span class="hljs-number">16</span>)</li><li>            .draggable(<span class="hljs-literal">false</span>)</li><li>        }</li><li>        .width(<span class="hljs-string">'100%'</span>)</li><li>        .height(<span class="hljs-number">73</span>)</li><li>        .justifyContent(FlexAlign.Center)</li><li>        .borderRadius(<span class="hljs-number">10</span>)</li><li>        .backgroundColor(<span class="hljs-string">'#F1F3F5'</span>)</li><li>        .animation({ curve: Curve.Sharp, duration: <span class="hljs-number">300</span> })</li><li>        .onClick(() =&gt; {</li><li>          <span class="hljs-keyword">return</span>;</li><li>        })</li><li>
</li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isEdit) {</li><li>          Image($r(<span class="hljs-string">'app.media.close'</span>))</li><li>            .width(<span class="hljs-number">20</span>)</li><li>            .height(<span class="hljs-number">20</span>)</li><li>            .objectFit(ImageFit.Contain)</li><li>            .draggable(<span class="hljs-literal">false</span>)</li><li>            .position({</li><li>              x: <span class="hljs-keyword">this</span>.isFoldAble &amp;&amp; <span class="hljs-keyword">this</span>.foldStatus === <span class="hljs-number">2</span> ? <span class="hljs-number">60</span> :</li><li>                <span class="hljs-keyword">this</span>.isFoldAble &amp;&amp; <span class="hljs-keyword">this</span>.foldStatus === <span class="hljs-number">1</span> ? <span class="hljs-number">86</span> : <span class="hljs-number">70</span>,</li><li>              y: -<span class="hljs-number">8</span></li><li>            })</li><li>            .onClick(() =&gt; {</li><li>              <span class="hljs-keyword">this</span>.getUIContext().animateTo({ duration: <span class="hljs-number">300</span> }, () =&gt; {</li><li>                <span class="hljs-keyword">this</span>.numbers = <span class="hljs-keyword">this</span>.numbers.filter((element) =&gt; element !== item);</li><li>              })</li><li>            })</li><li>        }</li><li>      }</li><li>    }</li><li>    .rotate({</li><li>      z: <span class="hljs-keyword">this</span>.rotateZ,</li><li>      angle: <span class="hljs-number">1</span>,</li><li>      centerX: <span class="hljs-string">'50%'</span>,</li><li>      centerY: <span class="hljs-string">'50%'</span></li><li>    })</li><li>    .width(<span class="hljs-string">'100%'</span>)</li><li>    .zIndex(<span class="hljs-keyword">this</span>.dragItem === item ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>)</li><li>    .translate(<span class="hljs-keyword">this</span>.dragItem === item ? { x: <span class="hljs-keyword">this</span>.offsetX, y: <span class="hljs-keyword">this</span>.offsetY } : { x: <span class="hljs-number">0</span>, y: <span class="hljs-number">0</span> })</li><li>    <span class="hljs-comment">// ...</span></li><li>  }, (item: number) =&gt; item.toString())</li><li>}</li><li>.width(<span class="hljs-string">'100%'</span>)</li><li>.height(<span class="hljs-string">'100%'</span>)</li><li>.editMode(<span class="hljs-literal">true</span>)</li><li>.clip(<span class="hljs-literal">false</span>)</li><li>.scrollBar(BarState.Off)</li><li>.columnsTemplate(<span class="hljs-keyword">this</span>.curBp === <span class="hljs-string">'md'</span> ? <span class="hljs-string">'1fr 1fr 1fr 1fr 1fr'</span> : <span class="hljs-string">'1fr 1fr 1fr 1fr'</span>)</li><li>.columnsGap(<span class="hljs-number">12</span>)</li><li>.rowsGap(<span class="hljs-number">12</span>)</li><li>.margin({ top: <span class="hljs-number">5</span> })</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/JitterAnimation.ets#L234-L365" target="_blank">JitterAnimation.ets</a></div></div></div></div> </li><li>添加抖动动画。<div class="screenLinkPre"><div _ngcontent-lbi-c106="" class="highlight-div"><div _ngcontent-lbi-c106="" class="highlight-div-header"><div _ngcontent-lbi-c106="" class="highlight-div-header-left"><div _ngcontent-lbi-c106="" class="handle-button expand-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lbi-c106="" class="highlight-div-header-right"><div _ngcontent-lbi-c106="" class="handle-button ai-button"></div><div _ngcontent-lbi-c106="" class="handle-button line-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lbi-c106="" class="handle-button theme-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lbi-c106="" class="handle-button copy-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lbi-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/JitterAnimation.ets#L153-L169" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">private</span> <span class="hljs-title function_">jumpWithSpeed</span>(<span class="hljs-variable">speed</span>: <span class="hljs-title class_">number</span>) {</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.<span class="hljs-variable">isEdit</span>) {</li><li>    <span class="hljs-keyword">this</span>.<span class="hljs-variable">rotateZ</span> = -<span class="hljs-number">1</span>;</li><li>    <span class="hljs-keyword">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">animateTo</span>({</li><li>      <span class="hljs-variable">delay</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-variable">tempo</span>: <span class="hljs-title class_">speed</span>,</li><li>      <span class="hljs-variable">duration</span>: <span class="hljs-number">1000</span>,</li><li>      <span class="hljs-variable">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-title class_">Smooth</span>,</li><li>      <span class="hljs-variable">playMode</span>: <span class="hljs-title class_">PlayMode</span>.<span class="hljs-title class_">Normal</span>,</li><li>      <span class="hljs-variable">iterations</span>: -<span class="hljs-number">1</span></li><li>    }, () =&gt; {</li><li>      <span class="hljs-keyword">this</span>.<span class="hljs-variable">rotateZ</span> = <span class="hljs-number">1</span>;</li><li>    })</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-keyword">this</span>.<span class="hljs-title function_">stopJump</span>();</li><li>  }</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/JitterAnimation.ets#L153-L169" target="_blank">JitterAnimation.ets</a></div></div></div></div> </li><li>定义stopJump()方法，执行后，能使网格元素停止抖动。<div class="screenLinkPre"><div _ngcontent-lbi-c106="" class="highlight-div"><div _ngcontent-lbi-c106="" class="highlight-div-header"><div _ngcontent-lbi-c106="" class="highlight-div-header-left"><div _ngcontent-lbi-c106="" class="handle-button expand-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lbi-c106="" class="highlight-div-header-right"><div _ngcontent-lbi-c106="" class="handle-button ai-button"></div><div _ngcontent-lbi-c106="" class="handle-button line-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lbi-c106="" class="handle-button theme-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lbi-c106="" class="handle-button copy-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lbi-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/JitterAnimation.ets#L138-L149" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">private</span> <span class="hljs-title function_">stopJump</span>() {</li><li>  <span class="hljs-keyword">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">animateTo</span>({</li><li>    <span class="hljs-variable">delay</span>: <span class="hljs-number">0</span>,</li><li>    <span class="hljs-variable">tempo</span>: <span class="hljs-number">5</span>,</li><li>    <span class="hljs-variable">duration</span>: <span class="hljs-number">0</span>,</li><li>    <span class="hljs-variable">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-title class_">Smooth</span>,</li><li>    <span class="hljs-variable">playMode</span>: <span class="hljs-title class_">PlayMode</span>.<span class="hljs-title class_">Normal</span>,</li><li>    <span class="hljs-variable">iterations</span>: <span class="hljs-number">1</span></li><li>  }, () =&gt; {</li><li>    <span class="hljs-keyword">this</span>.<span class="hljs-variable">rotateZ</span> = <span class="hljs-number">0</span>;</li><li>  })</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/JitterAnimation.ets#L138-L149" target="_blank">JitterAnimation.ets</a></div></div></div></div> </li><li>GridItem绑定组合手势：长按、拖拽。并在手势的回调函数中设置显式动画。<div class="screenLinkPre"><div _ngcontent-lbi-c106="" class="highlight-div"><div _ngcontent-lbi-c106="" class="highlight-div-header"><div _ngcontent-lbi-c106="" class="highlight-div-header-left"><div _ngcontent-lbi-c106="" class="handle-button expand-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-lbi-c106="" class="highlight-div-header-right"><div _ngcontent-lbi-c106="" class="handle-button ai-button"></div><div _ngcontent-lbi-c106="" class="handle-button line-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-lbi-c106="" class="handle-button theme-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-lbi-c106="" class="handle-button copy-button"><div _ngcontent-lbi-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-lbi-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/JitterAnimation.ets#L288-L352" data-highlighted="yes"><ol class="linenums"><li>.gesture(</li><li>  GestureGroup(GestureMode.Sequence,</li><li>    LongPressGesture({ repeat: <span class="hljs-literal">true</span> })</li><li>      .onAction(() =&gt; {</li><li>        <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isEdit) {</li><li>          <span class="hljs-keyword">this</span>.isEdit = <span class="hljs-literal">true</span>;</li><li>          <span class="hljs-keyword">this</span>.jumpWithSpeed(<span class="hljs-number">5</span>);</li><li>        }</li><li>      }),</li><li>    PanGesture({ fingers: <span class="hljs-number">1</span>, direction: <span class="hljs-literal">null</span>, distance: <span class="hljs-number">0</span> })</li><li>      .onActionStart(() =&gt; {</li><li>        <span class="hljs-keyword">this</span>.dragItem = item;</li><li>        <span class="hljs-keyword">this</span>.dragRefOffSetX = <span class="hljs-number">0</span>;</li><li>        <span class="hljs-keyword">this</span>.dragRefOffSetY = <span class="hljs-number">0</span>;</li><li>      })</li><li>      .onActionUpdate((event: GestureEvent) =&gt; {</li><li>        <span class="hljs-keyword">this</span>.offsetX = event.offsetX - <span class="hljs-keyword">this</span>.dragRefOffSetX;</li><li>        <span class="hljs-keyword">this</span>.offsetY = event.offsetY - <span class="hljs-keyword">this</span>.dragRefOffSetY;</li><li>        <span class="hljs-keyword">this</span>.getUIContext().animateTo({ curve: curves.interpolatingSpring(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">400</span>, <span class="hljs-number">38</span>) }, () =&gt; {</li><li>          let index = <span class="hljs-keyword">this</span>.numbers.indexOf(<span class="hljs-keyword">this</span>.dragItem);</li><li>          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.curBp === <span class="hljs-string">'md'</span>) {</li><li>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetX &gt;= <span class="hljs-keyword">this</span>.FIX_VP_X / <span class="hljs-number">2</span> &amp;&amp; (<span class="hljs-keyword">this</span>.offsetY &lt;= <span class="hljs-number">50</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetY &gt;= -<span class="hljs-number">50</span>) &amp;&amp;</li><li>              ![<span class="hljs-number">4</span>].includes(index)) {</li><li>              <span class="hljs-keyword">this</span>.right(index);</li><li>              <span class="hljs-keyword">this</span>.stopJump();</li><li>              <span class="hljs-keyword">this</span>.jumpWithSpeed(<span class="hljs-number">5</span>);</li><li>            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetX &lt;= -<span class="hljs-keyword">this</span>.FIX_VP_X / <span class="hljs-number">2</span> &amp;&amp;</li><li>              (<span class="hljs-keyword">this</span>.offsetY &lt;= <span class="hljs-number">50</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetY &gt;= -<span class="hljs-number">50</span>)) {</li><li>              <span class="hljs-keyword">this</span>.left(index);</li><li>              <span class="hljs-keyword">this</span>.stopJump();</li><li>              <span class="hljs-keyword">this</span>.jumpWithSpeed(<span class="hljs-number">5</span>);</li><li>            }</li><li>          } <span class="hljs-keyword">else</span> {</li><li>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetY &gt;= <span class="hljs-keyword">this</span>.FIX_VP_Y / <span class="hljs-number">2</span> &amp;&amp; (<span class="hljs-keyword">this</span>.offsetX &lt;= <span class="hljs-number">44</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetX &gt;= -<span class="hljs-number">44</span>) &amp;&amp;</li><li>            [...<span class="hljs-keyword">this</span>.downArr].includes(index)) {</li><li>              <span class="hljs-keyword">this</span>.down(index);</li><li>              <span class="hljs-keyword">this</span>.stopJump();</li><li>              <span class="hljs-keyword">this</span>.jumpWithSpeed(<span class="hljs-number">5</span>);</li><li>            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetY &lt;= -<span class="hljs-keyword">this</span>.FIX_VP_Y / <span class="hljs-number">2</span> &amp;&amp;</li><li>              (<span class="hljs-keyword">this</span>.offsetX &lt;= <span class="hljs-number">44</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetX &gt;= -<span class="hljs-number">44</span>)) {</li><li>              <span class="hljs-keyword">this</span>.up(index);</li><li>              <span class="hljs-keyword">this</span>.stopJump();</li><li>              <span class="hljs-keyword">this</span>.jumpWithSpeed(<span class="hljs-number">5</span>);</li><li>            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetX &gt;= <span class="hljs-keyword">this</span>.FIX_VP_X / <span class="hljs-number">2</span> &amp;&amp; (<span class="hljs-keyword">this</span>.offsetY &lt;= <span class="hljs-number">50</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetY &gt;= -<span class="hljs-number">50</span>) &amp;&amp;</li><li>              ![...<span class="hljs-keyword">this</span>.rightArr].includes(index)) {</li><li>              <span class="hljs-keyword">this</span>.right(index);</li><li>              <span class="hljs-keyword">this</span>.stopJump();</li><li>              <span class="hljs-keyword">this</span>.jumpWithSpeed(<span class="hljs-number">5</span>);</li><li>            } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.offsetX &lt;= -<span class="hljs-keyword">this</span>.FIX_VP_Y / <span class="hljs-number">2</span> &amp;&amp;</li><li>              (<span class="hljs-keyword">this</span>.offsetY &lt;= <span class="hljs-number">50</span> &amp;&amp; <span class="hljs-keyword">this</span>.offsetY &gt;= -<span class="hljs-number">50</span>) &amp;&amp;</li><li>              ![...<span class="hljs-keyword">this</span>.leftArr].includes(index)) {</li><li>              <span class="hljs-keyword">this</span>.left(index);</li><li>              <span class="hljs-keyword">this</span>.stopJump();</li><li>              <span class="hljs-keyword">this</span>.jumpWithSpeed(<span class="hljs-number">5</span>);</li><li>            }</li><li>          }</li><li>        })</li><li>      })</li><li>      .onActionEnd(() =&gt; {</li><li>        <span class="hljs-keyword">this</span>.getUIContext().animateTo({ curve: curves.interpolatingSpring(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">400</span>, <span class="hljs-number">38</span>) }, () =&gt; {</li><li>          <span class="hljs-keyword">this</span>.dragItem = -<span class="hljs-number">1</span>;</li><li>        })</li><li>      })</li><li>  )</li><li>)</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/grid-drag-sort/blob/master/entry/src/main/ets/pages/JitterAnimation.ets#L288-L352" target="_blank">JitterAnimation.ets</a></div></div></div></div> </li></ol> <div class="tiledSection"><h2 id="section541514337143">示例代码<i class="anchor-icon anchor-icon-link" anchorid="section541514337143" tips="复制节点链接"></i></h2><ul><li><a href="https://gitee.com/harmonyos_samples/grid-drag-sort" target="_blank">Grid网格元素拖拽交换</a></li></ul> </div> </div> <div></div></div>