<h1 _ngcontent-pag-c119="" class="doc-title ng-star-inserted" title="地址越界检测能力概述"> 地址越界检测能力概述 </h1>

<div _ngcontent-pag-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><p>地址越界检测功能主要用于帮助开发者在调试和压力测试阶段发现内存非法访问问题，如越界读写、Use-After-Free、Double-Free等。这些问题通常难以通过崩溃日志直接确定根本原因。为此，DevEco Studio提供了ASan（Address  Sanitizer）、HWASan（Hardware-Assisted Address Sanitizer）、MemDebug（Memory Debug）、GWP-ASan等多种检测工具，在运行时监控内存访问行为，及时捕获并报告潜在的地址越界问题，提高问题发现的效率和定位的准确性。这些工具在检测精度、性能开销和适用场景上各有侧重，分别适用于开发调试和商用发布的不同阶段。</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.2.1.6.1.1" valign="top" width="5.63%"><p>能力项</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.1.6.1.2" valign="top" width="16.79%"><p>ASan</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.1.6.1.3" valign="top" width="35.55%"><p>HWASan</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.1.6.1.4" valign="top" width="15.540000000000001%"><p>MemDebug</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.2.1.6.1.5" valign="top" width="26.490000000000002%"><p>GWP-ASan</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="5.63%"><p><strong>概述</strong></p> </td> <td class="cellrowborder" valign="top" width="16.79%"><p>基于Shadow Memory与红区机制来检测越界问题。</p> </td> <td class="cellrowborder" valign="top" width="35.55%"><p>基于指针Tag与Shadow Memory机制，通过硬件支持实现Tag校验来检测越界问题。</p> </td> <td class="cellrowborder" valign="top" width="15.540000000000001%"><p>采用隔离区加投毒填充的机制，并复用 HWASan的Tag校验对一部分问题进行检测。</p> </td> <td class="cellrowborder" valign="top" width="26.490000000000002%"><p>通过采样插桩拦截部分堆分配，检测释放后使用、堆溢出等典型内存错误。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="5.63%"><p><strong>优势</strong></p> </td> <td class="cellrowborder" valign="top" width="16.79%"><p><span style="color: rgb(73,73,73);">检测能力较强</span><span style="color: rgb(25,25,25);">，覆盖类型多</span>。</p> </td> <td class="cellrowborder" valign="top" width="35.55%"><ol><li>与ASan相比，HWASan无需安全区来检测buffer overflow，这不仅显著减少了工具对内存的消耗，还避免了ASan中某些overflow无法检测的问题。</li><li>HWASan也不需要隔离区来检测UseAfterFree，因此不会出现ASan中某些UseAfterFree检测不到的情况。</li><li>对于内存的二次释放free场景，启用HWASan后，无需代码插桩即可进行检测。</li><li>HWASan还能检测返回后的堆栈使用情况。</li></ol> </td> <td class="cellrowborder" valign="top" width="15.540000000000001%"><p><span style="color: rgb(25,25,25);">无需应用适配</span>。</p> </td> <td class="cellrowborder" valign="top" width="26.490000000000002%"><ol><li><span style="color: rgb(25,25,25);">无需应用适配</span>。</li><li><span style="color: rgb(25,25,25);">&lt;</span><span style="color: rgb(25,25,25);">5%</span><span style="color: rgb(25,25,25);">性能影响，很轻量</span>。</li></ol> </td> </tr> <tr><td class="cellrowborder" valign="top" width="5.63%"><p><strong>劣势</strong></p> </td> <td class="cellrowborder" valign="top" width="16.79%"><ol><li><span style="color: rgb(25,25,25);">需要应用适配插桩</span>。</li><li><span style="color: rgb(25,25,25);">2</span><span style="color: rgb(25,25,25);">倍</span><span style="color: rgb(25,25,25);">CPU</span><span style="color: rgb(25,25,25);">和内存开销</span>。</li></ol> </td> <td class="cellrowborder" valign="top" width="35.55%"><ol><li><span style="color: rgb(25,25,25);">需要应用适配插桩</span>。</li><li><span style="color: rgb(25,25,25);">2倍</span><span style="color: rgb(25,25,25);">CPU</span><span style="color: rgb(25,25,25);">开销和10%~35%的内存影响</span>。</li></ol> </td> <td class="cellrowborder" valign="top" width="15.540000000000001%"><ol><li><span style="color: rgb(25,25,25);">检测能力有限</span>。</li><li><span style="color: rgb(25,25,25);">10-20%</span><span style="color: rgb(25,25,25);">性能和内存影响</span>。</li></ol> </td> <td class="cellrowborder" valign="top" width="26.490000000000002%"><p><span style="color: rgb(25,25,25);">检测能力有限</span>。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="5.63%"><p><strong>适用场景</strong></p> </td> <td class="cellrowborder" valign="top" width="16.79%"><p>开发态（调试压测）。</p> </td> <td class="cellrowborder" valign="top" width="35.55%"><p>开发态（调试压测）。</p> </td> <td class="cellrowborder" valign="top" width="15.540000000000001%"><p>开发态（调试压测）。</p> </td> <td class="cellrowborder" valign="top" width="26.490000000000002%"><p>运行态（商用）。</p> </td> </tr>  </tbody></table></div> </div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><ol><li>ASan、HWASan、MemDebug对应用性能有影响，仅适用于开发调试和压力测试阶段。在应用上架前，请确保已关闭这些功能（检查方法：解压hap包，检查module.json文件中是否包含asanEnable或hwasanEnable字段，并且字段值为true）。</li><li>ASan相较于HWASan资源消耗更大，建议优先使用HWASan。</li></ol> </div></div></div> </div> <div></div></div>