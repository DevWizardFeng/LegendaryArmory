<h1 _ngcontent-kvl-c119="" class="doc-title ng-star-inserted" title="多目标产物构建"> 多目标产物构建 </h1>

<div _ngcontent-kvl-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section1815614103523">概述<i class="anchor-icon anchor-icon-link" anchorid="section1815614103523" tips="复制节点链接"></i></h2><p>多目标产物在HarmonyOS系统中的应用主要体现在软件开发与分发方面，特别是针对不同用户群体、不同业务场景的需求进行定制化开发。多目标产物为开发者提供了更加灵活和高效的开发方式，使得应用能够更好地适应市场需求和变化。通过定制化开发，还可以更好地满足用户的个性化需求，提升用户体验。</p> </div> <div class="tiledSection"><h3 id="section2733194914351" class="firsth2">基本概念<i class="anchor-icon anchor-icon-link" anchorid="section2733194914351" tips="复制节点链接"></i></h3><ul><li>target：对应HAR、HSP、HAP的多目标产物。工程内的每一个模块可以定义多个target，每个Target对应一个定制的HAP、HAR包，通过配置可以实现一个模块构建出不同的HAP、HAR包。</li><li>product：对应App的多目标产物。一个HarmonyOS工程的构建产物为App包，一个工程可以定义多个product，每个product对应一个定制化应用包，通过配置可以实现一个工程构建出多个不同的应用包。</li></ul> <p>在构建过程中，鸿蒙构建系统会根据配置文件中定义的product和target信息，生成相应的构建产物。对于每个target，构建系统会生成一个对应的HAP/HSP/HAR。这个HAP/HSP/HAR包含了该target所需的所有代码和资源。对于每个product，构建系统会生成一个包含了其所有依赖的target的App包。这个App包可以用于发布和上架到应用市场。</p> </div> <div class="tiledSection"><h3 id="section246105811131">应用场景<i class="anchor-icon anchor-icon-link" anchorid="section246105811131" tips="复制节点链接"></i></h3><p>主要应用场景:</p> <ul><li>不同用户群体：针对不同的用户群体（如国内用户与国际用户等），系统支持构建不同的应用版本。这些版本在功能、界面、语言等方面可能有所不同，以满足不同用户群体的需求。</li><li>不同业务场景：在不同的业务场景中，同一个应用可能需要提供不同的功能或资源。例如，一个在线教育应用可能需要为学生提供学习资料，而为教师提供教学资料。HarmonyOS系统支持通过配置不同的Target来实现这种差异化定制。</li></ul> <p>针对以上场景，开发者需要通过修改build-profile.json5、module.json5等配置文件，定义出不同的product和target。在这些配置文件中，开发者不仅可以为每个target指定不同的设备类型、源码集、资源等，并且还可以根据业务需要为不同的product分配不同的target。然后在构建过程中，构建工具会根据这些配置生成不同的target，然后通过不同的target搭配构建出不同的product产物。</p> <p>本文将通过一个具体的案例来介绍如何配置不同资源以及如何构建出多目标产物。</p> </div> <div class="tiledSection"><h2 id="section589512442151">实现原理<i class="anchor-icon anchor-icon-link" anchorid="section589512442151" tips="复制节点链接"></i></h2><p>HarmonyOS多目标产物支持<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/hap-package" target="_blank">HAP</a>（应用安装的基本单位，每个HAP都对应一个应用模块）、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/har-package" target="_blank">HAR</a>（静态共享包）、<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/in-app-hsp" target="_blank">HSP</a>（动态共享包）以及App（由多个HAP打包一起上架的完整应用程序）包多种类型的包，以满足不同业务场景下的应用开发和定制需求。</p> </div> <div class="tiledSection"><h3 id="section19846433183815" class="firsth2">多目标产物定制项<i class="anchor-icon anchor-icon-link" anchorid="section19846433183815" tips="复制节点链接"></i></h3><p>目前多目标产物支持的定制项信息如下表所示，表中已给出每一项的作用。详细的每一个定制项的配置方法可以参考：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-customized-multi-targets-and-products" target="_blank">配置多目标产物</a>。</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><caption><b>表1 </b>产物定制项</caption><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.5.3.2.4.1.1" valign="top" width="33.33333333333333%"><p>多目标模块</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.3.2.4.1.2" valign="top" width="33.33333333333333%"><p>定制项</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.5.3.2.4.1.3" valign="top" width="33.33333333333333%"><p>作用</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" rowspan="8" valign="top" width="33.33333333333333%"><p>HAP</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>HAP包名（artifactName）</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>产品生成的应用包名称，可由数字、英文字母、中划线、下划线和英文句号（.）组成，支持输入版本号。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>设备类型（deviceType）</p> </td> <td class="cellrowborder" valign="top"><p>用于配置支持的设备类型，如Phone、Tablet等。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>源码集（source）</p> </td> <td class="cellrowborder" valign="top"><p>target的源码范围：</p> <ul><li>pages：定制pages源码目录的page页面，数组长度至少为1。</li><li>sourceRoots：定制差异化代码空间，数组长度至少为1。</li></ul> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>资源（resource）</p> </td> <td class="cellrowborder" valign="top"><p>配置需要的资源文件路径，支持配置多个资源文件路径。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>分发规则（distributionFilter）</p> </td> <td class="cellrowborder" valign="top"><p>针对多target存在相同设备类型deviceType的场景，相同设备类型的target需要指定分发规则distributionFilter。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>产物分包（preloads）</p> </td> <td class="cellrowborder" valign="top"><p>对于元服务，每一个target均可以指定preloads的分包。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>abilities能力项（icon、label和launchType）</p> </td> <td class="cellrowborder" valign="top"><p>定制产物图标、名称、启动模式。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>so库依赖（nativeLib-filter）</p> </td> <td class="cellrowborder" valign="top"><p>定制打包so库的过滤规则。</p> </td> </tr> <tr><td class="cellrowborder" rowspan="4" valign="top" width="33.33333333333333%"><p>HAR/HSP</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>设备类型（deviceType）</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>用于配置支持的设备类型，如Phone、Tablet等。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>so库依赖（nativeLib-filter）</p> </td> <td class="cellrowborder" valign="top"><p>定制打包so库的过滤规则。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>源码集（source）</p> </td> <td class="cellrowborder" valign="top"><p>target的源码范围：</p> <ul><li>pages：定制pages源码目录的page页面，数组长度至少为1。</li><li>sourceRoots：定制差异化代码空间，数组长度至少为1。</li></ul> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>资源（resource）</p> </td> <td class="cellrowborder" valign="top"><p>配置需要的资源文件路径，支持配置多个资源文件路径。</p> </td> </tr> <tr><td class="cellrowborder" rowspan="6" valign="top" width="33.33333333333333%"><p>App</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>App包名和供应商名称(artifactName、vendor)</p> </td> <td class="cellrowborder" valign="top" width="33.33333333333333%"><p>指定产物命名和供应商名称。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>bundleName</p> </td> <td class="cellrowborder" valign="top"><p>定义工程的bundleName信息，在签名的时候可以选择对应的bundleName进行签名。如果product未定义bundleName，则采用工程默认的bundleName。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>bundleType</p> </td> <td class="cellrowborder" valign="top"><p>定义产物类型：</p> <ul><li>bundleType值为app，表示产物为应用；</li><li>bundleType值为atomicService，表示产物为元服务。</li></ul> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>签名配置信息(signingConfig)</p> </td> <td class="cellrowborder" valign="top"><p>为不同产物定制不同的签名文件。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>应用图标、名称（icon、label）</p> </td> <td class="cellrowborder" valign="top"><p>为不同产物定制不同的图标和名称。</p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>依赖的模块（modules）</p> </td> <td class="cellrowborder" valign="top"><p>定义product中包含的target，每个product可以指定一个或多个target。</p> </td> </tr>  </tbody></table></div> </div> <p>综上所述，App、HAP、HAR、HSP包目前并不支持配置所有配置项的差异化定制，开发者在开发过程中需要根据已支持的配置项合理的进行多目标定制。</p> </div> <div class="tiledSection"><h3 id="section10320154064315">构建原理图<i class="anchor-icon anchor-icon-link" anchorid="section10320154064315" tips="复制节点链接"></i></h3><p><span><img height="500.5854" originheight="1941" originwidth="3347" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163512.15874454813410773524568399895964:50001231000000:2800:3DBD16751C05F4B0003F33ED22A07BB1A7AC23DA0CED4616A1E4F15234469707.png" title="点击放大" width="864.5"></span></p> <p>如图所示，在HarmonyOS应用开发过程中，一个应用通常包含多个HAR/HAP/HSP模块。每个HAR/HAP/HSP模块可以通过配置模块级的build-profile.json文件定义多个target，每个target可以定制不同的资源（具体可参考上文定制项介绍）。因此形成了具有差异性的target，如：Module A通过定制生成了TargetA-1、TargetA-2；Module B通过定制生成了TargetB-1、TargetB-2、TargetB-3；Module C通过定制生成了TargetC-1、TargetC-2。然后通过配置工程级的build-profile.json定义多个product，每个product可以依赖不同的Target并且配置不同的App产物定制项。因此形成了具有差异的product，如：依赖TargetA-1、TargetB-1、TargetC-1构建出App-product1；依赖TargetB-3、TargetC-2构建出App-product2。最终在构建工程时选择相应的product就可以显示出对应的定制效果。</p> </div> <div class="tiledSection"><h3 id="section39991467405">开发流程<i class="anchor-icon anchor-icon-link" anchorid="section39991467405" tips="复制节点链接"></i></h3><ol><li>首先需要拆解需求，根据具体的业务场景判断出product、target信息。即确认我们要构建哪些product，每个product依赖哪些target以及每个target的定制项有哪些。</li><li>分别定制每个target定制项的内容。</li><li>分别定制product定制项并为其依赖需要的target。</li><li>实现不同目标产物需要定制的业务逻辑。</li><li>选择不同的product构建出不同目标产物。</li></ol> </div> <div class="tiledSection"><h2 id="section8617123719314">场景案例<i class="anchor-icon anchor-icon-link" anchorid="section8617123719314" tips="复制节点链接"></i></h2></div> <p>本节主要根据一个案例介绍构建多目标产物的流程和方法，该案例可以由同一套源代码构建出Official版本（官方版）和Test版本（测试版）两个product工程。两个工程的实现效果如下：</p> <p>Official版本：工程会在首页中显示Official版的资源以及一个页面跳转按钮，该页面是一个HAP模块页面。通过点击按钮可以跳转到Official版定制页面，该页面是一个HAR模块页面，其中包含了一个运算器。该运算器支持加法和减法。</p> <p>Test版本：工程会在首页中显示Test版的资源以及一个页面跳转按钮，该页面是一个HAP模块页面。通过点击按钮可以跳转到Test版定制页面，该页面是一个HAR模块页面，其中包含了一个普通版的运算器。该运算器仅支持减法。</p> <p></p> <p>该案例包含了HAP、HAR、APP相关定制项，具体差异项信息如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><caption><b>表2 </b>定制项信息</caption><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.14.2.4.1.1" valign="top" width="9.700970097009701%"><p>定制模块</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.2.4.1.2" valign="top" width="40.44404440444044%"><p>Official版本定制项</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.2.4.1.3" valign="top" width="49.85498549854985%"><p>Test版本定制项</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="9.700970097009701%"><p>HAP模块(target)</p> </td> <td class="cellrowborder" valign="top" width="40.44404440444044%"><ol><li>target名称official</li><li>source源码集-pages</li><li>资源文件目录</li><li>source源码集-sourceRoots</li></ol> </td> <td class="cellrowborder" valign="top" width="49.85498549854985%"><ol><li>target名称test</li><li>source源码集-pages</li><li>资源文件目录</li><li>source源码集-sourceRoots</li></ol> </td> </tr> <tr><td class="cellrowborder" valign="top" width="9.700970097009701%"><p>HAR模块(target)</p> </td> <td class="cellrowborder" valign="top" width="40.44404440444044%"><ol><li>target名称official</li><li>buildProfileFields自定义参数</li><li>产物名称</li><li>source源码集-sourceRoots</li><li>资源文件目录</li><li>剔除的.so文件</li></ol> </td> <td class="cellrowborder" valign="top" width="49.85498549854985%"><ol><li>target名称test</li><li>buildProfileFields自定义参数</li><li>产物名称</li><li>source源码集-sourceRoots</li><li>资源文件目录</li></ol> </td> </tr> <tr><td class="cellrowborder" valign="top" width="9.700970097009701%"><p>App工程（product）</p> </td> <td class="cellrowborder" valign="top" width="40.44404440444044%"><ol><li>product名称official</li><li>产物bundleName</li><li>签名配置信息</li><li>应用图标</li><li>依赖的target</li></ol> </td> <td class="cellrowborder" valign="top" width="49.85498549854985%"><ol><li>product名称test</li><li>产物bundleName</li><li>签名配置信息</li><li>应用图标</li><li>依赖的target</li></ol> </td> </tr>  </tbody></table></div> </div> <ol><li>拆解需求，根据具体的业务场景判断出product、target信息。<p>首先，根据上面案例设计和定制项表格可以确认我们需要定制两个product版本，即Official版本和Test版本。每个product需要依赖两个模块，即一个HAP模块和一个HAR模块。</p> </li><li>定制target内容。<p>HAP模块：在模块级build-profile.json5文件中配置。</p> <div class="screenLinkPre"><div _ngcontent-kvl-c106="" class="highlight-div"><div _ngcontent-kvl-c106="" class="highlight-div-header"><div _ngcontent-kvl-c106="" class="highlight-div-header-left"><div _ngcontent-kvl-c106="" class="handle-button expand-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kvl-c106="" class="highlight-div-header-right"><div _ngcontent-kvl-c106="" class="handle-button ai-button"></div><div _ngcontent-kvl-c106="" class="handle-button line-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kvl-c106="" class="handle-button theme-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kvl-c106="" class="handle-button copy-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kvl-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/myhar/build-profile.json5#L22-L84" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-string">"targets"</span>: [</li><li>  {</li><li>    <span class="hljs-string">"name"</span>: <span class="hljs-string">"official"</span>,</li><li>    <span class="hljs-string">"config"</span>: {</li><li>      <span class="hljs-string">"buildOption"</span>: {</li><li>        <span class="hljs-string">"arkOptions"</span>: {</li><li>          <span class="hljs-string">"buildProfileFields"</span>: {</li><li>            <span class="hljs-string">"productName"</span>: <span class="hljs-string">"official"</span></li><li>          }</li><li>        },</li><li>        <span class="hljs-string">"nativeLib"</span>: {</li><li>          <span class="hljs-string">"filter"</span>: {</li><li>            <span class="hljs-string">"excludes"</span>: [</li><li>              <span class="hljs-string">"../libs/arm64-v8a/libentry.so"</span></li><li>            ]</li><li>          }</li><li>        }</li><li>      }</li><li>    },</li><li>    <span class="hljs-string">"runtimeOS"</span>: <span class="hljs-string">"HarmonyOS"</span>,</li><li>    <span class="hljs-string">"output"</span>: {</li><li>      <span class="hljs-string">"artifactName"</span>: <span class="hljs-string">"official"</span></li><li>    },</li><li>    <span class="hljs-string">"source"</span>: {</li><li>      <span class="hljs-string">"sourceRoots"</span>: [</li><li>        <span class="hljs-string">"./src/official_pages"</span></li><li>      ]</li><li>    },</li><li>    <span class="hljs-string">"resource"</span>: {</li><li>      <span class="hljs-string">"directories"</span>: [</li><li>        <span class="hljs-string">"./src/main/official/resources"</span>,</li><li>        <span class="hljs-string">"./src/main/resources"</span></li><li>      ]</li><li>    }</li><li>  },</li><li>  {</li><li>    <span class="hljs-string">"name"</span>: <span class="hljs-string">"test"</span>,</li><li>    <span class="hljs-string">"config"</span>: {</li><li>      <span class="hljs-string">"buildOption"</span>: {</li><li>        <span class="hljs-string">"arkOptions"</span>: {</li><li>          <span class="hljs-string">"buildProfileFields"</span>: {</li><li>            <span class="hljs-string">"productName"</span>: <span class="hljs-string">"test"</span></li><li>          }</li><li>        }</li><li>      }</li><li>    },</li><li>    <span class="hljs-string">"runtimeOS"</span>: <span class="hljs-string">"HarmonyOS"</span>,</li><li>    <span class="hljs-string">"output"</span>: {</li><li>      <span class="hljs-string">"artifactName"</span>: <span class="hljs-string">"test"</span></li><li>    },</li><li>    <span class="hljs-string">"source"</span>: {</li><li>      <span class="hljs-string">"sourceRoots"</span>: [</li><li>        <span class="hljs-string">"./src/test_pages"</span></li><li>      ]</li><li>    },</li><li>    <span class="hljs-string">"resource"</span>: {</li><li>      <span class="hljs-string">"directories"</span>: [</li><li>        <span class="hljs-string">"./src/main/test/resources"</span>,</li><li>        <span class="hljs-string">"./src/main/resources"</span></li><li>      ]</li><li>    }</li><li>  }</li><li>],</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/myhar/build-profile.json5#L22-L84" target="_blank">build-profile.json5</a></div></div></div></div> <p>上述配置文件代码中，配置了official版本与test版本的target名称、source源码集-pages、source源码集-sourceRoots以及资源文件路径，因此我们需要在对应的目录结构下创建我们配置的文件以及目录。针对以上配置信息，我们需要创建pages目录下的Index.ets文件、src目录下的test_pages和official_pages目录以及src/main目录下的resource_test和resource_official目录。</p> <p></p> <p>在配置不同target的资源文件目录时，可以配置多个资源文件目录，建议将共有的资源文件放置到默认的资源文件目录中，将有差异的资源部分放置到定制的资源文件目录中，然后在配置资源目录时将默认的资源目录和定制的资源目录都加上。例如：案例中即给不同版本配置了两个资源目录，一个用于存放共有资源，一个存放不同target的差异性资源。</p> <p>如果target引用的多个资源文件目录下，存在同名的资源，则在构建打包过程中，将按照配置的资源文件目录顺序进行选择。例如，上述official版target引用的资源中，resource_official和resource中存在同名的资源文件，则resource_official中的资源会被打包到HAP中。</p> <p>* 配置文件中，default为创建工程时默认生成的target，一般无需特殊处理。</p> <p></p> <p>HAR模块：在模块级build-profile.json5文件中配置。</p> <div class="screenLinkPre"><div _ngcontent-kvl-c106="" class="highlight-div"><div _ngcontent-kvl-c106="" class="highlight-div-header"><div _ngcontent-kvl-c106="" class="highlight-div-header-left"><div _ngcontent-kvl-c106="" class="handle-button expand-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kvl-c106="" class="highlight-div-header-right"><div _ngcontent-kvl-c106="" class="handle-button ai-button"></div><div _ngcontent-kvl-c106="" class="handle-button line-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kvl-c106="" class="handle-button theme-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kvl-c106="" class="handle-button copy-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kvl-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/build-profile.json5#L0-L77" data-highlighted="yes"><ol class="linenums"><li>{</li><li>  <span class="hljs-string">"app"</span>: {</li><li>    <span class="hljs-string">"signingConfigs"</span>: [],</li><li>    <span class="hljs-string">"products"</span>: [</li><li>      {</li><li>        <span class="hljs-string">"name"</span>: <span class="hljs-string">"official"</span>,</li><li>        <span class="hljs-string">"compatibleSdkVersion"</span>: <span class="hljs-string">"5.0.5(17)"</span>,</li><li>        <span class="hljs-string">"targetSdkVersion"</span>: <span class="hljs-string">"5.0.5(17)"</span>,</li><li>        <span class="hljs-string">"runtimeOS"</span>: <span class="hljs-string">"HarmonyOS"</span>,</li><li>        <span class="hljs-string">"buildOption"</span>: {</li><li>          <span class="hljs-string">"strictMode"</span>: {</li><li>            <span class="hljs-string">"caseSensitiveCheck"</span>: <span class="hljs-keyword">true</span>,</li><li>            <span class="hljs-string">"useNormalizedOHMUrl"</span>: <span class="hljs-keyword">true</span></li><li>          }</li><li>        },</li><li>        <span class="hljs-string">"bundleName"</span>: <span class="hljs-string">"com.official.com"</span>,</li><li>        <span class="hljs-string">"bundleType"</span>: <span class="hljs-string">"app"</span>,</li><li>        <span class="hljs-string">"icon"</span>: <span class="hljs-string">"$media:startIcon"</span>,</li><li>        <span class="hljs-string">"label"</span>: <span class="hljs-string">"$string:official_app_name"</span></li><li>      },</li><li>      {</li><li>        <span class="hljs-string">"name"</span>: <span class="hljs-string">"test"</span>,</li><li>        <span class="hljs-string">"compatibleSdkVersion"</span>: <span class="hljs-string">"5.0.5(17)"</span>,</li><li>        <span class="hljs-string">"targetSdkVersion"</span>: <span class="hljs-string">"5.0.5(17)"</span>,</li><li>        <span class="hljs-string">"runtimeOS"</span>: <span class="hljs-string">"HarmonyOS"</span>,</li><li>        <span class="hljs-string">"buildOption"</span>: {</li><li>          <span class="hljs-string">"strictMode"</span>: {</li><li>            <span class="hljs-string">"caseSensitiveCheck"</span>: <span class="hljs-keyword">true</span>,</li><li>            <span class="hljs-string">"useNormalizedOHMUrl"</span>: <span class="hljs-keyword">true</span></li><li>          }</li><li>        },</li><li>        <span class="hljs-string">"bundleName"</span>: <span class="hljs-string">"com.test.com"</span>,</li><li>        <span class="hljs-string">"bundleType"</span>: <span class="hljs-string">"app"</span>,</li><li>        <span class="hljs-string">"icon"</span>: <span class="hljs-string">"$media:app_icon"</span>,</li><li>        <span class="hljs-string">"label"</span>: <span class="hljs-string">"$string:test_app_name"</span></li><li>      },</li><li>      {</li><li>        <span class="hljs-string">"name"</span>: <span class="hljs-string">"default"</span>,</li><li>        <span class="hljs-string">"compatibleSdkVersion"</span>: <span class="hljs-string">"5.0.5(17)"</span>,</li><li>        <span class="hljs-string">"targetSdkVersion"</span>: <span class="hljs-string">"5.0.5(17)"</span>,</li><li>        <span class="hljs-string">"runtimeOS"</span>: <span class="hljs-string">"HarmonyOS"</span>,</li><li>      }</li><li>    ],</li><li>    <span class="hljs-string">"buildModeSet"</span>: [</li><li>      {</li><li>        <span class="hljs-string">"name"</span>: <span class="hljs-string">"debug"</span>,</li><li>      },</li><li>      {</li><li>        <span class="hljs-string">"name"</span>: <span class="hljs-string">"release"</span></li><li>      }</li><li>    ]</li><li>  },</li><li>  <span class="hljs-string">"modules"</span>: [</li><li>    {</li><li>      <span class="hljs-string">"name"</span>: <span class="hljs-string">"entry"</span>,</li><li>      <span class="hljs-string">"srcPath"</span>: <span class="hljs-string">"./entry"</span>,</li><li>      <span class="hljs-string">"targets"</span>: [</li><li>        {</li><li>          <span class="hljs-string">"name"</span>: <span class="hljs-string">"official"</span>,</li><li>          <span class="hljs-string">"applyToProducts"</span>: [</li><li>            <span class="hljs-string">"official"</span></li><li>          ]</li><li>        },</li><li>        {</li><li>          <span class="hljs-string">"name"</span>: <span class="hljs-string">"test"</span>,</li><li>          <span class="hljs-string">"applyToProducts"</span>: [</li><li>            <span class="hljs-string">"test"</span></li><li>          ]</li><li>        }</li><li>      ]</li><li>    },</li><li>    {</li><li>      <span class="hljs-string">"name"</span>: <span class="hljs-string">"myhar"</span>,</li><li>      <span class="hljs-string">"srcPath"</span>: <span class="hljs-string">"./myhar"</span></li><li>    }</li><li>  ]</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/build-profile.json5#L0-L77" target="_blank">build-profile.json5</a></div></div></div></div> <p>上述配置文件代码中，配置了official版本与test版本的target名称、buildProFields自定义参数、产物名称、source源码集-sourceRoots以及资源文件目录，并且在official版本中剔除了无需打包的.so文件。同样的，我们也需要创建我们需要的文件目录，因此我们需要在该HAR模块的src/main/目录下创建resources_test和resources_official文件夹，在src/目录下创建official_pages和test_pages文件夹。</p> <p></p> </li><li>定制product内容。<p>App工程：在工程级build-profile.json5文件中配置。</p> <div class="screenLinkPre"><div _ngcontent-kvl-c106="" class="highlight-div"><div _ngcontent-kvl-c106="" class="highlight-div-header"><div _ngcontent-kvl-c106="" class="highlight-div-header-left"><div _ngcontent-kvl-c106="" class="handle-button expand-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kvl-c106="" class="highlight-div-header-right"><div _ngcontent-kvl-c106="" class="handle-button ai-button"></div><div _ngcontent-kvl-c106="" class="handle-button line-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kvl-c106="" class="handle-button theme-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kvl-c106="" class="handle-button copy-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kvl-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/build-profile.json5#L2-L95" data-highlighted="yes"><ol class="linenums"><li>{</li><li>  <span class="hljs-string">"app"</span>: {</li><li>    <span class="hljs-string">"signingConfigs"</span>: [],</li><li>    <span class="hljs-string">"products"</span>: [</li><li>      {</li><li>        <span class="hljs-string">"name"</span>: <span class="hljs-string">"official"</span>,</li><li>        <span class="hljs-string">"compatibleSdkVersion"</span>: <span class="hljs-string">"5.0.0(12)"</span>,</li><li>        <span class="hljs-string">"runtimeOS"</span>: <span class="hljs-string">"HarmonyOS"</span>,</li><li>        <span class="hljs-string">"buildOption"</span>: {</li><li>          <span class="hljs-string">"strictMode"</span>: {</li><li>            <span class="hljs-string">"caseSensitiveCheck"</span>: <span class="hljs-keyword">true</span>,</li><li>            <span class="hljs-string">"useNormalizedOHMUrl"</span>: <span class="hljs-keyword">true</span></li><li>          }</li><li>        },</li><li>        <span class="hljs-string">"bundleName"</span>: <span class="hljs-string">"com.official.com"</span>,</li><li>        <span class="hljs-string">"bundleType"</span>: <span class="hljs-string">"app"</span>,</li><li>        <span class="hljs-string">"icon"</span>: <span class="hljs-string">"$media:startIcon"</span>,</li><li>        <span class="hljs-string">"label"</span>: <span class="hljs-string">"$string:official_app_name"</span></li><li>      },</li><li>      {</li><li>        <span class="hljs-string">"name"</span>: <span class="hljs-string">"test"</span>,</li><li>        <span class="hljs-string">"compatibleSdkVersion"</span>: <span class="hljs-string">"5.0.0(12)"</span>,</li><li>        <span class="hljs-string">"runtimeOS"</span>: <span class="hljs-string">"HarmonyOS"</span>,</li><li>        <span class="hljs-string">"buildOption"</span>: {</li><li>          <span class="hljs-string">"strictMode"</span>: {</li><li>            <span class="hljs-string">"caseSensitiveCheck"</span>: <span class="hljs-keyword">true</span>,</li><li>            <span class="hljs-string">"useNormalizedOHMUrl"</span>: <span class="hljs-keyword">true</span></li><li>          }</li><li>        },</li><li>        <span class="hljs-string">"bundleName"</span>: <span class="hljs-string">"com.test.com"</span>,</li><li>        <span class="hljs-string">"bundleType"</span>: <span class="hljs-string">"app"</span>,</li><li>        <span class="hljs-string">"icon"</span>: <span class="hljs-string">"$media:app_icon"</span>,</li><li>        <span class="hljs-string">"label"</span>: <span class="hljs-string">"$string:test_app_name"</span></li><li>      },</li><li>      {</li><li>        <span class="hljs-string">"name"</span>: <span class="hljs-string">"default"</span>,</li><li>        <span class="hljs-string">"compatibleSdkVersion"</span>: <span class="hljs-string">"5.0.0(12)"</span>,</li><li>        <span class="hljs-string">"runtimeOS"</span>: <span class="hljs-string">"HarmonyOS"</span>,</li><li>      }</li><li>    ],</li><li>    <span class="hljs-string">"buildModeSet"</span>: [</li><li>      {</li><li>        <span class="hljs-string">"name"</span>: <span class="hljs-string">"debug"</span>,</li><li>      },</li><li>      {</li><li>        <span class="hljs-string">"name"</span>: <span class="hljs-string">"release"</span></li><li>      }</li><li>    ]</li><li>  },</li><li>  <span class="hljs-string">"modules"</span>: [</li><li>    {</li><li>      <span class="hljs-string">"name"</span>: <span class="hljs-string">"entry"</span>,</li><li>      <span class="hljs-string">"srcPath"</span>: <span class="hljs-string">"./entry"</span>,</li><li>      <span class="hljs-string">"targets"</span>: [</li><li>        {</li><li>          <span class="hljs-string">"name"</span>: <span class="hljs-string">"default"</span>,</li><li>          <span class="hljs-string">"applyToProducts"</span>: [</li><li>            <span class="hljs-string">"default"</span></li><li>          ]</li><li>        },</li><li>        {</li><li>          <span class="hljs-string">"name"</span>: <span class="hljs-string">"official"</span>,</li><li>          <span class="hljs-string">"applyToProducts"</span>: [</li><li>            <span class="hljs-string">"official"</span></li><li>          ]</li><li>        },</li><li>        {</li><li>          <span class="hljs-string">"name"</span>: <span class="hljs-string">"test"</span>,</li><li>          <span class="hljs-string">"applyToProducts"</span>: [</li><li>            <span class="hljs-string">"test"</span></li><li>          ]</li><li>        }</li><li>      ]</li><li>    },</li><li>    {</li><li>      <span class="hljs-string">"name"</span>: <span class="hljs-string">"myhar"</span>,</li><li>      <span class="hljs-string">"srcPath"</span>: <span class="hljs-string">"./myhar"</span>,</li><li>      <span class="hljs-string">"targets"</span>: [</li><li>        {</li><li>          <span class="hljs-string">"name"</span>: <span class="hljs-string">"official"</span>,</li><li>          <span class="hljs-string">"applyToProducts"</span>: [</li><li>            <span class="hljs-string">"official"</span></li><li>          ]</li><li>        },</li><li>        {</li><li>          <span class="hljs-string">"name"</span>: <span class="hljs-string">"test"</span>,</li><li>          <span class="hljs-string">"applyToProducts"</span>: [</li><li>            <span class="hljs-string">"test"</span></li><li>          ]</li><li>        }</li><li>      ]</li><li>    }</li><li>  ]</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/build-profile.json5#L2-L95" target="_blank">build-profile.json5</a></div></div></div></div> <p>在该配置文件中，配置了product名称、产物bundleName、签名配置信息、应用图标、依赖的target信息。这里需要注意的是，依赖的HAR模块需要在引用他的模块内配置依赖关系。我们的案例是在entry模块里调用的HAR包，所以需要在其对应的oh-package.json5文件中配置dependencies依赖。</p> <p></p> </li><li>实现不同目标产物需要定制的业务逻辑。<ul><li>通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-customized-multi-targets-and-products-guides#section18668905913" target="_blank">source源码集-sourceRoots配置</a>的差异性代码空间，实现标题（代码文件）多目标效果。<p><span><img originheight="61" originwidth="318" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163512.02670257838553162050304589271087:50001231000000:2800:32DB2B1493B94EFAD879AE90125952A12AF0BA371BA6CADEB286CFCAF03F14F1.png" width="318" height="61"></span>  <span><img originheight="57" originwidth="300" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163513.30937307148084025900039890224128:50001231000000:2800:A44F890297C3A0851528B742D5EB4A52083B177023B4FA684982F5A01289A8AA.png" width="300" height="57"></span></p> <p>在上述配置文件中，配置了HAP模块的source源码集-sourceRoots目录，official版本与test版本分别对应src/official_pages和src/test_pages。</p> <p>分别在对应的sourceRoots目录下创建同名ets文件并创建同名同类型的方法，例如：示例中创建的是VersionInfo.ets文件。添加如下代码：</p> <p>src/official_pages/VersionInfo.ets</p> <div class="screenLinkPre"><div _ngcontent-kvl-c106="" class="highlight-div"><div _ngcontent-kvl-c106="" class="highlight-div-header"><div _ngcontent-kvl-c106="" class="highlight-div-header-left"><div _ngcontent-kvl-c106="" class="handle-button expand-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kvl-c106="" class="highlight-div-header-right"><div _ngcontent-kvl-c106="" class="handle-button ai-button"></div><div _ngcontent-kvl-c106="" class="handle-button line-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kvl-c106="" class="handle-button theme-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kvl-c106="" class="handle-button copy-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kvl-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" codehub="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/entry/src/official_pages/VersionInfo.ets#L16-L17" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">getName</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-string">"This is official version."</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">getTitleName</span> = (<span class="hljs-params"></span>) =&gt; $r(<span class="hljs-string">'app.string.title'</span>)</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/entry/src/official_pages/VersionInfo.ets#L16-L17" target="_blank">VersionInfo.ets</a></div></div></div></div> <p>src/test_pages/VersionInfo.ets</p> <div class="screenLinkPre"><div _ngcontent-kvl-c106="" class="highlight-div"><div _ngcontent-kvl-c106="" class="highlight-div-header"><div _ngcontent-kvl-c106="" class="highlight-div-header-left"><div _ngcontent-kvl-c106="" class="handle-button expand-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kvl-c106="" class="highlight-div-header-right"><div _ngcontent-kvl-c106="" class="handle-button ai-button"></div><div _ngcontent-kvl-c106="" class="handle-button line-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kvl-c106="" class="handle-button theme-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kvl-c106="" class="handle-button copy-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kvl-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" codehub="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/entry/src/test_pages/VersionInfo.ets#L16-L17" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">getName</span> = (<span class="hljs-params"></span>) =&gt; <span class="hljs-string">"This is test version."</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">getTitleName</span> = (<span class="hljs-params"></span>) =&gt; $r(<span class="hljs-string">'app.string.title'</span>)</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/entry/src/test_pages/VersionInfo.ets#L16-L17" target="_blank">VersionInfo.ets</a></div></div></div></div> <p>在Index.ets文件中，通过import packageName的方式，省略sourceRoot，可以实现不同target下的差异化构建（ import xxx from '&lt;packageName&gt;/sourceFileName'）。该能力具体可参考：<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-customized-multi-targets-and-products-guides#section18668905913" target="_blank">source源码集-sourceRoots配置</a>。</p> <div class="screenLinkPre"><div _ngcontent-kvl-c106="" class="highlight-div"><div _ngcontent-kvl-c106="" class="highlight-div-header"><div _ngcontent-kvl-c106="" class="highlight-div-header-left"><div _ngcontent-kvl-c106="" class="handle-button expand-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kvl-c106="" class="highlight-div-header-right"><div _ngcontent-kvl-c106="" class="handle-button ai-button"></div><div _ngcontent-kvl-c106="" class="handle-button line-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kvl-c106="" class="handle-button theme-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kvl-c106="" class="handle-button copy-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kvl-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-typescript" codehub="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/entry/src/main/ets/pages/Index.ets#L17-L65" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> { getName, getTitleName } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../../test_pages/VersionInfo'</span></li><li>
</li><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct <span class="hljs-title class_">Index</span> {</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">message</span>: <span class="hljs-built_in">string</span> = <span class="hljs-title function_">getName</span>();</li><li>  <span class="hljs-meta">@State</span> <span class="hljs-attr">titleMessage</span>: <span class="hljs-title class_">Resource</span> = <span class="hljs-title function_">getTitleName</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>(<span class="hljs-params"></span>) {</li><li>    <span class="hljs-title class_">Column</span>() {</li><li>      <span class="hljs-title class_">Column</span>() {</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">titleMessage</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">30</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Medium</span>)</li><li>        <span class="hljs-title class_">Text</span>(<span class="hljs-variable language_">this</span>.<span class="hljs-property">message</span>)</li><li>          .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">14</span>)</li><li>          .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-title class_">FontWeight</span>.<span class="hljs-property">Normal</span>)</li><li>          .<span class="hljs-title function_">fontColor</span>(<span class="hljs-title class_">Color</span>.<span class="hljs-property">Black</span>)</li><li>          .<span class="hljs-title function_">opacity</span>(<span class="hljs-number">0.6</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-number">19</span>)</li><li>          .<span class="hljs-title function_">margin</span>({ <span class="hljs-attr">top</span>: <span class="hljs-number">2</span> })</li><li>      }</li><li>      <span class="hljs-comment">// ...</span></li><li>    }</li><li>    <span class="hljs-comment">// ...</span></li><li>  }</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/entry/src/main/ets/pages/Index.ets#L17-L65" target="_blank">Index.ets</a></div></div></div></div> </li><li>在HAR模块引用差异性资源，实现页面中资源多目标效果。<p><span><img originheight="296" originwidth="325" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163513.20138587460583539146950041905857:50001231000000:2800:CF4A90667C116A474844FEDE36E89F04A3AD57AB5CAB18E4DC0DDE37CFD68B0F.png" width="325" height="296"></span>   <span><img originheight="295" originwidth="321" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163513.50262691744595652136379571799661:50001231000000:2800:CD0755AF189F00A98EE974A01052532BC1F6444F48009B4757797EEE8E295D34.png" width="321" height="295"></span></p> <p>在上述配置文件中，我们配置了HAR模块的资源文件路径，official版本和test版本分别对应src/main/resources_official和src/main/resources_test文件。</p> <p>分别在对应的资源文件目录下添加同名图片资源和json字符串。例如：示例中分别在资源文件目录下的media文件中放入同名的HarImage.jpg图片（图片内容不同），并在element文件下的string.json中添加同名参数"title_description"（其对应的"value"值不相同）。</p> <p>在页面中直接引用对应同名资源即可，代码如下：</p> <div class="screenLinkPre"><div _ngcontent-kvl-c106="" class="highlight-div"><div _ngcontent-kvl-c106="" class="highlight-div-header"><div _ngcontent-kvl-c106="" class="highlight-div-header-left"><div _ngcontent-kvl-c106="" class="handle-button expand-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kvl-c106="" class="highlight-div-header-right"><div _ngcontent-kvl-c106="" class="handle-button ai-button"></div><div _ngcontent-kvl-c106="" class="handle-button line-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kvl-c106="" class="handle-button theme-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kvl-c106="" class="handle-button copy-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kvl-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" codehub="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/myhar/src/main/ets/components/MainPage.ets#L42-L52" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-selector-tag">TextArea</span>({ text: 'This is the first page of the beta version of the HAR module. Click the button below to jump to the second page of the beta version of the HAR module - the calculator page.' })</li><li>  <span class="hljs-selector-class">.fontSize</span>(<span class="hljs-number">16</span>)</li><li>  <span class="hljs-selector-class">.width</span>('<span class="hljs-number">100%</span>')</li><li>  <span class="hljs-selector-class">.fontColor</span>('#e6000000')</li><li>  <span class="hljs-selector-class">.fontWeight</span>(FontWeight.Normal)</li><li>  <span class="hljs-selector-class">.borderRadius</span>(<span class="hljs-number">16</span>)</li><li>  <span class="hljs-selector-class">.focusable</span>(false)</li><li><span class="hljs-built_in">Image</span>($r('app.media.HarImage'))</li><li>  <span class="hljs-selector-class">.width</span>('<span class="hljs-number">100%</span>')</li><li>  <span class="hljs-selector-class">.borderRadius</span>(<span class="hljs-number">12</span>)</li><li>  <span class="hljs-selector-class">.padding</span>({ top: <span class="hljs-number">16</span> })</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/myhar/src/main/ets/components/MainPage.ets#L42-L52" target="_blank">MainPage.ets</a></div></div></div></div> </li><li>在HAR模块中通过不同自定义参数信息跳转到不同页面，实现路由跳转多目标效果。<div class="p">效果对比如下：<div class="fignone"><span class="figcap"><b>图1 </b>official版本</span><br><span><img originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163513.66859187733650382907099212895185:50001231000000:2800:0FA99E0BA466508FFB50ADE9CEC0A0FA7029DE3B4F3B4F9D78BFEA03140E72A1.gif" width="348" height="720"></span></div> <div class="fignone"><span class="figcap"><b>图2 </b>test版本</span><br><span><img originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163513.24949928254816724556094351875671:50001231000000:2800:4B0154F029707E6F2F15C0D7F7096996A74AD71216A68F10872AE2699A44AB6B.gif" width="348" height="720"></span></div> </div> <p>在先前的案例中，已经介绍了如何在sourceRoot目录配置的差异性代码空间中实现对同名文件中的同名方法的调用。这里主要介绍在不同的target中如何调用不同名的文件中的不同方法。</p> <p>首先，需要通过配置文件中配置的自定义参数<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-hvigor-get-build-profile-para-guide#section8279154125918" target="_blank">生成相应的BuildProfile.ets文件</a>。上述HAR模块的配置文件中，我们配置了buildProfileFields自定义参数"productName",在official和test版本中分别配置了不同的值"official"和"test"。这样我们构建不同的产物版本就会生成不同的"productName"值，用于在代码工程中区分不同的产物版本。</p> <p>然后，分别在official和test的对应的sourceRoots目录下创建不同的ets文件，并导出相应的组件。如示例中在HAR模块的src/official_pages目录下创建了OfficialSecondPages.ets并export了一个OfficialSecond组件，然后在src/test_pages目录下创建了TestSecondPages.ets并export了一个TestSecond组件。这两个组件中分别包含了不同的页面信息。</p> <p></p> <p>最后在首页中import相应的方法实现跳转逻辑。具体代码如下：</p> <p>导入方法及组件：</p> <div class="screenLinkPre"><div _ngcontent-kvl-c106="" class="highlight-div"><div _ngcontent-kvl-c106="" class="highlight-div-header"><div _ngcontent-kvl-c106="" class="highlight-div-header-left"><div _ngcontent-kvl-c106="" class="handle-button expand-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kvl-c106="" class="highlight-div-header-right"><div _ngcontent-kvl-c106="" class="handle-button ai-button"></div><div _ngcontent-kvl-c106="" class="handle-button line-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kvl-c106="" class="handle-button theme-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kvl-c106="" class="handle-button copy-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kvl-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" codehub="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/myhar/src/main/ets/components/MainPage.ets#L16-L18" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">import</span> <span class="hljs-title class_">BuildProfile</span> <span class="hljs-keyword">from</span> <span class="hljs-string">'../../../../BuildProfile'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">OfficialSecond</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../../official_pages/OfficialSecondPage'</span>;</li><li><span class="hljs-keyword">import</span> { <span class="hljs-title class_">TestSecond</span> } <span class="hljs-keyword">from</span> <span class="hljs-string">'../../../test_pages/TestSecondPage'</span>;</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/myhar/src/main/ets/components/MainPage.ets#L16-L18" target="_blank">MainPage.ets</a></div></div></div></div> <p>定义页面跳转逻辑：接收到不同的参数值跳转不同页面。</p> <div class="screenLinkPre"><div _ngcontent-kvl-c106="" class="highlight-div"><div _ngcontent-kvl-c106="" class="highlight-div-header"><div _ngcontent-kvl-c106="" class="highlight-div-header-left"><div _ngcontent-kvl-c106="" class="handle-button expand-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kvl-c106="" class="highlight-div-header-right"><div _ngcontent-kvl-c106="" class="handle-button ai-button"></div><div _ngcontent-kvl-c106="" class="handle-button line-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kvl-c106="" class="handle-button theme-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kvl-c106="" class="handle-button copy-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kvl-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" codehub="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/myhar/src/main/ets/components/MainPage.ets#L23-L34" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">@Provide</span>(<span class="hljs-string">'pageInfos'</span>) <span class="hljs-attribute">pageInfos</span>: NavPathStack = new NavPathStack();</li><li>
</li><li><span class="hljs-keyword">@Builder</span></li><li>PagesMap(<span class="hljs-attribute">name</span>: string) {</li><li>  if (name == 'official') {</li><li>    <span class="hljs-comment">// According to the user-defined parameter value, if the value is Official, the</span></li><li>    <span class="hljs-comment">// second page of official will jump correspondingly.</span></li><li>    <span class="hljs-built_in">OfficialSecond</span>();</li><li>  } else {</li><li>    <span class="hljs-built_in">TestSecond</span>();</li><li>  }</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/myhar/src/main/ets/components/MainPage.ets#L23-L34" target="_blank">MainPage.ets</a></div></div></div></div> <p>为按钮添加点击属性，并传递自定义参数，用于实现Navigation路由跳转：</p> <div class="screenLinkPre"><div _ngcontent-kvl-c106="" class="highlight-div"><div _ngcontent-kvl-c106="" class="highlight-div-header"><div _ngcontent-kvl-c106="" class="highlight-div-header-left"><div _ngcontent-kvl-c106="" class="handle-button expand-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-kvl-c106="" class="highlight-div-header-right"><div _ngcontent-kvl-c106="" class="handle-button ai-button"></div><div _ngcontent-kvl-c106="" class="handle-button line-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-kvl-c106="" class="handle-button theme-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-kvl-c106="" class="handle-button copy-button"><div _ngcontent-kvl-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-kvl-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" codehub="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/myhar/src/main/ets/components/MainPage.ets#L56-L62" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title class_">Button</span>($r(<span class="hljs-string">'app.string.button_describe'</span>))</li><li>  .<span class="hljs-title function_">fontSize</span>(<span class="hljs-number">16</span>)</li><li>  .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>  .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  .<span class="hljs-title function_">onClick</span>(<span class="hljs-function">() =&gt;</span> {</li><li>    <span class="hljs-variable language_">this</span>.<span class="hljs-property">pageInfos</span>.<span class="hljs-title function_">pushPath</span>({ <span class="hljs-attr">name</span>: <span class="hljs-string">'official'</span> });</li><li>  })</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/MultiTarget/blob/master/myhar/src/main/ets/components/MainPage.ets#L56-L62" target="_blank">MainPage.ets</a></div></div></div></div> </li></ul> </li><li>选择不同的product构建出不同的目标产物。<div class="fignone"><span class="figcap"><b>图3 </b>构建图示</span><br><span><img originheight="332" originwidth="486" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163513.15566505212131293093021696779978:50001231000000:2800:DC3C5AA36A5FC21B1DC8650FA652D019EA9ECD511BDD8FA117F1E4577B610B9D.png" width="486" height="332"></span></div> <p>首先点击DevEco Studio工具右上角的Product按钮，即图中的1号标识处，然后在2号标识处选择对应的product工程，选择完工程之后会自动映射出我们文件中已经依赖的target，最后点击Apply应用。上述操作完成之后就可以点击运行按钮查看多目标产物效果了。本案例运行效果图如下：</p> <div class="fignone"><span class="figcap"><b>图4 </b>Official版本</span><p><span><img originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163513.51773046257809821248035707153184:50001231000000:2800:F074ACC301D6AB4B68824865E71E276F18AF4C3F07851EDA74D61500617B2309.gif" width="348" height="720"></span></p> </div> <div class="fignone"><span class="figcap"><b>图5 </b>Test版本</span><br><span><img originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163513.77479856924984382071203889390329:50001231000000:2800:613495D67C97591757AE95C93C860B0AC17AD72C78F648F703B5A6A8BC6EDC95.gif" width="348" height="720"></span></div> </li></ol> <div class="tiledSection"><h2 id="section125204319499">常见问题<i class="anchor-icon anchor-icon-link" anchorid="section125204319499" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section13944162214508" class="firsth2">如何为不同的product产物配置签名信息？<i class="anchor-icon anchor-icon-link" anchorid="section13944162214508" tips="复制节点链接"></i></h3><p>配置工程级的build-profile.json5文件.</p> <p>首先需要在每个product下添加配置项"signingConfig"。</p> <p><span><img height="340.79893400000003" originheight="270" originwidth="407" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163513.46936911293039480559557783430576:50001231000000:2800:4BB429E53F192312D90B71BB9EE991E6C12C9E53572679C7DCDC3E3D5C392CAE.png" title="点击放大" width="513.7125"></span></p> <p>然后进入到签名配置页面，点击加号，添加签名信息：</p> <p><span><img height="254.33058000000003" originheight="154" originwidth="421" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163513.77309458848036533153293947507272:50001231000000:2800:79F6292500BA618704809DF32B50BE7BE97170F7F14FDA52611A59C8405FFCF4.png" title="点击放大" width="695.2575"></span></p> <p>然后选择对应的bundle name，并填写上面配置的"signingConfig"信息（每个product产物都需要配置）：</p> <p><span><img height="505.5064" originheight="617" originwidth="974" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163513.21191384650906978322085477600644:50001231000000:2800:8E31C302D05F9D9152708AD8F79E254A55495228540090AA35D52D4227DF53B4.png" title="点击放大" width="798"></span></p> <p>点击ok之后，进行签名即可。</p> <p><span><img height="504.4956" originheight="593" originwidth="938" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163513.20564312907675354727349668255887:50001231000000:2800:01477FD844E2BCD1FD2353E60D76309DA38FE6B1F0B47B495108307AE089ADD2.png" title="点击放大" width="798"></span></p> </div> <div class="tiledSection"><h2 id="section3989355164917">示例代码<i class="anchor-icon anchor-icon-link" anchorid="section3989355164917" tips="复制节点链接"></i></h2><ul><li><a href="https://gitee.com/harmonyos_samples/MultiTarget" target="_blank">构建多目标产物工程</a></li></ul> </div> </div></div>