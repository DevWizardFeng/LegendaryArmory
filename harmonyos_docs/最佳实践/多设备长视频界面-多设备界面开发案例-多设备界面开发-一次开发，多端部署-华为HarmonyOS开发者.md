<h1 _ngcontent-ape-c119="" class="doc-title ng-star-inserted" title="多设备长视频界面"> 多设备长视频界面 </h1>

<div _ngcontent-ape-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section1465892916307">概述<i class="anchor-icon anchor-icon-link" anchorid="section1465892916307" tips="复制节点链接"></i></h2><p>本文从目前流行的垂类市场中，选择长视频行业应用作为典型案例详细介绍“一多”在实际开发中的应用。长视频应用的核心功能为沉浸式的视频播放和互动，主要包含首页推荐、视频搜索、视频详情、视频评论、全屏播放等。根据这些核心功能，本文选择<a href="/consumer/cn/doc/best-practices/multi-video-app#section109591922155720">首页</a>、<a href="/consumer/cn/doc/best-practices/multi-video-app#section1932711221013">搜索页</a>、<a href="/consumer/cn/doc/best-practices/multi-video-app#section9259381113">视频详情页</a>和<a href="/consumer/cn/doc/best-practices/multi-video-app#section2899145416113">全屏播放页</a>作为典型页面进行开发，遵从多设备的“差异性”、“一致性”、“灵活性”和“兼容性”，能够让开发者快速高效地掌握“一多”能力并实现长视频应用的相关功能。</p> <p>开发者在开发“一多”应用时，经常会遇到多端适配上的问题，本文选择了长视频应用部分痛难点问题，提供了推荐的解决方案，开发者在“一多”开发中遇到同类问题时可快速解决。</p> <ul><li><a href="/consumer/cn/doc/best-practices/multi-video-app#section620043518317">平级工程目录逻辑混乱且依赖关系不清晰</a></li><li><a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li139671645597">应用窗口宽度改变时导致图片变形</a></li><li><a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li19261618201020">图片等比改变大小导致容器组件的高度实时变化</a></li><li><a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li198001419141319">首页沉浸式设计页面的背景图与透视效果难以实现</a></li><li><a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li8773338111310">获取不到特定组件在应用窗口内的坐标</a></li><li><a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li189372272168">如何适配多设备下自定义滑动效果</a></li><li><a href="/consumer/cn/doc/best-practices/multi-video-app#li96815962218">折叠屏悬停态页面开发无从下手</a></li></ul> <p>当前系统的产品形态包括手机、折叠屏、平板和PC/2in1。下文将从UX设计、工程管理、页面开发和功能开发四个角度，介绍“一多”长视频应用在开发过程中的最佳实践。</p> <ul><li><a href="/consumer/cn/doc/best-practices/multi-video-app#section17797105112306">UX设计</a>章节介绍长视频应用的交互逻辑和通用的设计要点，对于类似的设计要点，开发者可以直接参考。</li><li><a href="/consumer/cn/doc/best-practices/multi-video-app#section189781175313">工程管理</a>章节推荐“一多”应用使用目录结构更加清晰的三层架构。</li><li><a href="/consumer/cn/doc/best-practices/multi-video-app#section7318163817529">页面开发</a>章节会从三个方面展开，将页面划分为不同区域，按照区域的开发顺序，介绍如何使用自适应布局和响应式布局实现不同的UI效果，以及提升用户体验的额外功能；<a href="/consumer/cn/doc/best-practices/multi-video-app#section3198710114717">交互开发</a>介绍长视频应用中的键鼠适配，包含交互方式的统一和键盘走焦；<a href="/consumer/cn/doc/best-practices/multi-video-app#section208330326545">资源使用</a>给出“一多”应用开发中推荐的资源使用方式。</li><li><a href="/consumer/cn/doc/best-practices/multi-video-app#section1288911441542">功能开发</a>章节中，因为长视频应用不涉及设备系统能力差异，所以只做简单说明。</li></ul> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>阅读本文前，开发者需熟悉<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkui-overview" target="_blank">方舟开发框架（ArkUI框架）</a>和页面开发的<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-multi-device-overview">“一多”能力</a>。下文将详细介绍它们在“一多”开发实践中如何使用。</p> </div></div></div> </div> <div class="tiledSection"><h2 id="section17797105112306">UX设计<i class="anchor-icon anchor-icon-link" anchorid="section17797105112306" tips="复制节点链接"></i></h2><p>影音娱乐类的多设备响应式设计指南，<a href="https://developer.huawei.com/consumer/cn/doc/design-guides/responsive-design-examples1-0000001957369849" target="_blank">点击访问</a>。</p> </div> <div class="tiledSection"><h2 id="section189781175313">工程管理<i class="anchor-icon anchor-icon-link" anchorid="section189781175313" tips="复制节点链接"></i></h2><p>本章将介绍如何创建“一多”工程及划分目录结构。</p> </div> <div class="tiledSection"><h3 id="section201811187312" class="firsth2">创建工程<i class="anchor-icon anchor-icon-link" anchorid="section201811187312" tips="复制节点链接"></i></h3><p>根据三层架构进行<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-multi-device-ide" target="_blank">多设备工程部署</a>，先创建出最基本的项目工程，再在基本目录结构的基础上进行修改。</p> </div> <div class="tiledSection"><h3 id="section620043518317">工程结构<i class="anchor-icon anchor-icon-link" anchorid="section620043518317" tips="复制节点链接"></i></h3><p>在创建“一多”工程时，开发者会面临工程结构目录的划分问题。考虑到复用性和可维护性，本文以长视频应用为例，提供推荐的参考方案。</p> <p>HarmonyOS的分层架构主要包括三个层次：产品定制层、基础特性层和公共能力层，为开发者构建了一个清晰、高效、可扩展的设计架构。更多详情请参考<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-layered-architecture-design" target="_blank">分层架构设计</a>的逻辑设计。</p> <p>长视频应用根据一多推荐的commons、features、products的“三层工程架构”划分目录。其中四个页面功能不同，互不依赖，根据页面划分为四个features（基础特性层）：首页-home、视频搜索页-search、视频详情页-videoDetail和全屏播放页-videoPlayer。公共常量、媒体播放工具以及窗口管理工具等需要被不同页面依赖引用的内容，划分为一个commons（公共能力层）：基础能力-base。</p> <div class="p">工程结构如下：<div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-less" data-highlighted="yes"><ol class="linenums"><li>├──<span class="hljs-selector-tag">commons</span>                                    <span class="hljs-comment">// 公共能力层</span></li><li>│  ├──<span class="hljs-selector-tag">base</span>/<span class="hljs-selector-tag">src</span>/<span class="hljs-selector-tag">main</span>/<span class="hljs-selector-tag">ets</span>                       <span class="hljs-comment">// 基础能力</span></li><li>│  │  ├──<span class="hljs-selector-tag">constants</span></li><li>│  │  └──<span class="hljs-selector-tag">utils</span></li><li>│  └──<span class="hljs-selector-tag">base</span>/<span class="hljs-selector-tag">Index</span><span class="hljs-selector-class">.ets</span>                          <span class="hljs-comment">// 对外接口类</span></li><li>├──<span class="hljs-selector-tag">features</span>                                   <span class="hljs-comment">// 基础特性层</span></li><li>│  ├──<span class="hljs-selector-tag">home</span>/<span class="hljs-selector-tag">src</span>/<span class="hljs-selector-tag">main</span>/<span class="hljs-selector-tag">ets</span>                       <span class="hljs-comment">// 首页</span></li><li>│  │  ├──<span class="hljs-selector-tag">constants</span></li><li>│  │  ├──<span class="hljs-selector-tag">utils</span></li><li>│  │  ├──<span class="hljs-selector-tag">view</span></li><li>│  │  └──<span class="hljs-selector-tag">viewmodel</span></li><li>│  ├──<span class="hljs-selector-tag">home</span>/<span class="hljs-selector-tag">src</span>/<span class="hljs-selector-tag">main</span>/<span class="hljs-selector-tag">resources</span>                 <span class="hljs-comment">// 资源文件目录</span></li><li>│  ├──<span class="hljs-selector-tag">home</span>/<span class="hljs-selector-tag">Index</span><span class="hljs-selector-class">.ets</span>                          <span class="hljs-comment">// 对外接口类</span></li><li>│  ├──<span class="hljs-selector-tag">search</span>/<span class="hljs-selector-tag">src</span>/<span class="hljs-selector-tag">main</span>/<span class="hljs-selector-tag">ets</span>                     <span class="hljs-comment">// 搜索页</span></li><li>│  │  ├──<span class="hljs-selector-tag">constants</span></li><li>│  │  ├──<span class="hljs-selector-tag">view</span></li><li>│  │  └──<span class="hljs-selector-tag">viewmodel</span></li><li>│  ├──<span class="hljs-selector-tag">search</span>/<span class="hljs-selector-tag">src</span>/<span class="hljs-selector-tag">main</span>/<span class="hljs-selector-tag">resources</span>               <span class="hljs-comment">// 资源文件目录</span></li><li>│  ├──<span class="hljs-selector-tag">search</span>/<span class="hljs-selector-tag">Index</span><span class="hljs-selector-class">.ets</span>                        <span class="hljs-comment">// 对外接口类</span></li><li>│  ├──<span class="hljs-selector-tag">videoDetail</span>/<span class="hljs-selector-tag">src</span>/<span class="hljs-selector-tag">main</span>/<span class="hljs-selector-tag">ets</span>                <span class="hljs-comment">// 视频详情页</span></li><li>│  │  ├──<span class="hljs-selector-tag">constants</span></li><li>│  │  ├──<span class="hljs-selector-tag">utils</span></li><li>│  │  ├──<span class="hljs-selector-tag">view</span></li><li>│  │  └──<span class="hljs-selector-tag">viewmodel</span></li><li>│  ├──<span class="hljs-selector-tag">videoDetail</span>/<span class="hljs-selector-tag">src</span>/<span class="hljs-selector-tag">main</span>/<span class="hljs-selector-tag">resources</span>          <span class="hljs-comment">// 资源文件目录</span></li><li>│  ├──<span class="hljs-selector-tag">videoPlayer</span>/<span class="hljs-selector-tag">src</span>/<span class="hljs-selector-tag">main</span>/<span class="hljs-selector-tag">ets</span>                <span class="hljs-comment">// 全屏播放页</span></li><li>│  │  ├──<span class="hljs-selector-tag">constants</span></li><li>│  │  └──<span class="hljs-selector-tag">view</span></li><li>│  └──<span class="hljs-selector-tag">videoPlayer</span>/<span class="hljs-selector-tag">src</span>/<span class="hljs-selector-tag">main</span>/<span class="hljs-selector-tag">resources</span>          <span class="hljs-comment">// 资源文件目录</span></li><li>└──<span class="hljs-selector-tag">products</span>                                   <span class="hljs-comment">// 产品定制层</span></li><li>   ├──<span class="hljs-selector-tag">phone</span>/<span class="hljs-selector-tag">src</span>/<span class="hljs-selector-tag">main</span>/<span class="hljs-selector-tag">ets</span>                      <span class="hljs-comment">// 支持手机、折叠屏、平板、PC/2in1</span></li><li>   │  ├──<span class="hljs-selector-tag">entryability</span></li><li>   │  └──<span class="hljs-selector-tag">pages</span></li><li>   └──<span class="hljs-selector-tag">phone</span>/<span class="hljs-selector-tag">src</span>/<span class="hljs-selector-tag">main</span>/<span class="hljs-selector-tag">resources</span>                <span class="hljs-comment">// 资源文件目录</span></li></ol></pre></div></div> </div> </div> <div class="tiledSection"><h2 id="section7318163817529">页面开发<i class="anchor-icon anchor-icon-link" anchorid="section7318163817529" tips="复制节点链接"></i></h2><p>本章介绍长视频应用中如何使用“一多”的布局能力，完成页面层级的一套代码、多端适配。同时介绍长视频应用中的<a href="/consumer/cn/doc/best-practices/multi-video-app#section3198710114717">交互开发</a>和推荐的<a href="/consumer/cn/doc/best-practices/multi-video-app#section208330326545">资源使用</a>方式。</p> </div> <div class="tiledSection"><h3 id="section109591922155720" class="firsth2">首页<i class="anchor-icon anchor-icon-link" anchorid="section109591922155720" tips="复制节点链接"></i></h3><p>长视频应用首页主要推荐精选视频，满足用户观看需求。首页内容围绕此功能设计。观察PC/2in1的UX设计图，可以进行如下设计（图中包含可滑动区域内容）：</p> </div> <ul><li>将应用首页划分为8个区域，效果图如下：<p></p> <p><span><img height="837.6665849999999" originheight="1629" originwidth="960" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163118.51539340006354744531548581721824:50001231000000:2800:A346F4AD196490D8EC2E36EE930F4B2954A1CCFA89A0672C69FA23DDF3BBDDBA.png" title="点击放大" width="502.85770500000007"></span></p> </li><li>整个页面响应式适配，借助栅格组件能力监听不同断点变化实现不同的布局效果。</li><li>首页区域2在小设备上呈两行显示，在中设备和大设备上单行显示，断点变化时切换显示效果。</li><li>首页区域3、4使用自适应布局延伸能力随不同设备尺寸延伸或隐藏。</li><li>首页区域1和5-8使用响应式布局的栅格断点系统，根据断点变化切换组件属性实现布局效果。</li></ul> <p>长视频应用搜索页包含8个基础区域，具体介绍及实现方案如下表所示：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.10.1.4.1.1" valign="top" width="5.18%"><p>区域编号</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.1.4.1.2" valign="top" width="14.06%"><p>简介</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.10.1.4.1.3" valign="top" width="80.76%"><p>实现方案</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="5.18%"><p>1</p> </td> <td class="cellrowborder" valign="top" width="14.06%"><p><a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li1226615201361">底部/侧边页签</a></p> </td> <td class="cellrowborder" valign="top" width="80.76%"><p>借助<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-multi-device-responsive-layout#section1914110349546">响应式组件</a>Tabs实现。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="5.18%"><p>2</p> </td> <td class="cellrowborder" valign="top" width="14.06%"><p><a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li1346175796">顶部页签及搜索框</a></p> </td> <td class="cellrowborder" valign="top" width="80.76%"><p>栅格布局监听断点变化实现折行显示，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-list" target="_blank">List组件</a>实现延伸能力，layoutWeight实现拉伸能力。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="5.18%"><p>3</p> </td> <td class="cellrowborder" valign="top" width="14.06%"><p><a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li139671645597">Banner图</a></p> </td> <td class="cellrowborder" valign="top" width="80.76%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-swiper" target="_blank">Swiper组件</a>，指定displayCount属性实现延伸能力，设置aspectRatio属性实现缩放能力。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="5.18%"><p>4</p> </td> <td class="cellrowborder" valign="top" width="14.06%"><p>图标列表</p> </td> <td class="cellrowborder" valign="top" width="80.76%"><p>Swiper组件，指定displayCount属性实现自适应布局延伸能力，设置aspectRatio属性实现缩放能力。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="5.18%"><p>5</p> </td> <td class="cellrowborder" valign="top" width="14.06%"><p><a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li19261618201020">推荐视频</a></p> </td> <td class="cellrowborder" valign="top" width="80.76%"><p><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid" target="_blank">Grid</a>组件，借助栅格组件能力监听断点变化改变列数，设置aspectRatio属性实现缩放能力。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="5.18%"><p>6</p> </td> <td class="cellrowborder" valign="top" width="14.06%"><p>新片发布</p> </td> <td class="cellrowborder" valign="top" width="80.76%"><p>网格容器，借助栅格组件能力监听断点变化改变列数，设置aspectRatio属性实现缩放能力。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="5.18%"><p>7</p> </td> <td class="cellrowborder" valign="top" width="14.06%"><p><a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li1938820294129">每日佳片</a></p> </td> <td class="cellrowborder" valign="top" width="80.76%"><p>利用响应式布局的栅格布局，结合<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-stack" target="_blank">Stack组件</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-grid" target="_blank">Grid组件</a>，设置aspectRatio属性实现缩放能力。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="5.18%"><p>8</p> </td> <td class="cellrowborder" valign="top" width="14.06%"><p>往期回顾</p> </td> <td class="cellrowborder" valign="top" width="80.76%"><p>响应式布局的栅格布局，设置aspectRatio属性实现缩放能力。</p> </td> </tr>  </tbody></table></div> </div> <p>在实际开发中，区域1为外层导航栏，区域2为内层导航栏，区域3-8为并列的首页内容，所以对应的开发顺序为区域1、区域2和区域3-8。另外，为了提升用户的使用体验，首页设计了额外的功能，包括<a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li198001419141319">首页社区页签的沉浸式设计</a>，<a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li5503173331317">PC/2in1首页Banner图的排版创新</a>，<a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li8773338111310">首页推荐视频区域长按预览</a>，<a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li8459423139">首页推荐视频区域的缩放</a>。</p> <ul><li id="zh-cn_topic_0000001744653537_li1226615201361"><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li1226615201361"></a><a name="zh-cn_topic_0000001744653537_li1226615201361"></a>底部/侧边页签<p><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li1226615201361"></a><a name="zh-cn_topic_0000001744653537_li1226615201361"></a>底部/侧边页签区域，使用Tabs组件，设置在不同断点下的vertical属性，实现显示在首页的不同位置。在sm和md断点下，页签显示在底部，高度为56vp；在lg断点下页签显示在左侧，宽度为96vp，且页签居中显示。</p> <p>示意图如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.12.1.3.1.5.1.1" valign="top" width="7.5200000000000005%"><p>示意图</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.1.3.1.5.1.2" valign="top" width="18.35%"><p>sm</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.1.3.1.5.1.3" valign="top" width="32.06%"><p>md</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.12.1.3.1.5.1.4" valign="top" width="42.07%"><p>lg</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top"><p>设计能力点</p> </td> <td class="cellrowborder" colspan="3" valign="top"><p><span><img height="232.1781" originheight="199" originwidth="228" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163118.36061465142436573002257156578616:50001231000000:2800:CB8ED83F8122092690F8CBB1CDEAC41AA032C5C8B03ADD5E31780494E61911EB.png" width="266" class="notEnlarge"></span></p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="7.5200000000000005%"><p>效果图</p> </td> <td class="cellrowborder" valign="top" width="18.35%"><p><span><img height="300.00911199999996" originheight="804" originwidth="385" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163118.87143164410595395887194463352053:50001231000000:2800:EC47F1B84FA8857F1CE2A522E2DDFDCF638BCAB0FFC4C25F760EC407440F7359.png" title="点击放大" width="144.82"></span></p> </td> <td class="cellrowborder" valign="top" width="32.06%"><p><span><img height="302.20179733333333" originheight="787" originwidth="705" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163118.95588991549386658689667061254629:50001231000000:2800:950FD41C8CAAC08BDAAD55C0A02D2647A1DA7134B8522CDA304A7D8B3EE4B9CD.png" title="点击放大" width="270.952"></span></p> </td> <td class="cellrowborder" valign="top" width="42.07%"><p><span><img height="235.30696860000003" originheight="869" originwidth="1344" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163118.85824761934469081791513572874934:50001231000000:2800:E9A0554987E59B46A08A5FAD8EA5CA964E6795C86F356F741C093ADE346BD43F.png" title="点击放大" width="363.04400000000004"></span></p> </td> </tr>  </tbody></table></div> </div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/Home.ets#L63-L144" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title function_">Tabs</span>({</li><li>  <span class="hljs-variable">barPosition</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">currentWidthBreakpoint</span> === <span class="hljs-string">'lg'</span> ? <span class="hljs-variable">BarPosition</span>.<span class="hljs-variable">Start</span> : <span class="hljs-title class_">BarPosition</span>.<span class="hljs-title class_">End</span></li><li>}) {</li><li>  <span class="hljs-comment">// ...</span></li><li>}</li><li><span class="hljs-comment">// Change the position and size of the tab at the bottom.</span></li><li>.<span class="hljs-title function_">barWidth</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span> === <span class="hljs-string">'lg'</span> ? <span class="hljs-string">'96vp'</span> : <span class="hljs-string">'100%'</span>)</li><li>.<span class="hljs-title function_">barHeight</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span> === <span class="hljs-string">'lg'</span> ? <span class="hljs-string">'100%'</span> : (<span class="hljs-title class_">deviceInfo</span>.<span class="hljs-title class_">deviceType</span> === <span class="hljs-string">'2in1'</span> ? <span class="hljs-string">'56vp'</span> : <span class="hljs-string">'76vp'</span>))</li><li>.<span class="hljs-title function_">barMode</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span> === <span class="hljs-string">'lg'</span> ? <span class="hljs-variable">BarMode</span>.<span class="hljs-variable">Scrollable</span> : <span class="hljs-title class_">BarMode</span>.<span class="hljs-title class_">Fixed</span>,</li><li>  { <span class="hljs-variable">nonScrollableLayoutStyle</span>: <span class="hljs-title class_">LayoutStyle</span>.<span class="hljs-title class_">ALWAYS_CENTER</span> })</li><li>.<span class="hljs-title function_">vertical</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span> === <span class="hljs-string">'lg'</span>)</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/Home.ets#L63-L144" target="_blank">Home.ets</a></div></div></div></div> </li></ul> <ul><li id="zh-cn_topic_0000001744653537_li1346175796"><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li1346175796"></a><a name="zh-cn_topic_0000001744653537_li1346175796"></a>顶部页签及搜索框<p><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li1346175796"></a><a name="zh-cn_topic_0000001744653537_li1346175796"></a>不同断点下，顶部页签和搜索框占用不同栅格列数，使用栅格布局实现在sm断点下分两行显示，在md和lg断点下单行显示。根据设计将栅格在sm、md和lg的断点上分别划分为4列、12列、12列。示意图如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.13.1.2.1.5.1.1" valign="top" width="6.805366517596734%"><p>示意图</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.1.2.1.5.1.2" valign="top" width="17.16896752867976%"><p>sm</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.1.2.1.5.1.3" valign="top" width="29.856115107913666%"><p>md</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.13.1.2.1.5.1.4" valign="top" width="46.16955084580984%"><p>lg</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="6.805366517596734%"><p>效果图</p> </td> <td class="cellrowborder" valign="top" width="17.16896752867976%"><p><span><img height="45.74546218160607" originheight="224" originwidth="656" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163119.43833343596690745036834569097832:50001231000000:2800:AFDA3834B55B0E4D1EB00F59FD566E841C82E2F4EDA9869D0AA962E61305F4F6.png" title="点击放大" width="133.95450126385379"></span></p> </td> <td class="cellrowborder" valign="top" width="29.856115107913666%"><p><span><img height="20.736497202238212" originheight="112" originwidth="1354" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163119.57192616436085140192155223342895:50001231000000:2800:6D5E811C3288F1DABD4864B2930CCA2DADA4A92DC47E9EBB563A1C5C1EF4B4C6.png" title="点击放大" width="250.67625899280574"></span></p> </td> <td class="cellrowborder" valign="top" width="46.16955084580984%"><p><span><img height="18.95594174606261" originheight="112" originwidth="2368" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163119.57668382165095367919442658203624:50001231000000:2800:AE2A3025818864A4C0FA4332AC6F54F3C7F6A38D012CA76E97B88EFC3EE93E2B.png" title="点击放大" width="400.7598677814505"></span></p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>栅格布局图</p> </td> <td class="cellrowborder" valign="top"><p></p> <p><span><img height="31.64005319852227" originheight="756" originwidth="3181" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163119.46777306259758395210368014126543:50001231000000:2800:5E946FCE4C8987CE9ED2D5FA46C381696FA9E9E99650C4769DAC50B3906FF649.jpg" title="点击放大" width="133.95450126385379"></span></p> </td> <td class="cellrowborder" colspan="2" valign="top"><p><span><img height="38.2926053665176" originheight="43" originwidth="450" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163119.24310738360070062264590378487783:50001231000000:2800:A8D327C21F14232169A7FE32C1F89818EEE0F7AEBDA729D79BF3F2F3541BAFF2.png" title="点击放大" width="400.7598677814505"></span></p> <p></p> </td> </tr>  </tbody></table></div> </div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/HomeHeader.ets#L35-L59" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title function_">build</span>() {</li><li>  <span class="hljs-title function_">Column</span>() {</li><li>    <span class="hljs-title function_">GridRow</span>({ <span class="hljs-variable">columns</span>: { <span class="hljs-variable">sm</span>: <span class="hljs-number">4</span>, <span class="hljs-variable">md</span>: <span class="hljs-number">12</span>, <span class="hljs-variable">lg</span>: <span class="hljs-number">12</span> } }) {</li><li>      <span class="hljs-title function_">GridCol</span>({ <span class="hljs-variable">span</span>: { <span class="hljs-variable">sm</span>: <span class="hljs-number">4</span>, <span class="hljs-variable">md</span>: <span class="hljs-number">7</span>, <span class="hljs-variable">lg</span>: <span class="hljs-number">7</span> } }) {</li><li>        <span class="hljs-keyword">this</span>.<span class="hljs-title function_">TopTabBar</span>()</li><li>      }</li><li>      .<span class="hljs-title function_">padding</span>({ <span class="hljs-variable">top</span>: <span class="hljs-title class_">deviceInfo</span>.<span class="hljs-title class_">deviceType</span> === <span class="hljs-string">'2in1'</span> ? <span class="hljs-number">0</span> : $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">search_top_padding_top</span>') })</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-variable">deviceInfo</span>.<span class="hljs-variable">deviceType</span> === <span class="hljs-string">'2in1'</span> ? $<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.float.search_top_height'</span>) : $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">search_top_height_more</span>'))</li><li>
</li><li>      <span class="hljs-title function_">GridCol</span>({ <span class="hljs-variable">span</span>: { <span class="hljs-variable">sm</span>: <span class="hljs-number">4</span>, <span class="hljs-variable">md</span>: <span class="hljs-number">5</span>, <span class="hljs-variable">lg</span>: <span class="hljs-number">5</span> } }) {</li><li>        <span class="hljs-keyword">this</span>.<span class="hljs-title function_">searchBar</span>()</li><li>      }</li><li>      .<span class="hljs-title function_">padding</span>({ <span class="hljs-variable">top</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">currentWidthBreakpoint</span> === <span class="hljs-string">'sm'</span> || <span class="hljs-variable">deviceInfo</span>.<span class="hljs-variable">deviceType</span> === <span class="hljs-string">'2in1'</span> ? <span class="hljs-number">0</span> : $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">search_top_padding_top</span>') })</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span> === <span class="hljs-string">'sm'</span> || <span class="hljs-variable">deviceInfo</span>.<span class="hljs-variable">deviceType</span> === <span class="hljs-string">'2in1'</span> ? $<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.float.search_top_height'</span>) : $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">search_top_height_more</span>'))</li><li>    }</li><li>    <span class="hljs-comment">// The background color of the top tab bar is changed during the slide-down process.</span></li><li>    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">scrollHeight</span> &gt;= <span class="hljs-variable">new</span> <span class="hljs-title function_">BreakpointType</span>(<span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">BACKGROUND_CHANGE_HEIGHT</span>[<span class="hljs-number">0</span>],</li><li>      <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">BACKGROUND_CHANGE_HEIGHT</span>[<span class="hljs-number">1</span>], <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">BACKGROUND_CHANGE_HEIGHT</span>[<span class="hljs-number">2</span>])</li><li>      .<span class="hljs-title function_">getValue</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span>) &amp;&amp; <span class="hljs-keyword">this</span>.<span class="hljs-variable">currentTopIndex</span> === <span class="hljs-number">2</span> ? $<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.color.home_content_background'</span>) :</li><li>      <span class="hljs-variable">Color</span>.<span class="hljs-variable">Transparent</span>)</li><li>  }</li><li>  .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/HomeHeader.ets#L35-L59" target="_blank">HomeHeader.ets</a></div></div></div></div> <p>随着设备宽度变大，顶部页签间距变大、页面能够展示更多页签内容，使用List组件实现延伸能力；同时使用layoutWeight将增加的空间全部分配给搜索框，实现拉伸能力。</p> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/HomeHeader.ets#L63-L119" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">@Builder</span></li><li>TopTabBar() {</li><li>  <span class="hljs-built_in">Row</span>() {</li><li>    <span class="hljs-built_in">Column</span>() {</li><li>      <span class="hljs-built_in">List</span>() {</li><li>        <span class="hljs-comment">// ...</span></li><li>      }</li><li>      <span class="hljs-selector-class">.tabIndex</span>(getTabIndex(HomeConstants.DIRECTION_LIST[<span class="hljs-number">1</span>]))</li><li>      <span class="hljs-selector-class">.scrollBar</span>(BarState.Off)</li><li>      <span class="hljs-selector-class">.listDirection</span>(Axis.Horizontal)</li><li>      <span class="hljs-selector-class">.padding</span>({ left: $r('app.float.search_top_padding') })</li><li>    }</li><li>    <span class="hljs-selector-class">.alignItems</span>(HorizontalAlign.Center)</li><li>    <span class="hljs-selector-class">.layoutWeight</span>(<span class="hljs-number">1</span>)</li><li>    <span class="hljs-comment">// ...</span></li><li>  }</li><li>  <span class="hljs-selector-class">.height</span>($r('app.float.top_bar_height'))</li><li>  <span class="hljs-selector-class">.width</span>('<span class="hljs-number">100%</span>')</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/HomeHeader.ets#L63-L119" target="_blank">HomeHeader.ets</a></div></div></div></div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-less" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/HomeHeader.ets#L123-L186" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">@Builder</span></li><li><span class="hljs-built_in">searchBar</span>() {</li><li>  <span class="hljs-selector-tag">Row</span>() {</li><li>    <span class="hljs-selector-tag">Stack</span>({ alignContent: Alignment.Start }) {</li><li>      <span class="hljs-comment">// ...</span></li><li>    }</li><li>    <span class="hljs-comment">// .tabIndex(getTabIndex(HomeConstants.DIRECTION_LIST[1]))</span></li><li>    .<span class="hljs-built_in">alignSelf</span>(ItemAlign.Center)</li><li>    .<span class="hljs-built_in">layoutWeight</span>(<span class="hljs-number">1</span>)</li><li>    <span class="hljs-comment">// ...</span></li><li>  }</li><li>  .<span class="hljs-built_in">padding</span>({</li><li>    <span class="hljs-attribute">left</span>: $<span class="hljs-built_in">r</span>(<span class="hljs-string">'app.float.search_top_padding'</span>),</li><li>    <span class="hljs-attribute">right</span>: $<span class="hljs-built_in">r</span>(<span class="hljs-string">'app.float.search_top_padding'</span>)</li><li>  })</li><li>  .<span class="hljs-built_in">justifyContent</span>(FlexAlign.Center)</li><li>  .<span class="hljs-built_in">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  .<span class="hljs-built_in">height</span>(<span class="hljs-string">'100%'</span>)</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/HomeHeader.ets#L123-L186" target="_blank">HomeHeader.ets</a></div></div></div></div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/HomeHeader.ets#L36-L58" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title function_">build</span>() {</li><li>  <span class="hljs-title function_">Column</span>() {</li><li>    <span class="hljs-title function_">GridRow</span>({ <span class="hljs-variable">columns</span>: { <span class="hljs-variable">sm</span>: <span class="hljs-number">4</span>, <span class="hljs-variable">md</span>: <span class="hljs-number">12</span>, <span class="hljs-variable">lg</span>: <span class="hljs-number">12</span> } }) {</li><li>      <span class="hljs-title function_">GridCol</span>({ <span class="hljs-variable">span</span>: { <span class="hljs-variable">sm</span>: <span class="hljs-number">4</span>, <span class="hljs-variable">md</span>: <span class="hljs-number">7</span>, <span class="hljs-variable">lg</span>: <span class="hljs-number">7</span> } }) {</li><li>        <span class="hljs-keyword">this</span>.<span class="hljs-title function_">TopTabBar</span>()</li><li>      }</li><li>      .<span class="hljs-title function_">padding</span>({ <span class="hljs-variable">top</span>: <span class="hljs-title class_">deviceInfo</span>.<span class="hljs-title class_">deviceType</span> === <span class="hljs-string">'2in1'</span> ? <span class="hljs-number">0</span> : $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">search_top_padding_top</span>') })</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-variable">deviceInfo</span>.<span class="hljs-variable">deviceType</span> === <span class="hljs-string">'2in1'</span> ? $<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.float.search_top_height'</span>) : $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">search_top_height_more</span>'))</li><li>
</li><li>      <span class="hljs-title function_">GridCol</span>({ <span class="hljs-variable">span</span>: { <span class="hljs-variable">sm</span>: <span class="hljs-number">4</span>, <span class="hljs-variable">md</span>: <span class="hljs-number">5</span>, <span class="hljs-variable">lg</span>: <span class="hljs-number">5</span> } }) {</li><li>        <span class="hljs-keyword">this</span>.<span class="hljs-title function_">searchBar</span>()</li><li>      }</li><li>      .<span class="hljs-title function_">padding</span>({ <span class="hljs-variable">top</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">currentWidthBreakpoint</span> === <span class="hljs-string">'sm'</span> || <span class="hljs-variable">deviceInfo</span>.<span class="hljs-variable">deviceType</span> === <span class="hljs-string">'2in1'</span> ? <span class="hljs-number">0</span> : $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">search_top_padding_top</span>') })</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span> === <span class="hljs-string">'sm'</span> || <span class="hljs-variable">deviceInfo</span>.<span class="hljs-variable">deviceType</span> === <span class="hljs-string">'2in1'</span> ? $<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.float.search_top_height'</span>) : $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">search_top_height_more</span>'))</li><li>    }</li><li>    <span class="hljs-comment">// The background color of the top tab bar is changed during the slide-down process.</span></li><li>    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">scrollHeight</span> &gt;= <span class="hljs-variable">new</span> <span class="hljs-title function_">BreakpointType</span>(<span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">BACKGROUND_CHANGE_HEIGHT</span>[<span class="hljs-number">0</span>],</li><li>      <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">BACKGROUND_CHANGE_HEIGHT</span>[<span class="hljs-number">1</span>], <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">BACKGROUND_CHANGE_HEIGHT</span>[<span class="hljs-number">2</span>])</li><li>      .<span class="hljs-title function_">getValue</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span>) &amp;&amp; <span class="hljs-keyword">this</span>.<span class="hljs-variable">currentTopIndex</span> === <span class="hljs-number">2</span> ? $<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.color.home_content_background'</span>) :</li><li>      <span class="hljs-variable">Color</span>.<span class="hljs-variable">Transparent</span>)</li><li>  }</li><li>  .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/HomeHeader.ets#L36-L58" target="_blank">HomeHeader.ets</a></div></div></div></div> </li></ul> <ul><li id="zh-cn_topic_0000001744653537_li139671645597"><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li139671645597"></a><a name="zh-cn_topic_0000001744653537_li139671645597"></a>Banner图<p><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li139671645597"></a><a name="zh-cn_topic_0000001744653537_li139671645597"></a>Banner图和图标列表区域，均使用Swiper组件，设置在不同断点下的displayCount属性来实现自适应布局的延伸能力，本章节以Banner图区域作为示例，图标列表的实现开发者可以自行查看代码。Banner图区域中，Banner展示数量在sm断点下为1，并显示导航点指示器；在md和lg断点下Banner为2，且前后边距展示前后两张Banner图的部分内容。</p> <p>在“一多”的应用中，经常会出现窗口大小改变如果组件随着窗口宽度变化只改变宽度、不改变高度，会导致图片变形，视觉上会给用户带来较差体验。为解决这一痛点，需要给Stack组件设置aspectRatio属性，Stack的高度会跟随宽度变化相应等比发生变化，Banner图大小变化且宽高比保持不变，实现自适应布局的缩放能力。</p> <p>示意图如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.14.1.4.1.5.1.1" valign="top" width="7.519248075192481%"><p>示意图</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.1.4.1.5.1.2" valign="top" width="15.928407159284072%"><p>sm</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.1.4.1.5.1.3" valign="top" width="29.957004299570038%"><p>md</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.14.1.4.1.5.1.4" valign="top" width="46.595340465953406%"><p>lg</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top"><p>设计能力点</p> </td> <td class="cellrowborder" colspan="3" valign="top"><p><span><img height="271.8387" originheight="233" originwidth="228" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163119.34304865315071607631543163683964:50001231000000:2800:9CE8ECBBE458A16D96A760700400E89081797C2289E2C4C9F079B2CC6EF830E5.png" width="266" class="notEnlarge"></span></p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="7.519248075192481%"><p>效果图</p> </td> <td class="cellrowborder" valign="top" width="15.928407159284072%"><p><span><img height="82.71540845915409" originheight="486" originwidth="720" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163119.37733037621982794998750452233912:50001231000000:2800:C46F98BC2910A0B5C083AECB30372BB9DE5CD36EE9049CB6EE4931E4DE8B1F8C.png" title="点击放大" width="122.54134586541346"></span></p> </td> <td class="cellrowborder" valign="top" width="29.957004299570038%"><p><span><img height="71.7282323101023" originheight="386" originwidth="1354" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163119.20841898158279854746007293784483:50001231000000:2800:59B69AF83411922597157D042FDC277891663F24E87DCA47072B836CFD50C7BB.png" title="点击放大" width="251.60443955604433"></span></p> </td> <td class="cellrowborder" valign="top" width="46.595340465953406%"><p><span><img height="82.71600583941606" originheight="484" originwidth="2368" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163119.92915918447550608147065251165232:50001231000000:2800:6682F0F9E67A55099ACDF8F71C11865AFA5FAF753E7528C5812207D47C221040.png" title="点击放大" width="404.6771322867713"></span></p> </td> </tr>  </tbody></table></div> </div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-less" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/BannerView.ets#L65-L153" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-selector-tag">Swiper</span>() {</li><li>  <span class="hljs-selector-tag">LazyForEach</span>(this.bannerDataSource, (<span class="hljs-attribute">item</span>: Banner, <span class="hljs-attribute">index</span>: number) =&gt; {</li><li>    <span class="hljs-selector-tag">Stack</span>() {</li><li>      <span class="hljs-comment">// ...</span></li><li>    }</li><li>    .<span class="hljs-built_in">height</span>(item.<span class="hljs-built_in">getBannerImg</span>().<span class="hljs-built_in">getHeight</span>().<span class="hljs-built_in">getValue</span>(this.currentWidthBreakpoint))</li><li>    .<span class="hljs-built_in">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    <span class="hljs-comment">// The width and height vary with the container assembly and the aspect ratio remains unchanged.</span></li><li>    .<span class="hljs-built_in">aspectRatio</span>(new <span class="hljs-built_in">BreakpointType</span>(<span class="hljs-number">1.49</span>, <span class="hljs-number">1.6</span>,</li><li>      <span class="hljs-number">2.1</span>).<span class="hljs-built_in">getValue</span>(this.currentWidthBreakpoint))</li><li>    .<span class="hljs-built_in">groupDefaultFocus</span>(index === <span class="hljs-number">0</span> ? <span class="hljs-attribute">true </span>: false)</li><li>    .<span class="hljs-built_in">focusable</span>(true)</li><li>    .<span class="hljs-built_in">padding</span>({</li><li>      <span class="hljs-attribute">top</span>: $<span class="hljs-built_in">r</span>(<span class="hljs-string">'app.float.banner_margin'</span>),</li><li>      <span class="hljs-attribute">bottom</span>: $<span class="hljs-built_in">r</span>(<span class="hljs-string">'app.float.banner_margin'</span>),</li><li>      <span class="hljs-attribute">left</span>: this.currentWidthBreakpoint === <span class="hljs-string">'sm'</span> ? $<span class="hljs-built_in">r</span>(<span class="hljs-string">'app.float.banner_padding_sm'</span>) : <span class="hljs-number">0</span>,</li><li>      <span class="hljs-attribute">right</span>: this.currentWidthBreakpoint === <span class="hljs-string">'sm'</span> ? $<span class="hljs-built_in">r</span>(<span class="hljs-string">'app.float.banner_padding_sm'</span>) : <span class="hljs-number">0</span></li><li>    })</li><li>  }, (<span class="hljs-attribute">item</span>: Banner, <span class="hljs-attribute">index</span>: number) =&gt; index + JSON.<span class="hljs-built_in">stringify</span>(item))</li><li>}</li><li><span class="hljs-selector-class">.displayCount</span>(this.currentWidthBreakpoint === <span class="hljs-string">'sm'</span> ? <span class="hljs-number">1</span> : <span class="hljs-number">2</span>)</li><li><span class="hljs-comment">// Interval between banner images</span></li><li><span class="hljs-selector-class">.itemSpace</span>(<span class="hljs-string">'12vp'</span>)</li><li><span class="hljs-selector-class">.prevMargin</span>(new <span class="hljs-built_in">BreakpointType</span>(<span class="hljs-string">"0vp"</span>,</li><li>  <span class="hljs-string">"12vp"</span>, <span class="hljs-string">"64vp"</span>)</li><li>  .<span class="hljs-built_in">getValue</span>(this.currentWidthBreakpoint))</li><li><span class="hljs-selector-class">.nextMargin</span>(new <span class="hljs-built_in">BreakpointType</span>(<span class="hljs-string">"0vp"</span>,</li><li>  <span class="hljs-string">"12vp"</span>, <span class="hljs-string">"64vp"</span>)</li><li>  .<span class="hljs-built_in">getValue</span>(this.currentWidthBreakpoint))</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/BannerView.ets#L65-L153" target="_blank">BannerView.ets</a></div></div></div></div> </li></ul> <ul><li id="zh-cn_topic_0000001744653537_li19261618201020"><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li19261618201020"></a><a name="zh-cn_topic_0000001744653537_li19261618201020"></a>推荐视频<p><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li19261618201020"></a><a name="zh-cn_topic_0000001744653537_li19261618201020"></a>视频推荐和新片发布区域，均使用网格布局Grid组件，在不同断点下将父组件分为不同列数，来实现自适应布局的占比能力，本章节以推荐视频区域作为示例，新片发布区域的实现开发者可以自行查看代码。</p> <p>视频推荐区域中，网格布局在sm断点下分2列，md断点下分3列，lg断点下分4列。示意图如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.15.1.3.1.5.1.1" valign="top" width="7.5200000000000005%"><p>示意图</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.15.1.3.1.5.1.2" valign="top" width="17.52%"><p>sm</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.15.1.3.1.5.1.3" valign="top" width="30.020000000000003%"><p>md</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.15.1.3.1.5.1.4" valign="top" width="44.940000000000005%"><p>lg</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top"><p>设计能力点</p> </td> <td class="cellrowborder" colspan="3" valign="top"><p><span><img height="275.8021" originheight="197" originwidth="190" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163119.56890672263952795808173371966525:50001231000000:2800:1259A0508B713882574D162D8623765B911D067E8FADA79457BD89D0CB73BC02.png" width="266" class="notEnlarge"></span></p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="7.5200000000000005%"><p>效果图</p> </td> <td class="cellrowborder" valign="top" width="17.52%"><p><span><img height="115.08365760000001" originheight="604" originwidth="720" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163119.51752572117049130736658189761495:50001231000000:2800:B2AC59201423D008D925CF4C80F374378ABC0A4047CA78E6F93DBDC9FDBA94A5.png" title="点击放大" width="137.184"></span></p> </td> <td class="cellrowborder" valign="top" width="30.020000000000003%"><p><span><img height="133.35630022222225" originheight="716" originwidth="1354" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163119.10123492019237363085799449108565:50001231000000:2800:D5C1BD7C38E298D73DC7FC27611884B97CF5D470416D10AD4C6DAEB1C0F1477E.png" title="点击放大" width="252.18400000000003"></span></p> </td> <td class="cellrowborder" valign="top" width="44.940000000000005%"><p><span><img height="144.06979680000003" originheight="876" originwidth="2368" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163119.19455147752964124439988117673757:50001231000000:2800:DDA2B4813131378E3D39F1715BF9B3E7C3FDD8CC579FF0E65B61971365FEEAD2.png" title="点击放大" width="389.44800000000004"></span></p> </td> </tr>  </tbody></table></div> </div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-typescript" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/products/phone/src/main/ets/entryability/EntryAbility.ets#L111-L145" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// products/phone/src/main/ets/entryability/EntryAbility.ets</span></li><li><span class="hljs-keyword">private</span> <span class="hljs-title function_">updateWidthBp</span>(): <span class="hljs-built_in">void</span> {</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-variable language_">this</span>.<span class="hljs-property">windowObj</span> === <span class="hljs-literal">undefined</span>) {</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-keyword">try</span> {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">mainWindow</span>: <span class="hljs-variable language_">window</span>.<span class="hljs-property">WindowProperties</span> = <span class="hljs-variable language_">this</span>.<span class="hljs-property">windowObj</span>.<span class="hljs-title function_">getWindowProperties</span>();</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">windowWidth</span>: <span class="hljs-built_in">number</span> = mainWindow.<span class="hljs-property">windowRect</span>.<span class="hljs-property">width</span>;</li><li>    <span class="hljs-keyword">let</span> windowWidthVp = windowWidth / display.<span class="hljs-title function_">getDefaultDisplaySync</span>().<span class="hljs-property">densityPixels</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">widthBp</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">''</span>;</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-attr">videoGridColumn</span>: <span class="hljs-built_in">string</span> = <span class="hljs-string">'1fr 1fr'</span>;</li><li>    <span class="hljs-keyword">if</span> (windowWidthVp &lt; <span class="hljs-number">320</span>) {</li><li>      widthBp = <span class="hljs-string">'xs'</span>;</li><li>      videoGridColumn = <span class="hljs-string">'1fr 1fr'</span>;</li><li>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (windowWidthVp &gt;= <span class="hljs-number">320</span> &amp;&amp; windowWidthVp &lt; <span class="hljs-number">600</span>) {</li><li>      widthBp = <span class="hljs-string">'sm'</span>;</li><li>      videoGridColumn = <span class="hljs-string">'1fr 1fr'</span>;</li><li>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (windowWidthVp &gt;= <span class="hljs-number">600</span> &amp;&amp; windowWidthVp &lt; <span class="hljs-number">840</span>) {</li><li>      widthBp = <span class="hljs-string">'md'</span>;</li><li>      videoGridColumn = <span class="hljs-string">'1fr 1fr 1fr'</span>;</li><li>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (windowWidthVp &gt;= <span class="hljs-number">840</span> &amp;&amp; windowWidthVp &lt; <span class="hljs-number">1440</span>) {</li><li>      widthBp = <span class="hljs-string">'lg'</span>;</li><li>      videoGridColumn = <span class="hljs-string">'1fr 1fr 1fr 1fr'</span>;</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      widthBp = <span class="hljs-string">'xl'</span>;</li><li>      videoGridColumn = <span class="hljs-string">'1fr 1fr 1fr 1fr'</span>;</li><li>    }</li><li>    <span class="hljs-title class_">AppStorage</span>.<span class="hljs-title function_">setOrCreate</span>(<span class="hljs-string">'currentWidthBreakpoint'</span>, widthBp);</li><li>    <span class="hljs-title class_">AppStorage</span>.<span class="hljs-title function_">setOrCreate</span>(<span class="hljs-string">'videoGridColumn'</span>, videoGridColumn);</li><li>  } <span class="hljs-keyword">catch</span> (error) {</li><li>    <span class="hljs-keyword">let</span> err = error <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>    hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x00</span>, <span class="hljs-string">'EntryAbility'</span>, <span class="hljs-string">`getDefaultDisplaySync failed, code = <span class="hljs-subst">${err.code}</span>, message = <span class="hljs-subst">${err.message}</span>`</span>);</li><li>  }</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/products/phone/src/main/ets/entryability/EntryAbility.ets#L111-L145" target="_blank">EntryAbility.ets</a></div></div></div></div> <p>为实现图片大小等比变化，需要给Stack组件设置aspectRatio属性，同<a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li139671645597">Banner图区域</a>，实现自适应布局的缩放能力。不同的是，因为Grid组件设置了rowsTemplate属性，子组件GridItem均分Grid组件的全部高度，所以Grid组件不能自适应为内容组件的高度，需要用getGridHeight方法先自行计算出Grid组件的高度，从而保证子组件中图片等比放大或缩小。在getGridHeight方法中，先根据窗口宽度和网格列数，计算出单张图片宽度；再根据图片宽度和宽高比计算出图片高度，并与标题和内容栏高度相加；最后乘网格行数得到Grid组件的总高度。</p> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/RecommendedVideo.ets#L41-L233" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title function_">build</span>() {</li><li>  <span class="hljs-comment">// Video grid layout.</span></li><li>  <span class="hljs-title function_">Grid</span>() {</li><li>    <span class="hljs-title function_">ForEach</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">videoImgList</span>, (<span class="hljs-variable">item</span>: <span class="hljs-title class_">VideoImage</span>, <span class="hljs-variable">index</span>: <span class="hljs-title class_">number</span>) =&gt; {</li><li>      <span class="hljs-title function_">GridItem</span>() {</li><li>        <span class="hljs-title function_">Column</span>() {</li><li>          <span class="hljs-title function_">Stack</span>({ <span class="hljs-variable">alignContent</span>: <span class="hljs-title class_">Alignment</span>.<span class="hljs-title class_">Center</span> }) {</li><li>            <span class="hljs-comment">// ...</span></li><li>          }</li><li>          .<span class="hljs-title function_">focusable</span>(<span class="hljs-keyword">true</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>          <span class="hljs-comment">// The width and height vary with the container assembly and the aspect ratio remains unchanged.</span></li><li>          .<span class="hljs-title function_">aspectRatio</span>(<span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">VIDEO_DIALOG_ASPECT_RATIO</span>)</li><li>          <span class="hljs-comment">// ...</span></li><li>          .<span class="hljs-title function_">gesture</span>(</li><li>            <span class="hljs-title function_">LongPressGesture</span>({ <span class="hljs-variable">repeat</span>: <span class="hljs-keyword">false</span> })</li><li>              .<span class="hljs-title function_">onAction</span>(() =&gt; {</li><li>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">index</span> !== <span class="hljs-number">0</span>) {</li><li>                  <span class="hljs-variable">Logger</span>.<span class="hljs-title function_">info</span>(`<span class="hljs-variable">Please</span> <span class="hljs-variable">long</span> <span class="hljs-variable">press</span> <span class="hljs-variable">the</span> <span class="hljs-variable">first</span> <span class="hljs-variable">image</span>`);</li><li>                  <span class="hljs-keyword">return</span>;</li><li>                }</li><li>                <span class="hljs-comment">// Obtains all attributes of a component.</span></li><li>                <span class="hljs-keyword">let</span> <span class="hljs-variable">modePosition</span>: <span class="hljs-title class_">componentUtils</span>.<span class="hljs-title class_">ComponentInfo</span> =</li><li>                  <span class="hljs-keyword">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">getComponentUtils</span>().<span class="hljs-title function_">getRectangleById</span>(<span class="hljs-variable">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-variable">item</span>));</li><li>                <span class="hljs-keyword">let</span> <span class="hljs-variable">windowOffset</span> = <span class="hljs-variable">modePosition</span>.<span class="hljs-variable">windowOffset</span>;</li><li>                <span class="hljs-keyword">let</span> <span class="hljs-variable">size</span> = <span class="hljs-variable">modePosition</span>.<span class="hljs-variable">size</span>;</li><li>                <span class="hljs-comment">// Obtains the height of the component from the top.</span></li><li>                <span class="hljs-keyword">let</span> <span class="hljs-variable">rectTop</span>: <span class="hljs-title class_">number</span> = <span class="hljs-keyword">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">px2vp</span>(<span class="hljs-variable">windowOffset</span>.<span class="hljs-variable">y</span>);</li><li>                <span class="hljs-keyword">let</span> <span class="hljs-variable">rectTop2</span>: <span class="hljs-title class_">number</span> = <span class="hljs-keyword">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">px2vp</span>(<span class="hljs-variable">windowOffset</span>.<span class="hljs-variable">y</span> + <span class="hljs-variable">Math</span>.<span class="hljs-title function_">floor</span>(<span class="hljs-variable">size</span>.<span class="hljs-variable">height</span>));</li><li>                <span class="hljs-comment">// Obtains the width of the component from the left.</span></li><li>                <span class="hljs-keyword">let</span> <span class="hljs-variable">rectLeft</span>: <span class="hljs-title class_">number</span> = <span class="hljs-keyword">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">px2vp</span>(<span class="hljs-variable">windowOffset</span>.<span class="hljs-variable">x</span>);</li><li>                <span class="hljs-keyword">let</span> <span class="hljs-variable">topHeightNeeded</span>: <span class="hljs-title class_">number</span> = <span class="hljs-variable">new</span> <span class="hljs-title function_">BreakpointType</span>(<span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">VIDEO_DIALOG_HEIGHTS</span>[<span class="hljs-number">0</span>],</li><li>                  <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">VIDEO_DIALOG_HEIGHTS</span>[<span class="hljs-number">1</span>], <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">VIDEO_DIALOG_HEIGHTS</span>[<span class="hljs-number">2</span>])</li><li>                  .<span class="hljs-title function_">getValue</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span>) + <span class="hljs-variable">rectTop</span> - <span class="hljs-variable">rectTop2</span>;</li><li>                <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span> === <span class="hljs-string">'sm'</span>) {</li><li>                  <span class="hljs-variable">topHeightNeeded</span> += <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">HOME_HEADER_HEIGHT_SM</span>;</li><li>                }</li><li>                <span class="hljs-keyword">let</span> <span class="hljs-variable">dialogYOffset</span>: <span class="hljs-title class_">number</span>;</li><li>                <span class="hljs-comment">// Adaptive pop-up window expansion direction.</span></li><li>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">topHeightNeeded</span> &lt; <span class="hljs-title class_">rectTop</span>) {</li><li>                  <span class="hljs-variable">dialogYOffset</span> = <span class="hljs-variable">rectTop2</span> - <span class="hljs-variable">new</span> <span class="hljs-title function_">BreakpointType</span>(<span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">VIDEO_DIALOG_HEIGHTS</span>[<span class="hljs-number">0</span>],</li><li>                    <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">VIDEO_DIALOG_HEIGHTS</span>[<span class="hljs-number">1</span>], <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">VIDEO_DIALOG_HEIGHTS</span>[<span class="hljs-number">2</span>])</li><li>                    .<span class="hljs-title function_">getValue</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span>);</li><li>                } <span class="hljs-keyword">else</span> {</li><li>                  <span class="hljs-variable">dialogYOffset</span> = <span class="hljs-variable">rectTop</span>;</li><li>                }</li><li>                <span class="hljs-keyword">this</span>.<span class="hljs-variable">windowUtil</span> = <span class="hljs-variable">WindowUtil</span>.<span class="hljs-title function_">getInstance</span>();</li><li>                <span class="hljs-keyword">let</span> <span class="hljs-variable">isLayoutFullScreen</span>: <span class="hljs-title class_">boolean</span> = <span class="hljs-keyword">true</span>;</li><li>                <span class="hljs-keyword">let</span> <span class="hljs-variable">mainWindow</span> = <span class="hljs-keyword">this</span>.<span class="hljs-variable">windowUtil</span>!.<span class="hljs-title function_">getMainWindow</span>();</li><li>                <span class="hljs-variable">isLayoutFullScreen</span> = <span class="hljs-variable">mainWindow</span>!.<span class="hljs-title function_">getWindowProperties</span>().<span class="hljs-variable">isLayoutFullScreen</span>;</li><li>                <span class="hljs-comment">// Subtract the width and height of the window in the PC/2in1 device.</span></li><li>                <span class="hljs-keyword">if</span> (<span class="hljs-variable">deviceInfo</span>.<span class="hljs-variable">deviceType</span> === <span class="hljs-string">'2in1'</span> &amp;&amp; !<span class="hljs-variable">isLayoutFullScreen</span>) {</li><li>                  <span class="hljs-variable">dialogYOffset</span> -= <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">WINDOW_UNDEFINED_TOP</span>;</li><li>                  <span class="hljs-variable">rectLeft</span> -= <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">WINDOW_UNDEFINED_LEFT</span>;</li><li>                } <span class="hljs-keyword">else</span> {</li><li>                  <span class="hljs-variable">Logger</span>.<span class="hljs-title function_">info</span>(`<span class="hljs-variable">No</span> <span class="hljs-variable">need</span> <span class="hljs-variable">to</span> <span class="hljs-variable">subtract</span> <span class="hljs-variable">extra</span> <span class="hljs-variable">height</span>`);</li><li>                }</li><li>                <span class="hljs-keyword">this</span>.<span class="hljs-variable">videoDialogController</span> = <span class="hljs-variable">new</span> <span class="hljs-title function_">CustomDialogController</span>({</li><li>                  <span class="hljs-variable">builder</span>: <span class="hljs-title class_">VideoDialog</span>(),</li><li>                  <span class="hljs-variable">autoCancel</span>: <span class="hljs-keyword">true</span>,</li><li>                  <span class="hljs-variable">customStyle</span>: <span class="hljs-keyword">true</span>,</li><li>                  <span class="hljs-variable">alignment</span>: <span class="hljs-title class_">DialogAlignment</span>.<span class="hljs-title class_">TopStart</span>,</li><li>                  <span class="hljs-variable">offset</span>: {</li><li>                    <span class="hljs-variable">dx</span>: <span class="hljs-title class_">rectLeft</span>,</li><li>                    <span class="hljs-variable">dy</span>: <span class="hljs-title class_">dialogYOffset</span></li><li>                  }</li><li>                });</li><li>                <span class="hljs-comment">// Display the customized pop-up window to play the video.</span></li><li>                <span class="hljs-keyword">this</span>.<span class="hljs-variable">videoDialogController</span>.<span class="hljs-keyword">open</span>();</li><li>              }))</li><li>          .<span class="hljs-title function_">bindContextMenu</span>(<span class="hljs-title function_">RightClickMenu</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span>), <span class="hljs-variable">ResponseType</span>.<span class="hljs-variable">RightClick</span>)</li><li>          <span class="hljs-title function_">VideoTitle</span>({ <span class="hljs-variable">title</span>: <span class="hljs-title class_">item</span>.<span class="hljs-title class_">getTitle</span>() })</li><li>          <span class="hljs-title function_">VideoContent</span>({ <span class="hljs-variable">content</span>: <span class="hljs-title class_">item</span>.<span class="hljs-title class_">getContent</span>() })</li><li>        }</li><li>        .<span class="hljs-title function_">alignItems</span>(<span class="hljs-variable">HorizontalAlign</span>.<span class="hljs-variable">Start</span>)</li><li>      }</li><li>    }, (<span class="hljs-variable">item</span>: <span class="hljs-title class_">VideoImage</span>, <span class="hljs-variable">index</span>: <span class="hljs-title class_">number</span>) =&gt; <span class="hljs-variable">index</span> + <span class="hljs-variable">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-variable">item</span>))</li><li>  }</li><li>  <span class="hljs-comment">// ...</span></li><li>  <span class="hljs-comment">// Zooming and pinching functions of the grid.</span></li><li>  .<span class="hljs-title function_">gesture</span>(<span class="hljs-title function_">PinchGesture</span>({ <span class="hljs-variable">fingers</span>: <span class="hljs-number">2</span> }).<span class="hljs-title function_">onActionUpdate</span>((<span class="hljs-variable">event</span>: <span class="hljs-title class_">GestureEvent</span>) =&gt; {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-variable">event</span>.<span class="hljs-variable">scale</span> &gt; <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span> !== <span class="hljs-string">'sm'</span>) {</li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span> === <span class="hljs-string">'md'</span>) {</li><li>        <span class="hljs-keyword">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">animateTo</span>({</li><li>          <span class="hljs-variable">duration</span>: <span class="hljs-number">500</span></li><li>        }, () =&gt; {</li><li>          <span class="hljs-keyword">this</span>.<span class="hljs-variable">videoGridColumn</span> = <span class="hljs-string">'1fr 1fr 1fr'</span>;</li><li>        })</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-keyword">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">animateTo</span>({</li><li>          <span class="hljs-variable">duration</span>: <span class="hljs-number">500</span></li><li>        }, () =&gt; {</li><li>          <span class="hljs-keyword">this</span>.<span class="hljs-variable">videoGridColumn</span> = <span class="hljs-string">'1fr 1fr 1fr 1fr'</span>;</li><li>        })</li><li>      }</li><li>    } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable">event</span>.<span class="hljs-variable">scale</span> &lt; <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-keyword">this</span>.<span class="hljs-title class_">currentWidthBreakpoint</span> !== '<span class="hljs-title class_">sm</span>') {</li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span> === <span class="hljs-string">'md'</span>) {</li><li>        <span class="hljs-keyword">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">animateTo</span>({</li><li>          <span class="hljs-variable">duration</span>: <span class="hljs-number">500</span></li><li>        }, () =&gt; {</li><li>          <span class="hljs-keyword">this</span>.<span class="hljs-variable">videoGridColumn</span> = <span class="hljs-string">'1fr 1fr 1fr 1fr'</span>;</li><li>        })</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-keyword">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">animateTo</span>({</li><li>          <span class="hljs-variable">duration</span>: <span class="hljs-number">500</span></li><li>        }, () =&gt; {</li><li>          <span class="hljs-keyword">this</span>.<span class="hljs-variable">videoGridColumn</span> = <span class="hljs-string">'1fr 1fr 1fr 1fr 1fr'</span>;</li><li>        })</li><li>      }</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-variable">Logger</span>.<span class="hljs-title function_">info</span>(`<span class="hljs-variable">Two</span>-<span class="hljs-variable">finger</span> <span class="hljs-variable">operation</span> <span class="hljs-keyword">is</span> <span class="hljs-variable">not</span> <span class="hljs-variable">supported</span>`);</li><li>    }</li><li>  }))</li><li>}</li><li>
</li><li><span class="hljs-title function_">getGridHeight</span>(<span class="hljs-variable">videoGridColumn</span>: <span class="hljs-title class_">string</span>, <span class="hljs-variable">currentWidthBreakpoint</span>: <span class="hljs-title class_">string</span>, <span class="hljs-variable">windowWidth</span>: <span class="hljs-title class_">number</span>): <span class="hljs-title class_">string</span> {</li><li>  <span class="hljs-comment">// Obtain the window width and subtract the blank parts on both sides.</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">result</span>: <span class="hljs-title class_">number</span> = <span class="hljs-keyword">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">px2vp</span>(<span class="hljs-variable">windowWidth</span>) - <span class="hljs-variable">new</span> <span class="hljs-title function_">BreakpointType</span>(<span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">VIDEO_GRID_MARGIN</span>[<span class="hljs-number">0</span>],</li><li>    <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">VIDEO_GRID_MARGIN</span>[<span class="hljs-number">1</span>], <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">VIDEO_GRID_MARGIN</span>[<span class="hljs-number">2</span>]).<span class="hljs-title function_">getValue</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span>);</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-variable">currentWidthBreakpoint</span> === <span class="hljs-string">'lg'</span>) {</li><li>    <span class="hljs-variable">result</span> = <span class="hljs-variable">result</span> - <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">LG_SIDEBAR_WIDTH</span>;</li><li>  }</li><li>  <span class="hljs-comment">// Calculate the width of a single image based on the number of grid columns.</span></li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-variable">videoGridColumn</span> === <span class="hljs-string">'1fr 1fr'</span>) {</li><li>    <span class="hljs-variable">result</span> = (<span class="hljs-variable">result</span> - <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">VIDEO_GRID_ITEM_SPACE</span> * <span class="hljs-number">1</span>) / <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">TWO</span>;</li><li>  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable">videoGridColumn</span> === <span class="hljs-string">'1fr 1fr 1fr'</span>) {</li><li>    <span class="hljs-variable">result</span> = (<span class="hljs-variable">result</span> - <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">VIDEO_GRID_ITEM_SPACE</span> * <span class="hljs-number">2</span>) / <span class="hljs-number">3</span>;</li><li>  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable">videoGridColumn</span> === <span class="hljs-string">'1fr 1fr 1fr 1fr'</span>) {</li><li>    <span class="hljs-variable">result</span> = (<span class="hljs-variable">result</span> - <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">VIDEO_GRID_ITEM_SPACE</span> * <span class="hljs-number">3</span>) / <span class="hljs-number">4</span>;</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-variable">result</span> = (<span class="hljs-variable">result</span> - <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">VIDEO_GRID_ITEM_SPACE</span> * <span class="hljs-number">4</span>) / <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">FIVE</span>;</li><li>  }</li><li>  <span class="hljs-comment">// Calculate the height of a single image, title, and content, and calculate the total height of the grid layout.</span></li><li>  <span class="hljs-keyword">return</span> <span class="hljs-variable">result</span> / <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">VIDEO_DIALOG_ASPECT_RATIO</span> * <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">TWO</span> +</li><li>    <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">VIDEO_GRID_DESCRIPTION_HEIGHT</span> + <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">HEIGHT_UNIT</span>;</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/RecommendedVideo.ets#L41-L233" target="_blank">RecommendedVideo.ets</a></div></div></div></div> </li></ul> <ul><li id="zh-cn_topic_0000001744653537_li1938820294129"><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li1938820294129"></a><a name="zh-cn_topic_0000001744653537_li1938820294129"></a>每日佳片<p><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li1938820294129"></a><a name="zh-cn_topic_0000001744653537_li1938820294129"></a>每日佳片和往期回顾区域，均使用挪移布局实现“上下布局”与“左右布局”间的切换。本章节以每日佳片区域作为示例，往期回顾区域的实现开发者可以自行查看代码。</p> <p>每日佳片区域中，使用GirdRow组件和GridCol组件设置主图部分和子图部分在sm、md和lg断点下的栅格列数，使用BreakpointType设置不同断点下的高度。子图部分中，使用Grid网格布局，通过2行+2列的布局均分给4张子图。为实现图片大小等比变化，需要给Stack组件设置aspectRatio属性，同<a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li139671645597">Banner图区域</a>，实现自适应布局的缩放能力。Grid组件的高度计算，getDailyVideoHeight方法同<a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li19261618201020">推荐视频区域</a>getGridHeight方法。</p> <p>示意图如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.16.1.4.1.5.1.1" valign="top" width="7.520752075207521%"><p>示意图</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.16.1.4.1.5.1.2" valign="top" width="16.761676167616763%"><p>sm</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.16.1.4.1.5.1.3" valign="top" width="28.982898289828984%"><p>md</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.16.1.4.1.5.1.4" valign="top" width="46.73467346734673%"><p>lg</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="7.520752075207521%"><p>效果图</p> </td> <td class="cellrowborder" valign="top" width="16.761676167616763%"><p><span><img height="200.01161900190021" originheight="1106" originwidth="720" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163120.33634143310473297478154825893880:50001231000000:2800:3E97CCE7D8C1E59E071940FFFE6395A8E76FF974E1B15887A68E9C04F3A7FAA0.png" title="点击放大" width="130.20742074207422"></span></p> </td> <td class="cellrowborder" valign="top" width="28.982898289828984%"><p><span><img height="104.65312911291132" originheight="584" originwidth="1354" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163120.97777903209375812607524951899222:50001231000000:2800:B107A20BAB3AB107C46E3FF437AC2D81242AFBC84AE6B8AED0DB05DF6D91877A.png" title="点击放大" width="242.64266426642666"></span></p> </td> <td class="cellrowborder" valign="top" width="46.73467346734673%"><p><span><img height="138.5199753842051" originheight="808" originwidth="2368" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163120.45945067823650993276292057231428:50001231000000:2800:E28CEAC9AA6F23DFC283F8F637DA95858D11B9F392D6A01A4DF271F202A9EE69.png" title="点击放大" width="405.9589958995899"></span></p> </td> </tr> <tr><td class="cellrowborder" valign="top"><p>栅格布局图</p> </td> <td class="cellrowborder" valign="top"><p><span><img height="27.10267462746275" originheight="61" originwidth="293" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163120.60666013031129348447072178835314:50001231000000:2800:82BCF7F7DFDBFA3CFC88CFE29137C3484B201F31DD4A827E25C246175F3DC524.png" width="130.20742074207422" class="notEnlarge"></span></p> </td> <td class="cellrowborder" colspan="2" valign="top"><p><span><img height="19.64164941827516" originheight="42" originwidth="868" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163120.99138802042642646670385647927749:50001231000000:2800:9A601157A09E4B5B006F506A54F023B6D34D182B85A69705EE64BA33BD5AB179.png" title="点击放大" width="405.9589958995899"></span></p> <p></p> </td> </tr>  </tbody></table></div> </div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/DailyVideo.ets#L31-L200" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title function_">Column</span>() {</li><li>  <span class="hljs-title function_">SubtitleComponent</span>({ <span class="hljs-variable">title</span>: <span class="hljs-string">'每日佳片'</span> })</li><li>
</li><li>  <span class="hljs-title function_">GridRow</span>({</li><li>    <span class="hljs-variable">columns</span>: { <span class="hljs-variable">sm</span>: <span class="hljs-number">4</span>, <span class="hljs-variable">md</span>: <span class="hljs-number">12</span>, <span class="hljs-variable">lg</span>: <span class="hljs-number">12</span> },</li><li>    <span class="hljs-variable">gutter</span>: <span class="hljs-string">'12vp'</span></li><li>  }) {</li><li>    <span class="hljs-comment">// Main video section.</span></li><li>    <span class="hljs-title function_">GridCol</span>({ <span class="hljs-variable">span</span>: { <span class="hljs-variable">sm</span>: <span class="hljs-number">4</span>, <span class="hljs-variable">md</span>: <span class="hljs-number">6</span>, <span class="hljs-variable">lg</span>: <span class="hljs-number">6</span> } }) {</li><li>      <span class="hljs-title function_">Column</span>() {</li><li>        <span class="hljs-comment">// ...</span></li><li>      }</li><li>      .<span class="hljs-title function_">tabIndex</span>(<span class="hljs-title function_">getTabIndex</span>(<span class="hljs-string">'DailyVideoOne'</span>))</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      <span class="hljs-comment">// Dynamically setting the height at different breakpoints.</span></li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-keyword">this</span>.<span class="hljs-title function_">getDailyVideoHeight</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span>, <span class="hljs-keyword">this</span>.<span class="hljs-variable">windowWidth</span>, <span class="hljs-keyword">true</span>))</li><li>      .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-string">'36vp'</span>)</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F1F3F5'</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">padding</span>({</li><li>      <span class="hljs-variable">top</span>: <span class="hljs-string">'13vp'</span>,</li><li>      <span class="hljs-variable">bottom</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">currentWidthBreakpoint</span> !== <span class="hljs-string">'sm'</span> ? <span class="hljs-string">'13vp'</span> : <span class="hljs-number">0</span>,</li><li>      <span class="hljs-variable">left</span>: <span class="hljs-title class_">new</span> <span class="hljs-title class_">BreakpointType</span>('<span class="hljs-number">16</span><span class="hljs-title class_">vp</span>', '<span class="hljs-number">24</span><span class="hljs-title class_">vp</span>', '<span class="hljs-number">36</span><span class="hljs-title class_">vp</span>').<span class="hljs-title class_">getValue</span>(<span class="hljs-keyword">this</span>.<span class="hljs-title class_">currentWidthBreakpoint</span>),</li><li>      <span class="hljs-variable">right</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">currentWidthBreakpoint</span> === <span class="hljs-string">'sm'</span> ? <span class="hljs-string">'16vp'</span> : <span class="hljs-number">0</span></li><li>    })</li><li>
</li><li>    <span class="hljs-comment">// Sub video section.</span></li><li>    <span class="hljs-title function_">GridCol</span>({ <span class="hljs-variable">span</span>: { <span class="hljs-variable">sm</span>: <span class="hljs-number">4</span>, <span class="hljs-variable">md</span>: <span class="hljs-number">6</span>, <span class="hljs-variable">lg</span>: <span class="hljs-number">6</span> } }) {</li><li>      <span class="hljs-title function_">Grid</span>() {</li><li>        <span class="hljs-title function_">ForEach</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">dailyVideoImgList</span>, (<span class="hljs-variable">item</span>: <span class="hljs-title class_">VideoImage</span>) =&gt; {</li><li>          <span class="hljs-title function_">GridItem</span>() {</li><li>            <span class="hljs-title function_">Column</span>() {</li><li>              <span class="hljs-title function_">Stack</span>({ <span class="hljs-variable">alignContent</span>: <span class="hljs-title class_">Alignment</span>.<span class="hljs-title class_">Bottom</span> }) {</li><li>                <span class="hljs-title function_">VideoImgComponent</span>({ <span class="hljs-variable">imgSrc</span>: <span class="hljs-title class_">item</span>.<span class="hljs-title class_">getImgSrc</span>() })</li><li>                <span class="hljs-title function_">VideoImgPlay</span>()</li><li>                <span class="hljs-title function_">VideoImgRating</span>({ <span class="hljs-variable">rating</span>: <span class="hljs-title class_">item</span>.<span class="hljs-title class_">getRating</span>() })</li><li>              }</li><li>              .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>              <span class="hljs-comment">// The width and height vary with the container assembly and the aspect ratio remains unchanged.</span></li><li>              .<span class="hljs-title function_">aspectRatio</span>(<span class="hljs-number">1.74</span>)</li><li>              <span class="hljs-comment">// ...</span></li><li>            }</li><li>            .<span class="hljs-title function_">alignItems</span>(<span class="hljs-variable">HorizontalAlign</span>.<span class="hljs-variable">Start</span>)</li><li>          }</li><li>        }, (<span class="hljs-variable">item</span>: <span class="hljs-title class_">VideoImage</span>, <span class="hljs-variable">index</span>: <span class="hljs-title class_">number</span>) =&gt; <span class="hljs-variable">index</span> + <span class="hljs-variable">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-variable">item</span>))</li><li>      }</li><li>      .<span class="hljs-title function_">tabIndex</span>(<span class="hljs-title function_">getTabIndex</span>(<span class="hljs-string">'DailyVideoTwo'</span>))</li><li>      <span class="hljs-comment">// Dynamically setting the height at different breakpoints.</span></li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-keyword">this</span>.<span class="hljs-title function_">getDailyVideoHeight</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span>, <span class="hljs-keyword">this</span>.<span class="hljs-variable">windowWidth</span>, <span class="hljs-keyword">false</span>))</li><li>      .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      <span class="hljs-comment">// Sets the number of grid layout columns and evenly divides the height.</span></li><li>      .<span class="hljs-title function_">columnsTemplate</span>(<span class="hljs-string">'1fr 1fr'</span>)</li><li>      .<span class="hljs-title function_">rowsTemplate</span>(<span class="hljs-string">'1fr 1fr'</span>)</li><li>      .<span class="hljs-title function_">rowsGap</span>(<span class="hljs-string">'12vp'</span>)</li><li>      .<span class="hljs-title function_">columnsGap</span>(<span class="hljs-string">'12vp'</span>)</li><li>      .<span class="hljs-title function_">padding</span>({</li><li>        <span class="hljs-variable">top</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">currentWidthBreakpoint</span> !== <span class="hljs-string">'sm'</span> ? <span class="hljs-string">'13vp'</span> : <span class="hljs-string">'6vp'</span>,</li><li>        <span class="hljs-variable">bottom</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">currentWidthBreakpoint</span> !== <span class="hljs-string">'sm'</span> ? <span class="hljs-string">'13vp'</span> : <span class="hljs-string">'6vp'</span>,</li><li>        <span class="hljs-variable">left</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">currentWidthBreakpoint</span> === <span class="hljs-string">'sm'</span> ? <span class="hljs-string">'16vp'</span> : <span class="hljs-string">'6vp'</span>,</li><li>        <span class="hljs-variable">right</span>: <span class="hljs-title class_">new</span> <span class="hljs-title class_">BreakpointType</span>('<span class="hljs-number">16</span><span class="hljs-title class_">vp</span>', '<span class="hljs-number">24</span><span class="hljs-title class_">vp</span>', '<span class="hljs-number">36</span><span class="hljs-title class_">vp</span>').<span class="hljs-title class_">getValue</span>(<span class="hljs-keyword">this</span>.<span class="hljs-title class_">currentWidthBreakpoint</span>)</li><li>      })</li><li>    }</li><li>  }</li><li>}</li><li>.<span class="hljs-title function_">padding</span>({ <span class="hljs-variable">left</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">currentWidthBreakpoint</span> === <span class="hljs-string">'lg'</span> &amp;&amp; <span class="hljs-keyword">this</span>.<span class="hljs-variable">currentTopIndex</span> === <span class="hljs-number">2</span> ? <span class="hljs-string">'96vp'</span> : <span class="hljs-number">0</span> })</li><li>.<span class="hljs-title function_">margin</span>({ <span class="hljs-variable">top</span>: <span class="hljs-string">'12vp'</span> })</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/DailyVideo.ets#L31-L200" target="_blank">DailyVideo.ets</a></div></div></div></div> </li></ul> <ul><li id="zh-cn_topic_0000001744653537_li198001419141319"><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li198001419141319"></a><a name="zh-cn_topic_0000001744653537_li198001419141319"></a>首页社区页签的沉浸式设计<p><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li198001419141319"></a><a name="zh-cn_topic_0000001744653537_li198001419141319"></a>沉浸式的视频播放和互动作为视频类应用的核心，沉浸式首页的设计在长视频应用中必不可少。为了给用户带来沉浸感强的体验，沉浸式界面往往会发生特别的变化，在页面中使用大型、高分辨率的背景图片，从而创造具有视觉冲击力的效果，同时文字、图标、按钮和背景的颜色也相应的改变。为解决这一难题，可以在项目中分别为不同设备重构一套代码用于展示沉浸式的页面。</p> <p>本章针对长视频应用的沉浸式首页的主要特点给出推荐的解决方案：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.17.1.3.1.3.1.1" valign="top" width="23.43%"><p>主要特点</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.17.1.3.1.3.1.2" valign="top" width="76.57000000000001%"><p>解决方案</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="23.43%"><p>Banner图覆盖到侧边页签和顶部页签栏</p> </td> <td class="cellrowborder" valign="top" width="76.57000000000001%"><p>将Banner图设置为backgroundImage，并使用Row组件显示文字占位，侧边/底部页签和顶部页签栏使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-tabs" target="_blank">Tabs组件</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-stack" target="_blank">Stack组件</a>控制层级，并根据设计将背景色设置为透明。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="23.43%"><p>背景色与Banner图底色保持统一色调</p> </td> <td class="cellrowborder" valign="top" width="76.57000000000001%"><p>在backgroundImage处设置backgroundColor属性为统一色调的背景色。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="23.43%"><p>下滑过程中顶部页签栏背景色更改为统一色调</p> </td> <td class="cellrowborder" valign="top" width="76.57000000000001%"><p>在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scroll" target="_blank">Scroll组件</a>的onScrollFrameBegin()方法中获取当前y轴滑动偏移量，根据固定偏移量修改顶部页签栏的backgroundColor属性为统一色调的背景色。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="23.43%"><p>文字和图标颜色与背景色为对比色</p> </td> <td class="cellrowborder" valign="top" width="76.57000000000001%"><p>相关文字和图标设置颜色时增加条件判断。</p> </td> </tr>  </tbody></table></div> </div> <p>效果图如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.17.1.5.1.5.1.1" valign="top" width="6.818624586012079%"><p>示意图</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.17.1.5.1.5.1.2" valign="top" width="18.96551724137931%"><p>sm</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.17.1.5.1.5.1.3" valign="top" width="29.72920319501266%"><p>md</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.17.1.5.1.5.1.4" valign="top" width="44.48665497759594%"><p>lg</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="6.818624586012079%"><p>效果图</p> </td> <td class="cellrowborder" valign="top" width="18.96551724137931%"><p><span><img height="312.15391034482764" originheight="804" originwidth="385" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163120.03224018407398351788552273192578:50001231000000:2800:A92C1054702D2006D0369107C7AF06A98274E9C4C3E63C41A79F448DCDDD5BB5.png" title="点击放大" width="150.48275862068965"></span></p> </td> <td class="cellrowborder" valign="top" width="29.72920319501266%"><p><span><img height="278.31998991276487" originheight="787" originwidth="705" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163120.19581084037822270609100707350789:50001231000000:2800:FB34F0B75C6670C645E8A6E512B52D029338F5FCD4C4B664A542D9761E4AEE1A.png" title="点击放大" width="249.50866939411645"></span></p> </td> <td class="cellrowborder" valign="top" width="44.48665497759594%"><p><span><img height="249.61469330476007" originheight="869" originwidth="1344" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163120.88886507178268447498028204940415:50001231000000:2800:03A45B4DFFEA572A25785DD47F68C5749D792323B84822C3E1A543D428861FEF.png" title="点击放大" width="385.2772257938827"></span></p> </td> </tr>  </tbody></table></div> </div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/Home.ets#L68-L120" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title function_">TabContent</span>() {</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentTopIndex</span> === <span class="hljs-number">2</span>) {</li><li>    <span class="hljs-comment">// The immersive design of the home page is displayed when the top tab is switched to 2.</span></li><li>    <span class="hljs-title function_">Stack</span>() {</li><li>      <span class="hljs-title function_">Scroll</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">sideScroller</span>) {</li><li>        <span class="hljs-title function_">Column</span>() {</li><li>          <span class="hljs-title function_">HomeContent</span>()</li><li>            .<span class="hljs-title function_">visibility</span>(!<span class="hljs-keyword">this</span>.<span class="hljs-variable">isSearching</span> ? <span class="hljs-variable">Visibility</span>.<span class="hljs-variable">Visible</span> : <span class="hljs-title class_">Visibility</span>.<span class="hljs-title class_">None</span>)</li><li>
</li><li>          <span class="hljs-title function_">SearchView</span>({ <span class="hljs-variable">isSearching</span>: $<span class="hljs-title class_">isSearching</span> })</li><li>            .<span class="hljs-title function_">visibility</span>(!<span class="hljs-keyword">this</span>.<span class="hljs-variable">isSearching</span> ? <span class="hljs-variable">Visibility</span>.<span class="hljs-variable">None</span> : <span class="hljs-title class_">Visibility</span>.<span class="hljs-title class_">Visible</span>)</li><li>        }</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">scrollBar</span>(<span class="hljs-variable">BarState</span>.<span class="hljs-variable">Off</span>)</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>      <span class="hljs-comment">// Obtains the sliding offset on the y axis during sliding.</span></li><li>      .<span class="hljs-title function_">onScrollFrameBegin</span>((<span class="hljs-variable">offset</span>: <span class="hljs-title class_">number</span>) =&gt; {</li><li>        <span class="hljs-keyword">this</span>.<span class="hljs-variable">scrollHeight</span> = <span class="hljs-keyword">this</span>.<span class="hljs-variable">sideScroller</span>.<span class="hljs-title function_">currentOffset</span>().<span class="hljs-variable">yOffset</span>;</li><li>        <span class="hljs-keyword">return</span> { <span class="hljs-variable">offsetRemain</span>: <span class="hljs-title class_">offset</span> }</li><li>      })</li><li>
</li><li>      <span class="hljs-title function_">HomeHeader</span>({ <span class="hljs-variable">isSearching</span>: $<span class="hljs-title class_">isSearching</span> })</li><li>        .<span class="hljs-title function_">visibility</span>(!<span class="hljs-keyword">this</span>.<span class="hljs-variable">isSearching</span> ? <span class="hljs-variable">Visibility</span>.<span class="hljs-variable">Visible</span> : <span class="hljs-title class_">Visibility</span>.<span class="hljs-title class_">None</span>)</li><li>        .<span class="hljs-title function_">padding</span>({ <span class="hljs-variable">left</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">currentWidthBreakpoint</span> === <span class="hljs-string">'lg'</span> ? <span class="hljs-string">'96vp'</span> : <span class="hljs-number">0</span> })</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">alignContent</span>(<span class="hljs-variable">Alignment</span>.<span class="hljs-variable">Top</span>)</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-comment">// Non-immersive design for the home page.</span></li><li>    <span class="hljs-title function_">Column</span>() {</li><li>      <span class="hljs-title function_">HomeHeader</span>({ <span class="hljs-variable">isSearching</span>: $<span class="hljs-title class_">isSearching</span> })</li><li>        .<span class="hljs-title function_">visibility</span>(!<span class="hljs-keyword">this</span>.<span class="hljs-variable">isSearching</span> ? <span class="hljs-variable">Visibility</span>.<span class="hljs-variable">Visible</span> : <span class="hljs-title class_">Visibility</span>.<span class="hljs-title class_">None</span>)</li><li>
</li><li>      <span class="hljs-title function_">Scroll</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">scroller</span>) {</li><li>        <span class="hljs-title function_">Column</span>() {</li><li>          <span class="hljs-title function_">HomeContent</span>()</li><li>            .<span class="hljs-title function_">visibility</span>(!<span class="hljs-keyword">this</span>.<span class="hljs-variable">isSearching</span> ? <span class="hljs-variable">Visibility</span>.<span class="hljs-variable">Visible</span> : <span class="hljs-title class_">Visibility</span>.<span class="hljs-title class_">None</span>)</li><li>
</li><li>          <span class="hljs-title function_">SearchView</span>({ <span class="hljs-variable">isSearching</span>: $<span class="hljs-title class_">isSearching</span> })</li><li>            .<span class="hljs-title function_">visibility</span>(!<span class="hljs-keyword">this</span>.<span class="hljs-variable">isSearching</span> ? <span class="hljs-variable">Visibility</span>.<span class="hljs-variable">None</span> : <span class="hljs-title class_">Visibility</span>.<span class="hljs-title class_">Visible</span>)</li><li>        }</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)</li><li>      .<span class="hljs-title function_">scrollBar</span>(<span class="hljs-variable">BarState</span>.<span class="hljs-variable">Off</span>)</li><li>    }</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li><li>.<span class="hljs-title function_">tabBar</span>(<span class="hljs-keyword">this</span>.<span class="hljs-title function_">BottomTabBuilder</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">tabList</span>[<span class="hljs-number">0</span>], <span class="hljs-number">0</span>))</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/Home.ets#L68-L120" target="_blank">Home.ets</a></div></div></div></div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/HomeContent.ets#L43-L62" data-highlighted="yes"><ol class="linenums"><li>Column() {</li><li>  <span class="hljs-comment">// ...</span></li><li>}</li><li><span class="hljs-comment">// Set the background image to cover the side and top tabs.</span></li><li>.backgroundImage(<span class="hljs-keyword">this</span>.currentTopIndex === <span class="hljs-number">2</span> &amp;&amp; !<span class="hljs-keyword">this</span>.isSearching ? new BreakpointType(</li><li>  $r(<span class="hljs-string">'app.media.immersive_background_sm'</span>), $r(<span class="hljs-string">'app.media.immersive_background_md'</span>),</li><li>  $r(<span class="hljs-string">'app.media.immersive_background_lg'</span>)).getValue(<span class="hljs-keyword">this</span>.currentWidthBreakpoint) : $r(<span class="hljs-string">'app.media.white_background'</span>))</li><li><span class="hljs-comment">// Set the size of the background image.</span></li><li>.backgroundImageSize({ width: <span class="hljs-string">'100%'</span>, height: new BreakpointType(<span class="hljs-string">'384vp'</span>,<span class="hljs-string">'420vp'</span>, <span class="hljs-string">'720vp'</span>).getValue(<span class="hljs-keyword">this</span>.currentWidthBreakpoint) })</li><li><span class="hljs-comment">// Set the uniform background color.</span></li><li>.backgroundColor(<span class="hljs-keyword">this</span>.currentTopIndex === <span class="hljs-number">2</span> &amp;&amp; !<span class="hljs-keyword">this</span>.isSearching ? (<span class="hljs-keyword">this</span>.currentWidthBreakpoint !== BreakpointConstants.BREAKPOINT_MD ?</li><li>  <span class="hljs-string">'#222A3E'</span> : <span class="hljs-string">'#273148'</span>) : Color.White)</li><li>.width(<span class="hljs-string">'100%'</span>)</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/HomeContent.ets#L43-L62" target="_blank">HomeContent.ets</a></div></div></div></div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/HomeHeader.ets#L36-L58" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title function_">build</span>() {</li><li>  <span class="hljs-title function_">Column</span>() {</li><li>    <span class="hljs-title function_">GridRow</span>({ <span class="hljs-variable">columns</span>: { <span class="hljs-variable">sm</span>: <span class="hljs-number">4</span>, <span class="hljs-variable">md</span>: <span class="hljs-number">12</span>, <span class="hljs-variable">lg</span>: <span class="hljs-number">12</span> } }) {</li><li>      <span class="hljs-title function_">GridCol</span>({ <span class="hljs-variable">span</span>: { <span class="hljs-variable">sm</span>: <span class="hljs-number">4</span>, <span class="hljs-variable">md</span>: <span class="hljs-number">7</span>, <span class="hljs-variable">lg</span>: <span class="hljs-number">7</span> } }) {</li><li>        <span class="hljs-keyword">this</span>.<span class="hljs-title function_">TopTabBar</span>()</li><li>      }</li><li>      .<span class="hljs-title function_">padding</span>({ <span class="hljs-variable">top</span>: <span class="hljs-title class_">deviceInfo</span>.<span class="hljs-title class_">deviceType</span> === <span class="hljs-string">'2in1'</span> ? <span class="hljs-number">0</span> : $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">search_top_padding_top</span>') })</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-variable">deviceInfo</span>.<span class="hljs-variable">deviceType</span> === <span class="hljs-string">'2in1'</span> ? $<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.float.search_top_height'</span>) : $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">search_top_height_more</span>'))</li><li>
</li><li>      <span class="hljs-title function_">GridCol</span>({ <span class="hljs-variable">span</span>: { <span class="hljs-variable">sm</span>: <span class="hljs-number">4</span>, <span class="hljs-variable">md</span>: <span class="hljs-number">5</span>, <span class="hljs-variable">lg</span>: <span class="hljs-number">5</span> } }) {</li><li>        <span class="hljs-keyword">this</span>.<span class="hljs-title function_">searchBar</span>()</li><li>      }</li><li>      .<span class="hljs-title function_">padding</span>({ <span class="hljs-variable">top</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">currentWidthBreakpoint</span> === <span class="hljs-string">'sm'</span> || <span class="hljs-variable">deviceInfo</span>.<span class="hljs-variable">deviceType</span> === <span class="hljs-string">'2in1'</span> ? <span class="hljs-number">0</span> : $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">search_top_padding_top</span>') })</li><li>      .<span class="hljs-title function_">height</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span> === <span class="hljs-string">'sm'</span> || <span class="hljs-variable">deviceInfo</span>.<span class="hljs-variable">deviceType</span> === <span class="hljs-string">'2in1'</span> ? $<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.float.search_top_height'</span>) : $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">search_top_height_more</span>'))</li><li>    }</li><li>    <span class="hljs-comment">// The background color of the top tab bar is changed during the slide-down process.</span></li><li>    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">scrollHeight</span> &gt;= <span class="hljs-variable">new</span> <span class="hljs-title function_">BreakpointType</span>(<span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">BACKGROUND_CHANGE_HEIGHT</span>[<span class="hljs-number">0</span>],</li><li>      <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">BACKGROUND_CHANGE_HEIGHT</span>[<span class="hljs-number">1</span>], <span class="hljs-variable">HomeConstants</span>.<span class="hljs-variable">BACKGROUND_CHANGE_HEIGHT</span>[<span class="hljs-number">2</span>])</li><li>      .<span class="hljs-title function_">getValue</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span>) &amp;&amp; <span class="hljs-keyword">this</span>.<span class="hljs-variable">currentTopIndex</span> === <span class="hljs-number">2</span> ? $<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.color.home_content_background'</span>) :</li><li>      <span class="hljs-variable">Color</span>.<span class="hljs-variable">Transparent</span>)</li><li>  }</li><li>  .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/HomeHeader.ets#L36-L58" target="_blank">HomeHeader.ets</a></div></div></div></div> </li></ul> <ul><li id="zh-cn_topic_0000001744653537_li5503173331317"><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li5503173331317"></a><a name="zh-cn_topic_0000001744653537_li5503173331317"></a>PC/2in1的Banner图排版创新<p><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li5503173331317"></a><a name="zh-cn_topic_0000001744653537_li5503173331317"></a>在lg断点下，切换顶部页签，能够查看Banner图的排版创新，增多展示内容，提高浏览效率。三列Banner图按4:4:3预设的比例排布，使用layoutWeight实现自适应布局的占比能力。</p> <p>效果图如下：</p> <p><span><img height="517.0109000000001" originheight="869" originwidth="1344" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163120.05832231695500631580626326479651:50001231000000:2800:7007F165BC92279B65CBCCAD02907AB75173069B9815EED08D77A21C745B00BB.png" title="点击放大" width="798"></span></p> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/BannerView.ets#L178-L217" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title function_">Row</span>({ <span class="hljs-variable">space</span>: <span class="hljs-string">'12vp'</span> }) {</li><li>  <span class="hljs-title function_">BannerText</span>({</li><li>    <span class="hljs-variable">banner</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">bannerImgList</span>[<span class="hljs-number">2</span>],</li><li>    <span class="hljs-variable">index</span>: <span class="hljs-number">0</span></li><li>  })</li><li>    .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">4</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>
</li><li>  <span class="hljs-title function_">BannerText</span>({</li><li>    <span class="hljs-variable">banner</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">bannerImgList</span>[<span class="hljs-number">1</span>],</li><li>    <span class="hljs-variable">index</span>: <span class="hljs-number">1</span></li><li>  })</li><li>    .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">4</span>)</li><li>    .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>
</li><li>  <span class="hljs-title function_">Column</span>() {</li><li>    <span class="hljs-title function_">BannerText</span>({</li><li>      <span class="hljs-variable">banner</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">bannerImgList</span>[<span class="hljs-number">0</span>],</li><li>      <span class="hljs-variable">index</span>: <span class="hljs-number">2</span></li><li>    })</li><li>      .<span class="hljs-title function_">margin</span>({ <span class="hljs-variable">bottom</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">new_banner_3_margin</span>') })</li><li>      .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)</li><li>
</li><li>    <span class="hljs-title function_">BannerText</span>({</li><li>      <span class="hljs-variable">banner</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">bannerImgList</span>[<span class="hljs-number">4</span>],</li><li>      <span class="hljs-variable">index</span>: <span class="hljs-number">3</span></li><li>    })</li><li>      .<span class="hljs-title function_">margin</span>({ <span class="hljs-variable">top</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">new_banner_3_margin</span>') })</li><li>      .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">1</span>)</li><li>  }</li><li>  .<span class="hljs-title function_">layoutWeight</span>(<span class="hljs-number">3</span>)</li><li>}</li><li>.<span class="hljs-title function_">height</span>(<span class="hljs-keyword">this</span>.<span class="hljs-title function_">getBannerNewHeight</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">windowWidth</span>))</li><li>.<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>.<span class="hljs-title function_">visibility</span>((<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span> === <span class="hljs-string">'lg'</span>) &amp;&amp;</li><li>  (<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentTopIndex</span> === <span class="hljs-number">1</span>) ? <span class="hljs-variable">Visibility</span>.<span class="hljs-variable">Visible</span> : <span class="hljs-title class_">Visibility</span>.<span class="hljs-title class_">None</span>)</li><li>.<span class="hljs-title function_">padding</span>({</li><li>  <span class="hljs-variable">left</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">banner_padding_sm</span>'),</li><li>  <span class="hljs-variable">right</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">banner_padding_sm</span>')</li><li>})</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/BannerView.ets#L178-L217" target="_blank">BannerView.ets</a></div></div></div></div> </li></ul> <ul><li id="zh-cn_topic_0000001744653537_li8773338111310"><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li8773338111310"></a><a name="zh-cn_topic_0000001744653537_li8773338111310"></a>推荐视频区域长按预览<p><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li8773338111310"></a><a name="zh-cn_topic_0000001744653537_li8773338111310"></a>长按首页推荐视频区域的第一张图片，在图片的位置显示<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-methods-custom-dialog-box" target="_blank">自定义弹窗 (CustomDialog)</a>播放视频，弹窗默认向上方展开。当图片上划至窗口顶部时，弹窗自适应向下方展开。长按手势事件用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-gestures-longpressgesture" target="_blank">LongPressGesture方法</a>实现。</p> <p>因为Banner图区域使用了aspectRatio属性来控制图片的宽高比不变，所以不能手动计算视频推荐区域距离窗口顶部的高度，动态获取组件的高度也成为“一多”开发中经常遇到的难点。对这种问题，推荐使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-attributes-component-id" target="_blank">组件标识</a>的getInspectorByKey方法获取组件相对于应用窗口左上角的水平和垂直方向坐标，获取的位置属性单位为px，使用this.getUIContext().px2vp方法转换单位为vp，从而确定自定义弹窗的偏移量offset。</p> <p>效果图如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.19.1.4.1.5.1.1" valign="top" width="6.420000000000001%"><p>示意图</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.19.1.4.1.5.1.2" valign="top" width="18.610000000000003%"><p>sm</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.19.1.4.1.5.1.3" valign="top" width="29.690000000000005%"><p>md</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.19.1.4.1.5.1.4" valign="top" width="45.28%"><p>lg</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top"><p>设计能力点</p> </td> <td class="cellrowborder" colspan="3" valign="top"><p><span><img height="240.26450000000003" originheight="168" originwidth="186" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163120.97900657280655834525065581984532:50001231000000:2800:3BE9DA1F67388BE39979B6A5698DC4FBB2E88C7AB3E6DC7A7AEEE1774DB18296.png" width="266" class="notEnlarge"></span></p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="6.420000000000001%"><p>效果图</p> </td> <td class="cellrowborder" valign="top" width="18.610000000000003%"><p><span><img height="305.3692122000001" originheight="804" originwidth="385" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163121.69577439018586106892784229155637:50001231000000:2800:D669F54595C88467E009D0D2C45AA266CB4FC867CA597F3CD12A7759C2A804FF.png" title="点击放大" width="147.21200000000005"></span></p> </td> <td class="cellrowborder" valign="top" width="29.690000000000005%"><p><span><img height="277.9176732222223" originheight="787" originwidth="705" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163121.81755944734296720607178611143134:50001231000000:2800:D5D83C434F6470996389923C7F688269F770378D6C874264F37D48E21BFE14A5.png" title="点击放大" width="249.14800000000002"></span></p> </td> <td class="cellrowborder" valign="top" width="45.28%"><p><span><img height="254.3434474666667" originheight="869" originwidth="1344" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163121.39838113886769155463476084961054:50001231000000:2800:FED4F3232DD6DC8E833BA72DE5C873AA45F51334B46A2BECC9539509C0951769.png" title="点击放大" width="392.57599999999996"></span></p> </td> </tr>  </tbody></table></div> </div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-less" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/RecommendedVideo.ets#L51-L141" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-selector-tag">Stack</span>({ alignContent: Alignment.Center }) {</li><li>  <span class="hljs-comment">// ...</span></li><li>}</li><li>.<span class="hljs-built_in">focusable</span>(true)</li><li>.<span class="hljs-built_in">width</span>(<span class="hljs-string">'100%'</span>)</li><li><span class="hljs-comment">// The width and height vary with the container assembly and the aspect ratio remains unchanged.</span></li><li>.<span class="hljs-built_in">aspectRatio</span>(HomeConstants.VIDEO_DIALOG_ASPECT_RATIO)</li><li><span class="hljs-comment">// ...</span></li><li>.<span class="hljs-built_in">gesture</span>(</li><li>  <span class="hljs-built_in">LongPressGesture</span>({ <span class="hljs-attribute">repeat</span>: false })</li><li>    .<span class="hljs-built_in">onAction</span>(() =&gt; {</li><li>      if (index !== <span class="hljs-number">0</span>) {</li><li>        Logger.<span class="hljs-built_in">info</span>(<span class="hljs-built_in">`Please long press the first image`</span>);</li><li>        return;</li><li>      }</li><li>      <span class="hljs-comment">// Obtains all attributes of a component.</span></li><li>      let <span class="hljs-attribute">modePosition</span>: componentUtils.ComponentInfo =</li><li>        this.<span class="hljs-built_in">getUIContext</span>().<span class="hljs-built_in">getComponentUtils</span>().<span class="hljs-built_in">getRectangleById</span>(JSON.<span class="hljs-built_in">stringify</span>(item));</li><li>      let windowOffset = modePosition.windowOffset;</li><li>      let size = modePosition.size;</li><li>      <span class="hljs-comment">// Obtains the height of the component from the top.</span></li><li>      let <span class="hljs-attribute">rectTop</span>: number = this.<span class="hljs-built_in">getUIContext</span>().<span class="hljs-built_in">px2vp</span>(windowOffset.y);</li><li>      let <span class="hljs-attribute">rectTop2</span>: number = this.<span class="hljs-built_in">getUIContext</span>().<span class="hljs-built_in">px2vp</span>(windowOffset.y + Math.<span class="hljs-built_in">floor</span>(size.<span class="hljs-attribute">height</span>));</li><li>      <span class="hljs-comment">// Obtains the width of the component from the left.</span></li><li>      let <span class="hljs-attribute">rectLeft</span>: number = this.<span class="hljs-built_in">getUIContext</span>().<span class="hljs-built_in">px2vp</span>(windowOffset.x);</li><li>      let <span class="hljs-attribute">topHeightNeeded</span>: number = new <span class="hljs-built_in">BreakpointType</span>(HomeConstants.VIDEO_DIALOG_HEIGHTS[<span class="hljs-number">0</span>],</li><li>        HomeConstants.VIDEO_DIALOG_HEIGHTS[<span class="hljs-number">1</span>], HomeConstants.VIDEO_DIALOG_HEIGHTS[<span class="hljs-number">2</span>])</li><li>        .<span class="hljs-built_in">getValue</span>(this.currentWidthBreakpoint) + rectTop - rectTop2;</li><li>      if (this.currentWidthBreakpoint === <span class="hljs-string">'sm'</span>) {</li><li>        topHeightNeeded += HomeConstants.HOME_HEADER_<span class="hljs-attribute">HEIGHT</span>_SM;</li><li>      }</li><li>      let <span class="hljs-attribute">dialogYOffset</span>: number;</li><li>      <span class="hljs-comment">// Adaptive pop-up window expansion direction.</span></li><li>      if (topHeightNeeded &lt; rectTop) {</li><li>        dialogYOffset = rectTop2 - new <span class="hljs-built_in">BreakpointType</span>(HomeConstants.VIDEO_DIALOG_HEIGHTS[<span class="hljs-number">0</span>],</li><li>          HomeConstants.VIDEO_DIALOG_HEIGHTS[<span class="hljs-number">1</span>], HomeConstants.VIDEO_DIALOG_HEIGHTS[<span class="hljs-number">2</span>])</li><li>          .<span class="hljs-built_in">getValue</span>(this.currentWidthBreakpoint);</li><li>      } else {</li><li>        dialogYOffset = rectTop;</li><li>      }</li><li>      this.windowUtil = WindowUtil.<span class="hljs-built_in">getInstance</span>();</li><li>      let <span class="hljs-attribute">isLayoutFullScreen</span>: boolean = true;</li><li>      let mainWindow = this.windowUtil!.<span class="hljs-built_in">getMainWindow</span>();</li><li>      isLayoutFullScreen = mainWindow!.<span class="hljs-built_in">getWindowProperties</span>().isLayoutFullScreen;</li><li>      <span class="hljs-comment">// Subtract the width and height of the window in the PC/2in1 device.</span></li><li>      if (deviceInfo.deviceType === <span class="hljs-string">'2in1'</span> &amp;&amp; !isLayoutFullScreen) {</li><li>        dialogYOffset -= HomeConstants.WINDOW_UNDEFINED_TOP;</li><li>        rectLeft -= HomeConstants.WINDOW_UNDEFINED_LEFT;</li><li>      } else {</li><li>        Logger.<span class="hljs-built_in">info</span>(<span class="hljs-built_in">`No need to subtract extra height`</span>);</li><li>      }</li><li>      this.videoDialogController = new <span class="hljs-built_in">CustomDialogController</span>({</li><li>        <span class="hljs-attribute">builder</span>: <span class="hljs-built_in">VideoDialog</span>(),</li><li>        <span class="hljs-attribute">autoCancel</span>: true,</li><li>        <span class="hljs-attribute">customStyle</span>: true,</li><li>        <span class="hljs-attribute">alignment</span>: DialogAlignment.TopStart,</li><li>        <span class="hljs-attribute">offset</span>: {</li><li>          <span class="hljs-attribute">dx</span>: rectLeft,</li><li>          <span class="hljs-attribute">dy</span>: dialogYOffset</li><li>        }</li><li>      });</li><li>      <span class="hljs-comment">// Display the customized pop-up window to play the video.</span></li><li>      this.videoDialogController.<span class="hljs-built_in">open</span>();</li><li>    }))</li><li>.<span class="hljs-built_in">bindContextMenu</span>(<span class="hljs-built_in">RightClickMenu</span>(this.currentWidthBreakpoint), ResponseType.RightClick)</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/RecommendedVideo.ets#L51-L141" target="_blank">RecommendedVideo.ets</a></div></div></div></div> </li></ul> <ul><li id="zh-cn_topic_0000001744653537_li8459423139"><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li8459423139"></a><a name="zh-cn_topic_0000001744653537_li8459423139"></a>推荐视频区域的缩放<p><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li8459423139"></a><a name="zh-cn_topic_0000001744653537_li8459423139"></a>在md和lg断点下，首页的推荐视频区域支持双指捏合放大与缩小。网格布局在md断点下默认3列显示，两指向中心捏合切换为4列显示，两指向外放大切换为3列显示；lg断点下，4列、5列显示同理。这一效果通过在<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-gestures-pinchgesture" target="_blank">PinchGesture</a>双指触发捏合手势中动态修改网格布局的columnsTemplate属性实现。</p> <p>效果图如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.20.1.3.1.3.1.1" valign="top" width="36.76%"><p>md</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.20.1.3.1.3.1.2" valign="top" width="63.239999999999995%"><p>lg</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="36.76%"><p><span><img height="349.3553213333333" originheight="720" originwidth="647" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163121.68116805342640636973314703507110:50001231000000:2800:644F5028798B4BE2FF2284773308A309BCAC6BD9BD12B9E1C3D6C1E95E0DB920.gif" title="点击放大" width="314.19199999999995"></span></p> </td> <td class="cellrowborder" valign="top" width="63.239999999999995%"><p><span><img height="362.93777520000003" originheight="518" originwidth="799" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163121.86601954202809781576886735019957:50001231000000:2800:882CD5BB5C601E09BF21A6FD6A3DD8624A4FA0518C3A8EBE638AB4281273AEE6.gif" title="点击放大" width="557.808"></span></p> </td> </tr>  </tbody></table></div> </div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/RecommendedVideo.ets#L45-L208" data-highlighted="yes"><ol class="linenums"><li>Grid() {</li><li>  <span class="hljs-comment">// ...</span></li><li>}</li><li><span class="hljs-comment">// ...</span></li><li>.gesture(PinchGesture({ fingers: <span class="hljs-number">2</span> }).onActionUpdate((event: GestureEvent) =&gt; {</li><li>  <span class="hljs-keyword">if</span> (event.scale &gt; <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-keyword">this</span>.currentWidthBreakpoint !== <span class="hljs-string">'sm'</span>) {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'md'</span>) {</li><li>      <span class="hljs-keyword">this</span>.getUIContext().animateTo({</li><li>        duration: <span class="hljs-number">500</span></li><li>      }, () =&gt; {</li><li>        <span class="hljs-keyword">this</span>.videoGridColumn = <span class="hljs-string">'1fr 1fr 1fr'</span>;</li><li>      })</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-keyword">this</span>.getUIContext().animateTo({</li><li>        duration: <span class="hljs-number">500</span></li><li>      }, () =&gt; {</li><li>        <span class="hljs-keyword">this</span>.videoGridColumn = <span class="hljs-string">'1fr 1fr 1fr 1fr'</span>;</li><li>      })</li><li>    }</li><li>  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (event.scale &lt; <span class="hljs-number">1</span> &amp;&amp; <span class="hljs-keyword">this</span>.currentWidthBreakpoint !== <span class="hljs-string">'sm'</span>) {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'md'</span>) {</li><li>      <span class="hljs-keyword">this</span>.getUIContext().animateTo({</li><li>        duration: <span class="hljs-number">500</span></li><li>      }, () =&gt; {</li><li>        <span class="hljs-keyword">this</span>.videoGridColumn = <span class="hljs-string">'1fr 1fr 1fr 1fr'</span>;</li><li>      })</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-keyword">this</span>.getUIContext().animateTo({</li><li>        duration: <span class="hljs-number">500</span></li><li>      }, () =&gt; {</li><li>        <span class="hljs-keyword">this</span>.videoGridColumn = <span class="hljs-string">'1fr 1fr 1fr 1fr 1fr'</span>;</li><li>      })</li><li>    }</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    Logger.info(`Two-finger operation <span class="hljs-keyword">is</span> not supported`);</li><li>  }</li><li>}))</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/RecommendedVideo.ets#L45-L208" target="_blank">RecommendedVideo.ets</a></div></div></div></div> </li></ul> <div class="tiledSection"><h3 id="section1932711221013">搜索页<i class="anchor-icon anchor-icon-link" anchorid="section1932711221013" tips="复制节点链接"></i></h3><p>长视频应用的搜索页应智能响应用户的特定输入并提供相关提示，同时展示搜索结果。请参考不同设备上的UX设计图进行如下设计：</p> </div> <ul><li id="zh-cn_topic_0000001744653537_li1926174391914"><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li1926174391914"></a><a name="zh-cn_topic_0000001744653537_li1926174391914"></a>将搜索页划分为5个区域，效果图如下： <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.22.1.1.1.5.1.1" valign="top" width="5.82%"><p>示意图</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.22.1.1.1.5.1.2" valign="top" width="19.28%"><p>sm</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.22.1.1.1.5.1.3" valign="top" width="33.18%"><p>md</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.22.1.1.1.5.1.4" valign="top" width="41.72%"><p>lg</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="5.82%"><p>搜索页</p> </td> <td class="cellrowborder" valign="top" width="19.28%"><p><span><img height="315.5174384000001" originheight="1571" originwidth="763" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163121.25271537060683238077065812986440:50001231000000:2800:A898B92C60672CC71BEEE6449F05BA6FADB6BBC0AA9FF542964875EAF24EC1D7.png" title="点击放大" width="153.37600000000003"></span><span><img height="318.1555056000001" originheight="804" originwidth="385" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163121.27162159737715957616129911565174:50001231000000:2800:AEC3E741E9E2CE39E1BFA93CFD2578C4FAF145F5EF06EB3CC64FD9279BB8934C.png" title="点击放大" width="153.37600000000003"></span></p> </td> <td class="cellrowborder" valign="top" width="33.18%"><p></p> <p><span><img height="313.7332553333333" originheight="787" originwidth="705" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163121.47388666393296939528791434878748:50001231000000:2800:B9ABFAE0021C3A157E7B1F12D8B55F88E9DF06D99B8BE3207E793FB43869A342.png" title="点击放大" width="281.256"></span></p> </td> <td class="cellrowborder" valign="top" width="41.72%"><p></p> <p><span><img height="233.1239725333334" originheight="869" originwidth="1344" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163121.78607716548178238841961087490164:50001231000000:2800:C42D1E32F6AC1775940FDA8D51CFA20A6CF0DC635C7D97F9384FC04C7C4B0016.png" title="点击放大" width="359.824"></span></p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="5.82%"><p>搜索输入页</p> </td> <td class="cellrowborder" valign="top" width="19.28%"><p></p> <p><span><img height="318.1478368000001" originheight="804" originwidth="385" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163121.72351092007298089889604898756874:50001231000000:2800:F1E68DF8849C7B17E961E9379DB94FFD2C814CC636C1D24CF2611D2F000297E3.png" title="点击放大" width="153.37600000000003"></span></p> </td> <td class="cellrowborder" valign="top" width="33.18%"><p></p> <p><span><img height="313.7332553333333" originheight="787" originwidth="705" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163121.48006391015568253461708872050051:50001231000000:2800:BD1C96B35AEBD35800EC40BF6D491921C12B7973D40B3FE742F203C20E1174F9.png" title="点击放大" width="281.256"></span></p> </td> <td class="cellrowborder" valign="top" width="41.72%"><p></p> <p><span><img height="233.1239725333334" originheight="869" originwidth="1344" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163121.37343337039932348898581812594520:50001231000000:2800:B0A9C5899B65BC66F7CD413A53AA23A5F0B74F4CE4AE85863D9233365FEBD83C.png" title="点击放大" width="359.824"></span></p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="5.82%"><p>搜索结果页</p> </td> <td class="cellrowborder" valign="top" width="19.28%"><p></p> <p><span><img height="318.1555056000001" originheight="804" originwidth="385" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163121.67691558238301189314829291577355:50001231000000:2800:5B6621138A1C5D1C7DF38B82E7CC4C0E528F70F78844151C4E5EAB6054F1D44E.png" title="点击放大" width="153.37600000000003"></span></p> </td> <td class="cellrowborder" valign="top" width="33.18%"><p></p> <p><span><img height="313.7332553333333" originheight="787" originwidth="705" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163121.75411416760749459997977181957233:50001231000000:2800:AD632E479F04668D7905FF6301464C0AEFA179D0437DA9FE0DC98723FDCC68BC.png" title="点击放大" width="281.256"></span></p> </td> <td class="cellrowborder" valign="top" width="41.72%"><p></p> <p><span><img height="233.7116850666667" originheight="1656" originwidth="2548" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163121.84906384240365653889952553631361:50001231000000:2800:1E895650A658C15E2FBC493458EF9B5B90A792F68AB75FCAC3E319B0B72B174F.png" title="点击放大" width="359.824"></span><span><img height="233.1239725333334" originheight="869" originwidth="1344" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163122.59949788507714254029566738451442:50001231000000:2800:615FE5A87DD9E823E9189E3632E1A487F265C746E7326102B1ABC2F5D17208D5.png" title="点击放大" width="359.824"></span></p> </td> </tr>  </tbody></table></div> </div> </li><li>整个页面实现响应式适配，利用栅格组件监听不同断点变化，实现不同的布局效果。</li><li>搜索页区域1在不同断点下占满屏幕，使用layoutWeight实现拉伸。</li><li>搜索页区域2-4在不同断点下的样式相同，但列表显示的列数不同，使用List组件的lanes属性实现。</li><li>搜索页区域5使用响应式布局中的栅格布局，在不同断点下占用不同的栅格列数以实现布局效果。</li></ul> <p>长视频应用搜索页的5个基础区域介绍及实现方案见下表：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.24.1.4.1.1" valign="top" width="7.5200000000000005%"><p>区域编号</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.24.1.4.1.2" valign="top" width="13.08%"><p>简介</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.24.1.4.1.3" valign="top" width="79.4%"><p>实现方案</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="7.5200000000000005%"><p>1</p> </td> <td class="cellrowborder" valign="top" width="13.08%"><p>搜索框</p> </td> <td class="cellrowborder" valign="top" width="79.4%"><p>layoutWeight实现拉伸能力，同<a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li1346175796">首页搜索框</a>。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="7.5200000000000005%"><p>2</p> </td> <td class="cellrowborder" valign="top" width="13.08%"><p><a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li311217374149">搜索发现</a></p> </td> <td class="cellrowborder" valign="top" width="79.4%"><p>标题栏的空白区域使用Blank实现拉伸能力，内容使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-list" target="_blank">List组件</a>的lanes属性，在不同断点下呈2、2、3列显示。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="7.5200000000000005%"><p>3</p> </td> <td class="cellrowborder" valign="top" width="13.08%"><p>热搜</p> </td> <td class="cellrowborder" valign="top" width="79.4%"><p>页签的间距随断点变化，热搜内容使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-list" target="_blank">List组件</a>的lanes属性，在不同断点下呈1、2、3列显示。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="7.5200000000000005%"><p>4</p> </td> <td class="cellrowborder" valign="top" width="13.08%"><p>“华”搜索智能提示</p> </td> <td class="cellrowborder" valign="top" width="79.4%"><p>使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-list" target="_blank">List组件</a>的lanes属性，在不同断点下呈1、1、2列显示。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="7.5200000000000005%"><p>5</p> </td> <td class="cellrowborder" valign="top" width="13.08%"><p>搜索结果</p> </td> <td class="cellrowborder" valign="top" width="79.4%"><p>响应式布局的栅格布局，同<a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li1938820294129">首页每日佳片</a>。</p> </td> </tr>  </tbody></table></div> </div> <p>在实际开发中，区域1为导航栏，区域2、3、4和5为并列的搜索页内容。因此，开发顺序为区域1和区域2至5。</p> <ul><li id="zh-cn_topic_0000001744653537_li311217374149"><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li311217374149"></a><a name="zh-cn_topic_0000001744653537_li311217374149"></a>搜索发现<p><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li311217374149"></a><a name="zh-cn_topic_0000001744653537_li311217374149"></a>搜索发现、热搜和“华”搜索智能提示区域均使用List组件，通过设置不同断点下的lanes属性来实现。本章节以搜索发现区域为例，热搜和“华”搜索智能提示区域的实现方法，开发者可以自行查看代码。</p> <p>示意图如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.26.1.3.1.5.1.1" valign="top" width="7.5200000000000005%"><p>示意图</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.26.1.3.1.5.1.2" valign="top" width="17.62%"><p>sm</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.26.1.3.1.5.1.3" valign="top" width="29.160000000000004%"><p>md</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.26.1.3.1.5.1.4" valign="top" width="45.7%"><p>lg</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="7.5200000000000005%"><p>效果图</p> </td> <td class="cellrowborder" valign="top" width="17.62%"><p><span><img height="81.78518880000001" originheight="273" originwidth="461" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163122.46474814729384993990307477120878:50001231000000:2800:B2EA782605DB757F4D43B47181F1BAD5FF4B544ACCBB25BD6FF213B6396E4E3A.png" title="点击放大" width="138.104"></span></p> </td> <td class="cellrowborder" valign="top" width="29.160000000000004%"><p><span><img height="80.94563400000003" originheight="280" originwidth="845" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163122.68728465249150209625028383737327:50001231000000:2800:A57ED959FC1010B90D0A29AF938D61BF19885A8AD46DEF6FD156667283B67CC8.png" title="点击放大" width="244.27200000000005"></span></p> </td> <td class="cellrowborder" valign="top" width="45.7%"><p><span><img height="85.16852666666666" originheight="417" originwidth="1941" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163122.02260338303002975763036761877597:50001231000000:2800:EEA26B40F16A3FF0FE1F0FD175FEF46CA2F8858A6766BED186A8429FB6BFD0B8.png" title="点击放大" width="396.44"></span></p> </td> </tr>  </tbody></table></div> </div> <p>搜索发现区域中，标题栏中间的空白区域使用Blank组件实现自适应布局的拉伸能力；List组件的lanes属性在sm和md断点下为2，在lg断点下为3，实现不同布局显示。</p> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-less" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/search/src/main/ets/view/SearchContent.ets#L84-L122" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">@Builder</span></li><li><span class="hljs-built_in">searchDiscovery</span>() {</li><li>  <span class="hljs-selector-tag">Row</span>() {</li><li>    <span class="hljs-selector-tag">Text</span>(<span class="hljs-string">'搜索发现'</span>)</li><li>      <span class="hljs-selector-class">.fontSize</span>(<span class="hljs-string">'20fp'</span>)</li><li>      <span class="hljs-selector-class">.fontWeight</span>(<span class="hljs-number">500</span>)</li><li>    <span class="hljs-selector-tag">Blank</span>()</li><li>    <span class="hljs-selector-tag">Image</span>($<span class="hljs-built_in">r</span>(<span class="hljs-string">'app.media.ic_public_rotate'</span>))</li><li>      <span class="hljs-selector-class">.height</span>(<span class="hljs-string">'16vp'</span>)</li><li>      <span class="hljs-selector-class">.width</span>(<span class="hljs-string">'16vp'</span>)</li><li>      <span class="hljs-selector-class">.margin</span>({ <span class="hljs-attribute">right</span>: <span class="hljs-string">'24vp'</span> })</li><li>      <span class="hljs-selector-class">.fillColor</span>(<span class="hljs-string">'#ED6F21'</span>)</li><li>  }</li><li>  .<span class="hljs-built_in">height</span>(<span class="hljs-string">'24vp'</span>)</li><li>  .<span class="hljs-built_in">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  .<span class="hljs-built_in">margin</span>({ <span class="hljs-attribute">top</span>: <span class="hljs-string">'24vp'</span> })</li><li>
</li><li>  <span class="hljs-built_in">List</span>() {</li><li>    <span class="hljs-selector-tag">ForEach</span>(this.currentWidthBreakpoint === <span class="hljs-string">'lg'</span> ? SearchConstants.<span class="hljs-attribute">SEARCH_DISCOVERY_LARGE </span>:</li><li>      SearchConstants.SEARCH_DISCOVERY_LARGE.<span class="hljs-built_in">slice</span>(<span class="hljs-number">0</span>, <span class="hljs-number">6</span>), (<span class="hljs-attribute">item</span>: string, <span class="hljs-attribute">index</span>: number) =&gt; {</li><li>      <span class="hljs-selector-tag">ListItem</span>() {</li><li>        <span class="hljs-comment">// ...</span></li><li>      }</li><li>    }, (<span class="hljs-attribute">item</span>: string, <span class="hljs-attribute">index</span>: number) =&gt; index + JSON.<span class="hljs-built_in">stringify</span>(item))</li><li>  }</li><li>  <span class="hljs-selector-class">.width</span>(<span class="hljs-string">'100%'</span>)</li><li>  <span class="hljs-selector-class">.lanes</span>(this.currentWidthBreakpoint === <span class="hljs-string">'lg'</span> ? <span class="hljs-number">3</span> : <span class="hljs-number">2</span>)</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/search/src/main/ets/view/SearchContent.ets#L84-L122" target="_blank">SearchContent.ets</a></div></div></div></div> </li></ul> <div class="tiledSection"><h3 id="section9259381113">视频详情页<i class="anchor-icon anchor-icon-link" anchorid="section9259381113" tips="复制节点链接"></i></h3><p>长视频应用的视频详情页具备视频播放、评论互动及展示视频相关信息的功能。观察视频详情页在不同设备上的UX设计图，可以参考以下设计（图中包含可滑动区域的内容）：</p> </div> <ul><li>将视频详情页划分为5个区域，效果图如下： <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.28.1.1.1.5.1.1" valign="top" width="7.520752075207521%"><p>示意图</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.28.1.1.1.5.1.2" valign="top" width="16.811681168116813%"><p>sm</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.28.1.1.1.5.1.3" valign="top" width="30.313031303130312%"><p>md</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.28.1.1.1.5.1.4" valign="top" width="45.35453545354536%"><p>lg</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="7.520752075207521%"><p>效果图</p> </td> <td class="cellrowborder" valign="top" width="16.811681168116813%"><p></p> <p><span><img height="476.4566372657978" originheight="2702" originwidth="720" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163122.85196298472079499650262185570216:50001231000000:2800:558B404581E753742DA93334572AE893A0F675EDA4F033C5658A890204B821F1.png" title="点击放大" width="130.66746674667468"></span></p> </td> <td class="cellrowborder" valign="top" width="30.313031303130312%"><p></p> <p><span><img height="611.2968204851875" originheight="2453" originwidth="1016" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163122.80869570112712312183492306449971:50001231000000:2800:5A19F7E6DFBC317858D11ADE59FBF1F96E5324AE330B529365BCA9A98E1F7203.png" title="点击放大" width="254.87988798879888"></span></p> </td> <td class="cellrowborder" valign="top" width="45.35453545354536%"><p></p> <p><span><img height="382.6431734575188" originheight="1325" originwidth="1280" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163122.37152754318276735669402391925327:50001231000000:2800:F1E48B215C8BC2192CBE4533346EDCF32BDCDADEA72F92EFE1CFC3C4D35C6EED.png" title="点击放大" width="393.26172617261733"></span></p> </td> </tr>  </tbody></table></div> </div> </li><li>视频详情页在sm、md和lg断点下的布局有所不同。在sm和md断点下，相关列表、全部评论和写评论区域均显示在视频下方，没有视频简介区域。在lg断点下，页面分为侧边栏和主内容区两部分。全部评论和写评论区域显示在右侧边栏，相关列表和视频简介区域显示在主内容区的视频下方。</li><li>视频详情页区域1包含视频播放相关组件，占据整个主内容区。</li><li>当视频详情页区域2的容器组件尺寸变化时，增加或减少的空间全部分配给标题栏的空白区域；内容按顺序随容器组件尺寸变化显示或隐藏。</li><li>在视频详情页的区域3中，图片在sm和md断点下的大小不同，在lg断点下会根据侧边栏的尺寸动态调整大小。</li><li>视频详情页区域4的评论框占据容器组件的剩余空间。</li><li>视频详情页区域5仅在lg断点下显示。当容器组件尺寸变化时，增加或减少的空间将均匀分配给视频简介的图标，或全部分配给周边视频标题的空白区域。选集列表内容将根据容器组件尺寸的变化，按先后顺序显示或隐藏。</li></ul> <p>长视频应用视频详情页的基础区域及其实现方案如下表所示：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.30.1.4.1.1" valign="top" width="7.5200000000000005%"><p>区域编号</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.30.1.4.1.2" valign="top" width="13.08%"><p>简介</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.30.1.4.1.3" valign="top" width="79.4%"><p>实现方案</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="7.5200000000000005%"><p>1</p> </td> <td class="cellrowborder" valign="top" width="13.08%"><p>视频播放</p> </td> <td class="cellrowborder" valign="top" width="79.4%"><p>使用视频播放<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-media-avplayer" target="_blank">AVPlayer</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-components-xcomponent" target="_blank">XComponent</a>等相关组件，不详细介绍具体功能实现，开发者可以自行查看代码。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="7.5200000000000005%"><p>2</p> </td> <td class="cellrowborder" valign="top" width="13.08%"><p>相关列表</p> </td> <td class="cellrowborder" valign="top" width="79.4%"><p>标题栏的空白区域使用Blank实现拉伸能力，视频列表通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-list" target="_blank">List组件</a>实现延伸能力，同<a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li311217374149">搜索页搜索发现</a>。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="7.5200000000000005%"><p>3</p> </td> <td class="cellrowborder" valign="top" width="13.08%"><p><a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li10952411168">全部评论</a></p> </td> <td class="cellrowborder" valign="top" width="79.4%"><p>在不同断点下修改评论区图片的宽高和aspectRatio属性，实现自适应布局的缩放。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="7.5200000000000005%"><p>4</p> </td> <td class="cellrowborder" valign="top" width="13.08%"><p>写评论</p> </td> <td class="cellrowborder" valign="top" width="79.4%"><p>layoutWeight实现自适应布局的拉伸能力，同<a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li1346175796">首页搜索框</a>。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="7.5200000000000005%"><p>5</p> </td> <td class="cellrowborder" valign="top" width="13.08%"><p><a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li1134192618160">视频简介</a></p> </td> <td class="cellrowborder" valign="top" width="79.4%"><p>图标<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-row" target="_blank">Row组件</a>的justifyContent属性设置为FlexAlign.SpaceBetween实现均分能力，选集列表通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-list" target="_blank">List组件</a>实现延伸能力，周边视频使用layoutWeight实现拉伸能力。</p> </td> </tr>  </tbody></table></div> </div> <p>在实际开发中，sm和md断点下的设计中，区域1-3和区域4为并列的视频详情页内容，所以对应的开发顺序为区域4，区域1-3；lg断点下的设计中，区域1、2、5和区域3-4是并列的视频详情页内容，所以对应的开发顺序为区域3-4，区域1、2、5。另外，视频详情页设计了额外的功能：<a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li189372272168">边看边评的交互逻辑</a>。</p> <ul><li id="zh-cn_topic_0000001744653537_li10952411168"><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li10952411168"></a><a name="zh-cn_topic_0000001744653537_li10952411168"></a>全部评论<p><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li10952411168"></a><a name="zh-cn_topic_0000001744653537_li10952411168"></a>根据UX设计，全部评论在sm、md断点下显示在视频下方，在lg断点下显示在右侧边栏，实现侧边悬浮面板。使用SideBarContainer组件和断点控制组件显示位置。侧边栏宽度可通过拖拽调整。全部评论中的图片在sm、md断点下使用不同的固定宽高；在lg断点下，通过SideBarContainer的onAreaChange方法按侧边栏宽度变化的百分比调整图片宽高，并使用aspectRatio属性控制等比缩放，实现自适应布局。</p> <p>效果图如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.32.1.3.1.5.1.1" valign="top" width="7.5200000000000005%"><p>示意图</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.32.1.3.1.5.1.2" valign="top" width="17.25%"><p>sm</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.32.1.3.1.5.1.3" valign="top" width="30.680000000000003%"><p>md</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.32.1.3.1.5.1.4" valign="top" width="44.55%"><p>lg</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top"><p>设计能力点</p> </td> <td class="cellrowborder" colspan="3" valign="top"><p><span><img height="194.978" originheight="151" originwidth="206" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163122.97182147656243129348366196721438:50001231000000:2800:7A63E95A682413FC0BCBEAD0EAAAE3434D78A5C931895E477F0DADD0C3475B99.png" width="266" class="notEnlarge"></span></p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="7.5200000000000005%"><p>效果图</p> </td> <td class="cellrowborder" valign="top" width="17.25%"><p></p> <p><span><img height="279.414945" originheight="804" originwidth="385" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163122.58670399954899026958800577624469:50001231000000:2800:54EFBB7C67DE91E8BC662CA4437112FF58E42350AE6DBD9351A2C7E0A6EC107F.png" title="点击放大" width="134.7"></span></p> </td> <td class="cellrowborder" valign="top" width="30.680000000000003%"><p></p> <p><span><img height="288.0773942222223" originheight="787" originwidth="705" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163122.19015071728980020262955863338866:50001231000000:2800:36DA33C675F0B3EA4026EB7BCF3A9A21E0125D86432B83C164272C0527D53DAD.png" title="点击放大" width="258.25600000000003"></span></p> </td> <td class="cellrowborder" valign="top" width="44.55%"><p></p> <p><span><img height="249.99226300000007" originheight="869" originwidth="1344" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163122.63552080596384920383760870228208:50001231000000:2800:19D9FEFEDC391495E14D42FB9365483EDDBA02196963D264644DEB9A43F0F636.png" title="点击放大" width="385.86"></span></p> </td> </tr>  </tbody></table></div> </div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-less" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/videoDetail/src/main/ets/view/VideoDetail.ets#L167-L220" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-selector-tag">SideBarContainer</span>() {</li><li>  <span class="hljs-selector-tag">Column</span>() {</li><li>    <span class="hljs-comment">// Sidebar area.</span></li><li>    <span class="hljs-selector-tag">Scroll</span>() {</li><li>      <span class="hljs-selector-tag">AllComments</span>({ commentImgHeight: $commentImgHeight, commentImgWidth: $commentImgWidth })</li><li>        <span class="hljs-selector-class">.visibility</span>(this.currentWidthBreakpoint === <span class="hljs-string">'lg'</span> ? Visibility.<span class="hljs-attribute">Visible </span>: Visibility.None)</li><li>    }</li><li>    .<span class="hljs-built_in">align</span>(Alignment.Top)</li><li>    .<span class="hljs-built_in">scrollBar</span>(BarState.Off)</li><li>    .<span class="hljs-built_in">layoutWeight</span>(<span class="hljs-number">1</span>)</li><li>    .<span class="hljs-built_in">width</span>(<span class="hljs-string">'100%'</span>)</li><li>    .<span class="hljs-built_in">padding</span>({ <span class="hljs-attribute">bottom</span>: <span class="hljs-string">'12vp'</span> })</li><li>
</li><li>    <span class="hljs-built_in">SelfComment</span>()</li><li>      .<span class="hljs-built_in">visibility</span>(this.currentWidthBreakpoint === <span class="hljs-string">'lg'</span> ? Visibility.<span class="hljs-attribute">Visible </span>: Visibility.None)</li><li>  }</li><li>  .<span class="hljs-built_in">justifyContent</span>(FlexAlign.Start)</li><li>  .<span class="hljs-built_in">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  .<span class="hljs-built_in">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  .<span class="hljs-built_in">backgroundColor</span>(<span class="hljs-attribute">Color</span>.White)</li><li>  .<span class="hljs-built_in">onAreaChange</span>((<span class="hljs-attribute">newValue</span>: Area) =&gt; {</li><li>    if (newValue.<span class="hljs-attribute">width</span> !== <span class="hljs-number">0</span>) {</li><li>      <span class="hljs-comment">// Handling when the width of the sidebar changes.</span></li><li>      let <span class="hljs-attribute">height</span>: number = <span class="hljs-number">150</span> + (<span class="hljs-built_in">Number</span>(newValue.<span class="hljs-attribute">width</span>) - <span class="hljs-number">320</span>) /</li><li>        (this.<span class="hljs-built_in">getUIContext</span>().<span class="hljs-built_in">px2vp</span>(this.windowWidth) * <span class="hljs-number">0.4</span> - <span class="hljs-number">320</span>) * (<span class="hljs-number">182</span> - <span class="hljs-number">150</span>);</li><li>      let <span class="hljs-attribute">width</span>: number = <span class="hljs-number">219</span> + (<span class="hljs-built_in">Number</span>(newValue.<span class="hljs-attribute">width</span>) - <span class="hljs-number">320</span>) /</li><li>        (this.<span class="hljs-built_in">getUIContext</span>().<span class="hljs-built_in">px2vp</span>(this.windowWidth) * <span class="hljs-number">0.4</span> - <span class="hljs-number">320</span>) * (<span class="hljs-number">266</span> - <span class="hljs-number">219</span>);</li><li>      this.commentImgHeight = JSON.<span class="hljs-built_in">stringify</span>(<span class="hljs-attribute">height</span>);</li><li>      this.commentImgWidth = JSON.<span class="hljs-built_in">stringify</span>(<span class="hljs-attribute">width</span>);</li><li>    }</li><li>  })</li><li>
</li><li>  <span class="hljs-built_in">Column</span>() {</li><li>    <span class="hljs-comment">// Content area.</span></li><li>    <span class="hljs-selector-tag">VideoDetailView</span>({</li><li>      screenHeight: this.screenHeight,</li><li>      relatedVideoHeight: this.relatedVideoHeight,</li><li>      videoHeight: this.videoHeight</li><li>    })</li><li>      <span class="hljs-selector-class">.layoutWeight</span>(<span class="hljs-number">1</span>)</li><li>
</li><li>    <span class="hljs-selector-tag">SelfComment</span>()</li><li>      <span class="hljs-selector-class">.visibility</span>(this.currentWidthBreakpoint === <span class="hljs-string">'lg'</span> || this.isFullScreen ? Visibility.<span class="hljs-attribute">None </span>: Visibility.Visible)</li><li>  }</li><li>  .<span class="hljs-built_in">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  .<span class="hljs-built_in">width</span>(<span class="hljs-string">'100%'</span>)</li><li>}</li><li>.<span class="hljs-built_in">showSideBar</span>(this.currentWidthBreakpoint === <span class="hljs-string">'lg'</span> &amp;&amp; !this.isFullScreen ? <span class="hljs-attribute">true </span>: false)</li><li>.<span class="hljs-built_in">showControlButton</span>(false)</li><li>.<span class="hljs-built_in">autoHide</span>(false)</li><li>.<span class="hljs-built_in">sideBarPosition</span>(SideBarPosition.End)</li><li>.<span class="hljs-built_in">sideBarWidth</span>($<span class="hljs-built_in">r</span>(<span class="hljs-string">'app.float.side_bar_min_width'</span>))</li><li>.<span class="hljs-built_in">minSideBarWidth</span>($<span class="hljs-built_in">r</span>(<span class="hljs-string">'app.float.side_bar_min_width'</span>))</li><li>.<span class="hljs-built_in">maxSideBarWidth</span>(this.<span class="hljs-built_in">getUIContext</span>().<span class="hljs-built_in">px2vp</span>(this.windowWidth * <span class="hljs-number">0.4</span>))</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/videoDetail/src/main/ets/view/VideoDetail.ets#L167-L220" target="_blank">VideoDetail.ets</a></div></div></div></div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/videoDetail/src/main/ets/view/AllComments.ets#L69-L73" data-highlighted="yes"><ol class="linenums"><li>Image(item.getCommentImageSrc())</li><li>  .width(new BreakpointType(<span class="hljs-string">'227vp'</span>, <span class="hljs-string">'254vp'</span>, <span class="hljs-keyword">this</span>.commentImgWidth).getValue(<span class="hljs-keyword">this</span>.currentWidthBreakpoint))</li><li>  .height(new BreakpointType(<span class="hljs-string">'227vp'</span>, <span class="hljs-string">'254vp'</span>, <span class="hljs-keyword">this</span>.commentImgHeight).getValue(<span class="hljs-keyword">this</span>.currentWidthBreakpoint))</li><li>  .borderRadius(<span class="hljs-string">'8vp'</span>)</li><li>  .aspectRatio(<span class="hljs-number">1.46</span>)</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/videoDetail/src/main/ets/view/AllComments.ets#L69-L73" target="_blank">AllComments.ets</a></div></div></div></div> </li></ul> <ul><li id="zh-cn_topic_0000001744653537_li1134192618160"><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li1134192618160"></a><a name="zh-cn_topic_0000001744653537_li1134192618160"></a>视频简介<p><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li1134192618160"></a><a name="zh-cn_topic_0000001744653537_li1134192618160"></a>视频简介区域仅在lg断点下显示。视频简介的图标通过设置Row组件的justifyContent属性为FlexAlign.SpaceBetween实现均分能力。选集列表使用List组件实现自适应布局的延伸能力，随容器组件尺寸变大，可以看到的集数相应增加，用户也可以通过手指滑动触发列表滑动，查看被隐藏的子节点。周边视频标题栏的空白区域随容器组件尺寸变化而伸缩，使用Blank实现自适应布局的拉伸能力。</p> <p>效果图如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.33.1.3.1.3.1.1" valign="top" width="7.5200000000000005%"><p>示意图</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.33.1.3.1.3.1.2" valign="top" width="92.47999999999999%"><p>lg</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="7.5200000000000005%"><p>效果图</p> </td> <td class="cellrowborder" valign="top" width="92.47999999999999%"><p><span><img height="303.24" originheight="1216" originwidth="1920" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163123.07957023069653422480496892127729:50001231000000:2800:1DAAAE4636F45F6994A0B8BC5CA5D89E981022D8367A2043AB984FBD6E31DAD5.png" title="点击放大" width="478.8"></span></p> </td> </tr>  </tbody></table></div> </div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/videoDetail/src/main/ets/view/RelatedList.ets#L166-L320" data-highlighted="yes"><ol class="linenums"><li>@<span class="hljs-title function_">Builder</span></li><li><span class="hljs-title function_">VideoIntroduction</span>() {</li><li>  <span class="hljs-title function_">Column</span>() {</li><li>    <span class="hljs-comment">// ...</span></li><li>    <span class="hljs-title function_">Row</span>() {</li><li>      <span class="hljs-title function_">ForEach</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">iconList</span>, (<span class="hljs-variable">item</span>: <span class="hljs-title class_">Resource</span>, <span class="hljs-variable">index</span>: <span class="hljs-title class_">number</span>) =&gt; {</li><li>        <span class="hljs-title function_">Image</span>(<span class="hljs-variable">item</span>)</li><li>          .<span class="hljs-title function_">height</span>(<span class="hljs-string">'24vp'</span>)</li><li>          .<span class="hljs-title function_">width</span>(<span class="hljs-string">'24vp'</span>)</li><li>      }, (<span class="hljs-variable">item</span>: <span class="hljs-title class_">Resource</span>, <span class="hljs-variable">index</span>: <span class="hljs-title class_">number</span>) =&gt; <span class="hljs-variable">index</span> + <span class="hljs-variable">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-variable">item</span>))</li><li>    }</li><li>    .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-variable">FlexAlign</span>.<span class="hljs-variable">SpaceBetween</span>)</li><li>    <span class="hljs-comment">// ...</span></li><li>
</li><li>    <span class="hljs-title function_">List</span>({ <span class="hljs-variable">space</span>: <span class="hljs-string">'12vp'</span> }) {</li><li>      <span class="hljs-title function_">ForEach</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">episodes</span>, (<span class="hljs-variable">item</span>: <span class="hljs-title class_">string</span>, <span class="hljs-variable">index</span>: <span class="hljs-title class_">number</span>) =&gt; {</li><li>        <span class="hljs-title function_">ListItem</span>() {</li><li>          <span class="hljs-comment">// ...</span></li><li>        }</li><li>      }, (<span class="hljs-variable">item</span>: <span class="hljs-title class_">string</span>, <span class="hljs-variable">index</span>: <span class="hljs-title class_">number</span>) =&gt; <span class="hljs-variable">index</span> + <span class="hljs-variable">JSON</span>.<span class="hljs-title function_">stringify</span>(<span class="hljs-variable">item</span>))</li><li>    }</li><li>    .<span class="hljs-title function_">scrollBar</span>(<span class="hljs-variable">BarState</span>.<span class="hljs-variable">Off</span>)</li><li>    .<span class="hljs-title function_">listDirection</span>(<span class="hljs-variable">Axis</span>.<span class="hljs-variable">Horizontal</span>)</li><li>    .<span class="hljs-title function_">padding</span>({ <span class="hljs-variable">left</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">sub_title_row_padding</span>') })</li><li>    .<span class="hljs-title function_">margin</span>({ <span class="hljs-variable">bottom</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">episodes_list_margin</span>') })</li><li>    .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>
</li><li>    <span class="hljs-keyword">this</span>.<span class="hljs-title function_">SubTitleAndMore</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.string.Peripheral'</span>))</li><li>
</li><li>    <span class="hljs-comment">// ...</span></li><li>  }</li><li>  .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable">Color</span>.<span class="hljs-variable">White</span>)</li><li>  .<span class="hljs-title function_">visibility</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">currentWidthBreakpoint</span> === <span class="hljs-string">'lg'</span> ? <span class="hljs-variable">Visibility</span>.<span class="hljs-variable">Visible</span> : <span class="hljs-title class_">Visibility</span>.<span class="hljs-title class_">None</span>)</li><li>}</li><li>
</li><li><span class="hljs-comment">// ...</span></li><li>
</li><li>@<span class="hljs-title function_">Builder</span></li><li><span class="hljs-title function_">SubTitleAndMore</span>(<span class="hljs-variable">subtitle</span>: <span class="hljs-title class_">ResourceStr</span>) {</li><li>  <span class="hljs-title function_">Row</span>() {</li><li>    <span class="hljs-comment">// ...</span></li><li>    <span class="hljs-title function_">Blank</span>()</li><li>    <span class="hljs-comment">// ...</span></li><li>  }</li><li>  .<span class="hljs-title function_">padding</span>({</li><li>    <span class="hljs-variable">left</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">sub_title_row_padding</span>'),</li><li>    <span class="hljs-variable">right</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">float</span>.<span class="hljs-title class_">sub_title_row_padding</span>')</li><li>  })</li><li>  .<span class="hljs-title function_">height</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.float.sub_title_row_height_detail'</span>))</li><li>  .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  .<span class="hljs-title function_">alignItems</span>(<span class="hljs-variable">VerticalAlign</span>.<span class="hljs-variable">Center</span>)</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/videoDetail/src/main/ets/view/RelatedList.ets#L166-L320" target="_blank">RelatedList.ets</a></div></div></div></div> </li></ul> <ul><li id="zh-cn_topic_0000001744653537_li189372272168"><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li189372272168"></a><a name="zh-cn_topic_0000001744653537_li189372272168"></a>边看边评的交互逻辑<p><a name="ZH-CN_TOPIC_0000002490707096__zh-cn_topic_0000001744653537_li189372272168"></a><a name="zh-cn_topic_0000001744653537_li189372272168"></a>视频详情页中，不同断点下页面下滑效果不同。在sm和md断点下，下滑时先隐藏相关列表区域，完全隐藏后视频区域等比缩小，缩至最小时固定，改为下滑全部评论区域；上滑时先上滑全部评论区，再等比放大视频区域，最后显示相关列表区域。在lg断点下，下滑时等比缩小视频区域，最小时固定改为下滑全部评论区域；上滑时先上滑全部评论区，再等比放大视频区域。这一效果通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-scroll" target="_blank">Scroll组件</a>的onScrollFrameBegin回调方法中控制相关组件的高度和偏移量实现。当组件高度变化时，返回偏移量为0；当全部评论区滑动时，返回实际偏移量。</p> <p>示意图如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.34.1.3.1.5.1.1" valign="top" width="7.519248075192481%"><p>示意图</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.34.1.3.1.5.1.2" valign="top" width="18.81811818818118%"><p>sm</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.34.1.3.1.5.1.3" valign="top" width="31.326867313268675%"><p>md</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.34.1.3.1.5.1.4" valign="top" width="42.33576642335766%"><p>lg</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top"><p>设计能力点</p> </td> <td class="cellrowborder" colspan="3" valign="top"><p><span><img height="232.48400000000004" originheight="215" originwidth="246" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163123.37492417775482071988630359901950:50001231000000:2800:33BCBBDE71728E73A6243D8F8E77614E918BBFFFCAA688EE4E2E264BA7A73ADA.png" width="266" class="notEnlarge"></span></p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="7.519248075192481%"><p>效果图</p> </td> <td class="cellrowborder" valign="top" width="18.81811818818118%"><p></p> <p></p> <p><span><img height="306.1347200879912" originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163123.14750108618965926920465899094911:50001231000000:2800:C5E3D129E29BE2C5453C6F5A7181E3A7B48FBBE36DEFC6F6C8435A7049FFE7A0.gif" title="点击放大" width="149.12668733126688"></span></p> </td> <td class="cellrowborder" valign="top" width="31.326867313268675%"><p></p> <p></p> <p><span><img height="293.77636609672373" originheight="720" originwidth="647" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163123.66807781422146255055473868333150:50001231000000:2800:6232E1AE36479C45BC602F98253E189E5796887C330C4FD10F4AD17366E5FC25.gif" title="点击放大" width="264.2071792820718"></span></p> </td> <td class="cellrowborder" valign="top" width="42.33576642335766%"><p></p> <p></p> <p><span><img height="237.80545109489046" originheight="518" originwidth="799" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163123.96458545894374598740947451231744:50001231000000:2800:FB994B1C92BB4B9360FEF98CEFC562544BD35C01264757018330B7566A049576.gif" title="点击放大" width="365.48905109489044"></span></p> </td> </tr>  </tbody></table></div> </div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/videoDetail/src/main/ets/view/RelatedList.ets#L39-L118" data-highlighted="yes"><ol class="linenums"><li>build() {</li><li>  Scroll(<span class="hljs-keyword">this</span>.scroller) {</li><li>    Column() {</li><li>      <span class="hljs-keyword">this</span>.RelatedVideoComponent()</li><li>      <span class="hljs-keyword">this</span>.VideoIntroduction()</li><li>      AllComments({commentImgHeight: <span class="hljs-keyword">this</span>.commentImgHeight, commentImgWidth: <span class="hljs-keyword">this</span>.commentImgWidth})</li><li>        .visibility(<span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'lg'</span> ? Visibility.None : Visibility.Visible)</li><li>    }</li><li>    .width(<span class="hljs-string">'100%'</span>)</li><li>    .alignItems(HorizontalAlign.Start)</li><li>    .padding({ bottom: <span class="hljs-string">'10vp'</span> })</li><li>  }</li><li>  .layoutWeight(<span class="hljs-number">1</span>)</li><li>  .scrollBar(BarState.Off)</li><li>  .visibility(!<span class="hljs-keyword">this</span>.isFullScreen ? Visibility.Visible : Visibility.None)</li><li>  .onScrollFrameBegin((offset: number) =&gt; {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'lg'</span>) {</li><li>      <span class="hljs-keyword">if</span> ((offset &gt; <span class="hljs-number">0</span>) &amp;&amp; (<span class="hljs-keyword">this</span>.videoHeight &gt; <span class="hljs-number">53</span>)) {</li><li>        <span class="hljs-comment">// Video zoom-out logic.</span></li><li>        <span class="hljs-comment">// Percentage of screen height by sliding.</span></li><li>        let offsetPercent = (Math.abs(offset) * <span class="hljs-number">100</span>) / <span class="hljs-keyword">this</span>.screenHeight;</li><li>        <span class="hljs-comment">// Video shrinkage percentage.</span></li><li>        let heightOffset = offsetPercent &lt; <span class="hljs-keyword">this</span>.videoHeight - <span class="hljs-number">53</span> ? offsetPercent : <span class="hljs-keyword">this</span>.videoHeight - <span class="hljs-number">53</span>;</li><li>        <span class="hljs-keyword">this</span>.videoHeight = <span class="hljs-keyword">this</span>.videoHeight - heightOffset;</li><li>        <span class="hljs-comment">// Returns the actual offset 0.</span></li><li>        <span class="hljs-keyword">return</span> { offsetRemain: <span class="hljs-number">0</span> };</li><li>      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((offset &lt; <span class="hljs-number">0</span>) &amp;&amp; (<span class="hljs-keyword">this</span>.videoHeight &lt; <span class="hljs-number">100</span>) &amp;&amp;</li><li>        (CurrentOffsetUtil.scrollToTop(JSON.stringify(<span class="hljs-keyword">this</span>.scroller.currentOffset())))) {</li><li>        <span class="hljs-comment">// Video magnification logic.</span></li><li>        let offsetPercent = (Math.abs(offset) * <span class="hljs-number">100</span>) / <span class="hljs-keyword">this</span>.screenHeight;</li><li>        let heightOffset = offsetPercent &lt; <span class="hljs-number">100</span> - <span class="hljs-keyword">this</span>.videoHeight ? offsetPercent : <span class="hljs-number">100</span> - <span class="hljs-keyword">this</span>.videoHeight;</li><li>        <span class="hljs-keyword">this</span>.videoHeight = <span class="hljs-keyword">this</span>.videoHeight + heightOffset;</li><li>        <span class="hljs-comment">// Returns the actual offset 0.</span></li><li>        <span class="hljs-keyword">return</span> { offsetRemain: <span class="hljs-number">0</span> };</li><li>      }</li><li>      <span class="hljs-keyword">return</span> { offsetRemain: offset };</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-keyword">if</span> ((offset &gt; <span class="hljs-number">0</span>) &amp;&amp; (<span class="hljs-keyword">this</span>.videoHeight === <span class="hljs-number">100</span>) &amp;&amp; (<span class="hljs-keyword">this</span>.relatedVideoHeight &gt; <span class="hljs-number">0</span>)) {</li><li>        <span class="hljs-comment">// Related list shrinking logic.</span></li><li>        <span class="hljs-comment">// Percentage of screen height by sliding.</span></li><li>        let offsetPercent = (Math.abs(offset) * DetailConstants.TEN) / <span class="hljs-keyword">this</span>.screenHeight;</li><li>        <span class="hljs-keyword">this</span>.relatedVideoHeight = (<span class="hljs-keyword">this</span>.relatedVideoHeight - offsetPercent * <span class="hljs-number">169</span>) &lt;</li><li>          <span class="hljs-number">0</span> ? <span class="hljs-number">0</span> : (<span class="hljs-keyword">this</span>.relatedVideoHeight - offsetPercent * <span class="hljs-number">169</span>);</li><li>        <span class="hljs-comment">// Returns the actual offset 0.</span></li><li>        <span class="hljs-keyword">return</span> { offsetRemain: <span class="hljs-number">0</span> };</li><li>      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((offset &gt; <span class="hljs-number">0</span>) &amp;&amp; (<span class="hljs-keyword">this</span>.videoHeight &gt; <span class="hljs-number">53</span>) &amp;&amp;</li><li>        (<span class="hljs-keyword">this</span>.relatedVideoHeight === <span class="hljs-number">0</span>)) {</li><li>        <span class="hljs-comment">// Video zoom-out logic.</span></li><li>        <span class="hljs-comment">// Percentage of screen height by sliding.</span></li><li>        let offsetPercent = (Math.abs(offset) * <span class="hljs-number">100</span>) / <span class="hljs-keyword">this</span>.screenHeight;</li><li>        <span class="hljs-comment">// Video shrinkage percentage.</span></li><li>        let heightOffset = offsetPercent &lt; <span class="hljs-keyword">this</span>.videoHeight - <span class="hljs-number">53</span> ? offsetPercent : <span class="hljs-keyword">this</span>.videoHeight - <span class="hljs-number">53</span>;</li><li>        <span class="hljs-keyword">this</span>.videoHeight = <span class="hljs-keyword">this</span>.videoHeight - heightOffset;</li><li>        <span class="hljs-comment">// Returns the actual offset 0.</span></li><li>        <span class="hljs-keyword">return</span> { offsetRemain: <span class="hljs-number">0</span> };</li><li>      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((offset &gt; <span class="hljs-number">0</span>) &amp;&amp; (<span class="hljs-keyword">this</span>.videoHeight === <span class="hljs-number">53</span>) &amp;&amp; (<span class="hljs-keyword">this</span>.relatedVideoHeight === <span class="hljs-number">0</span>)) {</li><li>        <span class="hljs-keyword">return</span> { offsetRemain: offset };</li><li>      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((offset &lt; <span class="hljs-number">0</span>) &amp;&amp; (<span class="hljs-keyword">this</span>.videoHeight &lt; <span class="hljs-number">100</span>) &amp;&amp; (<span class="hljs-keyword">this</span>.relatedVideoHeight === <span class="hljs-number">0</span>)) {</li><li>        <span class="hljs-keyword">if</span> (CurrentOffsetUtil.scrollToTop(JSON.stringify(<span class="hljs-keyword">this</span>.scroller.currentOffset()))) {</li><li>          <span class="hljs-comment">// Video magnification logic.</span></li><li>          let offsetPercent = (Math.abs(offset) * <span class="hljs-number">100</span>) / <span class="hljs-keyword">this</span>.screenHeight;</li><li>          let heightOffset = offsetPercent &lt; <span class="hljs-number">100</span> - <span class="hljs-keyword">this</span>.videoHeight ? offsetPercent : <span class="hljs-number">100</span> - <span class="hljs-keyword">this</span>.videoHeight;</li><li>          <span class="hljs-keyword">this</span>.videoHeight = <span class="hljs-keyword">this</span>.videoHeight + heightOffset;</li><li>          <span class="hljs-comment">// Returns the actual offset 0.</span></li><li>          <span class="hljs-keyword">return</span> { offsetRemain: <span class="hljs-number">0</span> };</li><li>        }</li><li>        <span class="hljs-keyword">return</span> { offsetRemain: offset };</li><li>      } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> ((offset &lt; <span class="hljs-number">0</span>) &amp;&amp; (<span class="hljs-keyword">this</span>.videoHeight === <span class="hljs-number">100</span>) &amp;&amp; (<span class="hljs-keyword">this</span>.relatedVideoHeight &gt;= <span class="hljs-number">0</span>)) {</li><li>        <span class="hljs-comment">// Related list enlargement logic.</span></li><li>        <span class="hljs-comment">// Percentage of screen height by sliding.</span></li><li>        let offsetPercent = (Math.abs(offset) * DetailConstants.TEN) / <span class="hljs-keyword">this</span>.screenHeight;</li><li>        <span class="hljs-keyword">this</span>.relatedVideoHeight = (<span class="hljs-keyword">this</span>.relatedVideoHeight + offsetPercent * <span class="hljs-number">169</span>) &gt; <span class="hljs-number">169</span> ? <span class="hljs-number">169</span> :</li><li>          (<span class="hljs-keyword">this</span>.relatedVideoHeight + offsetPercent * <span class="hljs-number">169</span>);</li><li>        <span class="hljs-comment">// Returns the actual offset 0.</span></li><li>        <span class="hljs-keyword">return</span> { offsetRemain: <span class="hljs-number">0</span> };</li><li>      }</li><li>      <span class="hljs-keyword">return</span> { offsetRemain: <span class="hljs-number">0</span> };</li><li>    }</li><li>  })</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/videoDetail/src/main/ets/view/RelatedList.ets#L39-L118" target="_blank">RelatedList.ets</a></div></div></div></div> </li><li>全屏播放不旋转<p>在折叠屏展开态的设备上，点击“全屏播放”按钮，视频画面不旋转。在全屏播放页，视频画面跟随系统传感器方向自动旋转，并受控制中心的旋转开关控制。使用window.setPreferredOrientation(window.Orientation.AUTO_ROTATION_RESTRICTED)设置。首页和视频详情页在其他设备或折叠屏其他折叠态时竖屏显示，使用window.setPreferredOrientation(window.Orientation.PORTRAIT)设置。</p> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/videoDetail/src/main/ets/view/VideoDetail.ets#L56-L135" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">private</span> onWindowSizeChange: (windowSize: window.Size) =&gt; void = (windowSize: window.Size) =&gt; {</li><li>  <span class="hljs-comment">// ...</span></li><li>  <span class="hljs-keyword">if</span> (((<span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'md'</span> &amp;&amp; <span class="hljs-keyword">this</span>.currentHeightBreakpoint !== <span class="hljs-string">'sm'</span>) ||</li><li>    <span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'lg'</span>) &amp;&amp; !<span class="hljs-keyword">this</span>.isHalfFolded) {</li><li>    <span class="hljs-keyword">this</span>.windowUtil?.setMainWindowOrientation(window.Orientation.AUTO_ROTATION_RESTRICTED);</li><li>  }</li><li>  <span class="hljs-comment">// ...</span></li><li>};</li><li>
</li><li><span class="hljs-keyword">private</span> onHalfFoldedChange(): void {</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isHalfFolded) {</li><li>    <span class="hljs-keyword">this</span>.windowUtil?.setMainWindowOrientation(window.Orientation.AUTO_ROTATION_LANDSCAPE_RESTRICTED);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'md'</span> &amp;&amp; <span class="hljs-keyword">this</span>.currentHeightBreakpoint === <span class="hljs-string">'md'</span>) {</li><li>      <span class="hljs-keyword">this</span>.windowUtil?.setMainWindowOrientation(window.Orientation.AUTO_ROTATION_RESTRICTED);</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li><span class="hljs-keyword">private</span> onFullScreenChange(): void {</li><li>  <span class="hljs-comment">// Large folding screen (X series) in unfolded state and tablet state, supporting rotation &amp;&amp; large folding screen (X series) in hover state requires landscape display and does not support rotation.</span></li><li>  <span class="hljs-keyword">if</span> (((<span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'md'</span> &amp;&amp; <span class="hljs-keyword">this</span>.currentHeightBreakpoint !== <span class="hljs-string">'sm'</span>) ||</li><li>    <span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'lg'</span>) &amp;&amp; !<span class="hljs-keyword">this</span>.isHalfFolded) {</li><li>    <span class="hljs-keyword">this</span>.windowUtil?.setMainWindowOrientation(window.Orientation.AUTO_ROTATION_RESTRICTED);</li><li>  }</li><li>  <span class="hljs-comment">// Phone and large folding screen (X series) in portrait mode.</span></li><li>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'sm'</span> &amp;&amp; <span class="hljs-keyword">this</span>.currentHeightBreakpoint === <span class="hljs-string">'lg'</span>) {</li><li>    <span class="hljs-comment">// In full-screen mode, the layout is displayed in landscape mode. Otherwise, the layout is displayed in portrait mode.</span></li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isFullScreen) {</li><li>      <span class="hljs-keyword">this</span>.windowUtil?.setMainWindowOrientation(window.Orientation.AUTO_ROTATION_LANDSCAPE_RESTRICTED);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-keyword">this</span>.windowUtil?.setMainWindowOrientation(window.Orientation.PORTRAIT);</li><li>    }</li><li>  }</li><li>  <span class="hljs-comment">// When the mobile phone and large folding screen (X series) are folded in landscape mode and the playback is not in full screen mode, the vertical display layout is displayed.</span></li><li>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'md'</span> &amp;&amp; <span class="hljs-keyword">this</span>.currentHeightBreakpoint === <span class="hljs-string">'sm'</span> &amp;&amp; !<span class="hljs-keyword">this</span>.isFullScreen) {</li><li>    <span class="hljs-keyword">this</span>.windowUtil?.setMainWindowOrientation(window.Orientation.PORTRAIT);</li><li>  }</li><li>  <span class="hljs-comment">// The navigation bar is not hidden on a 2in1 device.</span></li><li>  <span class="hljs-keyword">if</span> (deviceInfo.deviceType !== <span class="hljs-string">'2in1'</span>) {</li><li>    <span class="hljs-comment">// The navigation bar is hidden in full-screen playback. Otherwise, the navigation bar is displayed.</span></li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isFullScreen) {</li><li>      <span class="hljs-keyword">this</span>.windowUtil!.disableWindowSystemBar();</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-keyword">this</span>.windowUtil!.enableWindowSystemBar();</li><li>    }</li><li>  }</li><li>}</li><li>
</li><li>aboutToAppear() {</li><li>  <span class="hljs-comment">// ...</span></li><li>  <span class="hljs-keyword">this</span>.mainWindow = <span class="hljs-keyword">this</span>.windowUtil!.getMainWindow();</li><li>  <span class="hljs-keyword">this</span>.mainWindow?.on(<span class="hljs-string">'windowSizeChange'</span>, <span class="hljs-keyword">this</span>.onWindowSizeChange);</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.currentWidthBreakpoint !== <span class="hljs-string">'sm'</span>) {</li><li>    <span class="hljs-keyword">this</span>.windowUtil!.setMainWindowOrientation(window.Orientation.AUTO_ROTATION_RESTRICTED);</li><li>  }</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/videoDetail/src/main/ets/view/VideoDetail.ets#L56-L135" target="_blank">VideoDetail.ets</a></div></div></div></div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/products/phone/src/main/ets/entryability/EntryAbility.ets#L58-L62" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">let</span> <span class="hljs-variable">windowUtil</span>: <span class="hljs-title class_">WindowUtil</span> | <span class="hljs-title class_">undefined</span> = <span class="hljs-variable">WindowUtil</span>.<span class="hljs-title function_">getInstance</span>();</li><li><span class="hljs-keyword">if</span> (<span class="hljs-variable">windowUtil</span> !== <span class="hljs-variable">undefined</span>) {</li><li>  <span class="hljs-variable">windowUtil</span>.<span class="hljs-title function_">setWindowStage</span>(<span class="hljs-variable">windowStage</span>);</li><li>  <span class="hljs-comment">// windowUtil.setMainWindowPortrait();</span></li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/products/phone/src/main/ets/entryability/EntryAbility.ets#L58-L62" target="_blank">EntryAbility.ets</a></div></div></div></div> </li></ul> <div class="tiledSection"><h3 id="section2899145416113">全屏播放页<i class="anchor-icon anchor-icon-link" anchorid="section2899145416113" tips="复制节点链接"></i></h3><p>长视频应用的全屏播放页面为用户提供沉浸式观看体验，并支持选集功能。观察该页面在不同设备上的UX设计图，可以得出以下设计建议：</p> </div> <ul><li>将全屏播放页划分为3个区域，具体如下： <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.36.1.1.1.5.1.1" valign="top" width="6.399707441945511%"><p>示意图</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.36.1.1.1.5.1.2" valign="top" width="31.14829036386908%"><p>sm</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.36.1.1.1.5.1.3" valign="top" width="32.27281038581093%"><p>md</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.36.1.1.1.5.1.4" valign="top" width="30.179191808374473%"><p>lg</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="6.399707441945511%"><p>全屏播放页</p> </td> <td class="cellrowborder" valign="top" width="31.14829036386908%"><p></p> <p><span><img height="126.57765076114434" originheight="385" originwidth="804" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163123.21829011963652101604516507137046:50001231000000:2800:7281F8F9091917FDA882E8D6BC093784DAEB327CF95F7849806CBD75C7B03FFD.png" title="点击放大" width="262.56427134759554"></span></p> </td> <td class="cellrowborder" valign="top" width="32.27281038581093%"><p></p> <p><span><img height="304.4253123922135" originheight="787" originwidth="705" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163123.02746214608609996335191197351658:50001231000000:2800:D1233A86319FA864DFAB77A83B4CB21571D5696DA934BE1911A7D579B9655CDD.png" title="点击放大" width="272.90985554946053"></span></p> </td> <td class="cellrowborder" valign="top" width="30.179191808374473%"><p></p> <p><span><img height="164.33850241157234" originheight="869" originwidth="1344" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163123.65421306292794511361859944004207:50001231000000:2800:11C45FF47F198820A9959224E3AB36CE2B94A66BFB352874F549357BF66E1D06.png" title="点击放大" width="253.64856463704518"></span></p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="6.399707441945511%"><p>全屏播放选集页</p> </td> <td class="cellrowborder" valign="top" width="31.14829036386908%"><p></p> <p><span><img height="126.57765076114434" originheight="385" originwidth="804" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163123.90775159490070523002378360882532:50001231000000:2800:7AF5DD34F9C4C7D7954204506AD33E3FE5F4AF3CAFF2A815FB82DECF00BE8C81.png" title="点击放大" width="262.56427134759554"></span></p> </td> <td class="cellrowborder" valign="top" width="32.27281038581093%"><p></p> <p><span><img height="304.4253123922135" originheight="787" originwidth="705" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163124.10060756768677764514779785947658:50001231000000:2800:8387494EA507BB420C0F77479E52F59A11312DE548C1EBB77CB335EBAE0AD53A.png" title="点击放大" width="272.90985554946053"></span></p> </td> <td class="cellrowborder" valign="top" width="30.179191808374473%"><p></p> <p><span><img height="164.33850241157234" originheight="869" originwidth="1344" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163124.63749127591513642069417662336583:50001231000000:2800:904B634B2D454EB88FDEB698A6119695F5854FC3362946B0528EC5EE873D3E54.png" title="点击放大" width="253.64856463704518"></span></p> </td> </tr>  </tbody></table></div> </div> </li><li>整个页面通过栅格组件监听不同断点变化，实现响应式适配和布局效果。</li><li>全屏播放页中，区域1和区域2占满屏幕。点击选集时，弹出区域3。当区域2中的容器组件尺寸变化时，增加或减少的空间全部分配给进度条和下方工具栏的空白区域。</li><li>全屏播放页区域3在不同断点下显示位置和大小不同。在sm断点下显示在右侧，视频与侧边栏比例为3:2；在md断点下显示在底部，视频与底部栏比例为1:1；在lg断点下显示在右侧，侧边栏宽度为固定值360vp。</li></ul> <p>长视频应用全屏播放页的3个基础区域介绍及实现方案见下表：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.38.1.4.1.1" valign="top" width="6.6325563767292035%"><p>区域编号</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.38.1.4.1.2" valign="top" width="10.820541974606785%"><p>简介</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.38.1.4.1.3" valign="top" width="82.54690164866402%"><p>实现方案</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="6.6325563767292035%"><p>1</p> </td> <td class="cellrowborder" valign="top" width="10.820541974606785%"><p><a href="/consumer/cn/doc/best-practices/multi-video-app#li94810114559">全屏视频播放</a></p> </td> <td class="cellrowborder" valign="top" width="82.54690164866402%"><p>使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-window" target="_blank">window窗口</a>管理窗口隐藏状态栏和导航栏，在sm断点下控制窗口横屏显示，在md、lg上不改变窗口显示方向。视频播放使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-media-avplayer" target="_blank">AVPlayer</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-basic-components-xcomponent" target="_blank">XComponent</a>等相关组件，不详细介绍具体功能实现，开发者可以自行查看代码。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="6.6325563767292035%"><p>2</p> </td> <td class="cellrowborder" valign="top" width="10.820541974606785%"><p>进度条及工具栏</p> </td> <td class="cellrowborder" valign="top" width="82.54690164866402%"><p>进度条使用layoutWeight、工具栏的空白区域使用Blank实现自适应布局的拉伸能力，同<a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li1346175796">首页搜索框</a>。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="6.6325563767292035%"><p>3</p> </td> <td class="cellrowborder" valign="top" width="10.820541974606785%"><p>选集列表</p> </td> <td class="cellrowborder" valign="top" width="82.54690164866402%"><p>选集列表通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-list" target="_blank">List组件</a>实现延伸能力，同<a href="/consumer/cn/doc/best-practices/multi-video-app#zh-cn_topic_0000001744653537_li311217374149">搜索页搜索发现</a>。</p> </td> </tr>  </tbody></table></div> </div> <p>在实际开发中，区域1-2和区域3是并列的视频播放页内容，因此开发顺序为区域1-2和区域3。为了提升用户使用体验，全屏播放页在折叠屏的半折叠状态下设计了视频悬停播放功能。</p> <ul><li id="li94810114559"><a name="ZH-CN_TOPIC_0000002490707096__li94810114559"></a><a name="li94810114559"></a>全屏视频播放<p><a name="ZH-CN_TOPIC_0000002490707096__li94810114559"></a><a name="li94810114559"></a>进入全屏播放页，使用setWindowSystemBarEnable()方法隐藏顶部导航栏和状态栏，并使用setMainWindowOrientation()方法在手机和折叠屏折叠态下设置窗口横屏播放。</p> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/videoDetail/src/main/ets/view/VideoDetail.ets#L94-L122" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">private</span> onFullScreenChange(): void {</li><li>  <span class="hljs-comment">// Large folding screen (X series) in unfolded state and tablet state, supporting rotation &amp;&amp; large folding screen (X series) in hover state requires landscape display and does not support rotation.</span></li><li>  <span class="hljs-keyword">if</span> (((<span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'md'</span> &amp;&amp; <span class="hljs-keyword">this</span>.currentHeightBreakpoint !== <span class="hljs-string">'sm'</span>) ||</li><li>    <span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'lg'</span>) &amp;&amp; !<span class="hljs-keyword">this</span>.isHalfFolded) {</li><li>    <span class="hljs-keyword">this</span>.windowUtil?.setMainWindowOrientation(window.Orientation.AUTO_ROTATION_RESTRICTED);</li><li>  }</li><li>  <span class="hljs-comment">// Phone and large folding screen (X series) in portrait mode.</span></li><li>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'sm'</span> &amp;&amp; <span class="hljs-keyword">this</span>.currentHeightBreakpoint === <span class="hljs-string">'lg'</span>) {</li><li>    <span class="hljs-comment">// In full-screen mode, the layout is displayed in landscape mode. Otherwise, the layout is displayed in portrait mode.</span></li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isFullScreen) {</li><li>      <span class="hljs-keyword">this</span>.windowUtil?.setMainWindowOrientation(window.Orientation.AUTO_ROTATION_LANDSCAPE_RESTRICTED);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-keyword">this</span>.windowUtil?.setMainWindowOrientation(window.Orientation.PORTRAIT);</li><li>    }</li><li>  }</li><li>  <span class="hljs-comment">// When the mobile phone and large folding screen (X series) are folded in landscape mode and the playback is not in full screen mode, the vertical display layout is displayed.</span></li><li>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'md'</span> &amp;&amp; <span class="hljs-keyword">this</span>.currentHeightBreakpoint === <span class="hljs-string">'sm'</span> &amp;&amp; !<span class="hljs-keyword">this</span>.isFullScreen) {</li><li>    <span class="hljs-keyword">this</span>.windowUtil?.setMainWindowOrientation(window.Orientation.PORTRAIT);</li><li>  }</li><li>  <span class="hljs-comment">// The navigation bar is not hidden on a 2in1 device.</span></li><li>  <span class="hljs-keyword">if</span> (deviceInfo.deviceType !== <span class="hljs-string">'2in1'</span>) {</li><li>    <span class="hljs-comment">// The navigation bar is hidden in full-screen playback. Otherwise, the navigation bar is displayed.</span></li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isFullScreen) {</li><li>      <span class="hljs-keyword">this</span>.windowUtil!.disableWindowSystemBar();</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-keyword">this</span>.windowUtil!.enableWindowSystemBar();</li><li>    }</li><li>  }</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/videoDetail/src/main/ets/view/VideoDetail.ets#L94-L122" target="_blank">VideoDetail.ets</a></div></div></div></div> </li></ul> <ul><li id="li96815962218"><a name="ZH-CN_TOPIC_0000002490707096__li96815962218"></a><a name="li96815962218"></a>视频悬停播放<p><a name="ZH-CN_TOPIC_0000002490707096__li96815962218"></a><a name="li96815962218"></a>在折叠屏上浏览视频详情页或全屏播放页时，旋转设备至横屏并折叠设备至半折叠态，将自动切换至悬停态的沉浸播放视频体验。折叠屏悬停适配通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/arkts-apis-window-window" target="_blank">window</a>的setPreferredOrientation接口设置窗口横向显示，通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/js-apis-display" target="_blank">display</a>的getCurrentFoldCreaseRegion接口获取折叠屏折痕区域的位置和大小，通过自定义方式实现悬停态页面。视频移到上半屏，中间为折叠屏避让区，其他可操作组件堆叠到下半屏。示意图如下：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.41.1.2.1.2.1.1" valign="top" width="100%"><p>md</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="100%"><p><span><img height="331.98130000000003" originheight="355" originwidth="512" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163124.51048363550985283807420055885072:50001231000000:2800:17FE2ADC93B4CADFB6F5CF9445500BCEC7E551A3B2B526629015336BE6752FC3.png" title="点击放大" width="478.8"></span></p> </td> </tr>  </tbody></table></div> </div> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>更多悬停态页面的开发方式，请参考<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-folded-hover" target="_blank">折叠屏悬停态</a>。</p> </div></div></div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/commons/base/src/main/ets/utils/DisplayUtil.ets#L21-L39" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DisplayUtil</span> {</li><li>  <span class="hljs-keyword">static</span> <span class="hljs-title function_">getFoldCreaseRegion</span>(<span class="hljs-variable">uiContext</span>: <span class="hljs-title class_">UIContext</span>): <span class="hljs-title class_">void</span> {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-title function_">canIUse</span>(<span class="hljs-string">'SystemCapability.Window.SessionManager'</span>)) {</li><li>      <span class="hljs-keyword">try</span> {</li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-variable">display</span>.<span class="hljs-title function_">isFoldable</span>()) {</li><li>          <span class="hljs-keyword">let</span> <span class="hljs-variable">foldRegion</span>: <span class="hljs-title class_">display</span>.<span class="hljs-title class_">FoldCreaseRegion</span> = <span class="hljs-variable">display</span>.<span class="hljs-title function_">getCurrentFoldCreaseRegion</span>();</li><li>          <span class="hljs-keyword">let</span> <span class="hljs-variable">rect</span>: <span class="hljs-title class_">display</span>.<span class="hljs-title class_">Rect</span> = <span class="hljs-variable">foldRegion</span>.<span class="hljs-variable">creaseRects</span>[<span class="hljs-number">0</span>];</li><li>          <span class="hljs-comment">// Height of the avoidance area in the upper half screen and height of the avoidance area.</span></li><li>          <span class="hljs-keyword">let</span> <span class="hljs-variable">creaseRegion</span>: <span class="hljs-title class_">number</span>[] = [<span class="hljs-variable">uiContext</span>!.<span class="hljs-title function_">px2vp</span>(<span class="hljs-variable">rect</span>.<span class="hljs-variable">top</span>), <span class="hljs-variable">uiContext</span>!.<span class="hljs-title function_">px2vp</span>(<span class="hljs-variable">rect</span>.<span class="hljs-variable">height</span>)];</li><li>          <span class="hljs-variable">AppStorage</span>.<span class="hljs-title function_">setOrCreate</span>(<span class="hljs-string">'creaseRegion'</span>, <span class="hljs-variable">creaseRegion</span>);</li><li>        }</li><li>      } <span class="hljs-keyword">catch</span> (<span class="hljs-variable">error</span>) {</li><li>        <span class="hljs-keyword">let</span> <span class="hljs-variable">err</span> = <span class="hljs-variable">error</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">BusinessError</span>;</li><li>        <span class="hljs-variable">hilog</span>.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x00</span>, <span class="hljs-string">'DisplayUtil'</span>, `<span class="hljs-variable">geetIsFoldable</span> <span class="hljs-variable">failed</span>, <span class="hljs-variable">code</span> = ${<span class="hljs-variable">err</span>.<span class="hljs-variable">code</span>}, <span class="hljs-variable">message</span> = ${<span class="hljs-variable">err</span>.<span class="hljs-variable">message</span>}`);</li><li>      }</li><li>    }</li><li>  }</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/commons/base/src/main/ets/utils/DisplayUtil.ets#L21-L39" target="_blank">DisplayUtil.ets</a></div></div></div></div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/videoDetail/src/main/ets/view/VideoDetail.ets#L94-L122" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">private</span> onFullScreenChange(): void {</li><li>  <span class="hljs-comment">// Large folding screen (X series) in unfolded state and tablet state, supporting rotation &amp;&amp; large folding screen (X series) in hover state requires landscape display and does not support rotation.</span></li><li>  <span class="hljs-keyword">if</span> (((<span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'md'</span> &amp;&amp; <span class="hljs-keyword">this</span>.currentHeightBreakpoint !== <span class="hljs-string">'sm'</span>) ||</li><li>    <span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'lg'</span>) &amp;&amp; !<span class="hljs-keyword">this</span>.isHalfFolded) {</li><li>    <span class="hljs-keyword">this</span>.windowUtil?.setMainWindowOrientation(window.Orientation.AUTO_ROTATION_RESTRICTED);</li><li>  }</li><li>  <span class="hljs-comment">// Phone and large folding screen (X series) in portrait mode.</span></li><li>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'sm'</span> &amp;&amp; <span class="hljs-keyword">this</span>.currentHeightBreakpoint === <span class="hljs-string">'lg'</span>) {</li><li>    <span class="hljs-comment">// In full-screen mode, the layout is displayed in landscape mode. Otherwise, the layout is displayed in portrait mode.</span></li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isFullScreen) {</li><li>      <span class="hljs-keyword">this</span>.windowUtil?.setMainWindowOrientation(window.Orientation.AUTO_ROTATION_LANDSCAPE_RESTRICTED);</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-keyword">this</span>.windowUtil?.setMainWindowOrientation(window.Orientation.PORTRAIT);</li><li>    }</li><li>  }</li><li>  <span class="hljs-comment">// When the mobile phone and large folding screen (X series) are folded in landscape mode and the playback is not in full screen mode, the vertical display layout is displayed.</span></li><li>  <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'md'</span> &amp;&amp; <span class="hljs-keyword">this</span>.currentHeightBreakpoint === <span class="hljs-string">'sm'</span> &amp;&amp; !<span class="hljs-keyword">this</span>.isFullScreen) {</li><li>    <span class="hljs-keyword">this</span>.windowUtil?.setMainWindowOrientation(window.Orientation.PORTRAIT);</li><li>  }</li><li>  <span class="hljs-comment">// The navigation bar is not hidden on a 2in1 device.</span></li><li>  <span class="hljs-keyword">if</span> (deviceInfo.deviceType !== <span class="hljs-string">'2in1'</span>) {</li><li>    <span class="hljs-comment">// The navigation bar is hidden in full-screen playback. Otherwise, the navigation bar is displayed.</span></li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isFullScreen) {</li><li>      <span class="hljs-keyword">this</span>.windowUtil!.disableWindowSystemBar();</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-keyword">this</span>.windowUtil!.enableWindowSystemBar();</li><li>    }</li><li>  }</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/videoDetail/src/main/ets/view/VideoDetail.ets#L94-L122" target="_blank">VideoDetail.ets</a></div></div></div></div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/videoDetail/src/main/ets/view/VideoPlayer.ets#L84-L303" data-highlighted="yes"><ol class="linenums"><li>Stack({ alignContent: <span class="hljs-keyword">this</span>.isFullScreen ? Alignment.Center : Alignment.Bottom }) {</li><li>  Flex({</li><li>    <span class="hljs-comment">// ...</span></li><li>  }) {</li><li>    Column() {</li><li>      <span class="hljs-comment">// ...</span></li><li>    }</li><li>    .justifyContent(FlexAlign.Center)</li><li>    .height(<span class="hljs-keyword">this</span>.isHalfFolded ? <span class="hljs-keyword">this</span>.creaseRegion[<span class="hljs-number">0</span>] : (<span class="hljs-keyword">this</span>.isFullScreen ? <span class="hljs-string">'100%'</span> : <span class="hljs-string">'auto'</span>))</li><li>    .width(<span class="hljs-string">'100%'</span>)</li><li>
</li><li>  }</li><li>  .width(<span class="hljs-string">'100%'</span>)</li><li>  .onClick(() =&gt; {</li><li>    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isShowingSideBar) {</li><li>      <span class="hljs-keyword">this</span>.isShowingSideBar = <span class="hljs-literal">false</span>;</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-keyword">this</span>.avPlayerUtil?.playerStateControl();</li><li>    }</li><li>  })</li><li>  .priorityGesture(</li><li>    TapGesture({ count: <span class="hljs-number">2</span> })</li><li>      .onAction((event: GestureEvent) =&gt; {</li><li>        <span class="hljs-keyword">if</span> (event &amp;&amp; deviceInfo.deviceType === <span class="hljs-string">'2in1'</span>) {</li><li>          <span class="hljs-keyword">this</span>.isFullScreen = <span class="hljs-literal">true</span>;</li><li>          <span class="hljs-keyword">this</span>.windowUtil!.maximize();</li><li>        }</li><li>      })</li><li>  )</li><li>
</li><li>  Column() {</li><li>    <span class="hljs-comment">// ...</span></li><li>  }</li><li>  .height(<span class="hljs-keyword">this</span>.isFullScreen ? <span class="hljs-string">'100%'</span> : <span class="hljs-string">'auto'</span>)</li><li>  .width(<span class="hljs-string">'100%'</span>)</li><li>  .justifyContent(FlexAlign.End)</li><li>  .visibility(<span class="hljs-keyword">this</span>.isFullScreen &amp;&amp; !<span class="hljs-keyword">this</span>.isShowingSideBar ? Visibility.Visible : Visibility.None)</li><li>  .priorityGesture(</li><li>    TapGesture({ count: <span class="hljs-number">2</span> })</li><li>      .onAction((event: GestureEvent) =&gt; {</li><li>        <span class="hljs-keyword">if</span> (event &amp;&amp; deviceInfo.deviceType === <span class="hljs-string">'2in1'</span>) {</li><li>          <span class="hljs-keyword">this</span>.windowUtil!.maximize();</li><li>          <span class="hljs-keyword">this</span>.windowUtil!.recover();</li><li>        }</li><li>      })</li><li>  )</li><li>
</li><li>  <span class="hljs-comment">// ...</span></li><li>  Image($r(<span class="hljs-string">'app.media.ic_public_back'</span>))</li><li>    .height(<span class="hljs-string">'24vp'</span>)</li><li>    .width(<span class="hljs-string">'24vp'</span>)</li><li>    .position({</li><li>      x: <span class="hljs-keyword">this</span>.currentWidthBreakpoint === <span class="hljs-string">'lg'</span> ? <span class="hljs-string">'24vp'</span> : <span class="hljs-string">'32vp'</span>,</li><li>      y: $r(<span class="hljs-string">'app.float.back_position_y'</span>)</li><li>    })</li><li>    .fillColor(Color.White)</li><li>    .onClick(() =&gt; {</li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isHalfFolded) {</li><li>        <span class="hljs-keyword">this</span>.isHalfFolded = <span class="hljs-literal">false</span>;</li><li>      }</li><li>      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isFullScreen) {</li><li>        <span class="hljs-keyword">this</span>.isFullScreen = <span class="hljs-literal">false</span>;</li><li>      } <span class="hljs-keyword">else</span> {</li><li>        <span class="hljs-keyword">this</span>.pageInfo.setPageName(<span class="hljs-string">'home'</span>);</li><li>        <span class="hljs-keyword">this</span>.pageInfo.pop();</li><li>      }</li><li>    })</li><li>}</li><li>.height(<span class="hljs-string">'auto'</span>)</li><li>.layoutWeight(<span class="hljs-keyword">this</span>.isFullScreen ? <span class="hljs-number">1</span> : <span class="hljs-number">0</span>)</li><li>.width(<span class="hljs-string">'100%'</span>)</li><li>.backgroundColor(Color.Black)</li><li>.focusable(<span class="hljs-literal">false</span>)</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/videoDetail/src/main/ets/view/VideoPlayer.ets#L84-L303" target="_blank">VideoPlayer.ets</a></div></div></div></div> </li></ul> <div class="tiledSection"><h3 id="section3198710114717">交互开发<i class="anchor-icon anchor-icon-link" anchorid="section3198710114717" tips="复制节点链接"></i></h3><p><strong>交互事件归一</strong></p> <p>不同类型的智能设备，系统已经针对不同的交互方式做了适配，实现了<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-multi-interaction" target="_blank">多设备交互</a>，因此开发者无需额外关注用户不同的交互方式。长视频应用包含的基础输入方式如下（以鼠标为例）：</p>  <div class="tablenoborder"><div class="tbBox"><table class="layoutFixed idpTab"><thead><tr><th align="left" class="cellrowborder" id="mcps1.3.42.4.1.3.1.1" valign="top" width="20.05%"><p>事件</p> </th> <th align="left" class="cellrowborder" id="mcps1.3.42.4.1.3.1.2" valign="top" width="79.95%"><p>应用支持的鼠标交互</p> </th> </tr> </thead> <tbody><tr><td class="cellrowborder" valign="top" width="20.05%"><p>点击</p> </td> <td class="cellrowborder" valign="top" width="79.95%"><p>在Tabs、TextInput等组件上点击左键。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="20.05%"><p>长按</p> </td> <td class="cellrowborder" valign="top" width="79.95%"><p>在首页首个推荐视频上长按左键预览视频。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="20.05%"><p>拖拽</p> </td> <td class="cellrowborder" valign="top" width="79.95%"><p>在视频详情页右侧边栏上按压左键并移动鼠标，改变侧边栏的宽度。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="20.05%"><p>滚动/平移</p> </td> <td class="cellrowborder" valign="top" width="79.95%"><p>在List和Scroll组件中上下滚动滚轮，实现。</p> </td> </tr> <tr><td class="cellrowborder" valign="top" width="20.05%"><p>缩放</p> </td> <td class="cellrowborder" valign="top" width="79.95%"><p>在首页推荐视频区域中Ctrl+滚动滚轮控制宫格布局的缩放。</p> </td> </tr>  </tbody></table></div> </div> <p><strong>键盘走焦</strong></p> <p>在PC/2in1设备的应用首页，按Tab键使当前应用处于焦点激活态，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-common-events-focus-event#设置组件是否可获焦" target="_blank">默认可获焦的组件</a>遵循走焦规范。按住Tab键焦点依次从顶部页签、搜索栏、Banner图、图标列表直到走完整个主页的所有容器组件。Shift+Tab键则是与按Tab键相反的焦点移动效果。容器组件间可以使用Tab键跳跃焦点，容器组件中的元素，可以通过方向键（上、下、左、右），遵循十字型移动策略，在单层容器组件中移动，以获得更为灵活的走焦控制。</p> </div> <div class="tiledSection"><h3 id="section208330326545">资源使用<i class="anchor-icon anchor-icon-link" anchorid="section208330326545" tips="复制节点链接"></i></h3><p>本节以长视频应用为例，根据具体的资源使用情况，给出多设备应用开发中推荐的资源使用方式。</p> <p>在长视频应用中，多端页面显示的效果不同，组件的宽高、间距等资源值会随横向断点变化，推荐使用BreakpointType类，通过getValue()方法获取。在使用时，创建不同的资源值传入BreakpointType代表sm、md和lg横向断点下的组件宽高或字体大小等，实现应用窗口大小变化时的不同效果。</p> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/commons/base/src/main/ets/utils/BreakpointType.ets#L23-L46" data-highlighted="yes"><ol class="linenums"><li>export <span class="hljs-keyword">class</span> <span class="hljs-title class_">BreakpointType</span>&lt;<span class="hljs-type">T</span>&gt; {</li><li>  sm: T;</li><li>  md: T;</li><li>  lg: T;</li><li>
</li><li>  <span class="hljs-keyword">constructor</span>(sm: T, md: T, lg: T) {</li><li>    <span class="hljs-keyword">this</span>.sm = sm;</li><li>    <span class="hljs-keyword">this</span>.md = md;</li><li>    <span class="hljs-keyword">this</span>.lg = lg;</li><li>  }</li><li>
</li><li>  getValue(currentWidthBreakpoint: string): T {</li><li>    <span class="hljs-keyword">if</span> (currentWidthBreakpoint === <span class="hljs-string">'md'</span>) {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.md;</li><li>    }</li><li>    <span class="hljs-keyword">if</span> (currentWidthBreakpoint === <span class="hljs-string">'lg'</span>) {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.lg;</li><li>    } <span class="hljs-keyword">else</span> {</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.sm;</li><li>    }</li><li>  }</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/commons/base/src/main/ets/utils/BreakpointType.ets#L23-L46" target="_blank">BreakpointType.ets</a></div></div></div></div> <div class="screenLinkPre"><div _ngcontent-ape-c106="" class="highlight-div"><div _ngcontent-ape-c106="" class="highlight-div-header"><div _ngcontent-ape-c106="" class="highlight-div-header-left"><div _ngcontent-ape-c106="" class="handle-button expand-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ape-c106="" class="highlight-div-header-right"><div _ngcontent-ape-c106="" class="handle-button ai-button"></div><div _ngcontent-ape-c106="" class="handle-button line-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ape-c106="" class="handle-button theme-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ape-c106="" class="handle-button copy-button"><div _ngcontent-ape-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ape-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-less" codehub="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/DailyVideo.ets#L88-L91" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-selector-tag">Image</span>($<span class="hljs-built_in">r</span>(<span class="hljs-string">'app.media.daily_small_video'</span>))</li><li>  <span class="hljs-selector-class">.height</span>(new <span class="hljs-built_in">BreakpointType</span>(<span class="hljs-string">'40vp'</span>, <span class="hljs-string">'44vp'</span>, <span class="hljs-string">'68vp'</span>).<span class="hljs-built_in">getValue</span>(this.currentWidthBreakpoint))</li><li>  <span class="hljs-selector-class">.width</span>(new <span class="hljs-built_in">BreakpointType</span>(<span class="hljs-string">'76vp'</span>, <span class="hljs-string">'84vp'</span>, <span class="hljs-string">'129vp'</span>).<span class="hljs-built_in">getValue</span>(this.currentWidthBreakpoint))</li><li>  <span class="hljs-selector-class">.borderRadius</span>(<span class="hljs-string">'8vp'</span>)</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication/blob/master/features/home/src/main/ets/view/DailyVideo.ets#L88-L91" target="_blank">DailyVideo.ets</a></div></div></div></div> </div> <div class="tiledSection"><h2 id="section1288911441542">功能开发<i class="anchor-icon anchor-icon-link" anchorid="section1288911441542" tips="复制节点链接"></i></h2><p>本示例的目标运行设备手机、折叠屏和PC/2in1运行的都是标准系统，其系统能力一致，所以无需考虑<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-multi-device-function" target="_blank">多设备功能开发</a>的差异。</p> </div> <div class="tiledSection"><h2 id="section17518914552">总结<i class="anchor-icon anchor-icon-link" anchorid="section17518914552" tips="复制节点链接"></i></h2><p>本文针对长视频应用的沉浸式核心场景，从UX设计、工程管理、页面开发和功能开发四个角度，结合具体能力，提供开发中的推荐参考样例。同时，针对开发者在长视频应用开发中常见的痛点和难点问题，提供详细的解决方案，实现最佳实践，帮助开发者快速适配多种设备，减少多端开发的工作量，高效构建应用。</p> </div> <div class="tiledSection"><h2 id="section18854194463114">示例代码<i class="anchor-icon anchor-icon-link" anchorid="section18854194463114" tips="复制节点链接"></i></h2><ul><li><a href="https://gitee.com/harmonyos_codelabs/MultiVideoApplication" target="_blank">多设备长视频界面</a></li></ul> </div> </div> <div></div></div>