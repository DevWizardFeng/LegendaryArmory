<h1 _ngcontent-ydj-c119="" class="doc-title ng-star-inserted" title="应用冻屏问题排查方法"> 应用冻屏问题排查方法 </h1>

<div _ngcontent-ydj-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div><div class="hw-editor-tip warn"><div class="title">注意</div><div class="content"><p>应用冻屏日志获取方法与日志规格详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/appfreeze-guidelines#日志获取" target="_blank">日志获取</a>和<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/appfreeze-guidelines#日志规格" target="_blank">日志规格</a>。</p> </div></div></div> <div class="tiledSection"><h2 id="section1950514261110">定位步骤与思路<i class="anchor-icon anchor-icon-link" anchorid="section1950514261110" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section983417955515" class="firsth2">获取日志<i class="anchor-icon anchor-icon-link" anchorid="section983417955515" tips="复制节点链接"></i></h3></div> <p>应用冻屏（AppFreeze）日志是一种故障日志，与Native进程崩溃、JS应用崩溃、系统进程异常等都由FaultLog模块管理，可通过以下方式获取日志：</p> <p>方式一：通过DevEco Studio获取日志</p> <p>DevEco Studio会收集设备的故障日志并归档到FaultLog下。具体可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-fault-log" target="_blank">FaultLog</a>。</p> <p>方式二：通过hiappevent获取</p> <p>hiappevent对外提供订阅系统卡死事件，可以查询卡死事件信息，详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/hiappevent-watcher-freeze-events" target="_blank">应用冻屏事件介绍</a>。</p> <p>方式三：通过shell获取日志</p> <p>应用冻屏日志是以appfreeze-开头，生成在设备“/data/log/faultlog/faultlogger/”路径下。该日志文件名格式为“appfreeze-应用包名-应用UID-毫秒级时间”。</p> <div class="tiledSection"><h3 id="section1284082545513">查看基本信息<i class="anchor-icon anchor-icon-link" anchorid="section1284082545513" tips="复制节点链接"></i></h3><ol><li>进程号<p>故障日志中搜索“Pid”可获得。</p> <p>根据进程号可以查找对应进程的栈信息、在流水日志中过滤出对应进程的日志输出等。</p> </li><li>故障类型<p>故障日志中搜索“Reason”可获得。</p> <p>根据故障类型可以参考对应类型的检测原理和故障检测时长。</p> </li><li>故障上报时间点<p>故障日志中搜索“Fault time”可获得。</p> <p>请注意日志中多处“TIMESTAMP”字段的含义，代表着故障形成过程中中间重要节点的时间，正常场景下与故障上报时间点接近，但是特殊的，当故障形成时由于种种系统原因导致阻塞，可能存在一定的时间误差。</p> <p>而“Fault time”字段最接近故障上报时间点。</p> </li><li>前后台信息<p>故障日志中搜索“Foreground”可获得。</p> <p>该字段表示应用发生故障时所处前后台状态。</p> <p>值得注意的是，APP_INPUT_BLOCK 用户输入响应超时，事件能够分发到应用上，所以应用必为前台状态。</p> </li><li>故障检测时长<p>该信息可从故障类型和前后台信息推理得出。</p> <p>对于THREAD_BLOCK_6S事件，当应用处于前台时，检测时长为6s；当应用处在后台时，由于不直接与用户交互，其对主线程阻塞判断有所放宽，其故障检测时长为21s。</p> <p>对于LIFECYCLE_TIMEOUT事件，可以从MSG的reason部分获取是哪种生命周期超时，参照表格获取其对应的故障检测时长。</p> </li><li>故障检测时间区间<p>该信息可从故障上报时间点和故障检测时长推理得出。通过故障时间点往前推故障检测时长可得到故障发生的具体时间。</p> <p>区间为：【故障上报时间点 - 故障检测时长，故障上报时间点】</p> </li></ol> </div> <div class="tiledSection"><h3 id="section190014865618">查看eventHandler信息<i class="anchor-icon anchor-icon-link" anchorid="section190014865618" tips="复制节点链接"></i></h3></div> <ol><li>EventHandler dump begin curTime &amp; Current Running<div _ngcontent-ydj-c106="" class="highlight-div"><div _ngcontent-ydj-c106="" class="highlight-div-header"><div _ngcontent-ydj-c106="" class="highlight-div-header-left"><div _ngcontent-ydj-c106="" class="handle-button expand-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ydj-c106="" class="highlight-div-header-right"><div _ngcontent-ydj-c106="" class="handle-button ai-button"></div><div _ngcontent-ydj-c106="" class="handle-button line-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ydj-c106="" class="handle-button theme-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ydj-c106="" class="handle-button copy-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ydj-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">mainHandler</span> <span class="hljs-variable">dump</span> <span class="hljs-keyword">is</span>:</li><li><span class="hljs-variable">EventHandler</span> <span class="hljs-variable">dump</span> <span class="hljs-variable">begin</span> <span class="hljs-variable">curTime</span>: <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">43.544</span>         -&gt; <span class="hljs-title class_">开始</span> <span class="hljs-title class_">dump</span> <span class="hljs-title class_">时间</span></li><li><span class="hljs-variable">Event</span> <span class="hljs-variable">runner</span> (<span class="hljs-variable">Thread</span> <span class="hljs-variable">name</span> = , <span class="hljs-variable">Thread</span> <span class="hljs-variable">ID</span> = <span class="hljs-number">35854</span>) <span class="hljs-keyword">is</span> <span class="hljs-variable">running</span></li><li><span class="hljs-variable">Current</span> <span class="hljs-variable">Running</span>: <span class="hljs-title class_">start</span> <span class="hljs-title class_">at</span> <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">16.629</span>, <span class="hljs-variable">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">35882</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">16.628</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">16.629</span>, <span class="hljs-variable">trigger</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">16.630</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = , <span class="hljs-variable">caller</span> = <span class="hljs-variable">xxx</span>  }</li><li>-&gt; <span class="hljs-title class_">trigger</span> <span class="hljs-title class_">time</span>：<span class="hljs-title class_">任务开始运行的时间</span></li></ol></pre></div></div> <p>当前任务已运行时长 = dump begin curTime - trigger time，如示例中当前任务运行达到27s</p> <p>若时间差 &gt; 故障检测时长，表示当前正在运行的任务即是导致应用卡死的任务，需排查该任务运行情况。</p> <p>若时间差较小，表示当前任务仅是检测时间区间内主线程运行的任务之一，主要耗时不一定是本任务，需排查近期运行的任务中耗时较长者。该情形多为线程繁忙导致的watchdog无法调度执行。</p> </li><li>History event queue information<div _ngcontent-ydj-c106="" class="highlight-div"><div _ngcontent-ydj-c106="" class="highlight-div-header"><div _ngcontent-ydj-c106="" class="highlight-div-header-left"><div _ngcontent-ydj-c106="" class="handle-button expand-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ydj-c106="" class="highlight-div-header-right"><div _ngcontent-ydj-c106="" class="handle-button ai-button"></div><div _ngcontent-ydj-c106="" class="handle-button line-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ydj-c106="" class="handle-button theme-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ydj-c106="" class="handle-button copy-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ydj-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">Current</span> <span class="hljs-variable">Running</span>: <span class="hljs-title class_">start</span> <span class="hljs-title class_">at</span> <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">16.629</span>, <span class="hljs-variable">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">35882</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">16.628</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">16.629</span>, <span class="hljs-variable">trigger</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">16.630</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = , <span class="hljs-variable">caller</span> = [<span class="hljs-variable">extension_ability_thread</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">ScheduleAbilityTransaction</span>:<span class="hljs-number">393</span>)] }</li><li><span class="hljs-variable">History</span> <span class="hljs-variable">event</span> <span class="hljs-variable">queue</span> <span class="hljs-variable">information</span>:</li><li><span class="hljs-variable">No</span>. <span class="hljs-number">0</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">35854</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">15.525</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">15.525</span>, <span class="hljs-variable">trigger</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">15.527</span>, <span class="hljs-variable">completeTime</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">15.528</span>, <span class="hljs-variable">priority</span> = <span class="hljs-variable">High</span>, <span class="hljs-variable">id</span> = <span class="hljs-number">1</span> }</li><li><span class="hljs-variable">No</span>. <span class="hljs-number">1</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">35854</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">15.525</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">15.525</span>, <span class="hljs-variable">trigger</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">15.527</span>, <span class="hljs-variable">completeTime</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">15.527</span>, <span class="hljs-variable">priority</span> = <span class="hljs-variable">Low</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">MainThread</span>:<span class="hljs-title class_">SetRunnerStarted</span> }</li><li><span class="hljs-variable">No</span>. <span class="hljs-number">2</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">35856</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">15.765</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">15.765</span>, <span class="hljs-variable">trigger</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">15.766</span>, <span class="hljs-variable">completeTime</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">15.800</span>, <span class="hljs-variable">priority</span> = <span class="hljs-variable">Low</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">MainThread</span>:<span class="hljs-title class_">LaunchApplication</span> }</li><li><span class="hljs-variable">No</span>. <span class="hljs-number">3</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">35856</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">15.767</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">15.767</span>, <span class="hljs-variable">trigger</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">15.800</span>, <span class="hljs-variable">completeTime</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">16.629</span>, <span class="hljs-variable">priority</span> = <span class="hljs-variable">Low</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">MainThread</span>:<span class="hljs-title class_">LaunchAbility</span> }</li><li><span class="hljs-variable">No</span>. <span class="hljs-number">4</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">35854</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">15.794</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">15.794</span>, <span class="hljs-variable">trigger</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">16.629</span>, <span class="hljs-variable">completeTime</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">16.629</span>, <span class="hljs-variable">priority</span> = <span class="hljs-variable">IDEL</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">IdleTime</span>:<span class="hljs-title class_">PostTask</span> }</li><li><span class="hljs-variable">No</span>. <span class="hljs-number">5</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">35882</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">16.629</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">16.629</span>, <span class="hljs-variable">trigger</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">16.629</span>, <span class="hljs-variable">completeTime</span> <span class="hljs-variable">time</span> = , <span class="hljs-variable">priority</span> = <span class="hljs-variable">Low</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> =  }</li></ol></pre></div></div> <p>可以从历史任务队列中寻找故障发生时间区间内较为耗时的任务。其中completeTime time为空的任务即是当前任务。</p> <p>任务运行耗时 = completeTime time - trigger time</p> <p>筛选出耗时较高的任务，排查其运行情况。</p> </li><li>VIP priority event queue information<div _ngcontent-ydj-c106="" class="highlight-div"><div _ngcontent-ydj-c106="" class="highlight-div-header"><div _ngcontent-ydj-c106="" class="highlight-div-header-left"><div _ngcontent-ydj-c106="" class="handle-button expand-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ydj-c106="" class="highlight-div-header-right"><div _ngcontent-ydj-c106="" class="handle-button ai-button"></div><div _ngcontent-ydj-c106="" class="handle-button line-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ydj-c106="" class="handle-button theme-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ydj-c106="" class="handle-button copy-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ydj-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">VIP</span> <span class="hljs-variable">priority</span> <span class="hljs-variable">event</span> <span class="hljs-variable">queue</span> <span class="hljs-variable">information</span>:</li><li><span class="hljs-variable">No</span><span class="hljs-number">.1</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3205</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.407</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.407</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">ArkUIWindowInjectPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">task_runner_adapter_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">PostTask</span>:<span class="hljs-number">33</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.2</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3205</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.407</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.407</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">ArkUIWindowInjectPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">task_runner_adapter_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">PostTask</span>:<span class="hljs-number">33</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.3</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3205</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.407</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.407</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">ArkUIWindowInjectPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">task_runner_adapter_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">PostTask</span>:<span class="hljs-number">33</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.4</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3961</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.408</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.408</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">MMI</span>::<span class="hljs-title class_">OnPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">input_manager_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">OnPointerEvent</span>:<span class="hljs-number">493</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.5</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3205</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.408</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.408</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">ArkUIWindowInjectPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">task_runner_adapter_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">PostTask</span>:<span class="hljs-number">33</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.6</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3205</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.409</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.409</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">ArkUIWindowInjectPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">task_runner_adapter_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">PostTask</span>:<span class="hljs-number">33</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.7</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3205</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.409</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.409</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">ArkUIWindowInjectPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">task_runner_adapter_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">PostTask</span>:<span class="hljs-number">33</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.8</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3205</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.409</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.409</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">ArkUIWindowInjectPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">task_runner_adapter_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">PostTask</span>:<span class="hljs-number">33</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.9</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3205</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.410</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.410</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">ArkUIWindowInjectPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">task_runner_adapter_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">PostTask</span>:<span class="hljs-number">33</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.10</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3205</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.410</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.410</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">ArkUIWindowInjectPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">task_runner_adapter_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">PostTask</span>:<span class="hljs-number">33</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.11</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3205</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.411</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.411</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">ArkUIWindowInjectPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">task_runner_adapter_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">PostTask</span>:<span class="hljs-number">33</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.12</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3205</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.412</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.412</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">ArkUIWindowInjectPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">task_runner_adapter_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">PostTask</span>:<span class="hljs-number">33</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.13</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3205</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.412</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.412</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">ArkUIWindowInjectPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">task_runner_adapter_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">PostTask</span>:<span class="hljs-number">33</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.14</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3205</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.413</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.413</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">ArkUIWindowInjectPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">task_runner_adapter_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">PostTask</span>:<span class="hljs-number">33</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.15</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3205</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.414</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.414</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">ArkUIWindowInjectPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">task_runner_adapter_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">PostTask</span>:<span class="hljs-number">33</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.16</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3205</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.414</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.414</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">ArkUIWindowInjectPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">task_runner_adapter_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">PostTask</span>:<span class="hljs-number">33</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.17</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3205</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.414</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.414</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">ArkUIWindowInjectPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">task_runner_adapter_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">PostTask</span>:<span class="hljs-number">33</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.18</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3205</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.415</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.415</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">ArkUIWindowInjectPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">task_runner_adapter_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">PostTask</span>:<span class="hljs-number">33</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.19</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3205</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.416</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.416</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">ArkUIWindowInjectPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">task_runner_adapter_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">PostTask</span>:<span class="hljs-number">33</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.20</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3961</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.417</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.417</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">MMI</span>::<span class="hljs-title class_">OnPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">input_manager_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">OnPointerEvent</span>:<span class="hljs-number">493</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.21</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">3205</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.417</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">07</span> <span class="hljs-number">04</span>:<span class="hljs-number">11</span>:<span class="hljs-number">15.417</span>, <span class="hljs-variable">task</span> <span class="hljs-variable">name</span> = <span class="hljs-variable">ArkUIWindowInjectPointerEvent</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">task_runner_adapter_impl</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">PostTask</span>:<span class="hljs-number">33</span>)] }</li><li>...</li></ol></pre></div></div> <p>用户输入事件传递链中的任务都属于VIP优先级任务，为保障第一时间响应用户。</p> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>watchdog任务位于此优先级队列中，观察可发现其是每隔3s发送一次。</p> <p>watchdog任务仅针对于THREAD_BLOCK任务，用户输入无响应和生命周期超时任务不适用。</p> </div></div></div> </li><li>对比warning/block事件，观察watchdog任务在队列中的移动情况。<p>warning：</p> <div _ngcontent-ydj-c106="" class="highlight-div"><div _ngcontent-ydj-c106="" class="highlight-div-header"><div _ngcontent-ydj-c106="" class="highlight-div-header-left"><div _ngcontent-ydj-c106="" class="handle-button expand-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ydj-c106="" class="highlight-div-header-right"><div _ngcontent-ydj-c106="" class="handle-button ai-button"></div><div _ngcontent-ydj-c106="" class="handle-button line-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ydj-c106="" class="handle-button theme-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ydj-c106="" class="handle-button copy-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ydj-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">VIP</span> <span class="hljs-variable">priority</span> <span class="hljs-variable">event</span> <span class="hljs-variable">queue</span> <span class="hljs-variable">information</span>:</li><li><span class="hljs-variable">No</span><span class="hljs-number">.1</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">35862</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">25.526</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">25.526</span>, <span class="hljs-variable">id</span> = <span class="hljs-number">1</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">watchdog</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">Timer</span>:<span class="hljs-number">156</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.2</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">35862</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">28.526</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">28.526</span>, <span class="hljs-variable">id</span> = <span class="hljs-number">1</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">watchdog</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">Timer</span>:<span class="hljs-number">156</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.3</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">35862</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">31.526</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">31.526</span>, <span class="hljs-variable">id</span> = <span class="hljs-number">1</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">watchdog</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">Timer</span>:<span class="hljs-number">156</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.4</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">35862</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">34.530</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">34.530</span>, <span class="hljs-variable">id</span> = <span class="hljs-number">1</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">watchdog</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">Timer</span>:<span class="hljs-number">156</span>)] }</li><li><span class="hljs-variable">Total</span> <span class="hljs-variable">size</span> <span class="hljs-variable">of</span> <span class="hljs-variable">High</span> <span class="hljs-variable">events</span> : <span class="hljs-number">4</span></li></ol></pre></div></div> <p>block:</p> <div _ngcontent-ydj-c106="" class="highlight-div"><div _ngcontent-ydj-c106="" class="highlight-div-header"><div _ngcontent-ydj-c106="" class="highlight-div-header-left"><div _ngcontent-ydj-c106="" class="handle-button expand-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ydj-c106="" class="highlight-div-header-right"><div _ngcontent-ydj-c106="" class="handle-button ai-button"></div><div _ngcontent-ydj-c106="" class="handle-button line-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ydj-c106="" class="handle-button theme-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ydj-c106="" class="handle-button copy-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ydj-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">VIP</span> <span class="hljs-variable">priority</span> <span class="hljs-variable">event</span> <span class="hljs-variable">queue</span> <span class="hljs-variable">information</span>:</li><li><span class="hljs-variable">No</span><span class="hljs-number">.1</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">35862</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">25.526</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">25.526</span>, <span class="hljs-variable">id</span> = <span class="hljs-number">1</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">watchdog</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">Timer</span>:<span class="hljs-number">156</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.2</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">35862</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">28.526</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">28.526</span>, <span class="hljs-variable">id</span> = <span class="hljs-number">1</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">watchdog</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">Timer</span>:<span class="hljs-number">156</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.3</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">35862</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">31.526</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">31.526</span>, <span class="hljs-variable">id</span> = <span class="hljs-number">1</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">watchdog</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">Timer</span>:<span class="hljs-number">156</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.4</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">35862</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">34.530</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">34.530</span>, <span class="hljs-variable">id</span> = <span class="hljs-number">1</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">watchdog</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">Timer</span>:<span class="hljs-number">156</span>)] }</li><li><span class="hljs-variable">No</span><span class="hljs-number">.5</span> : <span class="hljs-title class_">Event</span> { <span class="hljs-variable">send</span> <span class="hljs-variable">thread</span> = <span class="hljs-number">35862</span>, <span class="hljs-variable">send</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">37.526</span>, <span class="hljs-variable">handle</span> <span class="hljs-variable">time</span> = <span class="hljs-number">2024</span>-<span class="hljs-number">08</span>-<span class="hljs-number">08</span> <span class="hljs-number">12</span>:<span class="hljs-number">17</span>:<span class="hljs-number">37.526</span>, <span class="hljs-variable">id</span> = <span class="hljs-number">1</span>, <span class="hljs-variable">caller</span> = [<span class="hljs-variable">watchdog</span>.<span class="hljs-title function_">cpp</span>(<span class="hljs-variable">Timer</span>:<span class="hljs-number">156</span>)] }</li><li><span class="hljs-variable">Total</span> <span class="hljs-variable">size</span> <span class="hljs-variable">of</span> <span class="hljs-variable">High</span> <span class="hljs-variable">events</span> : <span class="hljs-number">5</span></li></ol></pre></div></div> <p>以上示例中可发现block队列相比于warning队列更长了，而对应的第一个任务没有发生变化，可能存在两种情况：</p> <ul><li>当前正在运行的任务卡死阻塞，导致其他任务一直未被调度执行。</li><li>更高优先级队列中任务堆积，导致位于较低优先级队列中的watchdog任务未被调度执行。</li></ul> </li></ol> <div class="tiledSection"><h3 id="section14871936175611">查看stack信息<i class="anchor-icon anchor-icon-link" anchorid="section14871936175611" tips="复制节点链接"></i></h3></div> <p>应用冻屏所对应的故障类型，其检测主要都是应用主线程。</p> <p>应用主线程存在以下几种情况：</p> <ol><li>warning/block栈一致，卡锁<div _ngcontent-ydj-c106="" class="highlight-div"><div _ngcontent-ydj-c106="" class="highlight-div-header"><div _ngcontent-ydj-c106="" class="highlight-div-header-left"><div _ngcontent-ydj-c106="" class="handle-button expand-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ydj-c106="" class="highlight-div-header-right"><div _ngcontent-ydj-c106="" class="handle-button ai-button"></div><div _ngcontent-ydj-c106="" class="handle-button line-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ydj-c106="" class="handle-button theme-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ydj-c106="" class="handle-button copy-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ydj-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">Tid</span>:<span class="hljs-number">3025</span>, <span class="hljs-variable">Name</span>: <span class="hljs-title class_">xxx</span></li><li># <span class="hljs-number">00</span> <span class="hljs-variable">pc</span> <span class="hljs-number">00000000001</span><span class="hljs-variable">b4094</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib</span>/<span class="hljs-variable">ld</span>-<span class="hljs-variable">musl</span>-<span class="hljs-variable">aarch64</span>.<span class="hljs-variable">so</span><span class="hljs-number">.1</span>(<span class="hljs-variable">__timedwait_cp</span>+<span class="hljs-number">188</span>)(<span class="hljs-variable">b168f10a179cf6050a309242262e6a17</span>)</li><li># <span class="hljs-number">01</span> <span class="hljs-variable">pc</span> <span class="hljs-number">00000000001</span><span class="hljs-variable">b9fc8</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib</span>/<span class="hljs-variable">ld</span>-<span class="hljs-variable">musl</span>-<span class="hljs-variable">aarch64</span>.<span class="hljs-variable">so</span><span class="hljs-number">.1</span>(<span class="hljs-variable">__pthread_mutex_timedlock_inner</span>+<span class="hljs-number">592</span>)(<span class="hljs-variable">b168f10a179cf6050a309242262e6a17</span>)</li><li># <span class="hljs-number">02</span> <span class="hljs-variable">pc</span> <span class="hljs-number">00000000000</span><span class="hljs-variable">c3e40</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">libc</span>++.<span class="hljs-title function_">so</span>(<span class="hljs-variable">std</span>::<span class="hljs-title class_">__h</span>::<span class="hljs-title class_">mutex</span>::<span class="hljs-title class_">lock</span>()+<span class="hljs-number">8</span>)(<span class="hljs-number">9</span><span class="hljs-variable">cbc937082b3d7412696099dd58f4f78242f9512</span>) --&gt; <span class="hljs-title class_">等锁卡死</span></li><li># <span class="hljs-number">03</span> <span class="hljs-variable">pc</span> <span class="hljs-number">000000000007</span><span class="hljs-variable">ac4c</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">platformsdk</span>/<span class="hljs-variable">libnative_rdb</span>.<span class="hljs-variable">z</span>.<span class="hljs-title function_">so</span>(<span class="hljs-variable">OHOS</span>::<span class="hljs-title class_">NativeRdb</span>::<span class="hljs-title class_">SqliteConnectionPool</span>::<span class="hljs-title class_">Container</span>::<span class="hljs-title class_">Release</span>(<span class="hljs-variable">std</span>::<span class="hljs-variable">__h</span>::<span class="hljs-title class_">shared_ptr</span>&lt;<span class="hljs-variable">OHOS</span>::<span class="hljs-variable">NativeRdb</span>::<span class="hljs-variable">SqliteConnectionPool</span>::<span class="hljs-title class_">ConnNode</span>&gt;)+<span class="hljs-number">60</span>)(<span class="hljs-number">5e8443</span><span class="hljs-variable">def4695e8c791e5f847035ad9f</span>)</li><li># <span class="hljs-number">04</span> <span class="hljs-variable">pc</span> <span class="hljs-number">000000000007</span><span class="hljs-variable">aaf4</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">platformsdk</span>/<span class="hljs-variable">libnative_rdb</span>.<span class="hljs-variable">z</span>.<span class="hljs-title function_">so</span>(<span class="hljs-variable">OHOS</span>::<span class="hljs-title class_">NativeRdb</span>::<span class="hljs-title class_">SqliteConnectionPool</span>::<span class="hljs-title class_">ReleaseNode</span>(<span class="hljs-variable">std</span>::<span class="hljs-variable">__h</span>::<span class="hljs-title class_">shared_ptr</span>&lt;<span class="hljs-variable">OHOS</span>::<span class="hljs-variable">NativeRdb</span>::<span class="hljs-variable">SqliteConnectionPool</span>::<span class="hljs-title class_">ConnNode</span>&gt;)+<span class="hljs-number">276</span>)(<span class="hljs-number">5e8443</span><span class="hljs-variable">def4695e8c791e5f847035ad9f</span>)</li><li># <span class="hljs-number">05</span> <span class="hljs-variable">pc</span> <span class="hljs-number">000000000007</span><span class="hljs-variable">a8c0</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">platformsdk</span>/<span class="hljs-variable">libnative_rdb</span>.<span class="hljs-variable">z</span>.<span class="hljs-title function_">so</span>(<span class="hljs-number">5e8443</span><span class="hljs-variable">def4695e8c791e5f847035ad9f</span>)</li><li># <span class="hljs-number">06</span> <span class="hljs-variable">pc</span> <span class="hljs-number">00000000000</span><span class="hljs-variable">b36ec</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">platformsdk</span>/<span class="hljs-variable">libnative_rdb</span>.<span class="hljs-variable">z</span>.<span class="hljs-title function_">so</span>(<span class="hljs-variable">OHOS</span>::<span class="hljs-title class_">NativeRdb</span>::<span class="hljs-title class_">SqliteSharedResultSet</span>::<span class="hljs-title class_">Close</span>()+<span class="hljs-number">324</span>)(<span class="hljs-number">5e8443</span><span class="hljs-variable">def4695e8c791e5f847035ad9f</span>)</li><li># <span class="hljs-number">07</span> <span class="hljs-variable">pc</span> <span class="hljs-number">000000000006</span><span class="hljs-variable">da94</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">module</span>/<span class="hljs-variable">data</span>/<span class="hljs-variable">librelationalstore</span>.<span class="hljs-variable">z</span>.<span class="hljs-title function_">so</span>(<span class="hljs-variable">OHOS</span>::<span class="hljs-title class_">RelationalStoreJsKit</span>::<span class="hljs-title class_">ResultSetProxy</span>::<span class="hljs-title class_">Close</span>(<span class="hljs-variable">napi_env__</span>*, <span class="hljs-variable">napi_callback_info__</span>*) (.<span class="hljs-title class_">cfi</span>)+<span class="hljs-number">212</span>)(<span class="hljs-number">5</span><span class="hljs-variable">c7c67512e12e0e53fd23e82ee576a88</span>)</li><li># <span class="hljs-number">08</span> <span class="hljs-variable">pc</span> <span class="hljs-number">0000000000034408</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">platformsdk</span>/<span class="hljs-variable">libace_napi</span>.<span class="hljs-variable">z</span>.<span class="hljs-title function_">so</span>(<span class="hljs-variable">panda</span>::<span class="hljs-title class_">JSValueRef</span> <span class="hljs-title class_">ArkNativeFunctionCallBack</span>&lt;<span class="hljs-keyword">true</span>&gt;(<span class="hljs-variable">panda</span>::<span class="hljs-variable">JsiRuntimeCallInfo</span>*)+<span class="hljs-number">220</span>)(<span class="hljs-variable">f271f536a588ef9d0dc5328c70fce511</span>)</li><li># <span class="hljs-number">09</span> <span class="hljs-variable">pc</span> <span class="hljs-number">00000000002</span><span class="hljs-variable">d71d0</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">module</span>/<span class="hljs-variable">arkcompiler</span>/<span class="hljs-variable">stub</span>.<span class="hljs-title function_">an</span>(<span class="hljs-variable">RTStub_PushCallArgsAndDispatchNative</span>+<span class="hljs-number">40</span>)</li><li># <span class="hljs-number">10</span> <span class="hljs-variable">at</span> <span class="hljs-variable">parseResultSet</span> (<span class="hljs-variable">entry</span>/<span class="hljs-variable">build</span>/<span class="hljs-variable">default</span>/<span class="hljs-variable">cache</span>/<span class="hljs-variable">default</span>/<span class="hljs-variable">default</span>@<span class="hljs-title function_">CompileArkTS</span>/<span class="hljs-variable">esmodule</span>/<span class="hljs-variable">release</span>/<span class="hljs-variable">datamanager</span>/<span class="hljs-variable">datawrapper</span>/<span class="hljs-variable">src</span>/<span class="hljs-keyword">main</span>/<span class="hljs-variable">ets</span>/<span class="hljs-variable">database</span>/<span class="hljs-variable">RdbManager</span>.<span class="hljs-variable">ts</span>:<span class="hljs-number">266</span>:<span class="hljs-number">1</span>)</li><li># <span class="hljs-number">11</span> <span class="hljs-variable">at</span> <span class="hljs-variable">query</span> (<span class="hljs-variable">entry</span>/<span class="hljs-variable">build</span>/<span class="hljs-variable">default</span>/<span class="hljs-variable">cache</span>/<span class="hljs-variable">default</span>/<span class="hljs-variable">default</span>@<span class="hljs-title function_">CompileArkTS</span>/<span class="hljs-variable">esmodule</span>/<span class="hljs-variable">release</span>/<span class="hljs-variable">datamanager</span>/<span class="hljs-variable">datawrapper</span>/<span class="hljs-variable">src</span>/<span class="hljs-keyword">main</span>/<span class="hljs-variable">ets</span>/<span class="hljs-variable">database</span>/<span class="hljs-variable">RdbManager</span>.<span class="hljs-variable">ts</span>:<span class="hljs-number">188</span>:<span class="hljs-number">1</span>)</li></ol></pre></div></div> <p>堆栈显示等锁卡死，通过反汇编获取对应代码行，排查其他线程栈和代码上下文锁的使用解决故障，请参考：<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-stability-app-crash-cpp-way#li186453444512">通过llvm-addr2line工具定位行号</a>。</p> </li><li>warning/block栈一致，卡在IPC请求<div _ngcontent-ydj-c106="" class="highlight-div"><div _ngcontent-ydj-c106="" class="highlight-div-header"><div _ngcontent-ydj-c106="" class="highlight-div-header-left"><div _ngcontent-ydj-c106="" class="handle-button expand-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ydj-c106="" class="highlight-div-header-right"><div _ngcontent-ydj-c106="" class="handle-button ai-button"></div><div _ngcontent-ydj-c106="" class="handle-button line-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ydj-c106="" class="handle-button theme-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ydj-c106="" class="handle-button copy-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ydj-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">Tid</span>:<span class="hljs-number">53616</span>, <span class="hljs-variable">Name</span>:<span class="hljs-title class_">xxx</span></li><li># <span class="hljs-number">00</span> <span class="hljs-variable">pc</span> <span class="hljs-number">0000000000171</span><span class="hljs-variable">c1c</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib</span>/<span class="hljs-variable">ld</span>-<span class="hljs-variable">musl</span>-<span class="hljs-variable">aarch64</span>.<span class="hljs-variable">so</span><span class="hljs-number">.1</span>(<span class="hljs-variable">ioctl</span>+<span class="hljs-number">176</span>)(<span class="hljs-variable">b168f10a179cf6050a309242262e6a17</span>)</li><li># <span class="hljs-number">01</span> <span class="hljs-variable">pc</span> <span class="hljs-number">0000000000006508</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">chipset</span>-<span class="hljs-variable">pub</span>-<span class="hljs-variable">sdk</span>/<span class="hljs-variable">libipc_common</span>.<span class="hljs-variable">z</span>.<span class="hljs-title function_">so</span>(<span class="hljs-variable">OHOS</span>::<span class="hljs-title class_">BinderConnector</span>::<span class="hljs-title class_">WriteBinder</span>(<span class="hljs-title class_">unsigned</span> <span class="hljs-title class_">long</span>, <span class="hljs-variable">void</span>*)+<span class="hljs-number">100</span>)(<span class="hljs-number">1</span><span class="hljs-variable">edec25445c569dd1093635c1da3bc0a</span>) --&gt; <span class="hljs-title class_">binder</span> <span class="hljs-title class_">卡死</span></li><li># <span class="hljs-number">02</span> <span class="hljs-variable">pc</span> <span class="hljs-number">000000000004</span><span class="hljs-variable">d500</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">platformsdk</span>/<span class="hljs-variable">libipc_core</span>.<span class="hljs-variable">z</span>.<span class="hljs-title function_">so</span>(<span class="hljs-variable">OHOS</span>::<span class="hljs-title class_">BinderInvoker</span>::<span class="hljs-title class_">TransactWithDriver</span>(<span class="hljs-title class_">bool</span>)+<span class="hljs-number">296</span>)(<span class="hljs-number">6151</span><span class="hljs-variable">eca3b47aa2ab3e378e6e558b90f3</span>)</li><li># <span class="hljs-number">03</span> <span class="hljs-variable">pc</span> <span class="hljs-number">000000000004</span><span class="hljs-variable">c6c0</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">platformsdk</span>/<span class="hljs-variable">libipc_core</span>.<span class="hljs-variable">z</span>.<span class="hljs-title function_">so</span>(<span class="hljs-variable">OHOS</span>::<span class="hljs-title class_">BinderInvoker</span>::<span class="hljs-title class_">WaitForCompletion</span>(<span class="hljs-variable">OHOS</span>::<span class="hljs-variable">MessageParcel</span>*, <span class="hljs-variable">int</span>*)+<span class="hljs-number">128</span>)(<span class="hljs-number">6151</span><span class="hljs-variable">eca3b47aa2ab3e378e6e558b90f3</span>)</li><li># <span class="hljs-number">04</span> <span class="hljs-variable">pc</span> <span class="hljs-number">000000000004</span><span class="hljs-variable">c304</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">platformsdk</span>/<span class="hljs-variable">libipc_core</span>.<span class="hljs-variable">z</span>.<span class="hljs-title function_">so</span>(<span class="hljs-variable">OHOS</span>::<span class="hljs-title class_">BinderInvoker</span>::<span class="hljs-title class_">SendRequest</span>(<span class="hljs-title class_">int</span>, <span class="hljs-title class_">unsigned</span> <span class="hljs-title class_">int</span>, <span class="hljs-variable">OHOS</span>::<span class="hljs-title class_">MessageParcel</span>&amp;, <span class="hljs-variable">OHOS</span>::<span class="hljs-title class_">MessageParcel</span>&amp;, <span class="hljs-variable">OHOS</span>::<span class="hljs-title class_">MessageOption</span>&amp;)+<span class="hljs-number">348</span>)(<span class="hljs-number">6151</span><span class="hljs-variable">eca3b47aa2ab3e378e6e558b90f3</span>)</li><li># <span class="hljs-number">05</span> <span class="hljs-variable">pc</span> <span class="hljs-number">00000000000319</span><span class="hljs-variable">ac</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">platformsdk</span>/<span class="hljs-variable">libipc_core</span>.<span class="hljs-variable">z</span>.<span class="hljs-title function_">so</span>(<span class="hljs-variable">OHOS</span>::<span class="hljs-title class_">IPCObjectProxy</span>::<span class="hljs-title class_">SendRequestInner</span>(<span class="hljs-title class_">bool</span>, <span class="hljs-title class_">unsigned</span> <span class="hljs-title class_">int</span>, <span class="hljs-variable">OHOS</span>::<span class="hljs-title class_">MessageParcel</span>&amp;, <span class="hljs-variable">OHOS</span>::<span class="hljs-title class_">MessageParcel</span>&amp;, <span class="hljs-variable">OHOS</span>::<span class="hljs-title class_">MessageOption</span>&amp;)+<span class="hljs-number">124</span>)(<span class="hljs-number">6151</span><span class="hljs-variable">eca3b47aa2ab3e378e6e558b90f3</span>)</li><li># <span class="hljs-number">06</span> <span class="hljs-variable">pc</span> <span class="hljs-number">0000000000031</span><span class="hljs-variable">cfc</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">platformsdk</span>/<span class="hljs-variable">libipc_core</span>.<span class="hljs-variable">z</span>.<span class="hljs-title function_">so</span>(<span class="hljs-variable">OHOS</span>::<span class="hljs-title class_">IPCObjectProxy</span>::<span class="hljs-title class_">SendRequest</span>(<span class="hljs-title class_">unsigned</span> <span class="hljs-title class_">int</span>, <span class="hljs-variable">OHOS</span>::<span class="hljs-title class_">MessageParcel</span>&amp;, <span class="hljs-variable">OHOS</span>::<span class="hljs-title class_">MessageParcel</span>&amp;, <span class="hljs-variable">OHOS</span>::<span class="hljs-title class_">MessageOption</span>&amp;)+<span class="hljs-number">184</span>)(<span class="hljs-number">6151</span><span class="hljs-variable">eca3b47aa2ab3e378e6e558b90f3</span>)</li><li># <span class="hljs-number">07</span> <span class="hljs-variable">pc</span> <span class="hljs-number">0000000000023</span><span class="hljs-variable">c7c</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">libipc</span>.<span class="hljs-variable">dylib</span>.<span class="hljs-title function_">so</span>(&lt;<span class="hljs-title class_">ipc</span>::<span class="hljs-title class_">remote</span>::<span class="hljs-title class_">obj</span>::<span class="hljs-title class_">RemoteObj</span>&gt;::<span class="hljs-title class_">send_request</span>+<span class="hljs-number">268</span>)(<span class="hljs-number">7006</span><span class="hljs-variable">cb5520edc22f64d04df86cb90152</span>)</li><li># <span class="hljs-number">08</span> <span class="hljs-variable">pc</span> <span class="hljs-number">000000000000</span><span class="hljs-variable">b904</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">libasset_sdk</span>.<span class="hljs-variable">dylib</span>.<span class="hljs-title function_">so</span>(&lt;<span class="hljs-title class_">asset_sdk</span>::<span class="hljs-title class_">Manager</span>&gt;::<span class="hljs-title class_">send_request</span>+<span class="hljs-number">48</span>)(<span class="hljs-number">4073</span><span class="hljs-variable">ec22b58b83f79883d5fc8102ce77</span>)</li><li># <span class="hljs-number">09</span> <span class="hljs-variable">pc</span> <span class="hljs-number">000000000000</span><span class="hljs-variable">b600</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">libasset_sdk</span>.<span class="hljs-variable">dylib</span>.<span class="hljs-title function_">so</span>(&lt;<span class="hljs-title class_">asset_sdk</span>::<span class="hljs-title class_">Manager</span>&gt;::<span class="hljs-title class_">query</span>+<span class="hljs-number">156</span>)(<span class="hljs-number">4073</span><span class="hljs-variable">ec22b58b83f79883d5fc8102ce77</span>)</li><li># <span class="hljs-number">10</span> <span class="hljs-variable">pc</span> <span class="hljs-number">0000000000006</span><span class="hljs-variable">d94</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">libasset_sdk_ffi</span>.<span class="hljs-variable">z</span>.<span class="hljs-title function_">so</span>(<span class="hljs-variable">query_asset</span>+<span class="hljs-number">116</span>)(<span class="hljs-number">9</span><span class="hljs-variable">a309896092ba014c878289a54688679</span>)</li><li># <span class="hljs-number">11</span> <span class="hljs-variable">pc</span> <span class="hljs-number">0000000000006740</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">module</span>/<span class="hljs-variable">security</span>/<span class="hljs-variable">libasset_napi</span>.<span class="hljs-variable">z</span>.<span class="hljs-title function_">so</span>((<span class="hljs-variable">anonymous</span> <span class="hljs-variable">namespace</span>)::<span class="hljs-title class_">NapiQuerySync</span>(<span class="hljs-variable">napi_env__</span>*, <span class="hljs-variable">napi_callback_info__</span>*) (.<span class="hljs-title class_">cfi</span>)+<span class="hljs-number">220</span>)(<span class="hljs-variable">ef7afe850712e4822f085ed0ac184e8a</span>)</li><li># <span class="hljs-number">12</span> <span class="hljs-variable">pc</span> <span class="hljs-number">0000000000034408</span> /<span class="hljs-variable">system</span>/<span class="hljs-variable">lib64</span>/<span class="hljs-variable">platformsdk</span>/<span class="hljs-variable">libace_napi</span>.<span class="hljs-variable">z</span>.<span class="hljs-title function_">so</span>(<span class="hljs-variable">panda</span>::<span class="hljs-title class_">JSValueRef</span> <span class="hljs-title class_">ArkNativeFunctionCallBack</span>&lt;<span class="hljs-keyword">true</span>&gt;(<span class="hljs-variable">panda</span>::<span class="hljs-variable">JsiRuntimeCallInfo</span>*)+<span class="hljs-number">220</span>)(<span class="hljs-variable">f271f536a588ef9d0dc5328c70fce511</span>)</li></ol></pre></div></div> <p>通过IPC栈帧下面的业务栈帧，识别应用是通过什么接口进行IPC请求，识别对端是什么进程。需要结合binder调用链，确定对端阻塞没有返回的原因。</p> </li><li>warning/block栈一致，卡在某业务栈帧<div _ngcontent-ydj-c106="" class="highlight-div"><div _ngcontent-ydj-c106="" class="highlight-div-header"><div _ngcontent-ydj-c106="" class="highlight-div-header-left"><div _ngcontent-ydj-c106="" class="handle-button expand-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ydj-c106="" class="highlight-div-header-right"><div _ngcontent-ydj-c106="" class="handle-button ai-button"></div><div _ngcontent-ydj-c106="" class="handle-button line-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ydj-c106="" class="handle-button theme-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ydj-c106="" class="handle-button copy-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ydj-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-shell" data-highlighted="yes"><ol class="linenums"><li>Tid:14727, Name:xxx</li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">00 pc 00000000001c4c60 /system/lib/ld-musl-aarch64.so.1(pread+72)(b168f10a179cf6050a309242262e6a17)</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">01 pc 0000000000049154 /system/lib64/platformsdk/libsqlite.z.so(unixRead+180)(48485aa23da681fc87d8dc0b4be3e34c)</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">02 pc 0000000000053e98 /system/lib64/platformsdk/libsqlite.z.so(readDbPage+116)(48485aa23da681fc87d8dc0b4be3e34c)</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">03 pc 0000000000053d48 /system/lib64/platformsdk/libsqlite.z.so(getPageNormal+864)(48485aa23da681fc87d8dc0b4be3e34c)</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">04 pc 00000000000757a0 /system/lib64/platformsdk/libsqlite.z.so(getAndInitPage+216)(48485aa23da681fc87d8dc0b4be3e34c)</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">05 pc 0000000000077658 /system/lib64/platformsdk/libsqlite.z.so(moveToLeftmost+164)(48485aa23da681fc87d8dc0b4be3e34c)</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">06 pc 000000000006aa34 /system/lib64/platformsdk/libsqlite.z.so(sqlite3VdbeExec+34532)(48485aa23da681fc87d8dc0b4be3e34c)</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">07 pc 000000000002e424 /system/lib64/platformsdk/libsqlite.z.so(sqlite3_step+644)(48485aa23da681fc87d8dc0b4be3e34c)</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">08 pc 00000000000b1a70 /system/lib64/platformsdk/libnative_rdb.z.so(FillSharedBlockOpt+408)(5e8443def4695e8c791e5f847035ad9f)</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">09 pc 0000000000082a94 /system/lib64/platformsdk/libnative_rdb.z.so(OHOS::NativeRdb::SqliteStatement::FillBlockInfo(OHOS::NativeRdb::SharedBlockInfo*) const+76)(5e8443def4695e8c791e5f847035ad9f)</span></li><li><span class="hljs-meta prompt_"># </span><span class="language-bash">10 pc 00000000000b4214 /system/lib64/platformsdk/libnative_rdb.z.so(OHOS::NativeRdb::SqliteSharedResultSet::ExecuteForSharedBlock(OHOS::AppDataFwk::SharedBlock*, int, int, bool)+236)(5e8443def4695e8c791e5f847035ad9f)</span></li></ol></pre></div></div> <p>结合trace进一步确认，排查是否为应用调用的单一函数内部逻辑执行超时，例如：某函数内执行复杂计算。</p> </li><li>瞬时栈，warning/block栈不一致<p>表示两个时刻是在线程的运行过程中抓取的栈信息，此时进程未卡死，属于线程繁忙场景。</p> <p>warning栈：</p> <div _ngcontent-ydj-c106="" class="highlight-div"><div _ngcontent-ydj-c106="" class="highlight-div-header"><div _ngcontent-ydj-c106="" class="highlight-div-header-left"><div _ngcontent-ydj-c106="" class="handle-button expand-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ydj-c106="" class="highlight-div-header-right"><div _ngcontent-ydj-c106="" class="handle-button ai-button"></div><div _ngcontent-ydj-c106="" class="handle-button line-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ydj-c106="" class="handle-button theme-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ydj-c106="" class="handle-button copy-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ydj-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-swift" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-type">Tid</span>:<span class="hljs-number">2648</span>, <span class="hljs-type">Name</span>:ohos.sceneboard</li><li># <span class="hljs-number">00</span> pc 00000000001bd7e4 <span class="hljs-regexp">/system/</span>lib<span class="hljs-operator">/</span>ld<span class="hljs-operator">-</span>musl<span class="hljs-operator">-</span>aarch64.so.<span class="hljs-number">1</span>(__pthread_mutex_trylock<span class="hljs-operator">+</span><span class="hljs-number">36</span>)(aded9a3bf39f018cb492cc3b0ba36667)</li><li># <span class="hljs-number">01</span> pc 0000000000609d7c <span class="hljs-regexp">/system/</span>lib64<span class="hljs-regexp">/platformsdk/</span>libark_jsruntime.so(panda::ecmascript::Mutex::<span class="hljs-type">TryLock</span>()<span class="hljs-operator">+</span><span class="hljs-number">8</span>)(9d0bbd23f13dc63b84dc8d6c98d8ea54)</li><li># <span class="hljs-number">02</span> pc 00000000005a10d4 <span class="hljs-regexp">/system/</span>lib64<span class="hljs-regexp">/platformsdk/</span>libark_jsruntime.so(panda::ecmascript::RuntimeLockHolder::<span class="hljs-type">RuntimeLockHolder</span>(panda::ecmascript::<span class="hljs-type">JSThread</span><span class="hljs-operator">*</span>, panda::ecmascript::<span class="hljs-type">Mutex</span><span class="hljs-operator">&amp;</span>)<span class="hljs-operator">+</span><span class="hljs-number">32</span>)(9d0bbd23f13dc63b84dc8d6c98d8ea54)</li><li># <span class="hljs-number">03</span> pc 000000000030abf8 <span class="hljs-regexp">/system/</span>lib64<span class="hljs-regexp">/platformsdk/</span>libark_jsruntime.so(panda::ecmascript::EcmaStringTable::<span class="hljs-type">GetOrInternString</span>(panda::ecmascript::<span class="hljs-type">EcmaVM</span><span class="hljs-operator">*</span>, unsigned char const<span class="hljs-operator">*</span>, unsigned int, bool)<span class="hljs-operator">+</span><span class="hljs-number">136</span>)(9d0bbd23f13dc63b84dc8d6c98d8ea54)</li><li># <span class="hljs-number">04</span> pc 00000000005249d0 <span class="hljs-regexp">/system/</span>lib64<span class="hljs-regexp">/platformsdk/</span>libark_jsruntime.so(panda::ecmascript::ObjectFactory::<span class="hljs-type">NewFromASCII</span>(std::__h::basic_string_view<span class="hljs-operator">&lt;</span>char, std::__h::char_traits<span class="hljs-operator">&lt;</span>char<span class="hljs-operator">&gt;&gt;</span>)<span class="hljs-operator">+</span><span class="hljs-number">44</span>)(9d0bbd23f13dc63b84dc8d6c98d8ea54)</li><li># <span class="hljs-number">05</span> pc <span class="hljs-number">0000000000184768</span> <span class="hljs-regexp">/system/</span>lib64<span class="hljs-regexp">/platformsdk/</span>libark_jsruntime.so(panda::ecmascript::base::NumberHelper::<span class="hljs-type">NumberToString</span>(panda::ecmascript::<span class="hljs-type">JSThread</span> const<span class="hljs-operator">*</span>, panda::ecmascript::<span class="hljs-type">JSTaggedValue</span>)<span class="hljs-operator">+</span><span class="hljs-number">412</span>)(9d0bbd23f13dc63b84dc8d6c98d8ea54)</li><li># <span class="hljs-number">06</span> pc 0000000000166c28 <span class="hljs-regexp">/system/</span>lib64<span class="hljs-regexp">/platformsdk/</span>libark_jsruntime.so(9d0bbd23f13dc63b84dc8d6c98d8ea54)</li><li># <span class="hljs-number">07</span> pc 0000000000166ba4 <span class="hljs-regexp">/system/</span>lib64<span class="hljs-regexp">/platformsdk/</span>libark_jsruntime.so(9d0bbd23f13dc63b84dc8d6c98d8ea54)</li><li># <span class="hljs-number">08</span> pc 00000000001d8334 <span class="hljs-regexp">/system/</span>lib64<span class="hljs-regexp">/platformsdk/</span>libark_jsruntime.so(panda::ecmascript::builtins::BuiltinsArray::<span class="hljs-type">Flat</span>(panda::ecmascript::<span class="hljs-type">EcmaRuntimeCallInfo</span><span class="hljs-operator">*</span>)<span class="hljs-operator">+</span><span class="hljs-number">416</span>)(9d0bbd23f13dc63b84dc8d6c98d8ea54)</li><li># <span class="hljs-number">09</span> pc <span class="hljs-number">0000000000339790</span> <span class="hljs-regexp">/system/</span>lib64<span class="hljs-regexp">/module/</span>arkcompiler<span class="hljs-operator">/</span>stub.an(<span class="hljs-type">RTStub_PushCallArgsAndDispatchNative</span><span class="hljs-operator">+</span><span class="hljs-number">40</span>)</li><li># <span class="hljs-number">10</span> at getPageIndex (product<span class="hljs-regexp">/phone/</span>build<span class="hljs-regexp">/default/</span>cache<span class="hljs-regexp">/default/</span><span class="hljs-keyword">default</span><span class="hljs-meta">@CompileArkTS</span><span class="hljs-regexp">/esmodule/</span>release<span class="hljs-regexp">/staticcommon/</span>launchercommon<span class="hljs-regexp">/src/</span>main<span class="hljs-regexp">/ets/</span>folder<span class="hljs-regexp">/model/</span><span class="hljs-type">FolderData</span>.ts:<span class="hljs-number">463</span>:<span class="hljs-number">463</span>)</li><li># <span class="hljs-number">11</span> at anonymous (product<span class="hljs-regexp">/phone/</span>build<span class="hljs-regexp">/default/</span>cache<span class="hljs-regexp">/default/</span><span class="hljs-keyword">default</span><span class="hljs-meta">@CompileArkTS</span><span class="hljs-regexp">/esmodule/</span>release<span class="hljs-regexp">/feature/</span>desktop<span class="hljs-regexp">/bigfolder/</span>src<span class="hljs-regexp">/main/</span>ets<span class="hljs-regexp">/default/</span>view<span class="hljs-operator">/</span><span class="hljs-type">OpenFolderSwiperPage</span>.ts:<span class="hljs-number">761</span>:<span class="hljs-number">761</span>)</li><li># <span class="hljs-number">12</span> at anonymous (product<span class="hljs-regexp">/phone/</span>build<span class="hljs-regexp">/default/</span>cache<span class="hljs-regexp">/default/</span><span class="hljs-keyword">default</span><span class="hljs-meta">@CompileArkTS</span><span class="hljs-regexp">/esmodule/</span>release<span class="hljs-regexp">/feature/</span>desktop<span class="hljs-regexp">/bigfolder/</span>src<span class="hljs-regexp">/main/</span>ets<span class="hljs-regexp">/default/</span>view<span class="hljs-operator">/</span><span class="hljs-type">OpenFolderSwiperPage</span>.ts:<span class="hljs-number">749</span>:<span class="hljs-number">749</span>)</li><li># <span class="hljs-number">13</span> pc 00000000003291ac <span class="hljs-regexp">/system/</span>lib64<span class="hljs-regexp">/platformsdk/</span>libark_jsruntime.so(panda::ecmascript::InterpreterAssembly::<span class="hljs-type">Execute</span>(panda::ecmascript::<span class="hljs-type">EcmaRuntimeCallInfo</span><span class="hljs-operator">*</span>)<span class="hljs-operator">+</span><span class="hljs-number">280</span>)(9d0bbd23f13dc63b84dc8d6c98d8ea54)</li></ol></pre></div></div> <p>block栈：</p> <div _ngcontent-ydj-c106="" class="highlight-div"><div _ngcontent-ydj-c106="" class="highlight-div-header"><div _ngcontent-ydj-c106="" class="highlight-div-header-left"><div _ngcontent-ydj-c106="" class="handle-button expand-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ydj-c106="" class="highlight-div-header-right"><div _ngcontent-ydj-c106="" class="handle-button ai-button"></div><div _ngcontent-ydj-c106="" class="handle-button line-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ydj-c106="" class="handle-button theme-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ydj-c106="" class="handle-button copy-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ydj-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-less" data-highlighted="yes"><ol class="linenums"><li>Tid:2648, Name:ohos.sceneboard</li><li># 00 pc 000000000001d52c /system/lib64/module/arkcompiler/stub.an(BCStub_HandleLdobjbynameImm8Id16+2392)</li><li># 01 at anonymous (product/phone/build/default/cache/default/default@CompileArkTS/esmodule/release/staticcommon/launchercommon/<span class="hljs-attribute">src/main/ets/folder/model/FolderData.ts</span>:<span class="hljs-number">464</span>:<span class="hljs-number">464</span>)</li><li># <span class="hljs-number">02</span> at getPageIndex (product/phone/build/default/cache/default/default<span class="hljs-variable">@CompileArkTS</span>/esmodule/release/staticcommon/launchercommon/src/main/ets/folder/model/FolderData.<span class="hljs-attribute">ts</span>:<span class="hljs-number">463</span>:<span class="hljs-number">463</span>)</li><li># <span class="hljs-number">03</span> at anonymous (product/phone/build/default/cache/default/default<span class="hljs-variable">@CompileArkTS</span>/esmodule/release/feature/desktop/bigfolder/src/main/ets/default/view/OpenFolderSwiperPage.<span class="hljs-attribute">ts</span>:<span class="hljs-number">761</span>:<span class="hljs-number">761</span>)</li><li># <span class="hljs-number">04</span> at anonymous (product/phone/build/default/cache/default/default<span class="hljs-variable">@CompileArkTS</span>/esmodule/release/feature/desktop/bigfolder/src/main/ets/default/view/OpenFolderSwiperPage.<span class="hljs-attribute">ts</span>:<span class="hljs-number">749</span>:<span class="hljs-number">749</span>)</li><li># <span class="hljs-number">05</span> pc <span class="hljs-number">00000000003291</span>ac /system/lib64/platformsdk/libark_jsruntime.<span class="hljs-built_in">so</span>(<span class="hljs-attribute">panda</span>::<span class="hljs-attribute">ecmascript</span>::<span class="hljs-attribute">InterpreterAssembly</span>::<span class="hljs-built_in">Execute</span>(<span class="hljs-attribute">panda</span>::<span class="hljs-attribute">ecmascript</span>::EcmaRuntimeCallInfo*)+<span class="hljs-number">280</span>)(<span class="hljs-number">9</span>d0bbd23f13dc63b84dc8d6c98d8ea54)</li><li># <span class="hljs-number">06</span> pc <span class="hljs-number">00000000001</span>d34dc /system/lib64/platformsdk/libark_jsruntime.<span class="hljs-built_in">so</span>(<span class="hljs-attribute">panda</span>::<span class="hljs-attribute">ecmascript</span>::<span class="hljs-attribute">builtins</span>::<span class="hljs-attribute">BuiltinsArray</span>::<span class="hljs-built_in">ForEach</span>(<span class="hljs-attribute">panda</span>::<span class="hljs-attribute">ecmascript</span>::EcmaRuntimeCallInfo*)+<span class="hljs-number">680</span>)(<span class="hljs-number">9</span>d0bbd23f13dc63b84dc8d6c98d8ea54)</li><li># <span class="hljs-number">07</span> pc <span class="hljs-number">00000000003393</span>d4 /system/lib64/module/arkcompiler/stub.<span class="hljs-built_in">an</span>(RTStub_AsmInterpreterEntry+<span class="hljs-number">208</span>)</li></ol></pre></div></div> <p>warning/block栈可能存在相似性，需结合trace和hilog判断应用具体运行场景，针对场景进行优化。</p> </li><li>eventhandler栈<div _ngcontent-ydj-c106="" class="highlight-div"><div _ngcontent-ydj-c106="" class="highlight-div-header"><div _ngcontent-ydj-c106="" class="highlight-div-header-left"><div _ngcontent-ydj-c106="" class="handle-button expand-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ydj-c106="" class="highlight-div-header-right"><div _ngcontent-ydj-c106="" class="handle-button ai-button"></div><div _ngcontent-ydj-c106="" class="handle-button line-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ydj-c106="" class="handle-button theme-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ydj-c106="" class="handle-button copy-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ydj-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-rust" data-highlighted="yes"><ol class="linenums"><li>Tid:<span class="hljs-number">1778</span>, Name:sapp.appgallery</li><li># <span class="hljs-number">00</span> pc <span class="hljs-number">0000000000154</span>c54 /system/lib/ld-musl-aarch64.so.<span class="hljs-number">1</span>(epoll_wait+<span class="hljs-number">80</span>)(aded9a3bf39f018cb492cc3b0ba36667)</li><li># <span class="hljs-number">01</span> pc <span class="hljs-number">00000000000181e0</span> /system/lib64/chipset-<span class="hljs-keyword">pub</span>-sdk/libeventhandler.z.<span class="hljs-title function_ invoke__">so</span>(OHOS::AppExecFwk::EpollIoWaiter::<span class="hljs-title function_ invoke__">WaitFor</span>(std::__h::unique_lock&lt;std::__h::mutex&gt;&amp;, long)+<span class="hljs-number">228</span>)(ccb2dd405e62e3312e9e49a76e8ba04b)</li><li># <span class="hljs-number">02</span> pc <span class="hljs-number">00000000000201</span>b0 /system/lib64/chipset-<span class="hljs-keyword">pub</span>-sdk/libeventhandler.z.<span class="hljs-title function_ invoke__">so</span>(OHOS::AppExecFwk::EventQueue::<span class="hljs-title function_ invoke__">WaitUntilLocked</span>(std::__h::chrono::time_point&lt;std::__h::chrono::steady_clock, std::__h::chrono::duration&lt;long long, std::__h::ratio&lt;<span class="hljs-number">1</span>l, <span class="hljs-number">1000000000</span>l&gt;&gt;&gt; <span class="hljs-keyword">const</span>&amp;, std::__h::unique_lock&lt;std::__h::mutex&gt;&amp;)+<span class="hljs-number">140</span>)(ccb2dd405e62e3312e9e49a76e8ba04b)</li><li># <span class="hljs-number">03</span> pc <span class="hljs-number">0000000000021</span>b8c /system/lib64/chipset-<span class="hljs-keyword">pub</span>-sdk/libeventhandler.z.<span class="hljs-title function_ invoke__">so</span>(OHOS::AppExecFwk::EventQueueBase::<span class="hljs-title function_ invoke__">GetEvent</span>()+<span class="hljs-number">232</span>)(ccb2dd405e62e3312e9e49a76e8ba04b)</li><li># <span class="hljs-number">04</span> pc <span class="hljs-number">000000000002</span>b638 /system/lib64/chipset-<span class="hljs-keyword">pub</span>-sdk/libeventhandler.z.<span class="hljs-title function_ invoke__">so</span>(OHOS::AppExecFwk::(anonymous namespace)::EventRunnerImpl::<span class="hljs-title function_ invoke__">Run</span>()+<span class="hljs-number">900</span>)(ccb2dd405e62e3312e9e49a76e8ba04b)</li><li># <span class="hljs-number">05</span> pc <span class="hljs-number">000000000002e9</span>c4 /system/lib64/chipset-<span class="hljs-keyword">pub</span>-sdk/libeventhandler.z.<span class="hljs-title function_ invoke__">so</span>(OHOS::AppExecFwk::EventRunner::<span class="hljs-title function_ invoke__">Run</span>()+<span class="hljs-number">524</span>)(ccb2dd405e62e3312e9e49a76e8ba04b)</li><li># <span class="hljs-number">06</span> pc <span class="hljs-number">00000000000</span>b4200 /system/lib64/platformsdk/libappkit_native.z.<span class="hljs-title function_ invoke__">so</span>(OHOS::AppExecFwk::MainThread::<span class="hljs-title function_ invoke__">Start</span>()+<span class="hljs-number">408</span>)(<span class="hljs-number">40</span>f96e5ff3eda8dfba747fd3d21ecd70)</li><li># <span class="hljs-number">07</span> pc <span class="hljs-number">0000000000004e30</span> /system/lib64/appspawn/appspawn/libappspawn_ace.z.<span class="hljs-title function_ invoke__">so</span>(<span class="hljs-title function_ invoke__">RunChildProcessor</span>(AppSpawnContent*, AppSpawnClient*)+<span class="hljs-number">568</span>)(<span class="hljs-number">4</span>ed3e05e4fafe7623cd5942d69fc13c8)</li><li># <span class="hljs-number">08</span> pc <span class="hljs-number">000000000000</span>af04 /system/bin/<span class="hljs-title function_ invoke__">appspawn</span>(AppSpawnChild+<span class="hljs-number">576</span>)(<span class="hljs-number">14694678248</span>bb218ea81845fd797df79)</li><li># <span class="hljs-number">09</span> pc <span class="hljs-number">000000000000</span>ab98 /system/bin/<span class="hljs-title function_ invoke__">appspawn</span>(AppSpawnProcessMsg+<span class="hljs-number">708</span>)(<span class="hljs-number">14694678248</span>bb218ea81845fd797df79)</li><li># <span class="hljs-number">10</span> pc <span class="hljs-number">0000000000012</span>f30 /system/bin/<span class="hljs-title function_ invoke__">appspawn</span>(ProcessSpawnReqMsg+<span class="hljs-number">228</span>)(<span class="hljs-number">14694678248</span>bb218ea81845fd797df79)</li><li># <span class="hljs-number">11</span> pc <span class="hljs-number">0000000000011</span>cac /system/bin/<span class="hljs-title function_ invoke__">appspawn</span>(OnReceiveRequest+<span class="hljs-number">132</span>)(<span class="hljs-number">14694678248</span>bb218ea81845fd797df79)</li><li># <span class="hljs-number">12</span> pc <span class="hljs-number">00000000000160</span>ac /system/lib64/chipset-<span class="hljs-keyword">pub</span>-sdk/libbegetutil.z.<span class="hljs-title function_ invoke__">so</span>(HandleRecvMsg_+<span class="hljs-number">344</span>)(db681f1dae48804a106924985d1ee750)</li></ol></pre></div></div> <p>此堆栈表示当前线程eventhandler在等待任务提交，说明此时线程不繁忙，需结合trace和hilog判断应用具体运行场景，针对场景进行优化。</p> </li></ol> <div class="tiledSection"><h3 id="section1743626572">查看binder信息<i class="anchor-icon anchor-icon-link" anchorid="section1743626572" tips="复制节点链接"></i></h3></div> <p>binder信息抓取时机：存在半周期检测的故障类型是在warning事件产生后获取，其他则在block事件后获取。</p> <ol><li>获取binder调用链<div _ngcontent-ydj-c106="" class="highlight-div"><div _ngcontent-ydj-c106="" class="highlight-div-header"><div _ngcontent-ydj-c106="" class="highlight-div-header-left"><div _ngcontent-ydj-c106="" class="handle-button expand-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ydj-c106="" class="highlight-div-header-right"><div _ngcontent-ydj-c106="" class="handle-button ai-button"></div><div _ngcontent-ydj-c106="" class="handle-button line-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ydj-c106="" class="handle-button theme-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ydj-c106="" class="handle-button copy-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ydj-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-variable">PeerBinderCatcher</span> -- <span class="hljs-variable">pid</span>==<span class="hljs-number">35854</span></li><li><span class="hljs-variable">BinderCatcher</span> --</li><li>    <span class="hljs-number">35854</span>:<span class="hljs-number">35854</span> <span class="hljs-title class_">to</span> <span class="hljs-number">52462</span>:<span class="hljs-number">52462</span> <span class="hljs-title class_">code</span> <span class="hljs-number">16</span> <span class="hljs-title class_">wait</span>:<span class="hljs-number">27.185154163</span> <span class="hljs-title class_">s</span> <span class="hljs-title class_">frz_state</span>:<span class="hljs-number">3</span>,  <span class="hljs-variable">ns</span>:-<span class="hljs-number">1</span>:-<span class="hljs-number">1</span> <span class="hljs-title class_">to</span> -<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>, <span class="hljs-variable">debug</span>:<span class="hljs-number">35854</span>:<span class="hljs-number">35854</span> <span class="hljs-title class_">to</span> <span class="hljs-number">52462</span>:<span class="hljs-number">52462</span>, <span class="hljs-variable">active_code</span>:<span class="hljs-number">0</span>, <span class="hljs-variable">active_thread</span>=<span class="hljs-number">0</span>, <span class="hljs-variable">pending_async_proc</span>=<span class="hljs-number">0</span>                       -&gt; <span class="hljs-number">35854</span>:<span class="hljs-number">35854</span> <span class="hljs-title class_">to</span> <span class="hljs-number">52462</span>:<span class="hljs-number">52462</span> <span class="hljs-title class_">code</span> <span class="hljs-number">3</span> <span class="hljs-title class_">wait</span>:<span class="hljs-number">27.185154163</span> <span class="hljs-title class_">s</span></li><li>    <span class="hljs-number">3712</span>:<span class="hljs-number">3712</span> <span class="hljs-title class_">to</span> <span class="hljs-number">13967</span>:<span class="hljs-number">14076</span> <span class="hljs-title class_">code</span> <span class="hljs-title class_">d2</span> <span class="hljs-title class_">wait</span>:<span class="hljs-number">0.703385417</span> <span class="hljs-title class_">s</span> <span class="hljs-title class_">frz_state</span>:<span class="hljs-number">3</span>,  <span class="hljs-variable">ns</span>:-<span class="hljs-number">1</span>:-<span class="hljs-number">1</span> <span class="hljs-title class_">to</span> -<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>, <span class="hljs-variable">debug</span>:<span class="hljs-number">3712</span>:<span class="hljs-number">3712</span> <span class="hljs-title class_">to</span> <span class="hljs-number">13967</span>:<span class="hljs-number">14076</span>, <span class="hljs-variable">active_code</span>:<span class="hljs-number">0</span>, <span class="hljs-variable">active_thread</span>=<span class="hljs-number">0</span>, <span class="hljs-variable">pending_async_proc</span>=<span class="hljs-number">0</span></li><li>    <span class="hljs-number">52462</span>:<span class="hljs-number">52462</span> <span class="hljs-title class_">to</span> <span class="hljs-number">1386</span>:<span class="hljs-number">0</span> <span class="hljs-title class_">code</span> <span class="hljs-number">13</span> <span class="hljs-title class_">wait</span>:<span class="hljs-number">24.733640622</span> <span class="hljs-title class_">s</span> <span class="hljs-title class_">frz_state</span>:<span class="hljs-number">3</span>,  <span class="hljs-variable">ns</span>:-<span class="hljs-number">1</span>:-<span class="hljs-number">1</span> <span class="hljs-title class_">to</span> -<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>, <span class="hljs-variable">debug</span>:<span class="hljs-number">35854</span>:<span class="hljs-number">35854</span> <span class="hljs-title class_">to</span> <span class="hljs-number">52462</span>:<span class="hljs-number">52462</span>, <span class="hljs-variable">active_code</span>:<span class="hljs-number">0</span> <span class="hljs-title class_">active_thread</span>:<span class="hljs-number">0</span>, <span class="hljs-variable">pending_async_proc</span>=<span class="hljs-number">0</span></li><li>    <span class="hljs-number">1733</span>:<span class="hljs-number">2285</span> <span class="hljs-title class_">to</span> <span class="hljs-number">3712</span>:<span class="hljs-number">3712</span> <span class="hljs-title class_">code</span> <span class="hljs-title class_">b</span> <span class="hljs-title class_">wait</span>:<span class="hljs-number">1.365925521</span> <span class="hljs-title class_">s</span> <span class="hljs-title class_">frz_state</span>:<span class="hljs-number">3</span>,  <span class="hljs-variable">ns</span>:-<span class="hljs-number">1</span>:-<span class="hljs-number">1</span> <span class="hljs-title class_">to</span> -<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>, <span class="hljs-variable">debug</span>:<span class="hljs-number">1733</span>:<span class="hljs-number">2285</span> <span class="hljs-title class_">to</span> <span class="hljs-number">3712</span>:<span class="hljs-number">3712</span>, <span class="hljs-variable">active_code</span>:<span class="hljs-number">0</span>, <span class="hljs-variable">active_thread</span>=<span class="hljs-number">0</span>, <span class="hljs-variable">pending_async_proc</span>=<span class="hljs-number">0</span></li><li>...</li></ol></pre></div></div> <p>以上示例为参考：从故障进程的主线程出发，存在35854:35854 -&gt; 52462:52462 -&gt; 1386:0的调用链关系。</p> <p>结合对端进程堆栈信息排查对端阻塞原因。</p> </li><li>线程号为0<p>表示该应用IPC FULL，即应用的ipc线程都在使用中，没有空闲线程分配来完成本次请求，导致阻塞。例如上面示例中的1386进程</p> <div _ngcontent-ydj-c106="" class="highlight-div"><div _ngcontent-ydj-c106="" class="highlight-div-header"><div _ngcontent-ydj-c106="" class="highlight-div-header-left"><div _ngcontent-ydj-c106="" class="handle-button expand-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-ydj-c106="" class="highlight-div-header-right"><div _ngcontent-ydj-c106="" class="handle-button ai-button"></div><div _ngcontent-ydj-c106="" class="handle-button line-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-ydj-c106="" class="handle-button theme-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-ydj-c106="" class="handle-button copy-button"><div _ngcontent-ydj-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-ydj-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-yaml" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-string">pid</span>      <span class="hljs-string">context</span>      <span class="hljs-string">request</span>       <span class="hljs-string">started</span>       <span class="hljs-string">max</span>       <span class="hljs-string">ready</span>  <span class="hljs-string">free_async_space</span></li><li><span class="hljs-number">35863</span>    <span class="hljs-string">binder</span>     <span class="hljs-number">0</span>          <span class="hljs-number">2</span>         <span class="hljs-number">16</span>        <span class="hljs-number">2</span>      <span class="hljs-number">519984</span></li><li><span class="hljs-number">35854</span>    <span class="hljs-string">binder</span>     <span class="hljs-number">0</span>          <span class="hljs-number">2</span>         <span class="hljs-number">16</span>        <span class="hljs-number">3</span>      <span class="hljs-number">520192</span></li><li><span class="hljs-number">35850</span>    <span class="hljs-string">binder</span>     <span class="hljs-number">0</span>          <span class="hljs-number">2</span>         <span class="hljs-number">16</span>        <span class="hljs-number">3</span>      <span class="hljs-number">520192</span></li><li><span class="hljs-number">13669</span>    <span class="hljs-string">binder</span>     <span class="hljs-number">0</span>          <span class="hljs-number">1</span>         <span class="hljs-number">16</span>        <span class="hljs-number">3</span>      <span class="hljs-number">520192</span></li><li><span class="hljs-number">52516</span>    <span class="hljs-string">binder</span>     <span class="hljs-number">0</span>          <span class="hljs-number">3</span>         <span class="hljs-number">16</span>        <span class="hljs-number">4</span>      <span class="hljs-number">520192</span></li><li><span class="hljs-number">52462</span>    <span class="hljs-string">binder</span>     <span class="hljs-number">0</span>          <span class="hljs-number">9</span>         <span class="hljs-number">16</span>        <span class="hljs-number">8</span>      <span class="hljs-number">520192</span></li><li><span class="hljs-number">16786</span>    <span class="hljs-string">binder</span>     <span class="hljs-number">0</span>          <span class="hljs-number">8</span>         <span class="hljs-number">16</span>        <span class="hljs-number">10</span>     <span class="hljs-number">520192</span></li><li><span class="hljs-number">1972 </span><span class="hljs-string">binder</span>     <span class="hljs-number">0</span>          <span class="hljs-number">1</span>         <span class="hljs-number">16</span>        <span class="hljs-number">3</span>      <span class="hljs-number">520192</span></li><li><span class="hljs-number">1386 </span><span class="hljs-string">binder</span>     <span class="hljs-number">1</span>          <span class="hljs-number">15</span>            <span class="hljs-number">16</span>        <span class="hljs-number">0</span>      <span class="hljs-number">517264</span>                  <span class="hljs-string">-&gt;</span> <span class="hljs-string">binderInfo</span></li><li><span class="hljs-number">1474 </span><span class="hljs-string">binder</span>     <span class="hljs-number">0</span>          <span class="hljs-number">2</span>         <span class="hljs-number">16</span>        <span class="hljs-number">4</span>      <span class="hljs-number">520192</span></li></ol></pre></div></div> <p>可以看到此时1386进程处于ready态的线程为0，验证了上述说法。 此情况说明该进程的其他ipc线程可能全部被阻塞了，需要分析排查为什么其他ipc线程不释放。常见场景为：某一ipc线程持锁阻塞，导致其他所有线程等锁卡死。</p> <p>另一种情况为free_async_space消耗殆尽，导致新的ipc线程没有足够的buffer空间完成请求。值得说明的是，同步和异步请求都会消耗该值，常见场景为：某短时间段内大批量异步请求。</p> </li><li>waitTime过小<p>waitTime表示的是本次ipc通信时长，如果该值远小于故障检测时长，有理由确定本次ipc请求并不是卡死的根本原因。</p> <p>一种典型场景是：应用侧主线程在短时间内多次ipc请求，总请求时长过长导致故障。</p> <p>排查方向：</p> <ul><li>单次请求是否在预期时长内（例如：规格在20ms的请求接口异常情形下达到1s），排查该接口性能不达预期的原因。</li><li>应用侧频繁调用场景是否合理。</li></ul> </li><li>无调用关系，而栈却为ipc栈<p>确定是否为瞬时栈，即warning/block栈是否一致，可能场景是：warning为ipc栈，block栈为其他瞬时栈，表明抓取binder时ipc请求已经结束，本次ipc请求耗时并不长。</p> <p>需要提到的是：binder信息并不是在发生故障时刻实时获取的，有一定的延迟性；对于存在半周期检测的故障类型来说，binder抓取比较准确，绝大多数都可以在故障时间段内完成采集；而其他故障类型在上报存在延迟的情况下可能抓取到非现场binder。</p> <p>当然，结合trace分析更能直观查看binder耗时情况。</p> </li></ol> <div class="tiledSection"><h3 id="section14669182210579">结合HiLog信息<i class="anchor-icon anchor-icon-link" anchorid="section14669182210579" tips="复制节点链接"></i></h3></div> <p>DFX 相关打印：</p> <ol><li>故障上报时间点<p>搜索关键词“Start NotifyAppFault”确定流水中故障上报时间点。</p> </li><li>后台检测（5次后上报）<p>搜索关键词“In Background, thread may be blocked in, do not report this time”，判断故障检测时长是否达到 21s。</p> </li><li>抓栈（signal: 35）<p>搜索关键词“DfxFaultLogger: Receive dump request”获取故障抓栈时间点，结合故障上报时间点判断抓栈时机是否准确。</p> </li><li>记录查杀原因<p>搜索关键词“hisysevent write result=0, send event [FRAMEWORK,PROCESS_KILL]”获取故障查杀原因，结合AppRecovery。</p> </li><li>应用退出<p>搜索关键词“is going to exit due to APP_FREEZE”获取应用退出时间点</p> <p>一种可能的场景：应用退出时还未完成抓栈，该情况下无法获取到栈信息。</p> <p>一般分析步骤：</p> <ol><li>确定故障上报时间点</li><li>推断故障检测区间</li><li>判断该时间区间内应用主线程运行状态：</li></ol> <p>应用主线程日志完全无打应输出：卡死在最后日志打印的接口调用处</p> <p><span><img originheight="212" originwidth="1403" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163452.53640022504316092697565413147350:50001231000000:2800:721102C01F1388A4EAE7B9CD905E503A1A9C012F974DC47E885B367D49E36DB1.png" width="920" height="139.01639344262293"></span><span><img originheight="248" originwidth="1338" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163452.21553094177461692217056196838822:50001231000000:2800:22F206590841791F0F19F7FEAE3AECA988F5FA8C687CFDBDED2AAA250244A2FB.png" width="920" height="170.52316890881912"></span>例如示例：APP_INPUT_BLOCK 类型在07:24:08.167上报，应用主线程在07:24:01.581后就没有打印了，可排查是否为FormManagerService: [form_mgr_proxy.cpp(GetFormsInfoByApp:1128)]中的逻辑超时。</p> <p>应用高频打印输出同类日志：分析对应输出表示的场景及其合理性</p> <p><span><img originheight="857" originwidth="1596" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163452.72361751206803278032089280615630:50001231000000:2800:709578E81AB88B1F8F47A0A04CBF8C471D3517912B563285602FB3A1EC9E4E20.png" width="920" height="494.0100250626566"></span>例如示例：进程在被杀死前在大量输出，对应的ImageEffect领域需排查此日志是否正常，是否陷入死循环或频繁调用场景。</p> </li></ol> <div class="tiledSection"><h3 id="section4406119105814">结合trace信息<i class="anchor-icon anchor-icon-link" anchorid="section4406119105814" tips="复制节点链接"></i></h3><p>当前应用冻屏获取trace仅支持log版本，请参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/hilog#查看log版本信息" target="_blank">查看log版本信息</a>。trace规格及获取详见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/hitrace" target="_blank">hitrace</a>。</p> <ol><li>进程频繁执行密集任务超时<p><span><img height="197.3233780110228" originheight="545" originwidth="2541" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163453.05860018076597190157647911452930:50001231000000:2800:34D40D104A189EF1E17B5E03820CB444FDD1BDCF60704B7D94196EC7C4CB4EF8.png" title="点击放大" width="920"></span><span><img originheight="217" originwidth="989" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163453.00676972533569026970597037745668:50001231000000:2800:7A369486473C6F3950C3A60A3C8635E8E1ECEA0F5D1026A849E2279FC1DFEE0E.png" width="920" height="201.86046511627907"></span></p> <p>示例为：PreviewArea::updateShotComponent（更新组件） -&gt; ohos.animator （执行动画）-&gt; 密集的动画执行过程达9.2s；</p> <p>线程繁忙地循环执行某业务，分析每一小段业务：</p> <ol><li>不符合业务场景（此处不应该频繁调用），分析业务代码，为何会循环执行；</li><li>符合业务场景，分析每一小段业务是否耗时超过预期，性能为何不满足设计规格；</li></ol> </li><li>进程执行某一任务超时<p><span><img height="376.77902006897665" originheight="1039" originwidth="2537" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163453.14861171477097414947207508042604:50001231000000:2800:9194EE1C01AD318C3453F90EA6D370CEB6A647F7DC7CDC3103D8EADCE474B12F.png" title="点击放大" width="920"></span></p> <p>示例为：OHOS::AppExecFwk::FormMgrAdapter::GetFormsInfoByApp接口执行时长达到8s。</p> </li><li>进程多段任务累积超时<p><span><img height="326.71295282112976" originheight="815" originwidth="2295" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163453.83781863614927933444094530274231:50001231000000:2800:70599F4320473FAD8830DF637C16AEAB0F420D5A888382EE483FB014DC025243.png" title="点击放大" width="920"></span>示例中：三段任务累积到达6s超时，判断场景为屏幕旋转后页面动画超时。</p> </li></ol> </div> </div> <div></div></div>