<h1 _ngcontent-ujj-c119="" class="doc-title ng-star-inserted" title="应用功耗体验"> 应用功耗体验 </h1>

<div _ngcontent-ujj-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section17591151815503">应用功耗体验建议<i class="anchor-icon anchor-icon-link" anchorid="section17591151815503" tips="复制节点链接"></i></h2><p>应用功耗体验是用户在使用应用程序时的重要考量因素之一。因为手机等移动设备具有便携、移动的属性，其续航时间的长短直接影响用户对移动设备的体验和满意度。移动设备的续航时间越长，用户在户外或旅行场景下就能获得更便利的使用体验。为了提升应用的功耗体验、规范应用全生命周期软硬件资源合理使用，应用在开发阶段和测试阶段可以参考以下体验建议。</p> <p>主要包括如下两种场景：</p> <ul><li><strong>前台场景：</strong>当应用或元服务处于设备屏幕的顶层时，用户可以直接看到并进行操作，即为前台场景。<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/standard-foreground-power" target="_blank">前台场景功耗规范</a>提供了关于应用前台帧率、前台绘制渲染、前台资源使用的功耗规范。</li><li><strong>后台场景：</strong>当应用或元服务未处于设备屏幕的顶层时，用户无法直接看到或进行操作，即为后台场景。<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/standard-background-power" target="_blank">后台场景功耗规范</a>提供了关于后台任务、后台硬件资源、后台软件资源的使用规范。</li></ul> <p>本标准适用于应用和元服务的低功耗设计、开发及检测。</p> </div> <div class="tiledSection"><h2 id="section818174004918">应用功耗体验设计<i class="anchor-icon anchor-icon-link" anchorid="section818174004918" tips="复制节点链接"></i></h2><p>应用功耗体验是指用户在使用应用时对应用所消耗电量（即功耗）的感受和反馈。高功耗不仅会导致设备发热、续航时间缩短，还可能引发用户的电量焦虑，从而影响用户体验、降低用户的使用意愿。因此如何在应用运行期间保持低功耗是应用开发过程中无法避免的话题。</p> <p>根据用户感知情况，任务分为用户可见的前台任务与不可见的后台任务。低功耗指设备通过技术策略降低能耗，从而延长电池寿命和使用时间。</p> <ul><li><strong>前台任务</strong>：<p>前台任务指那些直接与用户进行交互的任务，它们通常会在用户界面中显示，并实时响应用户的操作。这些任务通常具有以下几个特点：</p> <ol><li>用户交互：前台任务需要处理用户的输入，如点击、滑动、输入文本等，并实时更新用户界面以反映这些操作的结果。</li><li>实时性：前台任务通常需要实时响应用户的操作，以确保用户界面的流畅性和响应性。</li><li>资源占用：由于前台任务需要与用户进行交互，并实时更新用户界面，因此它们通常会占用较多的CPU、内存和图形处理资源。</li></ol> </li><li><strong>后台任务</strong>：<p>后台任务是指那些不需要与用户直接交互，或者仅在用户不可见的情况下运行的任务。这些任务通常具有以下几个特点：</p> <ol><li>非交互性：后台任务通常不需要处理用户的直接输入，而是根据预设的逻辑或定时任务来执行。</li><li>低优先级：与前台任务相比，后台任务的优先级通常较低。操作系统会根据资源使用情况和其他因素来调度后台任务的执行。</li><li>资源占用较少：由于后台任务不需要实时更新用户界面或处理用户输入，因此它们通常会占用较少的CPU、内存和图形处理资源。然而，某些后台任务（如数据同步、文件下载等）可能会在网络或存储资源上产生较大的开销。</li></ol> </li></ul> <p>为了保障用户良好的功耗体验，开发者需要合理设计和管理应用的前台和后台任务来保障应用低功耗运行。</p> </div> <div class="tiledSection"><h3 id="section204811057191419" class="firsth2">前台任务低功耗设计<i class="anchor-icon anchor-icon-link" anchorid="section204811057191419" tips="复制节点链接"></i></h3><p>前台任务功耗是指应用在用户可见并与其交互时的功耗。在这种情况下，应用需要处理大量的用户界面（UI）更新、事件处理、计算任务以及网络请求等。这些操作都会消耗大量的CPU、内存、网络以及屏幕等资源，从而导致较高的功耗。</p> <p>本节主要针对前台场景下的帧率、前台绘制渲染以及前台资源使用三个方向提供低功耗设计。</p> <p><strong>帧率</strong></p> <p>帧率相关的详细低功耗体验设计可参考：<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-ltpo-description#section073373341913" target="_blank">基于LTPO的低功耗设计</a>。</p> <p><a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-ltpo-description#section132241429121713" target="_blank">LTPO</a>指自适应刷新率技术。通过按需自适应调整显示刷新率，实现最优的性能和功耗体验。应用通过适配LTPO可以精细化场景帧率控制，降低场景负载，减少偶发卡顿，降低场景功耗。</p> <p>可变帧率能力支持开发者自定义应用业务的帧率，其常见的使用场景：</p> <ul><li>通过配置属性动画/显示动画的帧率属性参数，用于动画的绘制，具体可见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/displaysync-animation" target="_blank">请求动画绘制帧率</a>。</li><li>通过申请一个独立的绘制帧率，用于UI的绘制，具体可见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/displaysync-ui" target="_blank">请求UI绘制帧率</a>。</li><li>通过XComponent在Native侧申请独立的绘制帧率，用于游戏等自绘制内容的绘制，具体可见<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/displaysync-xcomponent" target="_blank">请求自绘制内容绘制帧率</a>。</li></ul> <p><strong>前台绘制渲染</strong></p> <p>前台绘制渲染相关的详细低功耗体验设计可参考：<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-low-power-design-in-dark-mode" target="_blank">省电和深色模式下低功耗设计</a>与<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-utilize-hwc-efficiently" target="_blank">高效利用HWC的低功耗设计</a>。</p> <p>HarmonyOS默认提供了电源模式的特性，主要分为以下三类：正常模式、性能模式以及省电模式。当设备电量较低时，系统可以切换至<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-low-power-design-in-dark-mode#section1335695914514" target="_blank">省电模式</a>，以减少设备的能耗并延长电池的使用时间。通过与系统省电模式的配合，应用程序可以更加智能地调整自身的功耗策略，以适应设备电量较低的情况，从而延长设备的续航时间，提供更加稳定和持久的使用体验。</p> <p><a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-low-power-design-in-dark-mode#section221914535123" target="_blank">深色模式</a>使用更少的像素点和背光，因此能够减少能量的消耗。其次，深色模式在OLED屏幕上可以关闭像素点，这一特性进一步减少了能耗。</p> <p>系统基于的芯片平台除了通用的CPU/GPU计算单元外，还提供了<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-utilize-hwc-efficiently#li10223152812152" target="_blank">Hardware Composer</a>（下文简称HWC）专用硬件辅助系统进行图形渲染送显，相对于通用计算单元，在图层叠加场景具有更高的处理效率和更低的能耗。作为专用硬件单元，HWC需要满足一定条件才能充分发挥其硬件能力，降低系统CPU/GPU开销，减少发热和卡顿现象的出现。</p> <p><strong>前台资源使用</strong></p> <p>前台资源相关的详细低功耗体验设计可参考：<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-properly-use-foreground-resources" target="_blank">合理使用前台资源</a>。</p> <p>应用前台使用系统资源不当，可能会造成设备耗电快、发热等现象。通过前台资源使用的相关低功耗规则，可以帮助开发者降低设备耗电速度，保障用户功耗基础体验。</p> <p>目前主要提供了音乐播放、导航定位、静态场景、视频场景以及网络资源等前台资源使用的低功耗规则与建议。</p> </div> <div class="tiledSection"><h3 id="section1391517111518">后台任务低功耗设计<i class="anchor-icon anchor-icon-link" anchorid="section1391517111518" tips="复制节点链接"></i></h3><p>后台任务功耗是指应用在用户不可见且未与其交互时的功耗。与前台任务相比，后台任务通常不需要处理大量的UI更新和事件，因此功耗相对较低。然而，后台任务仍然需要执行一些必要的操作，如数据同步、状态更新等，这些操作也会消耗一定的资源。</p> <p>本节主要针对后台场景下的任务、硬件以及软件资源使用三个方向提供低功耗设计。</p> <p><strong>后台任务</strong></p> <p>后台任务相关的详细低功耗体验设计可参考：<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-use-of-background-tasks" target="_blank">合理使用后台任务</a>。</p> <p>应用退至后台后，如果继续活动，可能会造成设备耗电快、用户界面卡顿等现象。为了降低设备耗电速度、保障用户使用流畅度，系统会对退至后台的应用进行管控，包括进程挂起和进程终止。为了保障后台音乐播放、日历提醒等功能的正常使用，系统提供了规范内受约束的后台任务，扩展应用在后台运行时间。</p> <p><strong>后台硬件资源</strong></p> <p>后台硬件资源相关的详细低功耗体验设计可参考：<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-use-of-background-hardware-resources" target="_blank">合理使用后台硬件资源</a>。</p> <p>后台硬件资源通常指的是支持后台运行和服务所需的物理设备及其相关组件。后台硬件资源是确保后台系统稳定运行和高效性能的基础。通过合理配置、优化和管理这些资源，可以满足后台系统的各种需求，提升系统的整体性能和稳定性、降低设备整体功耗。</p> <p>目前主要提供了CPU、蓝牙、网络、音频、GPS、传感器等后台硬件资源使用的规范与建议。</p> <p><strong>后台软件资源</strong></p> <p>后台软件资源相关的详细低功耗体验设计可参考：<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-use-of-background-software-resources" target="_blank">合理使用后台软件资源</a>。</p> <p>后台软件资源是指那些支持后台操作和服务的软件系统，这些资源在确保后台系统的正常运行、数据处理、业务逻辑实现以及与前端的交互等方面发挥着至关重要的作用。合理使用这些资源可以提高系统整体的性能、降低设备整体功耗。</p> <p>目前主要提供了上传下载、音频播放、定位导航以及系统资源等后台软件资源使用的规范与建议。</p> </div> <div class="tiledSection"><h2 id="section162891359104916">应用功耗关键指标<i class="anchor-icon anchor-icon-link" anchorid="section162891359104916" tips="复制节点链接"></i></h2><p>综合考虑业界共识指标和实际用户使用体验，将主要对比屏幕显示耗电量、CPU耗电量、GPU耗电量以及最终总耗电量，关键指标详情如下所示：</p> <ul><li>显示耗电量：显示耗电量是手机耗电的主要来源之一，它通常占总能耗的很大比例，影响显示耗电量的关键因素包括屏幕亮度、显示内容、刷新率等。</li></ul> <ul><li>CPU耗电量：高性能的任务通常需要更多的CPU计算能力，通常会导致较高的CPU耗电量，影响CPU耗电量的关键因素包括CPU的工作频率、功耗管理策略以及对任务的调度和分配等。</li><li>GPU耗电量：类似于CPU，高性能的图形任务会导致较高的GPU耗电量，影响GPU耗电量的关键因素包括GPU的工作频率、工作负载、绘制内容、分辨率、绘制帧率等。</li><li>最终总耗电量：最终总耗电量是指设备在特定使用场景下的总能耗，包括屏幕显示、CPU计算和GPU图形处理等。它反映了设备在某种使用情境下的总体能耗水平。</li></ul> <p>通过对应用功耗关键指标的检测与分析，可以帮助开发者降低应用运行时的总功耗、提高用户体验感。详细的应用功耗检测与分析方法可参考<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-power-consumption-analysis" target="_blank">应用功耗检测与分析</a>。</p> </div> </div> <div></div></div>