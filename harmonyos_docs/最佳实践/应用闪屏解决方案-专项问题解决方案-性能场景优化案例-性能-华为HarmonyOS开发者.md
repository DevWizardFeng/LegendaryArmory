<h1 _ngcontent-nni-c119="" class="doc-title ng-star-inserted" title="应用闪屏解决方案"> 应用闪屏解决方案 </h1>

<div _ngcontent-nni-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section355817236202">概述<i class="anchor-icon anchor-icon-link" anchorid="section355817236202" tips="复制节点链接"></i></h2><p>在开发调试过程中，可能会遇到应用出现非预期的闪动，这种现象称为闪屏问题。闪屏问题的触发原因和表现形式各异，但都会影响应用的体验性和流畅度。</p> <p>本文概述几种常见的闪屏场景，分析其成因，并提供针对性解决方案，帮助开发者有效应对这些问题。</p> <ul><li>动画过程闪屏</li><li>刷新过程闪屏</li></ul> </div> <div class="tiledSection"><h2 id="section6410109151910">常见问题<i class="anchor-icon anchor-icon-link" anchorid="section6410109151910" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section1812295572019" class="firsth2">动画过程中，应用连续点击场景下的闪屏问题<i class="anchor-icon anchor-icon-link" anchorid="section1812295572019" tips="复制节点链接"></i></h3></div> <p><strong>问题现象</strong></p> <p>连续点击后，图标大小会异常变化，导致闪屏。</p> <p><span><img height="533.77422" originheight="1080" originwidth="523" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163419.59602657693430731561545824645519:50001231000000:2800:E96CE15B07626CFE4D9EF273AB934262CD36C0E1EFC9429AEE846C292A5F6591.gif" title="点击放大" width="268.99476100000004"></span></p> <div class="screenLinkPre"><div _ngcontent-nni-c106="" class="highlight-div"><div _ngcontent-nni-c106="" class="highlight-div-header"><div _ngcontent-nni-c106="" class="highlight-div-header-left"><div _ngcontent-nni-c106="" class="handle-button expand-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nni-c106="" class="highlight-div-header-right"><div _ngcontent-nni-c106="" class="handle-button ai-button"></div><div _ngcontent-nni-c106="" class="handle-button line-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nni-c106="" class="handle-button theme-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nni-c106="" class="handle-button copy-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nni-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_samples/BestPracticeSnippets/blob/master/ScreenFlickerSolution/entry/src/main/ets/pages/ClickError.ets#L17-L60" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct ClickError {</li><li>  <span class="hljs-meta">@State</span> scaleValue: number = <span class="hljs-number">0.5</span>; <span class="hljs-comment">// Pantograph ratio</span></li><li>  <span class="hljs-meta">@State</span> animated: boolean = <span class="hljs-literal">true</span>; <span class="hljs-comment">// Control zoom</span></li><li>
</li><li>  build() {</li><li>    Stack() {</li><li>      Stack() {</li><li>        Text(<span class="hljs-string">'click'</span>)</li><li>          .fontSize(<span class="hljs-number">45</span>)</li><li>          .fontColor(Color.White)</li><li>      }</li><li>      .borderRadius(<span class="hljs-number">50</span>)</li><li>      .width(<span class="hljs-number">100</span>)</li><li>      .height(<span class="hljs-number">100</span>)</li><li>      .backgroundColor(<span class="hljs-string">'#e6cfe6'</span>)</li><li>      .scale({ x: <span class="hljs-keyword">this</span>.scaleValue, y: <span class="hljs-keyword">this</span>.scaleValue })</li><li>      .onClick(() =&gt; {</li><li>        <span class="hljs-comment">// When the animation is delivered, the count is increased by 1</span></li><li>        <span class="hljs-keyword">this</span>.getUIContext().animateTo({</li><li>          curve: Curve.EaseInOut,</li><li>          duration: <span class="hljs-number">350</span>,</li><li>          onFinish: () =&gt; {</li><li>            <span class="hljs-comment">// At the end of the animation, the count is reduced by 1</span></li><li>            <span class="hljs-comment">// A count of 0 indicates the end of the last animation</span></li><li>              <span class="hljs-comment">// Determine the final zoom size at the end of the animation</span></li><li>              <span class="hljs-keyword">const</span> EPSILON: number = <span class="hljs-number">1e-6</span>;</li><li>              <span class="hljs-keyword">if</span> (Math.abs(<span class="hljs-keyword">this</span>.scaleValue - <span class="hljs-number">0.5</span>) &lt; EPSILON) {</li><li>                <span class="hljs-keyword">this</span>.scaleValue = <span class="hljs-number">1</span>;</li><li>              } <span class="hljs-keyword">else</span> {</li><li>                <span class="hljs-keyword">this</span>.scaleValue = <span class="hljs-number">2</span>;</li><li>              }</li><li>          },</li><li>        }, () =&gt; {</li><li>          <span class="hljs-keyword">this</span>.animated = !<span class="hljs-keyword">this</span>.animated;</li><li>          <span class="hljs-keyword">this</span>.scaleValue = <span class="hljs-keyword">this</span>.animated ? <span class="hljs-number">0.5</span> : <span class="hljs-number">2.5</span>;</li><li>        })</li><li>      })</li><li>    }</li><li>    .height(<span class="hljs-string">'100%'</span>)</li><li>    .width(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/BestPracticeSnippets/blob/master/ScreenFlickerSolution/entry/src/main/ets/pages/ClickError.ets#L17-L60" target="_blank">ClickError.ets</a></div></div></div></div> <p><strong><span style="color: rgb(73,73,73);">可能原因</span></strong></p> <p>在动画结束回调中修改了属性值。图标连续放大和缩小时，动画连续改变属性值，同时结束回调也直接修改属性值，导致过程中属性值异常，效果不符合预期。所有动画结束后，效果通常可恢复正常，但会出现跳变。</p> <p><strong><span style="color: rgb(73,73,73);">解决措施</span></strong></p> <ul><li>如果在动画结束回调中设值，可以通过计数器等方法判断属性上是否还有动画。</li><li>仅在属性上最后一个动画结束时，结束回调中才设值，避免因动画打断导致异常。<div class="screenLinkPre"><div _ngcontent-nni-c106="" class="highlight-div"><div _ngcontent-nni-c106="" class="highlight-div-header"><div _ngcontent-nni-c106="" class="highlight-div-header-left"><div _ngcontent-nni-c106="" class="handle-button expand-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nni-c106="" class="highlight-div-header-right"><div _ngcontent-nni-c106="" class="handle-button ai-button"></div><div _ngcontent-nni-c106="" class="handle-button line-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nni-c106="" class="handle-button theme-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nni-c106="" class="handle-button copy-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nni-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_samples/BestPracticeSnippets/blob/master/ScreenFlickerSolution/entry/src/main/ets/pages/ClickRight.ets#L17-L65" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct ClickRight {</li><li>  <span class="hljs-meta">@State</span> scaleValue: number = <span class="hljs-number">0.5</span>; <span class="hljs-comment">// Pantograph ratio</span></li><li>  <span class="hljs-meta">@State</span> animated: boolean = <span class="hljs-literal">true</span>; <span class="hljs-comment">// Control zoom</span></li><li>  <span class="hljs-meta">@State</span> cnt: number = <span class="hljs-number">0</span>; <span class="hljs-comment">// Run counter</span></li><li>
</li><li>  build() {</li><li>    Stack() {</li><li>      Stack() {</li><li>        Text(<span class="hljs-string">'click'</span>)</li><li>          .fontSize(<span class="hljs-number">45</span>)</li><li>          .fontColor(Color.White)</li><li>      }</li><li>      .borderRadius(<span class="hljs-number">50</span>)</li><li>      .width(<span class="hljs-number">100</span>)</li><li>      .height(<span class="hljs-number">100</span>)</li><li>      .backgroundColor(<span class="hljs-string">'#e6cfe6'</span>)</li><li>      .scale({ x: <span class="hljs-keyword">this</span>.scaleValue, y: <span class="hljs-keyword">this</span>.scaleValue })</li><li>      .onClick(() =&gt; {</li><li>        <span class="hljs-comment">// When the animation is delivered, the count is increased by 1</span></li><li>        <span class="hljs-keyword">this</span>.cnt = <span class="hljs-keyword">this</span>.cnt + <span class="hljs-number">1</span>;</li><li>        <span class="hljs-keyword">this</span>.getUIContext().animateTo({</li><li>          curve: Curve.EaseInOut,</li><li>          duration: <span class="hljs-number">350</span>,</li><li>          onFinish: () =&gt; {</li><li>            <span class="hljs-comment">// At the end of the animation, the count is reduced by 1</span></li><li>            <span class="hljs-keyword">this</span>.cnt = <span class="hljs-keyword">this</span>.cnt - <span class="hljs-number">1</span>;</li><li>            <span class="hljs-comment">// A count of 0 indicates the end of the last animation</span></li><li>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.cnt === <span class="hljs-number">0</span>) {</li><li>              <span class="hljs-comment">// Determine the final zoom size at the end of the animation</span></li><li>              <span class="hljs-keyword">const</span> EPSILON: number = <span class="hljs-number">1e-6</span>;</li><li>              <span class="hljs-keyword">if</span> (Math.abs(<span class="hljs-keyword">this</span>.scaleValue - <span class="hljs-number">0.5</span>) &lt; EPSILON) {</li><li>                <span class="hljs-keyword">this</span>.scaleValue = <span class="hljs-number">1</span>;</li><li>              } <span class="hljs-keyword">else</span> {</li><li>                <span class="hljs-keyword">this</span>.scaleValue = <span class="hljs-number">2</span>;</li><li>              }</li><li>            }</li><li>          },</li><li>        }, () =&gt; {</li><li>          <span class="hljs-keyword">this</span>.animated = !<span class="hljs-keyword">this</span>.animated;</li><li>          <span class="hljs-keyword">this</span>.scaleValue = <span class="hljs-keyword">this</span>.animated ? <span class="hljs-number">0.5</span> : <span class="hljs-number">2.5</span>;</li><li>        })</li><li>      })</li><li>    }</li><li>    .height(<span class="hljs-string">'100%'</span>)</li><li>    .width(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/BestPracticeSnippets/blob/master/ScreenFlickerSolution/entry/src/main/ets/pages/ClickRight.ets#L17-L65" target="_blank">ClickRight.ets</a></div></div></div></div> </li></ul> <p>运行效果如下图。</p> <p><span><img height="526.39272" originheight="1080" originwidth="523" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163419.23407405619881636734234347936184:50001231000000:2800:BECD4E0204B187F26DB74BF15471329183D1664168B6DD48128A79727F69F6E5.gif" title="点击放大" width="268.59084"></span></p> <div class="tiledSection"><h3 id="section14619105652317">动画过程中，Tabs页签切换场景下的闪屏问题<i class="anchor-icon anchor-icon-link" anchorid="section14619105652317" tips="复制节点链接"></i></h3><p><strong>问题现象</strong></p> <p>滑动Tabs组件时，上方标签不能同步更新。下方内容完全切换后，标签闪动跳转，产生闪屏。</p> <p><span><img height="523.99872" originheight="1080" originwidth="523" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163419.63470925251587360163329061815189:50001231000000:2800:0ED8653B48D8EF9BFC3AD69038CCD436BB6643DDC12428279EC62903A993484E.gif" title="点击放大" width="271.55541"></span></p> <div class="screenLinkPre"><div _ngcontent-nni-c106="" class="highlight-div"><div _ngcontent-nni-c106="" class="highlight-div-header"><div _ngcontent-nni-c106="" class="highlight-div-header-left"><div _ngcontent-nni-c106="" class="handle-button expand-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nni-c106="" class="highlight-div-header-right"><div _ngcontent-nni-c106="" class="handle-button ai-button"></div><div _ngcontent-nni-c106="" class="handle-button line-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nni-c106="" class="handle-button theme-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nni-c106="" class="handle-button copy-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nni-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_samples/BestPracticeSnippets/blob/master/ScreenFlickerSolution/entry/src/main/ets/pages/TabsError.ets#L17-L112" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct TabsContainer {</li><li>  <span class="hljs-meta">@State</span> currentIndex: number = <span class="hljs-number">0</span></li><li>  <span class="hljs-meta">@State</span> animationDuration: number = <span class="hljs-number">300</span>;</li><li>  <span class="hljs-meta">@State</span> indicatorLeftMargin: number = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-meta">@State</span> indicatorWidth: number = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-keyword">private</span> tabsWidth: number = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-keyword">private</span> textInfos: [number, number][] = [];</li><li>  <span class="hljs-keyword">private</span> isStartAnimateTo: boolean = <span class="hljs-literal">false</span>;</li><li>
</li><li>  <span class="hljs-meta">@Builder</span></li><li>  tabBuilder(index: number, name: string) {</li><li>    Column() {</li><li>      Text(name)</li><li>        .fontSize(<span class="hljs-number">16</span>)</li><li>        .fontColor(<span class="hljs-keyword">this</span>.currentIndex === index ? $r(<span class="hljs-string">'sys.color.brand'</span>) : $r(<span class="hljs-string">'sys.color.ohos_id_color_text_secondary'</span>))</li><li>        .fontWeight(<span class="hljs-keyword">this</span>.currentIndex === index ? <span class="hljs-number">500</span> : <span class="hljs-number">400</span>)</li><li>        .id(index.toString())</li><li>        .onAreaChange((_oldValue: Area, newValue: Area) =&gt; {</li><li>          <span class="hljs-keyword">this</span>.textInfos[index] = [newValue.globalPosition.x <span class="hljs-keyword">as</span> number, newValue.width <span class="hljs-keyword">as</span> number];</li><li>          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.currentIndex === index &amp;&amp; !<span class="hljs-keyword">this</span>.isStartAnimateTo) {</li><li>            <span class="hljs-keyword">this</span>.indicatorLeftMargin = <span class="hljs-keyword">this</span>.textInfos[index][<span class="hljs-number">0</span>];</li><li>            <span class="hljs-keyword">this</span>.indicatorWidth = <span class="hljs-keyword">this</span>.textInfos[index][<span class="hljs-number">1</span>];</li><li>          }</li><li>        })</li><li>    }</li><li>    .width(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>
</li><li>  build() {</li><li>    Stack({ alignContent: Alignment.TopStart }) {</li><li>      Tabs({ barPosition: BarPosition.Start }) {</li><li>        TabContent() {</li><li>          Column()</li><li>            .width(<span class="hljs-string">'100%'</span>)</li><li>            .height(<span class="hljs-string">'100%'</span>)</li><li>            .backgroundColor(Color.Green)</li><li>            .expandSafeArea([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])</li><li>        }</li><li>        .tabBar(<span class="hljs-keyword">this</span>.tabBuilder(<span class="hljs-number">0</span>, <span class="hljs-string">'green'</span>))</li><li>        .expandSafeArea([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])</li><li>
</li><li>        TabContent() {</li><li>          Column()</li><li>            .width(<span class="hljs-string">'100%'</span>)</li><li>            .height(<span class="hljs-string">'100%'</span>)</li><li>            .backgroundColor(Color.Blue)</li><li>            .expandSafeArea([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])</li><li>        }</li><li>        .tabBar(<span class="hljs-keyword">this</span>.tabBuilder(<span class="hljs-number">1</span>, <span class="hljs-string">'blue'</span>))</li><li>        .expandSafeArea([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])</li><li>
</li><li>        TabContent() {</li><li>          Column()</li><li>            .width(<span class="hljs-string">'100%'</span>)</li><li>            .height(<span class="hljs-string">'100%'</span>)</li><li>            .backgroundColor(Color.Yellow)</li><li>            .expandSafeArea([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])</li><li>        }</li><li>        .tabBar(<span class="hljs-keyword">this</span>.tabBuilder(<span class="hljs-number">2</span>, <span class="hljs-string">'yellow'</span>))</li><li>        .expandSafeArea([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])</li><li>
</li><li>        TabContent() {</li><li>          Column()</li><li>            .width(<span class="hljs-string">'100%'</span>)</li><li>            .height(<span class="hljs-string">'100%'</span>)</li><li>            .backgroundColor(Color.Pink)</li><li>            .expandSafeArea([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])</li><li>        }</li><li>        .tabBar(<span class="hljs-keyword">this</span>.tabBuilder(<span class="hljs-number">3</span>, <span class="hljs-string">'pink'</span>))</li><li>        .expandSafeArea([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])</li><li>      }</li><li>      .onAreaChange((_oldValue: Area, newValue: Area) =&gt; {</li><li>        <span class="hljs-keyword">this</span>.tabsWidth = newValue.width <span class="hljs-keyword">as</span> number;</li><li>      })</li><li>      .barWidth(<span class="hljs-string">'100%'</span>)</li><li>      .barHeight(<span class="hljs-number">56</span>)</li><li>      .width(<span class="hljs-string">'100%'</span>)</li><li>      .expandSafeArea([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])</li><li>      .backgroundColor(<span class="hljs-string">'#F1F3F5'</span>)</li><li>      .animationDuration(<span class="hljs-keyword">this</span>.animationDuration)</li><li>      .onChange((index: number) =&gt; {</li><li>        <span class="hljs-keyword">this</span>.currentIndex = index; <span class="hljs-comment">// Monitor changes in index and switch TAB contents.</span></li><li>      })</li><li>
</li><li>      Column()</li><li>        .height(<span class="hljs-number">2</span>)</li><li>        .borderRadius(<span class="hljs-number">1</span>)</li><li>        .width(<span class="hljs-keyword">this</span>.indicatorWidth)</li><li>        .margin({ left: <span class="hljs-keyword">this</span>.indicatorLeftMargin, top: <span class="hljs-number">48</span> })</li><li>        .backgroundColor($r(<span class="hljs-string">'sys.color.brand'</span>))</li><li>    }</li><li>    .width(<span class="hljs-string">'100%'</span>)</li><li>  }</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/BestPracticeSnippets/blob/master/ScreenFlickerSolution/entry/src/main/ets/pages/TabsError.ets#L17-L112" target="_blank">TabsError.ets</a></div></div></div></div> </div> <p><strong><span style="color: rgb(73,73,73);">可能原因</span></strong></p> <p>在Tabs左右翻页动画的结束回调中，刷新选中页面的索引值。这导致页面左右转场动画结束时，页签栏中索引对应的页签样式（如字体大小、下划线等）立即改变，从而产生闪屏现象。</p> <p><strong><span style="color: rgb(73,73,73);">解决措施</span></strong></p> <p>在左右跟手翻页过程中，通过 <a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-container-tabs#tabsanimationevent11对象说明" target="_blank">TabsAnimationEvent</a> 事件获取手指滑动距离，改变下划线在前后两个子页签间的位置。离手触发翻页动画时，同步触发下划线动画，确保下划线与页面左右转场动画同步。</p> <div class="screenLinkPre"><div _ngcontent-nni-c106="" class="highlight-div"><div _ngcontent-nni-c106="" class="highlight-div-header"><div _ngcontent-nni-c106="" class="highlight-div-header-left"><div _ngcontent-nni-c106="" class="handle-button expand-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nni-c106="" class="highlight-div-header-right"><div _ngcontent-nni-c106="" class="handle-button ai-button"></div><div _ngcontent-nni-c106="" class="handle-button line-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nni-c106="" class="handle-button theme-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nni-c106="" class="handle-button copy-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nni-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_samples/BestPracticeSnippets/blob/master/ScreenFlickerSolution/entry/src/main/ets/pages/TabsRight.ets#L47-L126" data-highlighted="yes"><ol class="linenums"><li>build() {</li><li>  Stack({ alignContent: Alignment.TopStart }) {</li><li>    Tabs({ barPosition: BarPosition.Start }) {</li><li>      TabContent() {</li><li>        Column()</li><li>          .width(<span class="hljs-string">'100%'</span>)</li><li>          .height(<span class="hljs-string">'100%'</span>)</li><li>          .backgroundColor(Color.Green)</li><li>          .expandSafeArea([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])</li><li>      }</li><li>      .tabBar(<span class="hljs-keyword">this</span>.tabBuilder(<span class="hljs-number">0</span>, <span class="hljs-string">'green'</span>))</li><li>      .expandSafeArea([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])</li><li>
</li><li>      TabContent() {</li><li>        Column()</li><li>          .width(<span class="hljs-string">'100%'</span>)</li><li>          .height(<span class="hljs-string">'100%'</span>)</li><li>          .backgroundColor(Color.Blue)</li><li>          .expandSafeArea([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])</li><li>      }</li><li>      .tabBar(<span class="hljs-keyword">this</span>.tabBuilder(<span class="hljs-number">1</span>, <span class="hljs-string">'blue'</span>))</li><li>      .expandSafeArea([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])</li><li>
</li><li>      TabContent() {</li><li>        Column()</li><li>          .width(<span class="hljs-string">'100%'</span>)</li><li>          .height(<span class="hljs-string">'100%'</span>)</li><li>          .backgroundColor(Color.Yellow)</li><li>          .expandSafeArea([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])</li><li>      }</li><li>      .tabBar(<span class="hljs-keyword">this</span>.tabBuilder(<span class="hljs-number">2</span>, <span class="hljs-string">'yellow'</span>))</li><li>      .expandSafeArea([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])</li><li>
</li><li>      TabContent() {</li><li>        Column()</li><li>          .width(<span class="hljs-string">'100%'</span>)</li><li>          .height(<span class="hljs-string">'100%'</span>)</li><li>          .backgroundColor(Color.Pink)</li><li>          .expandSafeArea([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])</li><li>      }</li><li>      .tabBar(<span class="hljs-keyword">this</span>.tabBuilder(<span class="hljs-number">3</span>, <span class="hljs-string">'pink'</span>))</li><li>      .expandSafeArea([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])</li><li>    }</li><li>    .onAreaChange((_oldValue: Area, newValue: Area) =&gt; {</li><li>      <span class="hljs-keyword">this</span>.tabsWidth = newValue.width <span class="hljs-keyword">as</span> number;</li><li>    })</li><li>    .barWidth(<span class="hljs-string">'100%'</span>)</li><li>    .barHeight(<span class="hljs-number">56</span>)</li><li>    .width(<span class="hljs-string">'100%'</span>)</li><li>    .expandSafeArea([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])</li><li>    .backgroundColor(<span class="hljs-string">'#F1F3F5'</span>)</li><li>    .animationDuration(<span class="hljs-keyword">this</span>.animationDuration)</li><li>    .onChange((index: number) =&gt; {</li><li>      <span class="hljs-keyword">this</span>.currentIndex = index; <span class="hljs-comment">// Monitor changes in index and switch TAB contents.</span></li><li>    })</li><li>    .onAnimationStart((_index: number, targetIndex: number) =&gt; {</li><li>      <span class="hljs-comment">// The callback is triggered when the switch animation begins. The underline slides along with the page, and the width changes gradually.</span></li><li>      <span class="hljs-keyword">this</span>.currentIndex = targetIndex;</li><li>      <span class="hljs-keyword">this</span>.startAnimateTo(<span class="hljs-keyword">this</span>.animationDuration, <span class="hljs-keyword">this</span>.textInfos[targetIndex][<span class="hljs-number">0</span>], <span class="hljs-keyword">this</span>.textInfos[targetIndex][<span class="hljs-number">1</span>]);</li><li>    })</li><li>    .onAnimationEnd((index: number, event: TabsAnimationEvent) =&gt; {</li><li>      let currentIndicatorInfo = <span class="hljs-keyword">this</span>.getCurrentIndicatorInfo(index, event);</li><li>      <span class="hljs-keyword">this</span>.startAnimateTo(<span class="hljs-number">0</span>, currentIndicatorInfo.left, currentIndicatorInfo.width);</li><li>    })</li><li>    .onGestureSwipe((index: number, event: TabsAnimationEvent) =&gt; {</li><li>      let currentIndicatorInfo = <span class="hljs-keyword">this</span>.getCurrentIndicatorInfo(index, event);</li><li>      <span class="hljs-keyword">this</span>.currentIndex = currentIndicatorInfo.index;</li><li>      <span class="hljs-keyword">this</span>.indicatorLeftMargin = currentIndicatorInfo.left;</li><li>      <span class="hljs-keyword">this</span>.indicatorWidth = currentIndicatorInfo.width;</li><li>    })</li><li>
</li><li>    Column()</li><li>      .height(<span class="hljs-number">2</span>)</li><li>      .borderRadius(<span class="hljs-number">1</span>)</li><li>      .width(<span class="hljs-keyword">this</span>.indicatorWidth)</li><li>      .margin({ left: <span class="hljs-keyword">this</span>.indicatorLeftMargin, top: <span class="hljs-number">48</span> })</li><li>      .backgroundColor($r(<span class="hljs-string">'sys.color.brand'</span>))</li><li>  }</li><li>  .width(<span class="hljs-string">'100%'</span>)</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/BestPracticeSnippets/blob/master/ScreenFlickerSolution/entry/src/main/ets/pages/TabsRight.ets#L47-L126" target="_blank">TabsRight.ets</a></div></div></div></div> <p>TabsAnimationEvent方法如下所示。</p> <div class="screenLinkPre"><div _ngcontent-nni-c106="" class="highlight-div"><div _ngcontent-nni-c106="" class="highlight-div-header"><div _ngcontent-nni-c106="" class="highlight-div-header-left"><div _ngcontent-nni-c106="" class="handle-button expand-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nni-c106="" class="highlight-div-header-right"><div _ngcontent-nni-c106="" class="handle-button ai-button"></div><div _ngcontent-nni-c106="" class="handle-button line-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nni-c106="" class="handle-button theme-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nni-c106="" class="handle-button copy-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nni-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_samples/BestPracticeSnippets/blob/master/ScreenFlickerSolution/entry/src/main/ets/pages/TabsRight.ets#L130-L162" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">private</span> <span class="hljs-title function_">getCurrentIndicatorInfo</span>(<span class="hljs-variable">index</span>: <span class="hljs-title class_">number</span>, <span class="hljs-variable">event</span>: <span class="hljs-title class_">TabsAnimationEvent</span>): <span class="hljs-title class_">Record</span>&lt;<span class="hljs-title class_">string</span>, <span class="hljs-title class_">number</span>&gt; {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">nextIndex</span> = <span class="hljs-variable">index</span>;</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-variable">index</span> &gt; <span class="hljs-number">0</span> &amp;&amp; <span class="hljs-variable">event</span>.<span class="hljs-variable">currentOffset</span> &gt; <span class="hljs-number">0</span>) {</li><li>    <span class="hljs-variable">nextIndex</span>--;</li><li>  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable">index</span> &lt; <span class="hljs-number">3</span> &amp;&amp; <span class="hljs-title class_">event</span>.<span class="hljs-title class_">currentOffset</span> &lt; <span class="hljs-number">0</span>) {</li><li>    <span class="hljs-title class_">nextIndex</span>++;</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">indexInfo</span> = <span class="hljs-keyword">this</span>.<span class="hljs-variable">textInfos</span>[<span class="hljs-variable">index</span>];</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">nextIndexInfo</span> = <span class="hljs-keyword">this</span>.<span class="hljs-variable">textInfos</span>[<span class="hljs-variable">nextIndex</span>];</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">swipeRatio</span> = <span class="hljs-variable">Math</span>.<span class="hljs-title function_">abs</span>(<span class="hljs-variable">event</span>.<span class="hljs-variable">currentOffset</span> / <span class="hljs-keyword">this</span>.<span class="hljs-variable">tabsWidth</span>);</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">currentIndex</span> = <span class="hljs-variable">swipeRatio</span> &gt; <span class="hljs-number">0.5</span> ? <span class="hljs-variable">nextIndex</span> :</li><li>    <span class="hljs-variable">index</span>; <span class="hljs-comment">// The page slides more than halfway and the tabBar switches to the next page.</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">currentLeft</span> = <span class="hljs-variable">indexInfo</span>[<span class="hljs-number">0</span>] + (<span class="hljs-variable">nextIndexInfo</span>[<span class="hljs-number">0</span>] - <span class="hljs-variable">indexInfo</span>[<span class="hljs-number">0</span>]) * <span class="hljs-variable">swipeRatio</span>;</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">currentWidth</span> = <span class="hljs-variable">indexInfo</span>[<span class="hljs-number">1</span>] + (<span class="hljs-variable">nextIndexInfo</span>[<span class="hljs-number">1</span>] - <span class="hljs-variable">indexInfo</span>[<span class="hljs-number">1</span>]) * <span class="hljs-variable">swipeRatio</span>;</li><li>  <span class="hljs-keyword">return</span> { <span class="hljs-string">'index'</span>: <span class="hljs-title class_">currentIndex</span>, <span class="hljs-string">'left'</span>: <span class="hljs-title class_">currentLeft</span>, <span class="hljs-string">'width'</span>: <span class="hljs-title class_">currentWidth</span> };</li><li>}</li><li>
</li><li><span class="hljs-keyword">private</span> <span class="hljs-title function_">startAnimateTo</span>(<span class="hljs-variable">duration</span>: <span class="hljs-title class_">number</span>, <span class="hljs-variable">leftMargin</span>: <span class="hljs-title class_">number</span>, <span class="hljs-variable">width</span>: <span class="hljs-title class_">number</span>) {</li><li>  <span class="hljs-keyword">this</span>.<span class="hljs-variable">isStartAnimateTo</span> = <span class="hljs-keyword">true</span>;</li><li>  <span class="hljs-keyword">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">animateTo</span>({</li><li>    <span class="hljs-variable">duration</span>: <span class="hljs-title class_">duration</span>, <span class="hljs-comment">// duration</span></li><li>    <span class="hljs-variable">curve</span>: <span class="hljs-title class_">Curve</span>.<span class="hljs-title class_">Linear</span>, <span class="hljs-comment">// curve</span></li><li>    <span class="hljs-variable">iterations</span>: <span class="hljs-number">1</span>, <span class="hljs-comment">// iterations</span></li><li>    <span class="hljs-variable">playMode</span>: <span class="hljs-title class_">PlayMode</span>.<span class="hljs-title class_">Normal</span>, <span class="hljs-comment">// playMode</span></li><li>    <span class="hljs-variable">onFinish</span>: () =&gt; {</li><li>      <span class="hljs-keyword">this</span>.<span class="hljs-variable">isStartAnimateTo</span> = <span class="hljs-keyword">false</span>;</li><li>    }</li><li>  }, () =&gt; {</li><li>    <span class="hljs-keyword">this</span>.<span class="hljs-variable">indicatorLeftMargin</span> = <span class="hljs-variable">leftMargin</span>;</li><li>    <span class="hljs-keyword">this</span>.<span class="hljs-variable">indicatorWidth</span> = <span class="hljs-variable">width</span>;</li><li>  });</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/BestPracticeSnippets/blob/master/ScreenFlickerSolution/entry/src/main/ets/pages/TabsRight.ets#L130-L162" target="_blank">TabsRight.ets</a></div></div></div></div> <p>运行效果如下图。</p> <p><span><img height="533.5747200000001" originheight="1080" originwidth="523" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163419.58316453243662701306423557612453:50001231000000:2800:F2DBAA6D779886EDBE3512BE0C80FF12D865029BC4FD8385FF9259535EE63A7D.gif" title="点击放大" width="269.21022100000005"></span></p> <div class="tiledSection"><h3 id="section6978161018718">刷新过程中，ForEach键值生成函数未设置导致的闪屏问题<i class="anchor-icon anchor-icon-link" anchorid="section6978161018718" tips="复制节点链接"></i></h3><p><strong>问题现象</strong></p> <p>下拉刷新时，应用卡顿，出现闪屏。</p> <p><span><img height="532.7767200000001" originheight="1080" originwidth="523" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163419.11834915742352254644494422412187:50001231000000:2800:25A08F4D586884A9B4A7BEB161AC173B70495058044E3639EC018A467EA47724.gif" title="点击放大" width="270.886021"></span></p> <div class="screenLinkPre"><div _ngcontent-nni-c106="" class="highlight-div"><div _ngcontent-nni-c106="" class="highlight-div-header"><div _ngcontent-nni-c106="" class="highlight-div-header-left"><div _ngcontent-nni-c106="" class="handle-button expand-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nni-c106="" class="highlight-div-header-right"><div _ngcontent-nni-c106="" class="handle-button ai-button"></div><div _ngcontent-nni-c106="" class="handle-button line-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nni-c106="" class="handle-button theme-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nni-c106="" class="handle-button copy-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nni-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_samples/BestPracticeSnippets/blob/master/ScreenFlickerSolution/entry/src/main/ets/pages/PullToRefreshError.ets#L214-L243" data-highlighted="yes"><ol class="linenums"><li>@<span class="hljs-title function_">Builder</span></li><li><span class="hljs-keyword">private</span> <span class="hljs-title function_">getListView</span>() {</li><li>  <span class="hljs-title function_">List</span>({</li><li>    <span class="hljs-variable">space</span>: <span class="hljs-number">12</span>,</li><li>    <span class="hljs-variable">scroller</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">scroller</span></li><li>  }) {</li><li>    <span class="hljs-comment">// Render data using lazy loading components</span></li><li>    <span class="hljs-title function_">ForEach</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">newsData</span>, (<span class="hljs-variable">item</span>: <span class="hljs-title class_">NewsData</span>) =&gt; {</li><li>      <span class="hljs-title function_">ListItem</span>() {</li><li>        <span class="hljs-title function_">newsItem</span>({</li><li>          <span class="hljs-variable">newsTitle</span>: <span class="hljs-title class_">item</span>.<span class="hljs-title class_">newsTitle</span>,</li><li>          <span class="hljs-variable">newsContent</span>: <span class="hljs-title class_">item</span>.<span class="hljs-title class_">newsContent</span>,</li><li>          <span class="hljs-variable">newsTime</span>: <span class="hljs-title class_">item</span>.<span class="hljs-title class_">newsTime</span>,</li><li>          <span class="hljs-variable">img</span>: <span class="hljs-title class_">item</span>.<span class="hljs-title class_">img</span></li><li>        })</li><li>      }</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable">Color</span>.<span class="hljs-variable">White</span>)</li><li>      .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">16</span>)</li><li>    });</li><li>  }</li><li>  .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  .<span class="hljs-title function_">padding</span>({</li><li>    <span class="hljs-variable">left</span>: <span class="hljs-number">16</span>,</li><li>    <span class="hljs-variable">right</span>: <span class="hljs-number">16</span></li><li>  })</li><li>  .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F1F3F5'</span>)</li><li>  <span class="hljs-comment">// You must set the list to slide to edge to have no effect, otherwise the pullToRefresh component's slide up and drop down method cannot be triggered.</span></li><li>  .<span class="hljs-title function_">edgeEffect</span>(<span class="hljs-variable">EdgeEffect</span>.<span class="hljs-variable">None</span>)</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/BestPracticeSnippets/blob/master/ScreenFlickerSolution/entry/src/main/ets/pages/PullToRefreshError.ets#L214-L243" target="_blank">PullToRefreshError.ets</a></div></div></div></div> <p><strong><span style="color: rgb(73,73,73);">可能原因</span></strong></p> <p>ForEach提供了一个名为keyGenerator的参数，这是一个函数，开发者可以通过它自定义键值生成规则。如果开发者没有定义keyGenerator函数，则ArkUI框架会使用默认的键值生成函数，即(item: Object, index: number) =&gt; { return index + '__' + JSON.stringify(item); }。可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-rendering-control-foreach#键值生成规则" target="_blank">键值生成规则</a>。</p> <p>在使用ForEach的过程中，若对键值生成规则理解不足，将导致错误的使用方式。错误使用会导致功能问题，如渲染结果非预期，或性能问题，如渲染性能下降。</p> <p><strong><span style="color: rgb(73,73,73);">解决措施</span></strong></p> <p>在ForEach第三个参数中定义自定义键值的生成规则，即(item: NewsData, index?: number) =&gt; item.id，这样可以在渲染时降低重复组件的渲染开销，从而消除闪屏问题。可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-rendering-control-foreach#使用建议" target="_blank">ForEach组件使用建议</a>。</p> <div class="screenLinkPre"><div _ngcontent-nni-c106="" class="highlight-div"><div _ngcontent-nni-c106="" class="highlight-div-header"><div _ngcontent-nni-c106="" class="highlight-div-header-left"><div _ngcontent-nni-c106="" class="handle-button expand-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nni-c106="" class="highlight-div-header-right"><div _ngcontent-nni-c106="" class="handle-button ai-button"></div><div _ngcontent-nni-c106="" class="handle-button line-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nni-c106="" class="handle-button theme-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nni-c106="" class="handle-button copy-button"><div _ngcontent-nni-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nni-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_samples/BestPracticeSnippets/blob/master/ScreenFlickerSolution/entry/src/main/ets/pages/PullToRefreshRight.ets#L213-L242" data-highlighted="yes"><ol class="linenums"><li>@<span class="hljs-title function_">Builder</span></li><li><span class="hljs-keyword">private</span> <span class="hljs-title function_">getListView</span>() {</li><li>  <span class="hljs-title function_">List</span>({</li><li>    <span class="hljs-variable">space</span>: <span class="hljs-number">12</span>,</li><li>    <span class="hljs-variable">scroller</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">scroller</span></li><li>  }) {</li><li>    <span class="hljs-comment">// Render data using lazy loading components</span></li><li>    <span class="hljs-title function_">ForEach</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">newsData</span>, (<span class="hljs-variable">item</span>: <span class="hljs-title class_">NewsData</span>) =&gt; {</li><li>      <span class="hljs-title function_">ListItem</span>() {</li><li>        <span class="hljs-title function_">newsItem</span>({</li><li>          <span class="hljs-variable">newsTitle</span>: <span class="hljs-title class_">item</span>.<span class="hljs-title class_">newsTitle</span>,</li><li>          <span class="hljs-variable">newsContent</span>: <span class="hljs-title class_">item</span>.<span class="hljs-title class_">newsContent</span>,</li><li>          <span class="hljs-variable">newsTime</span>: <span class="hljs-title class_">item</span>.<span class="hljs-title class_">newsTime</span>,</li><li>          <span class="hljs-variable">img</span>: <span class="hljs-title class_">item</span>.<span class="hljs-title class_">img</span></li><li>        })</li><li>      }</li><li>      .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-variable">Color</span>.<span class="hljs-variable">White</span>)</li><li>      .<span class="hljs-title function_">borderRadius</span>(<span class="hljs-number">16</span>)</li><li>    }, (<span class="hljs-variable">item</span>: <span class="hljs-title class_">NewsData</span>) =&gt; <span class="hljs-variable">item</span>.<span class="hljs-variable">newsId</span>);</li><li>  }</li><li>  .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>  .<span class="hljs-title function_">height</span>(<span class="hljs-string">'100%'</span>)</li><li>  .<span class="hljs-title function_">padding</span>({</li><li>    <span class="hljs-variable">left</span>: <span class="hljs-number">16</span>,</li><li>    <span class="hljs-variable">right</span>: <span class="hljs-number">16</span></li><li>  })</li><li>  .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F1F3F5'</span>)</li><li>  <span class="hljs-comment">// You must set the list to slide to edge to have no effect, otherwise the pullToRefresh component's slide up and drop down method cannot be triggered.</span></li><li>  .<span class="hljs-title function_">edgeEffect</span>(<span class="hljs-variable">EdgeEffect</span>.<span class="hljs-variable">None</span>)</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/BestPracticeSnippets/blob/master/ScreenFlickerSolution/entry/src/main/ets/pages/PullToRefreshRight.ets#L213-L242" target="_blank">PullToRefreshRight.ets</a></div></div></div></div> <p>运行效果如下图所示。</p> <p><span><img height="520.6072200000001" originheight="1080" originwidth="523" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163419.82059308678677911017183233770155:50001231000000:2800:57D4FACCF3A5FA838E2A249C2A3B6F137C341EF47B45389E6F205130841EB5DF.gif" title="点击放大" width="269.591266"></span></p> </div> <div class="tiledSection"><h2 id="section1499085832214">总结<i class="anchor-icon anchor-icon-link" anchorid="section1499085832214" tips="复制节点链接"></i></h2><p>当出现应用闪屏问题时，首先确定可能的原因，分别测试每个原因。找到问题后，尝试使用相应的解决方案，以消除问题现象。</p> <ul><li>在应用连续点击场景下，通过计数器优化动画逻辑。</li><li>在Tabs页签切换场景下，完善动画细粒度，提高流畅表现。</li><li>在ForEach刷新内容过程中，根据业务场景调整键值生成函数。</li></ul> </div> <div class="tiledSection"><h2 id="section1630117642">示例代码<i class="anchor-icon anchor-icon-link" anchorid="section1630117642" tips="复制节点链接"></i></h2><ul><li><a href="https://gitee.com/harmonyos_samples/BestPracticeSnippets/tree/master/ScreenFlickerSolution" target="_blank">解决应用动效闪屏的方案</a></li></ul> </div> </div> <div></div></div>