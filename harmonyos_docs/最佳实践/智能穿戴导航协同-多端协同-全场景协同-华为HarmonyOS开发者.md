<h1 _ngcontent-nke-c119="" class="doc-title ng-star-inserted" title="智能穿戴导航协同"> 智能穿戴导航协同 </h1>

<div _ngcontent-nke-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <div class="tiledSection">     <h2 id="section17207036216">概述<i class="anchor-icon anchor-icon-link" anchorid="section17207036216" tips="复制节点链接"></i></h2>          <p>本文以智能手表的协同导航功能为典型案例，系统阐述了手机与智能穿戴设备通过通信协作实现地图导航的技术方案，主要包含了智能穿戴设备协同导航的体验设计、方案设计、界面开发及功能开发。</p>     <ul>      <li><a href="/consumer/cn/doc/best-practices/bpta-smartwatchnavigation#section1736651042110">体验设计</a>：从设计与交互层面，展示智能穿戴设备协同导航的体验设计要点。</li>      <li><a href="/consumer/cn/doc/best-practices/bpta-smartwatchnavigation#section8229111792118">方案设计</a>：从交互流程层面，展示智能穿戴设备协同导航应用整体的实现方案。</li>      <li><a href="/consumer/cn/doc/best-practices/bpta-smartwatchnavigation#section15111857670">界面开发</a>：从手机与智能穿戴设备双端，展示手机与智能穿戴设备协同导航中的界面开发要点。</li>      <li><a href="/consumer/cn/doc/best-practices/bpta-smartwatchnavigation#section88311141387">功能开发</a>：展示智能穿戴设备协同导航应用中的核心功能开发的原理与开发步骤。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="section1736651042110">体验设计<i class="anchor-icon anchor-icon-link" anchorid="section1736651042110" tips="复制节点链接"></i></h2>          <p>本章节从<a href="/consumer/cn/doc/best-practices/bpta-smartwatchnavigation#section10370135220120">UX设计</a>和<a href="/consumer/cn/doc/best-practices/bpta-smartwatchnavigation#section1914862101311">UI交互</a>两个维度，详细阐述智能穿戴设备协同导航的体验设计方案。</p>    </div>    <div class="tiledSection">     <h3 id="section10370135220120" class="firsth2">UX设计<i class="anchor-icon anchor-icon-link" anchorid="section10370135220120" tips="复制节点链接"></i></h3>          <p>在智能穿戴设备协同导航实践中，涉及手机与智能穿戴设备的互联通信，双方协同完成导航功能，因此UX设计需要同时考虑手机端与智能穿戴设备端。手机端UX设计以地图展示页为核心，智能穿戴设备端UX设计以地图展示页、导航页为核心，具体设计如下表所示。</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <caption>        <b>表1 </b>智能穿戴设备协同导航手机与智能穿戴设备侧UX设计       </caption>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.2.4.1.1" valign="top" width="36.730000000000004%">          <p>手机侧页面</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.2.4.1.2" valign="top" width="24.09%">          <p>效果图（手机）</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.3.3.2.4.1.3" valign="top" width="39.18%">          <p>效果图（智能穿戴设备）</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="36.730000000000004%">          <p>首页（地图展示页）</p></td>         <td class="cellrowborder" valign="top" width="24.09%">          <p><span><img height="408.22039679999995" originheight="661" originwidth="320" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163242.04388565876738220773171961974046:50001231000000:2800:904002B1209AD9C807BB5EF06123FF30B6D96A92FFD9C199604EF27FCAEB3B0A.png" title="点击放大" width="197.628"></span></p></td>         <td class="cellrowborder" valign="top" width="39.18%">          <p><span><img originheight="483" originwidth="320" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163242.58533498445548481471552571319079:50001231000000:2800:F41BF821B3AB11A6C9950EC89CCA3048990635D4EF9F0564CA197DF097F30609.png" width="320" height="483"></span></p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="36.730000000000004%">          <p>导航页</p></td>         <td class="cellrowborder" valign="top" width="24.09%">          <p>不涉及</p></td>         <td class="cellrowborder" valign="top" width="39.18%">          <p><span><img originheight="483" originwidth="320" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163242.57586366252144339379662899326245:50001231000000:2800:2701C10CBC335397AF28C1706355E5BF4B52DCFDBBE49194F63AF00F5F2E41F0.png" width="320" height="483"></span></p></td>        </tr>             </tbody></table></div>     </div>    </div>    <div class="tiledSection">     <h3 id="section1914862101311">UI交互<i class="anchor-icon anchor-icon-link" anchorid="section1914862101311" tips="复制节点链接"></i></h3>          <p>智能穿戴设备协同导航的UI交互设计主要包含以下关键特性：</p>     <ol>      <li>导航提醒：手表通过振动反馈提示用户。</li>      <li>双端同步：目的地选择在手机与手表端实时同步。</li>      <li>常亮显示：导航过程中保持手表屏幕常亮，导航结束后关闭常亮。</li>      <li>交互控制：支持通过旋转表冠缩放地图视图。</li>     </ol>    </div>    <div class="tiledSection">     <h2 id="section8229111792118">方案设计<i class="anchor-icon anchor-icon-link" anchorid="section8229111792118" tips="复制节点链接"></i></h2>          <p>本章节将系统阐述智能穿戴设备协同导航的交互逻辑，完整呈现手机与智能穿戴设备协同的实现方案。</p>    </div>    <div class="tiledSection">     <h3 id="section1294671718917" class="firsth2">实现方案<i class="anchor-icon anchor-icon-link" anchorid="section1294671718917" tips="复制节点链接"></i></h3>          <p><span><img height="1010.3334031413613" originheight="9294" originwidth="8463" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163242.59425349050850822331163246818400:50001231000000:2800:DBDBB9D6828B207FDC0C8BE27CDA4A9E09012F7667E0B201DBF82B773069F21A.jpg" title="点击放大" width="920"></span></p>     <p></p>    </div>    <div class="tiledSection">     <h2 id="section15111857670">界面开发<i class="anchor-icon anchor-icon-link" anchorid="section15111857670" tips="复制节点链接"></i></h2>          <p>本章节将详细阐述协同导航场景下手机端与智能穿戴设备端的核心界面开发规范，重点解析双端界面开发的关键技术要点。</p>    </div>    <div class="tiledSection">     <h3 id="section1188010569146" class="firsth2">手机端界面开发核心要点<i class="anchor-icon anchor-icon-link" anchorid="section1188010569146" tips="复制节点链接"></i></h3>          <p>手机端界面开发规范要点：</p>     <ol>      <li>沉浸式地图展示：全屏适配，优化视觉呈现。</li>      <li>交互设计：采用半模态转场实现操作按钮唤起。</li>     </ol>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>沉浸式地图展示，开发者可参考<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-immersive" target="_blank">沉浸式页面实现</a>。</p>       <p>操作按钮的拉起，开发者可以参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/ts-universal-attributes-sheet-transition" target="_blank">半模态转场</a>。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h3 id="section2016388161512">智能穿戴设备端界面开发核心要点<i class="anchor-icon anchor-icon-link" anchorid="section2016388161512" tips="复制节点链接"></i></h3>          <p>由于智能穿戴设备屏幕尺寸有限且采用圆形表盘设计，界面开发需特别注意：</p>     <ol>      <li>内容适配：确保显示内容完整居中，避免挤压或截断。</li>      <li>布局优化：针对圆形屏幕特性进行UX适配。</li>     </ol>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>智能穿戴设备界面开发具体可参考<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-smartwatch">智能穿戴</a>。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="section88311141387">功能开发<i class="anchor-icon anchor-icon-link" anchorid="section88311141387" tips="复制节点链接"></i></h2>          <p>本章节将详细解析智能穿戴设备协同导航的核心功能开发，重点阐述<a href="/consumer/cn/doc/best-practices/bpta-smartwatchnavigation#section1084068101014">地图操作</a>、<a href="/consumer/cn/doc/best-practices/bpta-smartwatchnavigation#section5132818141013">互联通信</a>、<a href="/consumer/cn/doc/best-practices/bpta-smartwatchnavigation#section113733017108">消息通知</a>和<a href="/consumer/cn/doc/best-practices/bpta-smartwatchnavigation#section15991113613101">振感提示</a>四大核心功能的实现方案，为开发者提供明确的技术指导。</p>    </div>    <div class="tiledSection">     <h3 id="section1084068101014" class="firsth2">地图操作<i class="anchor-icon anchor-icon-link" anchorid="section1084068101014" tips="复制节点链接"></i></h3>          <p>地图操作主要涉及地图展示以及地图绘制两个功能，地图展示能力开发者可以参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/map-presenting" target="_blank">显示地图</a>。</p>     <p>智能穿戴设备协同导航的地图绘制功能通过<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-mapcomponentcontroller" target="_blank">MapComponentController</a>实现，具体包含以下核心操作：</p>     <p><strong>地图点击（目的地标记）：</strong></p>     <div class="fignone">      <span class="figcap"><b>图1 </b>地图点击操作时序图</span>      <br><span><img height="505.07707600000003" originheight="4031" originwidth="5294" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163243.12061485815038184115658566701299:50001231000000:2800:E0714F127B5CCF83650F76E14A7C44FB55B89643E22FBA5CF84E118FE485779C.jpg" title="点击放大" width="663.3375000000001"></span>     </div>     <p>开发步骤如下：</p>     <ol>      <li><span>注册地图点击事件监听器，在回调函数中将触点的地理坐标持久化存储至destination_Position状态变量中。</span>       <p></p>       <div class="screenLinkPre"><div _ngcontent-nke-c106="" class="highlight-div"><div _ngcontent-nke-c106="" class="highlight-div-header"><div _ngcontent-nke-c106="" class="highlight-div-header-left"><div _ngcontent-nke-c106="" class="handle-button expand-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nke-c106="" class="highlight-div-header-right"><div _ngcontent-nke-c106="" class="handle-button ai-button"></div><div _ngcontent-nke-c106="" class="handle-button line-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nke-c106="" class="handle-button theme-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nke-c106="" class="handle-button copy-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nke-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_samples/SmartWatchMapNavigation/blob/master/products/phone/src/main/ets/pages/Index.ets#L49-L158" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Destination location information obtained based on the map click event.</span></li><li><span class="hljs-meta">@StorageLink(<span class="hljs-string">'destination_Position'</span>)</span> <span class="hljs-meta">@Watch(<span class="hljs-string">'changeDestinationPositionMark'</span>)</span> destination_Position: mapCommon.LatLng =</li><li>  {</li><li>    longitude: <span class="hljs-number">0</span>,</li><li>    latitude: <span class="hljs-number">0</span></li><li>  };</li><li><span class="hljs-comment">// ...</span></li><li>aboutToAppear(): void {</li><li>  <span class="hljs-comment">// ...</span></li><li>  <span class="hljs-comment">// Map initialization callback</span></li><li>  <span class="hljs-keyword">this</span>.callback = async (err, mapController) =&gt; {</li><li>    <span class="hljs-keyword">if</span> (!err) {</li><li>      <span class="hljs-comment">// ...</span></li><li>      let mapOnclickCallBack = async (position: mapCommon.LatLng) =&gt; {</li><li>        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.isStartNavigation) {</li><li>          <span class="hljs-comment">// If the navigation has started, you are not allowed to click on the mobile phone.</span></li><li>          <span class="hljs-keyword">this</span>.isBarShow = <span class="hljs-literal">false</span>;</li><li>        } <span class="hljs-keyword">else</span> {</li><li>          <span class="hljs-comment">// Send destination information to the watch for synchronization</span></li><li>          <span class="hljs-keyword">this</span>.connectUtils.sendMessage(JSON.stringify(new CommunicationInformation(<span class="hljs-number">1</span>, undefined, position)));</li><li>          <span class="hljs-comment">// Modify destination_Position to trigger changeDestinationPositionMark</span></li><li>          <span class="hljs-comment">// To refresh the destination mark on the map.</span></li><li>          <span class="hljs-keyword">this</span>.destination_Position = position;</li><li>          <span class="hljs-keyword">this</span>.isBarShow = <span class="hljs-literal">true</span>;</li><li>        }</li><li>      };</li><li>      <span class="hljs-keyword">this</span>.mapEventManager.on(<span class="hljs-string">'mapLoad'</span>, mapLoadCallback);</li><li>      <span class="hljs-keyword">this</span>.mapEventManager.on(<span class="hljs-string">'mapClick'</span>, mapOnclickCallBack);</li><li>    }</li><li>  };</li><li>  <span class="hljs-comment">// Obtains the connected watch device and subscribes to the watch's message sending event.</span></li><li>  <span class="hljs-keyword">this</span>.connectUtils.getConnectedDevices();</li><li>  <span class="hljs-keyword">this</span>.connectUtils.notifyClient = wearEngine.getNotifyClient(<span class="hljs-keyword">this</span>.getUIContext().getHostContext());</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/SmartWatchMapNavigation/blob/master/products/phone/src/main/ets/pages/Index.ets#L49-L158" target="_blank">Index.ets</a></div></div></div></div>       <p></p></li>      <li><span>监听destination_Position变化，调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-mapcomponentcontroller#section0810361284" target="_blank">addMarker()</a>动态更新目的地地图标记。</span>       <p></p>       <div class="screenLinkPre"><div _ngcontent-nke-c106="" class="highlight-div"><div _ngcontent-nke-c106="" class="highlight-div-header"><div _ngcontent-nke-c106="" class="highlight-div-header-left"><div _ngcontent-nke-c106="" class="handle-button expand-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nke-c106="" class="highlight-div-header-right"><div _ngcontent-nke-c106="" class="handle-button ai-button"></div><div _ngcontent-nke-c106="" class="handle-button line-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nke-c106="" class="handle-button theme-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nke-c106="" class="handle-button copy-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nke-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_samples/SmartWatchMapNavigation/blob/master/products/phone/src/main/ets/pages/Index.ets#L48-L107" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Destination location information obtained based on the map click event.</span></li><li>@<span class="hljs-title function_">StorageLink</span>(<span class="hljs-string">'destination_Position'</span>) @<span class="hljs-title function_">Watch</span>(<span class="hljs-string">'changeDestinationPositionMark'</span>) <span class="hljs-variable">destination_Position</span>: <span class="hljs-title class_">mapCommon</span>.<span class="hljs-title class_">LatLng</span> =</li><li>  {</li><li>    <span class="hljs-variable">longitude</span>: <span class="hljs-number">0</span>,</li><li>    <span class="hljs-variable">latitude</span>: <span class="hljs-number">0</span></li><li>  };</li><li><span class="hljs-comment">// ...</span></li><li><span class="hljs-comment">/*</span></li><li><span class="hljs-comment"> * Triggered when destination_Position changes.</span></li><li><span class="hljs-comment"> * Used to refresh the destination marker on the map when the destination changes.</span></li><li><span class="hljs-comment"> */</span></li><li><span class="hljs-variable">async</span> <span class="hljs-title function_">changeDestinationPositionMark</span>() {</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.<span class="hljs-variable">mapController</span>) {</li><li>    <span class="hljs-keyword">this</span>.<span class="hljs-variable">mapController</span>.<span class="hljs-title function_">clear</span>();</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-variable">markerOptions</span>: <span class="hljs-title class_">mapCommon</span>.<span class="hljs-title class_">MarkerOptions</span> = {</li><li>      <span class="hljs-variable">position</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">destination_Position</span>,</li><li>      <span class="hljs-variable">rotation</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-variable">visible</span>: <span class="hljs-keyword">true</span>,</li><li>      <span class="hljs-variable">zIndex</span>: <span class="hljs-number">0</span>,</li><li>      <span class="hljs-variable">alpha</span>: <span class="hljs-number">1</span>,</li><li>      <span class="hljs-variable">anchorU</span>: <span class="hljs-number">0.5</span>,</li><li>      <span class="hljs-variable">anchorV</span>: <span class="hljs-number">1</span>,</li><li>      <span class="hljs-variable">clickable</span>: <span class="hljs-keyword">true</span>,</li><li>      <span class="hljs-variable">draggable</span>: <span class="hljs-keyword">true</span>,</li><li>      <span class="hljs-variable">flat</span>: <span class="hljs-keyword">false</span>,</li><li>    };</li><li>    <span class="hljs-variable">await</span> <span class="hljs-keyword">this</span>.<span class="hljs-variable">mapController</span>.<span class="hljs-title function_">addMarker</span>(<span class="hljs-variable">markerOptions</span>);</li><li>  }</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/SmartWatchMapNavigation/blob/master/products/phone/src/main/ets/pages/Index.ets#L48-L107" target="_blank">Index.ets</a></div></div></div></div>       <p></p></li>     </ol>     <p><strong>路径导航：</strong></p>     <ol>      <li><span>根据当前位置与目的地位置，生成导航路线信息。</span>       <p></p>       <div class="screenLinkPre"><div _ngcontent-nke-c106="" class="highlight-div"><div _ngcontent-nke-c106="" class="highlight-div-header"><div _ngcontent-nke-c106="" class="highlight-div-header-left"><div _ngcontent-nke-c106="" class="handle-button expand-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nke-c106="" class="highlight-div-header-right"><div _ngcontent-nke-c106="" class="handle-button ai-button"></div><div _ngcontent-nke-c106="" class="handle-button line-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nke-c106="" class="handle-button theme-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nke-c106="" class="handle-button copy-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nke-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_samples/SmartWatchMapNavigation/blob/master/products/phone/src/main/ets/pages/Index.ets#L186-L204" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title function_">Button</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.string.DrawRoute'</span>))</li><li>  .<span class="hljs-title function_">width</span>(<span class="hljs-number">158</span>)</li><li>  .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>  .<span class="hljs-title function_">onClick</span>(<span class="hljs-variable">async</span> () =&gt; {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-variable">params</span>: <span class="hljs-title class_">navi</span>.<span class="hljs-title class_">RouteParams</span> = {</li><li>      <span class="hljs-variable">origins</span>: [</li><li>        {</li><li>          <span class="hljs-variable">latitude</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">myLocation</span>.<span class="hljs-title class_">latitude</span>,</li><li>          <span class="hljs-variable">longitude</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">myLocation</span>.<span class="hljs-title class_">longitude</span></li><li>        }</li><li>      ],</li><li>      <span class="hljs-variable">destination</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">destination_Position</span>,</li><li>      <span class="hljs-variable">language</span>: <span class="hljs-string">'zh_CN'</span></li><li>    };</li><li>    <span class="hljs-keyword">const</span> <span class="hljs-variable">result</span> = <span class="hljs-variable">await</span> <span class="hljs-variable">navi</span>.<span class="hljs-title function_">getWalkingRoutes</span>(<span class="hljs-variable">params</span>);</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-variable">drawRouteUtil</span>: <span class="hljs-title class_">DrawRouteUtils</span> = <span class="hljs-variable">new</span> <span class="hljs-title function_">DrawRouteUtils</span>();</li><li>    <span class="hljs-comment">// Draw a route on a map using navigation route information.</span></li><li>    <span class="hljs-variable">drawRouteUtil</span>.<span class="hljs-title function_">drawRoute</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">mapController</span>, <span class="hljs-variable">result</span>.<span class="hljs-variable">routes</span>[<span class="hljs-number">0</span>].<span class="hljs-variable">steps</span>[<span class="hljs-number">0</span>].<span class="hljs-variable">roads</span>)</li><li>  })</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/SmartWatchMapNavigation/blob/master/products/phone/src/main/ets/pages/Index.ets#L186-L204" target="_blank">Index.ets</a></div></div></div></div>       <p></p></li>      <li><span>通过调用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-references/map-map-mapcomponentcontroller#section6818109112812" target="_blank">addPolyline()</a>接口，结合导航路线信息，绘制可视化路径。</span>       <p></p>       <div class="screenLinkPre"><div _ngcontent-nke-c106="" class="highlight-div"><div _ngcontent-nke-c106="" class="highlight-div-header"><div _ngcontent-nke-c106="" class="highlight-div-header-left"><div _ngcontent-nke-c106="" class="handle-button expand-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nke-c106="" class="highlight-div-header-right"><div _ngcontent-nke-c106="" class="handle-button ai-button"></div><div _ngcontent-nke-c106="" class="handle-button line-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nke-c106="" class="handle-button theme-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nke-c106="" class="handle-button copy-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nke-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_samples/SmartWatchMapNavigation/blob/master/commons/map/src/main/ets/common/utils/DrawRouteUtils.ets#L25-L60" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">/*</span></li><li><span class="hljs-comment"> * Draw a navigation route on a map</span></li><li><span class="hljs-comment"> * The first parameter needs to be transferred to MapComponentController to operate the map.</span></li><li><span class="hljs-comment"> * The second parameter needs to pass in the navigation information to draw the navigation route.</span></li><li><span class="hljs-comment"> * @param mapController : map controller for drawing markers or routes on a map.</span></li><li><span class="hljs-comment"> * @param steps : Navigation route information obtained through the Map Kit</span></li><li><span class="hljs-comment"> */</span></li><li><span class="hljs-variable">async</span> <span class="hljs-title function_">drawRoute</span>(<span class="hljs-variable">mapController</span>: <span class="hljs-title class_">map</span>.<span class="hljs-title class_">MapComponentController</span> | <span class="hljs-title class_">undefined</span>, <span class="hljs-variable">steps</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">navi</span>.<span class="hljs-title class_">RouteRoad</span>&gt;) {</li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-variable">mapController</span> === <span class="hljs-variable">undefined</span>) {</li><li>    <span class="hljs-variable">hilog</span>.<span class="hljs-title function_">info</span>(<span class="hljs-number">0</span><span class="hljs-variable">X0000</span>, <span class="hljs-variable">TAG</span>, <span class="hljs-string">'Drawing failed'</span>);</li><li>    <span class="hljs-keyword">return</span>;</li><li>  }</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">roads</span>: <span class="hljs-title class_">Array</span>&lt;<span class="hljs-title class_">mapCommon</span>.<span class="hljs-title class_">LatLng</span>&gt; = [];</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">des_arr</span>: <span class="hljs-title class_">RouteInfomation</span>[] = [];</li><li>  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> <span class="hljs-variable">index</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">index</span> &lt; <span class="hljs-title class_">steps</span>.<span class="hljs-title class_">length</span>; <span class="hljs-title class_">index</span>++) {</li><li>    <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> <span class="hljs-variable">i</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">i</span> &lt; <span class="hljs-title class_">steps</span>[<span class="hljs-title class_">index</span>].<span class="hljs-title class_">polyline</span>.<span class="hljs-title class_">length</span>; <span class="hljs-title class_">i</span>++) {</li><li>      <span class="hljs-variable">roads</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable">steps</span>[<span class="hljs-variable">index</span>].<span class="hljs-variable">polyline</span>[<span class="hljs-variable">i</span>]);</li><li>      <span class="hljs-variable">des_arr</span>.<span class="hljs-title function_">push</span>(<span class="hljs-variable">new</span> <span class="hljs-title function_">RouteInfomation</span>(<span class="hljs-variable">steps</span>[<span class="hljs-variable">index</span>].<span class="hljs-variable">action</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">string</span>, <span class="hljs-variable">steps</span>[<span class="hljs-variable">index</span>].<span class="hljs-variable">distance</span>, <span class="hljs-variable">steps</span>[<span class="hljs-variable">index</span>].<span class="hljs-variable">duration</span>))</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// The route segment information is stored in the AppStorage and then sent to the watch through the WearEngine.</span></li><li>  <span class="hljs-variable">AppStorage</span>.<span class="hljs-title function_">setOrCreate</span>(<span class="hljs-string">'routeInfomation'</span>, <span class="hljs-variable">des_arr</span>);</li><li>
</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">polylineOption</span>: <span class="hljs-title class_">mapCommon</span>.<span class="hljs-title class_">MapPolylineOptions</span> = {</li><li>    <span class="hljs-variable">points</span>: <span class="hljs-title class_">roads</span>,</li><li>    <span class="hljs-variable">color</span>: <span class="hljs-number">0xFF089C57</span>,</li><li>    <span class="hljs-variable">jointType</span>: <span class="hljs-title class_">mapCommon</span>.<span class="hljs-title class_">JointType</span>.<span class="hljs-title class_">ROUND</span>,</li><li>    <span class="hljs-variable">width</span>: <span class="hljs-number">24</span></li><li>  };</li><li>
</li><li>  <span class="hljs-comment">// Use MapComponentController to draw a route on a map</span></li><li>  <span class="hljs-variable">mapController</span>.<span class="hljs-title function_">addPolyline</span>(<span class="hljs-variable">polylineOption</span>).<span class="hljs-title function_">then</span>(() =&gt; {</li><li>    <span class="hljs-variable">hilog</span>.<span class="hljs-title function_">info</span>(<span class="hljs-number">0</span><span class="hljs-variable">X0000</span>, <span class="hljs-variable">TAG</span>, <span class="hljs-string">'Drawing success'</span>);</li><li>  });</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/SmartWatchMapNavigation/blob/master/commons/map/src/main/ets/common/utils/DrawRouteUtils.ets#L25-L60" target="_blank">DrawRouteUtils.ets</a></div></div></div></div>       <p></p></li>     </ol>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>地图实现依赖Map Kit能力，使用前首先需要申请Map服务，详情请参考Map Kit<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/map-config-agc" target="_blank">开发准备</a>。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h3 id="section5132818141013">互联通信<i class="anchor-icon anchor-icon-link" anchorid="section5132818141013" tips="复制节点链接"></i></h3>          <p>智能穿戴设备协同导航系统通过设备间通信协议实现双端数据同步，各类消息通过头部TAG标志位进行区分，具体消息类型定义如下表所示：</p>     <div class="tablenoborder">      <div class="tbBox"><table class="layoutFixed idpTab">       <caption>        <b>表2 </b>消息实体类消息类型表       </caption>       <thead>        <tr>         <th align="left" class="cellrowborder" id="mcps1.3.12.3.2.4.1.1" valign="top" width="33.5033503350335%">          <p>消息类型</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.12.3.2.4.1.2" valign="top" width="33.16331633163316%">          <p>TAG标志位取值</p></th>         <th align="left" class="cellrowborder" id="mcps1.3.12.3.2.4.1.3" valign="top" width="33.33333333333333%">          <p>作用</p></th>        </tr>       </thead>               <tbody><tr>         <td class="cellrowborder" valign="top" width="33.5033503350335%">          <p>路线信息</p></td>         <td class="cellrowborder" valign="top" width="33.16331633163316%">          <p>0</p></td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">          <p>用于同步导航路线信息。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.5033503350335%">          <p>目的地定位</p></td>         <td class="cellrowborder" valign="top" width="33.16331633163316%">          <p>1</p></td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">          <p>用于同步目的地定位信息。</p></td>        </tr>        <tr>         <td class="cellrowborder" valign="top" width="33.5033503350335%">          <p>信号信息</p></td>         <td class="cellrowborder" valign="top" width="33.16331633163316%">          <p>2及以上</p></td>         <td class="cellrowborder" valign="top" width="33.33333333333333%">          <p>用于信号，包括手机侧告知手表侧导航已开启、手表侧告知手机侧导航结束等。</p></td>        </tr>             </tbody></table></div>     </div>     <p>在对端消息监听（手机端与智能穿戴设备端均使用，监听对方发来的消息）的回调中，会对发送的消息进行转码，并根据TAG标志位进行数据的存储，分别用于不同的逻辑。</p>     <div class="screenLinkPre"><div _ngcontent-nke-c106="" class="highlight-div"><div _ngcontent-nke-c106="" class="highlight-div-header"><div _ngcontent-nke-c106="" class="highlight-div-header-left"><div _ngcontent-nke-c106="" class="handle-button expand-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nke-c106="" class="highlight-div-header-right"><div _ngcontent-nke-c106="" class="handle-button ai-button"></div><div _ngcontent-nke-c106="" class="handle-button line-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nke-c106="" class="handle-button theme-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nke-c106="" class="handle-button copy-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nke-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_samples/SmartWatchMapNavigation/blob/master/commons/Communication/src/main/ets/common/utils/CommunicationUtils.ets#L69-L97" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">/**</span></li><li><span class="hljs-comment"> * Callback Method for Listening to Peer Communication.</span></li><li><span class="hljs-comment"> */</span></li><li><span class="hljs-keyword">private</span> <span class="hljs-variable">onMsgCallback</span>: <span class="hljs-title class_">Callback</span>&lt;<span class="hljs-title class_">wearEngine</span>.<span class="hljs-title class_">P2pMessage</span>&gt; = (<span class="hljs-variable">data</span>: <span class="hljs-title class_">wearEngine</span>.<span class="hljs-title class_">P2pMessage</span>): <span class="hljs-title class_">void</span> =&gt; {</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">str</span>: <span class="hljs-title class_">string</span> = <span class="hljs-string">''</span>;</li><li>  <span class="hljs-comment">// Decodes the intercepted content into a character string.</span></li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-title function_">canIUse</span>(<span class="hljs-string">'SystemCapability.Utils.Lang'</span>)) {</li><li>    <span class="hljs-keyword">let</span> <span class="hljs-variable">decoder</span>: <span class="hljs-title class_">util</span>.<span class="hljs-title class_">TextDecoder</span> = <span class="hljs-variable">util</span>.<span class="hljs-variable">TextDecoder</span>.<span class="hljs-title function_">create</span>();</li><li>    <span class="hljs-variable">str</span> = <span class="hljs-variable">decoder</span>.<span class="hljs-title function_">decodeToString</span>(<span class="hljs-variable">data</span>.<span class="hljs-variable">content</span>);</li><li>  }</li><li>  <span class="hljs-comment">// Convert the JSON character string to the CommunicationInformation type.</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">communicationInformation</span>: <span class="hljs-title class_">CommunicationInformation</span> = <span class="hljs-variable">JSON</span>.<span class="hljs-title function_">parse</span>(<span class="hljs-variable">str</span>);</li><li>  <span class="hljs-comment">// Determine the information type based on the tag.</span></li><li>  <span class="hljs-keyword">if</span> (<span class="hljs-variable">communicationInformation</span>.<span class="hljs-variable">tag</span> === <span class="hljs-number">0</span>) {</li><li>    <span class="hljs-comment">// When tag is set to 0,Indicates that the transferred information is path description information,</span></li><li>    <span class="hljs-comment">// which is stored in AppStorage to refresh the watch navigation page.</span></li><li>    <span class="hljs-variable">AppStorage</span>.<span class="hljs-title function_">setOrCreate</span>(<span class="hljs-string">'route_information'</span>, <span class="hljs-variable">communicationInformation</span>.<span class="hljs-variable">routeInfomation</span>);</li><li>  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable">communicationInformation</span>.<span class="hljs-variable">tag</span> === <span class="hljs-number">1</span>) {</li><li>    <span class="hljs-comment">// When tag is set to 1, Indicates that the transferred information is destination location information</span></li><li>    <span class="hljs-comment">// and is saved to the AppStorage for synchronizing the destination logo of the mobile phone and watch.</span></li><li>    <span class="hljs-variable">AppStorage</span>.<span class="hljs-title function_">setOrCreate</span>(<span class="hljs-string">'destination_Position'</span>, <span class="hljs-variable">communicationInformation</span>.<span class="hljs-variable">location</span>);</li><li>  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (<span class="hljs-variable">communicationInformation</span>.<span class="hljs-variable">tag</span> === <span class="hljs-number">2</span>) {</li><li>    <span class="hljs-comment">// Signal sent from your phone to your watch when navigation starts, indicating that navigation starts.</span></li><li>    <span class="hljs-variable">AppStorage</span>.<span class="hljs-title function_">setOrCreate</span>(<span class="hljs-string">'isStartNavigation'</span>, <span class="hljs-keyword">true</span>);</li><li>  } <span class="hljs-keyword">else</span> {</li><li>    <span class="hljs-comment">// Signal sent from your watch to your phone when navigation ends, indicating that navigation ends.</span></li><li>    <span class="hljs-variable">AppStorage</span>.<span class="hljs-title function_">setOrCreate</span>(<span class="hljs-string">'isStartNavigation'</span>, <span class="hljs-keyword">false</span>);</li><li>  }</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/SmartWatchMapNavigation/blob/master/commons/Communication/src/main/ets/common/utils/CommunicationUtils.ets#L69-L97" target="_blank">CommunicationUtils.ets</a></div></div></div></div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>手机手表互联通信的具体实现，详情可参考<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-smartwatch">智能穿戴</a>与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/p2p_communication" target="_blank">应用间消息通信</a>。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h3 id="section113733017108">消息通知<i class="anchor-icon anchor-icon-link" anchorid="section113733017108" tips="复制节点链接"></i></h3>          <p>在导航启动阶段，手机端需通过WearEngine提供的notify()接口向智能穿戴设备端发送通知消息，告知手表端导航开始。</p>     <div class="screenLinkPre"><div _ngcontent-nke-c106="" class="highlight-div"><div _ngcontent-nke-c106="" class="highlight-div-header"><div _ngcontent-nke-c106="" class="highlight-div-header-left"><div _ngcontent-nke-c106="" class="handle-button expand-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nke-c106="" class="highlight-div-header-right"><div _ngcontent-nke-c106="" class="handle-button ai-button"></div><div _ngcontent-nke-c106="" class="handle-button line-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nke-c106="" class="handle-button theme-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nke-c106="" class="handle-button copy-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nke-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_samples/SmartWatchMapNavigation/blob/master/commons/Communication/src/main/ets/common/utils/CommunicationUtils.ets#L154-L181" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">/*</span></li><li><span class="hljs-comment"> * Method of notifying a message to watch.</span></li><li><span class="hljs-comment"> */</span></li><li><span class="hljs-title function_">notifyMessage</span>() {</li><li>  <span class="hljs-comment">// Configure the notification content.</span></li><li>  <span class="hljs-comment">// Including the package name of the notification source, notification title, and notification content.</span></li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">type1Notification</span>: <span class="hljs-title class_">wearEngine</span>.<span class="hljs-title class_">Notification</span> = {</li><li>    <span class="hljs-keyword">type</span>: <span class="hljs-title class_">wearEngine</span>.<span class="hljs-title class_">NotificationType</span>.<span class="hljs-title class_">NOTIFICATION_WITHOUT_BUTTONS</span>,</li><li>    <span class="hljs-variable">bundleName</span>: <span class="hljs-string">'com.example.smartwatchmapnavigation'</span>,</li><li>    <span class="hljs-variable">title</span>: <span class="hljs-string">'smartwatchmapnavigation'</span>,</li><li>    <span class="hljs-variable">text</span>: <span class="hljs-string">'walk navigation start'</span>,</li><li>  }</li><li>  <span class="hljs-keyword">let</span> <span class="hljs-variable">options</span>: <span class="hljs-title class_">wearEngine</span>.<span class="hljs-title class_">NotificationOptions</span> = {</li><li>    <span class="hljs-variable">notification</span>: <span class="hljs-title class_">type1Notification</span>,</li><li>    <span class="hljs-variable">onAction</span>: (<span class="hljs-variable">feedback</span>: <span class="hljs-title class_">wearEngine</span>.<span class="hljs-title class_">NotificationFeedback</span>) =&gt; {</li><li>      <span class="hljs-variable">hilog</span>.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x000</span>, <span class="hljs-variable">TAG</span>,</li><li>        `<span class="hljs-variable">one</span> <span class="hljs-variable">button</span> <span class="hljs-variable">notify</span> <span class="hljs-variable">get</span> <span class="hljs-variable">feedback</span> <span class="hljs-keyword">is</span> ${<span class="hljs-variable">feedback</span>.<span class="hljs-variable">action</span> ? <span class="hljs-variable">feedback</span>.<span class="hljs-variable">action</span> : <span class="hljs-title class_">feedback</span>.<span class="hljs-title class_">errorCode</span>}`);</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// Sends a notification to the watch based on notifyClient.</span></li><li>  <span class="hljs-comment">// This method can be invoked only by apps on mobile phones.</span></li><li>  <span class="hljs-keyword">this</span>.<span class="hljs-variable">notifyClient</span>!.<span class="hljs-title function_">notify</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">deviceRandomId</span>, <span class="hljs-variable">options</span>).<span class="hljs-title function_">then</span>(<span class="hljs-variable">result</span> =&gt; {</li><li>    <span class="hljs-variable">hilog</span>.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x000</span>, <span class="hljs-variable">TAG</span>, `<span class="hljs-variable">Succeeded</span> <span class="hljs-keyword">in</span> <span class="hljs-variable">sending</span> <span class="hljs-variable">notification</span>.`);</li><li>  }).<span class="hljs-keyword">catch</span>((<span class="hljs-variable">error</span>: <span class="hljs-title class_">BusinessError</span>) =&gt; {</li><li>    <span class="hljs-variable">hilog</span>.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x000</span>, <span class="hljs-variable">TAG</span>, `<span class="hljs-variable">Failed</span> <span class="hljs-variable">to</span> <span class="hljs-variable">send</span> <span class="hljs-variable">notification</span>. <span class="hljs-variable">Code</span> <span class="hljs-keyword">is</span> ${<span class="hljs-variable">error</span>.<span class="hljs-variable">code</span>}, <span class="hljs-variable">message</span> <span class="hljs-keyword">is</span> ${<span class="hljs-variable">error</span>.<span class="hljs-variable">message</span>}`);</li><li>  })</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/SmartWatchMapNavigation/blob/master/commons/Communication/src/main/ets/common/utils/CommunicationUtils.ets#L154-L181" target="_blank">CommunicationUtils.ets</a></div></div></div></div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>消息通知依赖wearengine服务，详情可参考<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-smartwatch">智能穿戴</a>与<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/device_notification" target="_blank">穿戴设备模板化通知</a>。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h3 id="section15991113613101">振感提示<i class="anchor-icon anchor-icon-link" anchorid="section15991113613101" tips="复制节点链接"></i></h3>          <p>在导航过程中，智能穿戴设备需要使用振动向开发者提供振感提示。</p>     <div class="screenLinkPre"><div _ngcontent-nke-c106="" class="highlight-div"><div _ngcontent-nke-c106="" class="highlight-div-header"><div _ngcontent-nke-c106="" class="highlight-div-header-left"><div _ngcontent-nke-c106="" class="handle-button expand-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-nke-c106="" class="highlight-div-header-right"><div _ngcontent-nke-c106="" class="handle-button ai-button"></div><div _ngcontent-nke-c106="" class="handle-button line-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-nke-c106="" class="handle-button theme-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-nke-c106="" class="handle-button copy-button"><div _ngcontent-nke-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-nke-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-javascript" codehub="https://gitee.com/harmonyos_samples/SmartWatchMapNavigation/blob/master/commons/vibrator/src/main/ets/commons/VibratorUtil.ets#L23-L49" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-comment">// Vibration Tools Class</span></li><li><span class="hljs-keyword">export</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">VibratorUtil</span> {</li><li>  <span class="hljs-comment">/*</span></li><li><span class="hljs-comment">   * The method of  Vibration.</span></li><li><span class="hljs-comment">   */</span></li><li>  <span class="hljs-title class_">Vibrator</span>() {</li><li>    <span class="hljs-keyword">try</span> {</li><li>      <span class="hljs-comment">// Use the startVibration method to enable vibration and set the duration.</span></li><li>      vibrator.<span class="hljs-title function_">startVibration</span>({</li><li>        <span class="hljs-attr">type</span>: <span class="hljs-string">'time'</span>,</li><li>        <span class="hljs-attr">duration</span>: <span class="hljs-number">1000</span>,</li><li>      }, {</li><li>        <span class="hljs-attr">id</span>: <span class="hljs-number">0</span>,</li><li>        <span class="hljs-attr">usage</span>: <span class="hljs-string">'alarm'</span></li><li>      }, <span class="hljs-function">(<span class="hljs-params">error: BusinessError</span>) =&gt;</span> {</li><li>        <span class="hljs-keyword">if</span> (error) {</li><li>          hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`Failed to start vibration. Code: <span class="hljs-subst">${error.code}</span>, message: <span class="hljs-subst">${error.message}</span>`</span>);</li><li>          <span class="hljs-keyword">return</span>;</li><li>        }</li><li>        hilog.<span class="hljs-title function_">info</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">'Succeed in starting vibration'</span>);</li><li>      });</li><li>    } <span class="hljs-keyword">catch</span> (err) {</li><li>      <span class="hljs-keyword">let</span> <span class="hljs-attr">e</span>: <span class="hljs-title class_">BusinessError</span> = err <span class="hljs-keyword">as</span> <span class="hljs-title class_">BusinessError</span>;</li><li>      hilog.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x00000</span>, <span class="hljs-variable constant_">TAG</span>, <span class="hljs-string">`An unexpected error occurred. Code: <span class="hljs-subst">${e.code}</span>, message: <span class="hljs-subst">${e.message}</span>`</span>);</li><li>    }</li><li>  }</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/SmartWatchMapNavigation/blob/master/commons/vibrator/src/main/ets/commons/VibratorUtil.ets#L23-L49" target="_blank">VibratorUtil.ets</a></div></div></div></div>     <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content">       <p>使用振动需要进行权限申请，详情可参考<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/vibrator-guidelines" target="_blank">振动开发指导(ArkTS)</a>。</p>      </div></div></div>    </div>    <div class="tiledSection">     <h2 id="section45692151110">示例代码<i class="anchor-icon anchor-icon-link" anchorid="section45692151110" tips="复制节点链接"></i></h2>          <ul>      <li><a href="https://gitee.com/harmonyos_samples/SmartWatchMapNavigation" target="_blank">穿戴协同-地图导航应用</a></li>     </ul>    </div>   </div>   <div></div></div>