<h1 _ngcontent-qli-c119="" class="doc-title ng-star-inserted" title="视频场景图层低功耗建议"> 视频场景图层低功耗建议 </h1>

<div _ngcontent-qli-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section103291628287">建议<i class="anchor-icon anchor-icon-link" anchorid="section103291628287" tips="复制节点链接"></i></h2></div> <ul><li>图层合成包括硬件合成和GPU合成两种方式。硬件合成的功耗比GPU合成低20mA以上。图层数量过多会增加合成负载，超过硬件合成能力时将使用GPU合成，导致功耗增加。因此，建议应用控制图层数量以避免使用GPU合成。</li><li>图层个数限制：三方应用的图层个数，无弹幕时建议不超过2个图层，有弹幕时建议不超过3个图层。</li></ul> <div class="tiledSection"><h2 id="section7181529165813">开发步骤<i class="anchor-icon anchor-icon-link" anchorid="section7181529165813" tips="复制节点链接"></i></h2><p><span style="color: rgb(64,64,64);">应用使用XComponent组件时，有Surface和Texture两种模式。Surface模式会由一个XComponent组件创建一个独立的Surface图层。根据不同的播放场景，XComponent组件的使用数量也有所不同。在视频/小视频场景中，无弹幕全屏视频播放时，要求一个界面内的Surface模式的XComponent组件数量≤2；而在弹幕全屏视频播放时，由于弹幕功能需要额外Surface图层渲染弹幕内容，该限制放宽至一个界面内的Surface模式的XComponent组件数量≤3。</span></p> <div class="screenLinkPre"><div _ngcontent-qli-c106="" class="highlight-div"><div _ngcontent-qli-c106="" class="highlight-div-header"><div _ngcontent-qli-c106="" class="highlight-div-header-left"><div _ngcontent-qli-c106="" class="handle-button expand-button"><div _ngcontent-qli-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-qli-c106="" class="highlight-div-header-right"><div _ngcontent-qli-c106="" class="handle-button ai-button"></div><div _ngcontent-qli-c106="" class="handle-button line-button"><div _ngcontent-qli-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-qli-c106="" class="handle-button theme-button"><div _ngcontent-qli-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-qli-c106="" class="handle-button copy-button"><div _ngcontent-qli-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-qli-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-php" codehub="https://gitee.com/harmonyos_samples/BestPracticeSnippets/blob/master/RationalUseOfFrontEndResources/entry/src/main/ets/pages/VideoSceneLayers.ets#L26-L28" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-title function_ invoke__">XComponent</span>({ <span class="hljs-attr">id</span>: <span class="hljs-string">'XComponentId'</span>, <span class="hljs-attr">type</span>: <span class="hljs-string">'surface'</span>, <span class="hljs-attr">libraryname</span>: <span class="hljs-string">'entry'</span> })</li><li>  .<span class="hljs-title function_ invoke__">width</span>(<span class="hljs-number">360</span>)</li><li>  .<span class="hljs-title function_ invoke__">height</span>(<span class="hljs-number">360</span>)</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/BestPracticeSnippets/blob/master/RationalUseOfFrontEndResources/entry/src/main/ets/pages/VideoSceneLayers.ets#L26-L28" target="_blank">VideoSceneLayers.ets</a></div></div></div></div> <p></p> </div> <div class="tiledSection"><h2 id="section894815155911">调测验证<i class="anchor-icon anchor-icon-link" anchorid="section894815155911" tips="复制节点链接"></i></h2><p><span style="color: rgb(36,39,40);">图层抓取命令为</span><strong><span style="color: rgb(36,39,40);">hdc shell hidumper -s 10 -a allInfo。</span></strong><span style="color: rgb(36,39,40);">图层的信息如下，通过查看LayerInfo中的Surface个数，可以得出图层个数。</span></p> <p><span><img height="295.72284" originheight="832" originwidth="1841" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211163445.24973290336175491386024069681447:50001231000000:2800:E056B10EA04CEA66372C25146A599609F235B71FDCD0DD0ED8E62A3BF226E54F.png" title="点击放大" width="654.36"></span></p> <p><span style="color: rgb(36,39,40);">上图所示为一个没有弹幕的视频场景，共有4个图层，其中系统的图层2个，三方应用图层2个，符合三方应用图层个数要求</span>。</p> </div> </div> <div></div></div>