<h1 _ngcontent-hjl-c119="" class="doc-title ng-star-inserted" title="运行效率提高"> 运行效率提高 </h1>

<div _ngcontent-hjl-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;">   <div>    <p>在开发过程中，优化影响性能的代码片段，以提高运行效率。以下实践总结了一些高性能的写法和建议：</p>    <div class="tiledSection">     <h2 id="section036811453382">变量声明<i class="anchor-icon anchor-icon-link" anchorid="section036811453382" tips="复制节点链接"></i></h2>          <ul>      <li>对于初期明确不会改变的变量，尽量<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-arkts-high-performance#section11738469467">使用const声明常量</a>。这里的常量包括基础类型和引用类型。通过const声明，可以确保地址不会变化，减少因误操作导致的赋值错误，从而避免逻辑改变，并在编辑时及时发现错误。</li>      <li>对于number类型，编译器在优化时会区分int和double类型。开发者在初始化number类型的变量时<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-arkts-high-performance#section999716366470">指定number的类型</a>，如果预期是整数类型就初始化为0，小数类型就初始化为0.0，避免将一个number类型初始化为undefined或者null。</li>      <li>ESObject主要用于ArkTS和TS/JS跨语言调用的类型标注。在非跨语言场景中使用ESObject会引入不必要的跨语言调用，造成额外性能开销。建议在非跨语言调用的场景下<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-arkts-high-performance#section7831352488">减少使用ESObject</a>，引入明确的类型进行注释。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="section51711118161316">属性访问<i class="anchor-icon anchor-icon-link" anchorid="section51711118161316" tips="复制节点链接"></i></h2>          <ul>      <li>在要求性能的场景下，建议通过使用将全局变量存储为局部变量的方式来<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-arkts-high-performance#section1754105654816">减少变量的属性查找</a>，访问局部变量比访问全局变量更快。重复访问同一变量会造成不必要的消耗，尤其是在循环中，对性能的影响更大。</li>      <li>在ArkTS中，类结构的属性支持private、protected和public可访问修饰符。默认情况下，属性的可访问修饰符为public。<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-arkts-high-performance#section743155016482">给类属性添加访问修饰符</a>选取适当的可访问修饰符可以提升代码的安全性、可读性。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="section1889416518188">数值计算与数据结构<i class="anchor-icon anchor-icon-link" anchorid="section1889416518188" tips="复制节点链接"></i></h2>          <ul>      <li>如果是纯数值计算的场合，推荐<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-arkts-high-performance#section1169143314502">数值计算使用TypedArray</a>数据结构。TypedArray类型化数组是一种类似数组的对象，提供在内存缓冲区中访问原始二进制数据的机制。在图像数据处理和加解密计算中使用TypedArray可以提高数据处理效率，因为TypedArray基于ArrayBuffer实现，性能方面有显著提升。</li>      <li>通过<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-arkts-high-performance#section941819318528">选取合适的数据结构</a>提高运行效率。例如，使用Record作为临时容器处理属性存取逻辑，或使用HashMap实现快速读写键值。HashMap是ArkTS提供的高性能容器类，底层使用红黑树实现，支持高效的数据读写操作。</li>     </ul>    </div>    <div class="tiledSection">     <h2 id="section1478995916285">减少同文件大量export *导出方式和延迟加载<i class="anchor-icon anchor-icon-link" anchorid="section1478995916285" tips="复制节点链接"></i></h2>          <ul>      <li>由于依赖模块解析采用深度优先遍历，会从入口文件的第一个导入语句开始逐层查找，直到最后一个没有导入语句的模块。连接好该模块的导出变量后，再回到上一级模块重复此步骤。因此<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-arkts-high-performance#section1218510102815">减少同文件大量export *导出方式</a>，降低依赖模块解析、文件执行阶段耗时增长。</li>      <li>当工具类中存在较多暴露函数或变量时，推荐按需引用使用到的变量，<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-arkts-high-performance#section12861143418213">延迟加载</a>可以减少该阶段中.ets文件执行耗时，即减少文件中所有export变量的初始化过程。</li>     </ul>    </div>   </div>   <div></div></div>