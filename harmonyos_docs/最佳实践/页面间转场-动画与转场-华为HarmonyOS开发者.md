<h1 _ngcontent-jug-c119="" class="doc-title ng-star-inserted" title="页面间转场"> 页面间转场 </h1>

<div _ngcontent-jug-c106="" auitextselectionexpansion="" class="markdown-body ng-star-inserted" style="position: relative;"> <div><div class="tiledSection"><h2 id="section785234018814">概述<i class="anchor-icon anchor-icon-link" anchorid="section785234018814" tips="复制节点链接"></i></h2><p>页面间转场是用户从一个页面切换到另一个页面时的过程，一个无缝流畅的转场动效可以提升用户的交互体验。从主页到详情页、从列表页到结果页都需要去设置一些转场动效，使得用户体验更加流畅。基于用户行为和应用设计模式，总结出了一些常见的转场场景，包括层级转场、搜索转场、新建转场、编辑转场、通用转场、跨应用转场。针对这些转场场景，根据“人因研究”（在 HarmonyOS 中，通过大量的人因研究为UX设计提供了系统性的科学指导），给各位开发者推荐一些适合本场景下转场动效，常见的转场动效有左右位移遮罩动效、一镜到底动效等。</p> <p>HarmonyOS为开发者提供了丰富的转场能力，如UIAbility转场、页面路由转场、组件转场。同时，HarmonyOS提供了一些基于场景化封装的相关高级模板化转场，如导航转场、模态转场、共享元素转场，来实现页面之间的转场效果。</p> <p>在实际开发过程中，需要把上述UX设计视角转换为开发实现视角，即使用HarmonyOS提供的转场能力和动画能力来实现UX设计的场景和动效。在视角转化上，包含了分析UX设计视角、设计转场方案、使用转场与动画能力、使用高级模板化转场、调试和优化，详细可以参考<a href="https://developer.huawei.com/consumer/cn/doc/best-practices/bpta-fair-use-animation">《合理使用动画》</a>。通过以上步骤，开发者可以将UX设计视角转换为开发实现视角，并将设计师提供的转场场景和动效转化为具体的代码实现。这样可以确保应用在实际使用中达到设计的预期效果，并提供良好的用户体验。</p> <div class="fignone"><span class="figcap"><b>图1 </b>合理使用导航组件和转场动效</span><br><span><img height="327.10020000000003" originheight="1286" originwidth="2503" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211162947.36276292548029892415508506275051:50001231000000:2800:1ACE151DCCACF59891A734B8FE68176FF0AC4F9CF499B2F5E05B2F59AB8E60DC.png" title="点击放大" width="638.4000000000001"></span></div> </div> <div class="tiledSection"><h2 id="section199394454818">转场场景设计<i class="anchor-icon anchor-icon-link" anchorid="section199394454818" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section11424162718101" class="firsth2">转场动效<i class="anchor-icon anchor-icon-link" anchorid="section11424162718101" tips="复制节点链接"></i></h3><p>HarmonyOS系统为开发者提供了丰富的转场动效库，使开发者能够轻松实现各种转场动画效果。以下是一些在HarmonyOS系统中提供的转场动效：</p> <ul><li>左右位移遮罩动效：这种效果在转场过程中，页面元素会以左右方向进行位移，并且使用遮罩效果来过渡。这种转场效果常用于切换不同页面或者展示不同内容的情况，能够给用户带来明显的页面变化感。</li><li>左右间隔位移动效：这种效果在转场过程中，页面元素会以左右方向进行位移，但是与左右位移遮罩转场不同的是，元素之间会有一定的间隔。这种转场效果常用于展示多个相关页面之间的切换，能够给用户带来清晰的页面切换感。</li><li>一镜到底动效：这种效果在转场过程中，整个页面会以一种平滑的方式从一个场景过渡到另一个场景，仿佛是通过一镜到底的方式切换。这种转场效果常用于展示不同页面之间的关联性，能够给用户带来流畅的视觉体验。</li><li>淡入淡出动效：这种效果在转场过程中，页面元素会以逐渐淡入或淡出的方式进行过渡。这种转场效果常用于切换不同页面或者展示不同内容的情况，能够给用户带来柔和的视觉过渡效果。</li><li>缩放动效：这种效果在转场过程中，页面元素会以放大或缩小的方式进行过渡。这种转场效果常用于突出某个元素或者展示不同页面之间的层次感，能够给用户带来视觉上的冲击和焦点转移。</li></ul> <p>开发者可以根据具体需求，在应用的不同场景中应用这些转场动效，以提升用户体验和界面的吸引力。需要注意的是，为了最佳的用户体验，开发者应根据界面的功能和特点，合理选择转场动效，并遵循动效的使用准则，以确保转场动效在视觉和交互上的一致性。具体实现效果，请参考下一章节案例。</p> </div> <div class="tiledSection"><h3 id="section92341720171119">转场场景<i class="anchor-icon anchor-icon-link" anchorid="section92341720171119" tips="复制节点链接"></i></h3><p><strong>层级转场</strong></p> </div> <p>层级转场是指在用户界面中，从一个层级结构的界面状态转换到另一个层级结构的界面状态的过程，它通常用于在应用中进行页面间的导航和视图层级的变化。层级转场的场景可以划分为卡片、图表展开和列表展开：</p> <ul><li>列表展开：通常是完整的页面替换，开发者可以使用左右位移遮罩动效完成这类变化，见图2。</li></ul> <div class="fignone"><span class="figcap"><b>图2 </b>左右位移遮罩在列表展开场景下的用例</span></div> <p><span><img height="545.965" originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211162947.51365193032841394087185793602852:50001231000000:2800:54F81F7212ADFA32DCCFDECECE46BBABFF70E8A215497E98DAD588EB12D32203.gif" title="点击放大" width="266"></span></p> <ul><li>卡片/图表展开：单体独立卡片展开推荐使用一镜到底动效，见图3；相对复杂的组合卡片样式则需要由开发者以更为符合用户视觉流畅感为标准，根据实际情况选择左右位移遮罩动效或一镜到底动效。</li></ul> <div class="fignone"><span class="figcap"><b>图3 </b>一镜到底在单体卡片场景下的用例</span><br><span><img height="550.354" originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211162948.21657667906443501017705651579350:50001231000000:2800:3BF03CB7A9A7A96BEE01F5D292CC4996B5ED59165147BBFC01728F0A281E12A0.gif" title="点击放大" width="266"></span></div> <p>对于层级转场，推荐使用系统转场，页面转场采用左右位移的运动方式，不应单帧直接切换或上下位移切换，曲线优先使用弹簧曲线。</p> <p><strong>搜索转场</strong></p> <p>搜索转场是指在用户执行搜索操作，如在搜索栏中输入关键词并按下搜索按钮，或者直接触摸搜索图标时，应用改变应用页面以显示搜索结果的过程。它包含了固定搜索区域和非固定搜索区域两种情况：</p> <ul><li>固定搜索区域：在固定搜索区域中，大部分空间是不需要变化的，只是在上面增加了一层蒙版。主要变化区域集中在页眉，即搜索框和返回按键。当用户触发搜索操作时，页面可以使用淡入淡出动效来优化搜索体验，搜索框和返回按键通过渐变的方式进入视图，从而吸引用户的注意力，见图4。</li></ul> <div class="fignone"><span class="figcap"><b>图4 </b>淡入淡出在固定搜索区域场景下的用例</span><br><span><img height="545.965" originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211162948.03365175046584676298124003556718:50001231000000:2800:D9DFD3C78C2A42A30B62DEE9446DE9F74184DC6B3F9B1A85821D31BF8D0CFCA4.gif" title="点击放大" width="266"></span></div> <ul><li>非固定搜索区域：在非固定搜索区域中，页面的变化更加复杂。为了保持用户的注意力和流畅的体验，可以使用一镜到底的动效，让搜索框始终保持在用户视线焦点中，相对忽视页面中其余变动较大的部分，见图5。</li></ul> <div class="fignone"><span class="figcap"><b>图5 </b>一镜到底在非固定搜索区域场景下的用例</span><br><span><img height="545.965" originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211162948.74702839266531322491307610347206:50001231000000:2800:F9FF2E73E3EC45A744B29B5233C965CA5A36DAE55219855886FE00C98B4974E8.gif" title="点击放大" width="266"></span></div> <p>对于搜索转场，推荐使用共享元素转场，搜索框作为持续存在的元素串联前后两个界面，其他元素可采用淡入淡出或者其他过渡方式，不应单帧切换或非共享元素的方式转场。</p> <p><strong>新建转场</strong></p> <p>新建转场是指用户创建新内容或实体时，应用页面发生的过渡效果，它可以让用户感知到新的事物的添加或创建，并提供一种连贯和引人注目的视觉切换。由于新建页面中需要完成整个页面的替换，推荐开发者使用左右位移遮罩作为转场动效，如下图所示。</p> <div class="fignone"><span class="figcap"><b>图6 </b>左右位移遮罩在新建文本场景下的用例</span><br><span><img height="550.354" originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211162948.55661960528217971530088244846768:50001231000000:2800:AAA48A4B3C2A1820EE9E42FC4B1E7C5DB5BBFCB5E3ABB6D3EBCEC3293524A8AB.gif" title="点击放大" width="266"></span></div> <p>对于新建转场，推荐使用系统转场，页面转场采用左右位移的运动方式，不应单帧直接切换或上下位移切换，曲线优先使用弹簧曲线。</p> <p><strong>编辑转场</strong></p> <p>用户对现有内容或实体进行编辑时，例如点击“编辑”按钮，选择要编辑的项目或内容，或者执行其他与编辑相关的动作，应用应提供动效引导用户进入一个用于编辑现有内容的页面，修改所需的信息。在这个场景下，开发者需要达成的视觉效果是从编辑按键处弹出编辑页面，类似于单体卡片展开的效果。但由于一般的编辑按键并没有分明的外框，并不适用一镜到底的动效，此时淡入淡出能够提供类似于一镜到底的效果，如下图所示。</p> <div class="fignone"><span class="figcap"><b>图7 </b>淡入淡出在编辑联系人信息场景下的用例</span><br><span><img height="545.965" originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211162948.49602136126010466999445020648412:50001231000000:2800:703EB63E79C0C35E8589A51D1E353485E6F7E5873ADD79FC8E4164C5CB9C2986.gif" title="点击放大" width="266"></span></div> <p>对于编辑转场，推荐使用系统转场，页面转场采用淡入淡出的过渡方式，不应单帧直接切换或位移切换。</p> <p><strong>通用转场</strong></p> <p>通用转场是一种广泛适用于不同情境和应用类型的页面过渡效果，目的是提供一种通用的、可重复使用的方式，以改善用户页面之间的切换，增强用户体验。其关键点在于要适用各种应用情境，包括不同类型的应用（例如社交媒体、电子商务、新闻等）和不同操作（例如导航、搜索、编辑等）。这就需要一种通用的、不需要复杂操作的动效来完成跳转任务，而缩放能够满足绝大多数用户的需求和视觉体验感受，如下图所示。</p> <div class="fignone"><span class="figcap"><b>图8 </b>缩放在单体卡片场景下的用例</span><br><span><img height="550.354" originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211162948.83225125370011370479686521675592:50001231000000:2800:3F44C624329328EA42A668ADF5D3E60B1BB625B159E6263702E531A41378EE41.gif" title="点击放大" width="266"></span></div> <p><strong>跨应用转场</strong></p> <p>跨应用转场是指用户从一个应用程序切换到另一个应用程序，用户能够无缝地从一个应用切换到另一个应用，而不会感到中断或不适。和以上几类转场都不同的是，用户点击应用内的链接、按钮或执行其他与外部应用交互的动作后，页面的跳转已经不仅仅存在于页面与页面之间，而是应用与应用之间，为此，推荐开发者使用专为此设计的左右间隔位移动效，跳转效果如下图所示。</p> <div class="fignone"><span class="figcap"><b>图9 </b>左右间隔位移在跨应用跳转场景下的用例</span><br><span><img height="545.965" originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211162948.76657523471128551267977083144953:50001231000000:2800:73692796B7625C69859497EF8A582B1E43EC6910AC0D5555B2734AC8B71380AE.gif" title="点击放大" width="266"></span></div> <div class="tiledSection"><h3 id="section04583981310">场景解构<i class="anchor-icon anchor-icon-link" anchorid="section04583981310" tips="复制节点链接"></i></h3><p>转场是由交互行为引起的界面变化，分析界面元素在过程中的意义，定义其在转场中所在的类型，并将它们进行分类，元素所属的类别会影响它们使用怎样的转场能力，同时也将决定用什么类型的曲线和时长。</p> </div> <ul><li>进场元素：转场中新出现的元素，一般是结果界面上的构成元素。</li><li>出场元素：转场中消失的元素，一般是上一界面中的构成元素。</li><li>持续元素：转场中持续存在的元素，可以是元素在布局上的变化，也可以是某种连续性的动画效果，整个过程无中断。</li><li>静止元素：转场中无任何变化的元素。<div class="fignone"><span class="figcap"><b>图10 </b>分析元素示例</span><br><span><img height="182.54250000000002" originheight="307" originwidth="880" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211162948.78758206683145229288466726213954:50001231000000:2800:BE6CECB8166EFA12DCE86C56DF175B137BB6A7803E099201C56A547F7958B84C.gif" title="点击放大" width="523.6875"></span></div> <p>如上图中示例，①是进场元素，②是出场元素，③是持续元素，④是静止元素。</p> <p>接下来，开发者需要根据分析的元素类型选择合适的转场能力，并综合考虑元素和页面的整体感官效果。不同的元素类型可能需要不同的转场方式来展现其特定的特征和交互效果。</p> </li></ul> <div class="tiledSection"><h2 id="section314518508817">转场场景开发<i class="anchor-icon anchor-icon-link" anchorid="section314518508817" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section2374144171418" class="firsth2">转场能力<i class="anchor-icon anchor-icon-link" anchorid="section2374144171418" tips="复制节点链接"></i></h3><p>开发人员接收到设计需求后，需要选择合适的转场能力完成该设计。HarmonyOS为开发者提供了UIAbility转场、页面路由和组件转场三种方式，在选择转场方式时，开发者需要考虑用户体验、界面一致性和业务需求，确保所选导航组件能够提供直观、易用的导航方式，帮助应用实现更好的转场效果。</p> <ul><li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/uiability-intra-device-interaction" target="_blank">UIAbility组件间交互</a>：UIAbility是系统调度的最小单元。通过调用startAbility()方法启动UIAbility实现在设备内的功能模块之间的跳转。该UIAbility可以是应用内的其他UIAbility，也可以是其他应用的UIAbility（例如启动三方支付UIAbility）。</li><li>组件转场：组件转场是指通过HarmonyOS提供的各类组件来实现转场效果，以便更加便捷地展示不同的内容或功能模块。在组件转场中，可以使用诸如页面切换动画、过渡效果、布局变化等方式来实现页面之间的平滑切换。</li></ul> </div> <div class="tiledSection"><h3 id="section1560222414153">动画能力<i class="anchor-icon anchor-icon-link" anchorid="section1560222414153" tips="复制节点链接"></i></h3><p>转场动画是指对将要出现或消失的组件做动画，对始终出现的组件做动画应使用属性动画。转场动画主要为了让开发者从繁重的消失节点管理中解放出来，如果用属性动画做组件转场，开发者需要在动画结束回调中删除组件节点。同时，由于动画结束前已经删除的组件节点可能会重新出现，还需要在结束回调中增加对节点状态的判断。</p> <p>转场动画分为基础转场和高级模板化转场，<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-enter-exit-transition" target="_blank">出现/消失转场</a>是一种基础转场，是对新增、消失的控件实现动画效果的能力。为了简化开发者工作，HarmonyOS提供了以下高级模板，将属性动画和出现消失动画封装，开发者只需调用接口，可以轻松的完成页面转场：</p> <ul><li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-navigation-navigation" target="_blank">导航转场</a>：页面的路由转场方式，对应一个界面消失，另外一个界面出现的动画效果，如设置应用一级菜单切换到二级界面。</li><li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-modal-transition" target="_blank">模态转场</a>：新的界面覆盖在旧的界面之上的动画，旧的界面不消失，新的界面出现，如弹框就是典型的模态转场动画。</li><li><a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/arkts-shared-element-transition" target="_blank">共享元素转场</a>：共享元素转场是一种界面切换时对相同或者相似的元素做的一种位置和大小匹配的过渡动画效果。</li></ul> <div><div class="hw-editor-tip info"><div class="title">说明</div><div class="content"><p>在实现组件出现和消失的动画效果时，相比于组件动画（animateTo），推荐优先使用transition。因为animateTo需要在动画前后做两次属性更新，而transition只需做一次条件改变更新，性能更好。此外，使用transition可以避免在结束回调中做复杂逻辑处理，开发实现更容易。</p> <p>建议开发者优先使用<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide-code-linter" target="_blank">Code Linter扫描工具</a>进行代码检查，重点关注<a href="https://developer.huawei.com/consumer/cn/doc/harmonyos-guides/ide_hp-arkui-use-transition-to-replace-animateto" target="_blank">@performance/hp-arkui-use-transition-to-replace-animateto</a>规则。若扫描结果中出现该规则相关问题，可参考本章节提供的优化建议进行调整。</p> </div></div></div> </div> <div class="tiledSection"><h2 id="section1679175418813">最佳实践案例<i class="anchor-icon anchor-icon-link" anchorid="section1679175418813" tips="复制节点链接"></i></h2></div> <div class="tiledSection"><h3 id="section192919111307" class="firsth2">共享元素转场实现搜索转场<i class="anchor-icon anchor-icon-link" anchorid="section192919111307" tips="复制节点链接"></i></h3><p><strong>场景描述</strong></p> </div> <p>在日常的各类应用交互场景中，搜索转场是极为常见的页面转场。通过点击当前页面的搜索栏会跳转进入搜索输入页面，详细效果如下所示。</p> <div class="fignone"><span class="figcap"><b>图11 </b>共享元素转场实现搜索转场</span><br><span><img height="550.3407000000001" originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211162948.29991746722799992847630636075983:50001231000000:2800:43A722F69EAAE0AB4C78645D495219C49C0D42A51C2F32AA99E821FE5BBE3A19.gif" title="点击放大" width="266"></span></div> <p><strong>实现原理</strong></p> <p>在本案例中，搜索框会在转场中持续存在，且在转场前后有位置上的变化，可以使用共享元素转场让搜索框在转场过程中进行丝滑的上下文过渡。其实现步骤如下所示。</p> <ol><li><span>在转场前的页面中，在搜索组件上设置geometryTransition属性和唯一ID。同时，需要配合显示动画animateTo才能实现动画效果。</span></li><li><span>在转场后的页面中，在搜索组件上设置geometryTransition属性，并绑定唯一ID。</span></li></ol> <p><strong>开发步骤</strong></p> <p>在转场前页面的搜索组件Search上设置geometryTransition属性，并在Search的onTouch中设置显示动画animateTo，其中curve为动画曲线。</p> <div class="screenLinkPre"><div _ngcontent-jug-c106="" class="highlight-div"><div _ngcontent-jug-c106="" class="highlight-div-header"><div _ngcontent-jug-c106="" class="highlight-div-header-left"><div _ngcontent-jug-c106="" class="handle-button expand-button"><div _ngcontent-jug-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jug-c106="" class="highlight-div-header-right"><div _ngcontent-jug-c106="" class="handle-button ai-button"></div><div _ngcontent-jug-c106="" class="handle-button line-button"><div _ngcontent-jug-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jug-c106="" class="handle-button theme-button"><div _ngcontent-jug-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jug-c106="" class="handle-button copy-button"><div _ngcontent-jug-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jug-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-kotlin" codehub="https://gitee.com/harmonyos_samples/transitions-collection/blob/master/entry/src/main/ets/feature/SearchLongTakeTransition/SearchLongTakeTransitionPageOne.ets#L25-L83" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-meta">@Entry</span></li><li><span class="hljs-meta">@Component</span></li><li>struct SearchLongTakeTransitionPageOne {</li><li>  <span class="hljs-meta">@State</span> translateY: number = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-meta">@State</span> transitionEffect: TransitionEffect = TransitionEffect.IDENTITY;</li><li>  <span class="hljs-keyword">private</span> pageInfos: NavPathStack = new NavPathStack();</li><li>
</li><li>  build() {</li><li>    NavDestination() {</li><li>      Column({ space: <span class="hljs-number">20</span> }) {</li><li>        Search({ placeholder: <span class="hljs-string">'Search'</span> })</li><li>          .height(<span class="hljs-number">40</span>)</li><li>          .placeholderColor($r(<span class="hljs-string">'sys.color.mask_secondary'</span>))</li><li>          .width(<span class="hljs-string">'100%'</span>)</li><li>          <span class="hljs-comment">// set geometry transition</span></li><li>          .geometryTransition(<span class="hljs-string">'SEARCH_ONE_SHOT_DEMO_TRANSITION_ID'</span>, { follow: <span class="hljs-literal">true</span> })</li><li>          .backgroundColor(<span class="hljs-string">'#0D000000'</span>)</li><li>          .defaultFocus(<span class="hljs-literal">false</span>)</li><li>          .focusOnTouch(<span class="hljs-literal">false</span>)</li><li>          .focusable(<span class="hljs-literal">false</span>)</li><li>          .onTouch((event: TouchEvent) =&gt; {</li><li>            <span class="hljs-keyword">if</span> (event.type === TouchType.Up) {</li><li>              <span class="hljs-comment">// set search animation</span></li><li>              <span class="hljs-keyword">this</span>.showSearchPage();</li><li>            }</li><li>          })</li><li>      }</li><li>      .size({</li><li>        width: <span class="hljs-string">'90%'</span>,</li><li>        height: <span class="hljs-string">'100%'</span></li><li>      })</li><li>    }</li><li>    .transition(TransitionEffect.OPACITY)</li><li>    .backgroundColor(<span class="hljs-string">'#F1F3F5'</span>)</li><li>    .title(getResourceString(<span class="hljs-keyword">this</span>.getUIContext(), $r(<span class="hljs-string">'app.string.search_title'</span>), <span class="hljs-keyword">this</span>))</li><li>    .onReady((context: NavDestinationContext) =&gt; {</li><li>      <span class="hljs-keyword">this</span>.pageInfos = context.pathStack;</li><li>    })</li><li>    .onBackPressed(() =&gt; {</li><li>      <span class="hljs-keyword">this</span>.transitionEffect = TransitionEffect.IDENTITY;</li><li>      <span class="hljs-keyword">this</span>.pageInfos.pop(<span class="hljs-literal">true</span>);</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;</li><li>    })</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// Search animation</span></li><li>  <span class="hljs-keyword">private</span> showSearchPage(): void {</li><li>    <span class="hljs-keyword">this</span>.transitionEffect = TransitionEffect.OPACITY;</li><li>    <span class="hljs-keyword">this</span>.getUIContext().animateTo({</li><li>      curve: curves.interpolatingSpring(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">342</span>, <span class="hljs-number">38</span>)</li><li>    }, () =&gt; {</li><li>      <span class="hljs-keyword">this</span>.pageInfos.pushPath({ name: <span class="hljs-string">'SearchLongTakeTransitionPageTwo'</span> }, <span class="hljs-literal">false</span>);</li><li>    })</li><li>  }</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/transitions-collection/blob/master/entry/src/main/ets/feature/SearchLongTakeTransition/SearchLongTakeTransitionPageOne.ets#L25-L83" target="_blank">SearchLongTakeTransitionPageOne.ets</a></div></div></div></div> <p>在转场后的页面的搜索组件Search上绑定唯一ID。</p> <div class="screenLinkPre"><div _ngcontent-jug-c106="" class="highlight-div"><div _ngcontent-jug-c106="" class="highlight-div-header"><div _ngcontent-jug-c106="" class="highlight-div-header-left"><div _ngcontent-jug-c106="" class="handle-button expand-button"><div _ngcontent-jug-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jug-c106="" class="highlight-div-header-right"><div _ngcontent-jug-c106="" class="handle-button ai-button"></div><div _ngcontent-jug-c106="" class="handle-button line-button"><div _ngcontent-jug-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jug-c106="" class="handle-button theme-button"><div _ngcontent-jug-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jug-c106="" class="handle-button copy-button"><div _ngcontent-jug-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jug-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_samples/transitions-collection/blob/master/entry/src/main/ets/feature/SearchLongTakeTransition/SearchLongTakeTransitionPageTwo.ets#L25-L93" data-highlighted="yes"><ol class="linenums"><li>@<span class="hljs-title function_">Component</span></li><li><span class="hljs-variable">export</span> <span class="hljs-variable">default</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">SearchLongTakeTransitionPageTwo</span> {</li><li>  @<span class="hljs-title function_">Prop</span> <span class="hljs-variable">param</span>: <span class="hljs-title class_">SearchPageExtraInfo</span>;</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-variable">pageInfos</span>: <span class="hljs-title class_">NavPathStack</span> = <span class="hljs-variable">new</span> <span class="hljs-title function_">NavPathStack</span>();</li><li>
</li><li>  <span class="hljs-title function_">build</span>() {</li><li>    <span class="hljs-title function_">NavDestination</span>() {</li><li>      <span class="hljs-title function_">Column</span>() {</li><li>        <span class="hljs-title function_">Row</span>({ <span class="hljs-variable">space</span>: <span class="hljs-number">8</span> }) {</li><li>          <span class="hljs-title function_">Image</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.media.img'</span>))</li><li>            .<span class="hljs-title function_">width</span>(<span class="hljs-number">40</span>)</li><li>            .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>            .<span class="hljs-title function_">onClick</span>(() =&gt; {</li><li>              <span class="hljs-keyword">this</span>.<span class="hljs-title function_">onArrowClicked</span>();</li><li>            })</li><li>            .<span class="hljs-title function_">transition</span>(<span class="hljs-variable">TransitionEffect</span>.<span class="hljs-title function_">asymmetric</span>(</li><li>              <span class="hljs-variable">TransitionEffect</span>.<span class="hljs-variable">OPACITY</span></li><li>                .<span class="hljs-title function_">animation</span>({ <span class="hljs-variable">duration</span>: <span class="hljs-number">200</span>, <span class="hljs-variable">delay</span>: <span class="hljs-number">150</span>, <span class="hljs-variable">curve</span>: <span class="hljs-title class_">curves</span>.<span class="hljs-title class_">cubicBezierCurve</span>(<span class="hljs-number">0.33</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.67</span>, <span class="hljs-number">1</span>) }),</li><li>              <span class="hljs-variable">TransitionEffect</span>.<span class="hljs-variable">OPACITY</span></li><li>                .<span class="hljs-title function_">animation</span>({ <span class="hljs-variable">duration</span>: <span class="hljs-number">200</span>, <span class="hljs-variable">curve</span>: <span class="hljs-title class_">curves</span>.<span class="hljs-title class_">cubicBezierCurve</span>(<span class="hljs-number">0.33</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0.67</span>, <span class="hljs-number">1</span>) })</li><li>            ))</li><li>
</li><li>          <span class="hljs-title function_">Search</span>({ <span class="hljs-variable">placeholder</span>: <span class="hljs-string">'DevEco Studio'</span> })</li><li>            .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>            .<span class="hljs-title function_">placeholderColor</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'sys.color.mask_secondary'</span>))</li><li>            .<span class="hljs-title function_">width</span>(<span class="hljs-string">'85%'</span>)</li><li>            .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#0D000000'</span>)</li><li>            .<span class="hljs-title function_">height</span>(<span class="hljs-number">40</span>)</li><li>            <span class="hljs-comment">// bind geometry id</span></li><li>            .<span class="hljs-title function_">geometryTransition</span>(<span class="hljs-string">'SEARCH_ONE_SHOT_DEMO_TRANSITION_ID'</span>)</li><li>            .<span class="hljs-title function_">transition</span>(<span class="hljs-variable">TransitionEffect</span>.<span class="hljs-title function_">opacity</span>(<span class="hljs-number">0.99</span>))</li><li>            .<span class="hljs-title function_">defaultFocus</span>(<span class="hljs-keyword">true</span>)</li><li>            .<span class="hljs-title function_">focusOnTouch</span>(<span class="hljs-keyword">true</span>)</li><li>        }</li><li>        .<span class="hljs-title function_">width</span>(<span class="hljs-string">'100%'</span>)</li><li>        .<span class="hljs-title function_">height</span>(<span class="hljs-number">50</span>)</li><li>        .<span class="hljs-title function_">alignItems</span>(<span class="hljs-variable">VerticalAlign</span>.<span class="hljs-variable">Center</span>)</li><li>        .<span class="hljs-title function_">padding</span>(<span class="hljs-number">16</span>)</li><li>      }</li><li>      .<span class="hljs-title function_">size</span>({</li><li>        <span class="hljs-variable">width</span>: <span class="hljs-string">'100%'</span>,</li><li>        <span class="hljs-variable">height</span>: <span class="hljs-string">'100%'</span></li><li>      })</li><li>      .<span class="hljs-title function_">margin</span>({ <span class="hljs-variable">top</span>: <span class="hljs-number">16</span> })</li><li>    }</li><li>    .<span class="hljs-title function_">transition</span>(<span class="hljs-variable">TransitionEffect</span>.<span class="hljs-variable">OPACITY</span>)</li><li>    .<span class="hljs-title function_">hideTitleBar</span>(<span class="hljs-keyword">true</span>)</li><li>    .<span class="hljs-title function_">backgroundColor</span>(<span class="hljs-string">'#F1F3F5'</span>)</li><li>    .<span class="hljs-title function_">onReady</span>((<span class="hljs-variable">context</span>: <span class="hljs-title class_">NavDestinationContext</span>) =&gt; {</li><li>      <span class="hljs-keyword">this</span>.<span class="hljs-variable">pageInfos</span> = <span class="hljs-variable">context</span>.<span class="hljs-variable">pathStack</span>;</li><li>    })</li><li>    .<span class="hljs-title function_">onBackPressed</span>(() =&gt; {</li><li>      <span class="hljs-keyword">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">animateTo</span>({</li><li>        <span class="hljs-variable">curve</span>: <span class="hljs-title class_">curves</span>.<span class="hljs-title class_">interpolatingSpring</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">342</span>, <span class="hljs-number">38</span>),</li><li>      }, () =&gt; {</li><li>        <span class="hljs-keyword">this</span>.<span class="hljs-variable">pageInfos</span>.<span class="hljs-title function_">pop</span>(<span class="hljs-keyword">false</span>);</li><li>      })</li><li>      <span class="hljs-keyword">return</span> <span class="hljs-keyword">true</span>;</li><li>    })</li><li>  }</li><li>
</li><li>  <span class="hljs-keyword">private</span> <span class="hljs-title function_">onArrowClicked</span>(): <span class="hljs-title class_">void</span> {</li><li>    <span class="hljs-keyword">this</span>.<span class="hljs-title function_">getUIContext</span>().<span class="hljs-title function_">animateTo</span>({</li><li>      <span class="hljs-variable">curve</span>: <span class="hljs-title class_">curves</span>.<span class="hljs-title class_">interpolatingSpring</span>(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>, <span class="hljs-number">342</span>, <span class="hljs-number">38</span>)</li><li>    }, () =&gt; {</li><li>      <span class="hljs-keyword">this</span>.<span class="hljs-variable">pageInfos</span>.<span class="hljs-title function_">pop</span>(<span class="hljs-keyword">false</span>);</li><li>    })</li><li>  }</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/transitions-collection/blob/master/entry/src/main/ets/feature/SearchLongTakeTransition/SearchLongTakeTransitionPageTwo.ets#L25-L93" target="_blank">SearchLongTakeTransitionPageTwo.ets</a></div></div></div></div> <div class="tiledSection"><h3 id="section1269248173010">模态转场模板实现通用转场<i class="anchor-icon anchor-icon-link" anchorid="section1269248173010" tips="复制节点链接"></i></h3><p><strong>场景描述</strong></p> </div> <p>如图所示，在进入第一个页面时为半模态转场，通过半模态展现多种登录的方式。点击进入第二个页面时为全模态转场，展示了手机验证码登录页面。</p> <div class="fignone"><span class="figcap"><b>图12 </b>模态转场实现通用转场</span><br><span><img height="550.354" originheight="720" originwidth="348" src="https://alliance-communityfile-drcn.dbankcdn.com/FileServer/getFile/cmtyPub/011/111/111/0000000000011111111.20251211162948.62601485777874322019097294291847:50001231000000:2800:BE050A133B165EA379ACD0CECF628F9FC2C8CD2AB5EE8567994B64C23E997D2E.gif" title="点击放大" width="266"></span></div> <p><strong>实现原理</strong></p> <p>在半模态转场和全模态转场中，两者实现的步骤基本相同，具体调用的接口有差异，详细实现步骤如下所示。</p> <ol><li><span>定义模态展示界面，即提前准备需要展示的页面。</span></li><li><span>通过模态接口调起模态展示界面。半模态转场使用bindSheet接口，全模态转场使用bindContentCover接口。通过模态接口绑定模态展示界面。</span></li><li><span>设置接口参数，选择转场动画。</span></li></ol> <p><strong>开发步骤</strong></p> <ul><li>在半模态转场中，首先需要准备模态展示的页面，再通过bindSheet绑定模态展示界面。</li></ul> <div class="screenLinkPre"><div _ngcontent-jug-c106="" class="highlight-div"><div _ngcontent-jug-c106="" class="highlight-div-header"><div _ngcontent-jug-c106="" class="highlight-div-header-left"><div _ngcontent-jug-c106="" class="handle-button expand-button"><div _ngcontent-jug-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jug-c106="" class="highlight-div-header-right"><div _ngcontent-jug-c106="" class="handle-button ai-button"></div><div _ngcontent-jug-c106="" class="handle-button line-button"><div _ngcontent-jug-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jug-c106="" class="handle-button theme-button"><div _ngcontent-jug-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jug-c106="" class="handle-button copy-button"><div _ngcontent-jug-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jug-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-cangjie" codehub="https://gitee.com/harmonyos_samples/transitions-collection/blob/master/entry/src/main/ets/feature/MultiModalTransition/HalfModalWindow.ets#L28-L278" data-highlighted="yes"><ol class="linenums"><li>@<span class="hljs-title function_">Component</span></li><li><span class="hljs-variable">export</span> <span class="hljs-keyword">struct</span> <span class="hljs-title class_">HalfModalWindow</span> {</li><li>  @<span class="hljs-title function_">Consume</span>(<span class="hljs-string">'NavPathStack'</span>) <span class="hljs-variable">pageInfos</span>: <span class="hljs-title class_">NavPathStack</span>;</li><li>  <span class="hljs-comment">// Whether to display the half-screen modal page.</span></li><li>  @<span class="hljs-title function_">State</span> <span class="hljs-variable">isPresent</span>: <span class="hljs-title class_">boolean</span> = <span class="hljs-keyword">false</span>;</li><li>  <span class="hljs-comment">// half-mode height</span></li><li>  @<span class="hljs-title function_">State</span> <span class="hljs-variable">sheetHeight</span>: <span class="hljs-title class_">number</span> = <span class="hljs-variable">Constants</span>.<span class="hljs-variable">FONT_WEIGHT</span>;</li><li>  <span class="hljs-comment">// Whether to display the control bar</span></li><li>  @<span class="hljs-title function_">State</span> <span class="hljs-variable">showDragBar</span>: <span class="hljs-title class_">boolean</span> = <span class="hljs-keyword">true</span>;</li><li>  <span class="hljs-comment">// Determine whether to agree with the agreement</span></li><li>  @<span class="hljs-title function_">State</span> <span class="hljs-variable">isConfirmed</span>: <span class="hljs-title class_">boolean</span> = <span class="hljs-keyword">false</span>;</li><li>  <span class="hljs-comment">// Controlling Full-Modal Presentation</span></li><li>  @<span class="hljs-title function_">State</span> <span class="hljs-variable">isPresentInLoginView</span>: <span class="hljs-title class_">boolean</span> = <span class="hljs-keyword">false</span>;</li><li>  <span class="hljs-comment">// Transparency of the button for sending a verification code</span></li><li>  @<span class="hljs-title function_">State</span> <span class="hljs-variable">op</span>: <span class="hljs-title class_">number</span> = <span class="hljs-variable">Constants</span>.<span class="hljs-variable">HALF_OPACITY</span>;</li><li>  <span class="hljs-comment">// Specifies the transition type</span></li><li>  <span class="hljs-comment">// The value is false when the component is redirected from the semi-modal component to the mobile verification code component</span></li><li>  <span class="hljs-comment">// and the value is true when the component is redirected from the account password component to the mobile verification code component</span></li><li>  @<span class="hljs-title function_">State</span> <span class="hljs-variable">isShowTransition</span>: <span class="hljs-title class_">boolean</span> = <span class="hljs-keyword">false</span>;</li><li>  @<span class="hljs-title function_">State</span> <span class="hljs-variable">isCenter</span>: <span class="hljs-title class_">boolean</span> = <span class="hljs-keyword">true</span>;</li><li>  @<span class="hljs-title function_">State</span> <span class="hljs-variable">screenW</span>: <span class="hljs-title class_">number</span> = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-comment">// According to the mode attribute description of Navigation</span></li><li>  <span class="hljs-comment">// if Auto is used and the window width is greater than or equal to 600 vp, the Split mode is used for display</span></li><li>  <span class="hljs-variable">curFoldStatus</span>: <span class="hljs-title class_">display</span>.<span class="hljs-title class_">FoldStatus</span> | <span class="hljs-title class_">undefined</span> = <span class="hljs-variable">undefined</span>;</li><li>  <span class="hljs-comment">// Folded state of the current screen (valid only for devices with folded screens)</span></li><li>  <span class="hljs-comment">// When the window width is less than 600 vp, the window is displayed in stack mode</span></li><li>  <span class="hljs-keyword">private</span> <span class="hljs-variable">deviceSize</span>: <span class="hljs-title class_">number</span> = <span class="hljs-variable">Constants</span>.<span class="hljs-variable">DEFAULT_DEVICE_SIZE</span>;</li><li>
</li><li>  <span class="hljs-comment">// ...</span></li><li>
</li><li>  @<span class="hljs-title function_">Builder</span></li><li>  <span class="hljs-title function_">defaultLogin</span>() {</li><li>    <span class="hljs-title function_">Column</span>() {</li><li>      <span class="hljs-comment">// CheckBox to control, semi-modal, full-modal, and semi-modal confirmations in the login page</span></li><li>      <span class="hljs-title function_">CaptchaLogin</span>({</li><li>        <span class="hljs-variable">isPresent</span>: $<span class="hljs-title class_">isPresent</span>,</li><li>        <span class="hljs-variable">isPresentInLoginView</span>: $<span class="hljs-title class_">isPresentInLoginView</span>,</li><li>        <span class="hljs-variable">isShowTransition</span>: $<span class="hljs-title class_">isShowTransition</span></li><li>      })</li><li>    }</li><li>  }</li><li>
</li><li>  @<span class="hljs-title function_">Builder</span></li><li>  <span class="hljs-title function_">halfModalLogin</span>() {</li><li>    <span class="hljs-comment">// semi-modal window page</span></li><li>    <span class="hljs-title function_">Column</span>() {</li><li>      <span class="hljs-title function_">Text</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.string.multimodaltransion_after_login_more_service'</span>))</li><li>        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-variable">Color</span>.<span class="hljs-variable">Black</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.integer.font_size_normal'</span>))</li><li>        .<span class="hljs-title function_">padding</span>({ <span class="hljs-variable">top</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">integer</span>.<span class="hljs-title class_">padding_top_large</span>') })</li><li>
</li><li>      <span class="hljs-title function_">Text</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.string.multimodaltransion_user_phone_number'</span>))</li><li>        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-variable">Color</span>.<span class="hljs-variable">Black</span>)</li><li>        .<span class="hljs-title function_">fontSize</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.integer.font_size_large'</span>))</li><li>        .<span class="hljs-title function_">fontWeight</span>(<span class="hljs-variable">Constants</span>.<span class="hljs-variable">FONT_WEIGHT_SM</span>)</li><li>        .<span class="hljs-title function_">padding</span>({</li><li>          <span class="hljs-variable">top</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">integer</span>.<span class="hljs-title class_">font_size_large</span>'),</li><li>          <span class="hljs-variable">bottom</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">integer</span>.<span class="hljs-title class_">multimodaltransion_margin_default</span>')</li><li>        })</li><li>
</li><li>      <span class="hljs-title function_">Text</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.string.multimodaltransion_get_service'</span>))</li><li>        .<span class="hljs-title function_">fontColor</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.color.multimodaltransion_grey_9'</span>))</li><li>        .<span class="hljs-title function_">fontSize</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.integer.multimodaltransion_row_text_font_size'</span>))</li><li>        .<span class="hljs-title function_">padding</span>({ <span class="hljs-variable">bottom</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">integer</span>.<span class="hljs-title class_">multimodaltransion_height_fifty</span>') })</li><li>
</li><li>      <span class="hljs-title function_">Button</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.string.multimodaltransion_phone_start_login'</span>))</li><li>        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-variable">Color</span>.<span class="hljs-variable">White</span>)</li><li>        .<span class="hljs-keyword">type</span>(<span class="hljs-variable">ButtonType</span>.<span class="hljs-variable">Normal</span>)</li><li>        .<span class="hljs-title function_">backgroundColor</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.color.multimodaltransion_red'</span>))</li><li>        .<span class="hljs-title function_">onClick</span>(() =&gt; {</li><li>          <span class="hljs-keyword">try</span> {</li><li>            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.<span class="hljs-variable">isConfirmed</span>) {</li><li>              <span class="hljs-keyword">this</span>.<span class="hljs-title function_">getUIContext</span>()</li><li>                .<span class="hljs-title function_">getPromptAction</span>()</li><li>                .<span class="hljs-title function_">showToast</span>({ <span class="hljs-variable">message</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">string</span>.<span class="hljs-title class_">multimodaltransion_login_success</span>') });</li><li>              <span class="hljs-variable">AppStorage</span>.<span class="hljs-title function_">set</span>(<span class="hljs-string">'login'</span>, <span class="hljs-keyword">true</span>);</li><li>              <span class="hljs-keyword">this</span>.<span class="hljs-variable">pageInfos</span>.<span class="hljs-title function_">pop</span>();</li><li>            } <span class="hljs-keyword">else</span> {</li><li>              <span class="hljs-keyword">this</span>.<span class="hljs-title function_">getUIContext</span>()</li><li>                .<span class="hljs-title function_">getPromptAction</span>()</li><li>                .<span class="hljs-title function_">showToast</span>({ <span class="hljs-variable">message</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">string</span>.<span class="hljs-title class_">multimodaltransion_please_read_and_agree</span>') });</li><li>            }</li><li>          } <span class="hljs-keyword">catch</span> (<span class="hljs-variable">err</span>) {</li><li>            <span class="hljs-keyword">let</span> <span class="hljs-variable">error</span> = <span class="hljs-variable">err</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">BusinessError</span>;</li><li>            <span class="hljs-variable">hilog</span>.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'HalfModalWindow'</span>, `<span class="hljs-variable">login</span> <span class="hljs-variable">failed</span>. <span class="hljs-variable">error</span> <span class="hljs-variable">code</span>=${<span class="hljs-variable">error</span>.<span class="hljs-variable">code</span>}, <span class="hljs-variable">message</span>=${<span class="hljs-variable">error</span>.<span class="hljs-variable">message</span>}`);</li><li>          }</li><li>        })</li><li>        .<span class="hljs-title function_">width</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.string.multimodaltransion_size_ninety_percent'</span>))</li><li>        .<span class="hljs-title function_">height</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.integer.multimodaltransion_height_fifty'</span>))</li><li>        .<span class="hljs-title function_">margin</span>({</li><li>          <span class="hljs-variable">left</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">integer</span>.<span class="hljs-title class_">main_page_padding2</span>'),</li><li>          <span class="hljs-variable">right</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">integer</span>.<span class="hljs-title class_">main_page_padding2</span>'),</li><li>          <span class="hljs-variable">bottom</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">integer</span>.<span class="hljs-title class_">multimodaltransion_row_padding_bottom</span>')</li><li>        })</li><li>
</li><li>      <span class="hljs-title function_">Button</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.string.multimodaltransion_captcha_login_text'</span>))</li><li>        .<span class="hljs-title function_">fontColor</span>(<span class="hljs-variable">Color</span>.<span class="hljs-variable">Black</span>)</li><li>        .<span class="hljs-title function_">borderRadius</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.integer.multimodaltransion_border_radius'</span>))</li><li>        .<span class="hljs-keyword">type</span>(<span class="hljs-variable">ButtonType</span>.<span class="hljs-variable">Normal</span>)</li><li>        .<span class="hljs-title function_">backgroundColor</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.color.multimodaltransion_btn_bgc'</span>))</li><li>        .<span class="hljs-title function_">border</span>({</li><li>          <span class="hljs-variable">color</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">color</span>.<span class="hljs-title class_">multimodaltransion_half_modal_btn_bgc</span>'),</li><li>          <span class="hljs-variable">width</span>: <span class="hljs-title class_">Constants</span>.<span class="hljs-title class_">DEFAULT_ONE</span></li><li>        })</li><li>        .<span class="hljs-title function_">onClick</span>(() =&gt; {</li><li>          <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.<span class="hljs-variable">isConfirmed</span>) {</li><li>            <span class="hljs-keyword">this</span>.<span class="hljs-variable">isPresentInLoginView</span> = <span class="hljs-keyword">true</span>;</li><li>            <span class="hljs-keyword">this</span>.<span class="hljs-variable">isConfirmed</span> = <span class="hljs-keyword">false</span>;</li><li>            <span class="hljs-keyword">this</span>.<span class="hljs-variable">isShowTransition</span> = <span class="hljs-keyword">false</span>;</li><li>          } <span class="hljs-keyword">else</span> {</li><li>            <span class="hljs-keyword">try</span> {</li><li>              <span class="hljs-keyword">this</span>.<span class="hljs-title function_">getUIContext</span>()</li><li>                .<span class="hljs-title function_">getPromptAction</span>()</li><li>                .<span class="hljs-title function_">showToast</span>({ <span class="hljs-variable">message</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">string</span>.<span class="hljs-title class_">multimodaltransion_please_read_and_agree</span>') });</li><li>            } <span class="hljs-keyword">catch</span> (<span class="hljs-variable">err</span>) {</li><li>              <span class="hljs-keyword">let</span> <span class="hljs-variable">error</span> = <span class="hljs-variable">err</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">BusinessError</span>;</li><li>              <span class="hljs-variable">hilog</span>.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'HalfModalWindow'</span>,</li><li>                `<span class="hljs-variable">code</span> <span class="hljs-variable">login</span> <span class="hljs-variable">failed</span>. <span class="hljs-variable">error</span> <span class="hljs-variable">code</span>=${<span class="hljs-variable">error</span>.<span class="hljs-variable">code</span>}, <span class="hljs-variable">message</span>=${<span class="hljs-variable">error</span>.<span class="hljs-variable">message</span>}`);</li><li>            }</li><li>          }</li><li>        })</li><li>        .<span class="hljs-title function_">width</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.string.multimodaltransion_size_ninety_percent'</span>))</li><li>        .<span class="hljs-title function_">height</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.integer.multimodaltransion_height_fifty'</span>))</li><li>        .<span class="hljs-title function_">margin</span>({ <span class="hljs-variable">bottom</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">integer</span>.<span class="hljs-title class_">font_size_large</span>') })</li><li>      <span class="hljs-title function_">Blank</span>()</li><li>
</li><li>      <span class="hljs-title function_">Row</span>() {</li><li>        <span class="hljs-title function_">Checkbox</span>({ <span class="hljs-variable">name</span>: <span class="hljs-title class_">Constants</span>.<span class="hljs-title class_">CHECK_BOX_NAME1</span> })</li><li>          .<span class="hljs-title function_">select</span>(<span class="hljs-keyword">this</span>.<span class="hljs-variable">isConfirmed</span>)</li><li>          .<span class="hljs-title function_">width</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.integer.font_size_sm'</span>))</li><li>          .<span class="hljs-title function_">onChange</span>((<span class="hljs-variable">value</span>: <span class="hljs-title class_">boolean</span>) =&gt; {</li><li>            <span class="hljs-keyword">this</span>.<span class="hljs-variable">isConfirmed</span> = <span class="hljs-variable">value</span>;</li><li>          })</li><li>        <span class="hljs-title function_">Text</span>() {</li><li>          <span class="hljs-title function_">Span</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.string.multimodaltransion_read_and_agree'</span>))</li><li>            .<span class="hljs-title function_">fontColor</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.color.multimodaltransion_grey_9'</span>))</li><li>          <span class="hljs-title function_">Span</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.string.multimodaltransion_server_proxy_rule_detail'</span>))</li><li>            .<span class="hljs-title function_">fontColor</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.color.multimodaltransion_note_color'</span>))</li><li>            .<span class="hljs-title function_">onClick</span>(() =&gt; {</li><li>              <span class="hljs-keyword">try</span> {</li><li>                <span class="hljs-keyword">this</span>.<span class="hljs-title function_">getUIContext</span>()</li><li>                  .<span class="hljs-title function_">getPromptAction</span>()</li><li>                  .<span class="hljs-title function_">showToast</span>({ <span class="hljs-variable">message</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">string</span>.<span class="hljs-title class_">multimodaltransion_only_show_ui</span>') });</li><li>              } <span class="hljs-keyword">catch</span> (<span class="hljs-variable">err</span>) {</li><li>                <span class="hljs-keyword">let</span> <span class="hljs-variable">error</span> = <span class="hljs-variable">err</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">BusinessError</span>;</li><li>                <span class="hljs-variable">hilog</span>.<span class="hljs-title function_">error</span>(<span class="hljs-number">0x0000</span>, <span class="hljs-string">'HalfModalWindow'</span>,</li><li>                  `<span class="hljs-variable">rule</span> <span class="hljs-variable">detail</span>. <span class="hljs-variable">error</span> <span class="hljs-variable">code</span>=${<span class="hljs-variable">error</span>.<span class="hljs-variable">code</span>}, <span class="hljs-variable">message</span>=${<span class="hljs-variable">error</span>.<span class="hljs-variable">message</span>}`);</li><li>              }</li><li>            })</li><li>        }.<span class="hljs-title function_">fontSize</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.integer.font_size_sm'</span>))</li><li>      }</li><li>      .<span class="hljs-title function_">margin</span>({ <span class="hljs-variable">left</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">integer</span>.<span class="hljs-title class_">multimodaltransion_other_ways_icon_height</span>') })</li><li>      .<span class="hljs-title function_">width</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.string.multimodaltransion_size_full'</span>))</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-title function_">build</span>() {</li><li>    <span class="hljs-title function_">NavDestination</span>() {</li><li>      <span class="hljs-title function_">Column</span>() {</li><li>        <span class="hljs-comment">//The Text component is bound for semi-modal display</span></li><li>        <span class="hljs-title function_">Text</span>()</li><li>          .<span class="hljs-title function_">bindSheet</span>($$<span class="hljs-keyword">this</span>.<span class="hljs-variable">isPresent</span>, <span class="hljs-keyword">this</span>.<span class="hljs-title function_">halfModalLogin</span>(), {</li><li>            <span class="hljs-variable">height</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">sheetHeight</span>,</li><li>            <span class="hljs-variable">dragBar</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">showDragBar</span>,</li><li>            <span class="hljs-variable">preferType</span>: <span class="hljs-keyword">this</span>.<span class="hljs-title class_">isCenter</span> ? <span class="hljs-title class_">SheetType</span>.<span class="hljs-title class_">CENTER</span> : <span class="hljs-title class_">SheetType</span>.<span class="hljs-title class_">POPUP</span>,</li><li>            <span class="hljs-variable">backgroundColor</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">color</span>.<span class="hljs-title class_">multimodaltransion_btn_bgc</span>'),</li><li>            <span class="hljs-variable">showClose</span>: <span class="hljs-keyword">true</span>,</li><li>            <span class="hljs-variable">shouldDismiss</span>: ((<span class="hljs-variable">sheetDismiss</span>: <span class="hljs-title class_">SheetDismiss</span>) =&gt; {</li><li>              <span class="hljs-variable">sheetDismiss</span>.<span class="hljs-title function_">dismiss</span>();</li><li>              <span class="hljs-keyword">this</span>.<span class="hljs-variable">pageInfos</span>.<span class="hljs-title function_">pop</span>();</li><li>            })</li><li>          })</li><li>        <span class="hljs-comment">// ...</span></li><li>      }</li><li>      .<span class="hljs-title function_">expandSafeArea</span>([<span class="hljs-variable">SafeAreaType</span>.<span class="hljs-variable">SYSTEM</span>], [<span class="hljs-variable">SafeAreaEdge</span>.<span class="hljs-variable">TOP</span>, <span class="hljs-variable">SafeAreaEdge</span>.<span class="hljs-variable">BOTTOM</span>])</li><li>      .<span class="hljs-title function_">justifyContent</span>(<span class="hljs-variable">FlexAlign</span>.<span class="hljs-variable">Center</span>)</li><li>      .<span class="hljs-title function_">size</span>({</li><li>        <span class="hljs-variable">width</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">string</span>.<span class="hljs-title class_">multimodaltransion_size_full</span>'),</li><li>        <span class="hljs-variable">height</span>: $<span class="hljs-title class_">r</span>('<span class="hljs-title class_">app</span>.<span class="hljs-title class_">string</span>.<span class="hljs-title class_">multimodaltransion_size_full</span>')</li><li>      })</li><li>      .<span class="hljs-title function_">padding</span>($<span class="hljs-title function_">r</span>(<span class="hljs-string">'app.integer.multimodaltransion_padding_default'</span>))</li><li>    }</li><li>  }</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/transitions-collection/blob/master/entry/src/main/ets/feature/MultiModalTransition/HalfModalWindow.ets#L28-L278" target="_blank">HalfModalWindow.ets</a></div></div></div></div> <ul><li>在全模态转场中，其实现步骤与半模态转场类似，代码如下所示。</li></ul> <div class="screenLinkPre"><div _ngcontent-jug-c106="" class="highlight-div"><div _ngcontent-jug-c106="" class="highlight-div-header"><div _ngcontent-jug-c106="" class="highlight-div-header-left"><div _ngcontent-jug-c106="" class="handle-button expand-button"><div _ngcontent-jug-c106="" class="handle-hover-tips">收起</div></div></div><div _ngcontent-jug-c106="" class="highlight-div-header-right"><div _ngcontent-jug-c106="" class="handle-button ai-button"></div><div _ngcontent-jug-c106="" class="handle-button line-button"><div _ngcontent-jug-c106="" class="handle-hover-tips">自动换行</div></div><div _ngcontent-jug-c106="" class="handle-button theme-button"><div _ngcontent-jug-c106="" class="handle-hover-tips">深色代码主题</div></div><div _ngcontent-jug-c106="" class="handle-button copy-button"><div _ngcontent-jug-c106="" class="handle-hover-tips">复制</div></div></div></div><div _ngcontent-jug-c106="" class="highlight-scroll-div"><pre class="screen prettyprint linenums hljs language-scss" codehub="https://gitee.com/harmonyos_samples/transitions-collection/blob/master/entry/src/main/ets/feature/MultiModalTransition/HalfModalWindow.ets#L27-L279" data-highlighted="yes"><ol class="linenums"><li><span class="hljs-keyword">@Component</span></li><li>export struct HalfModalWindow {</li><li>  <span class="hljs-keyword">@Consume</span>(<span class="hljs-string">'NavPathStack'</span>) <span class="hljs-attribute">pageInfos</span>: NavPathStack;</li><li>  <span class="hljs-comment">// Whether to display the half-screen modal page.</span></li><li>  <span class="hljs-keyword">@State</span> <span class="hljs-attribute">isPresent</span>: boolean = false;</li><li>  <span class="hljs-comment">// half-mode height</span></li><li>  <span class="hljs-keyword">@State</span> <span class="hljs-attribute">sheetHeight</span>: number = Constants.FONT_WEIGHT;</li><li>  <span class="hljs-comment">// Whether to display the control bar</span></li><li>  <span class="hljs-keyword">@State</span> <span class="hljs-attribute">showDragBar</span>: boolean = true;</li><li>  <span class="hljs-comment">// Determine whether to agree with the agreement</span></li><li>  <span class="hljs-keyword">@State</span> <span class="hljs-attribute">isConfirmed</span>: boolean = false;</li><li>  <span class="hljs-comment">// Controlling Full-Modal Presentation</span></li><li>  <span class="hljs-keyword">@State</span> <span class="hljs-attribute">isPresentInLoginView</span>: boolean = false;</li><li>  <span class="hljs-comment">// Transparency of the button for sending a verification code</span></li><li>  <span class="hljs-keyword">@State</span> <span class="hljs-attribute">op</span>: number = Constants.HALF_OPACITY;</li><li>  <span class="hljs-comment">// Specifies the transition type</span></li><li>  <span class="hljs-comment">// The value is false when the component is redirected from the semi-modal component to the mobile verification code component</span></li><li>  <span class="hljs-comment">// and the value is true when the component is redirected from the account password component to the mobile verification code component</span></li><li>  <span class="hljs-keyword">@State</span> <span class="hljs-attribute">isShowTransition</span>: boolean = false;</li><li>  <span class="hljs-keyword">@State</span> <span class="hljs-attribute">isCenter</span>: boolean = true;</li><li>  <span class="hljs-keyword">@State</span> <span class="hljs-attribute">screenW</span>: number = <span class="hljs-number">0</span>;</li><li>  <span class="hljs-comment">// According to the mode attribute description of Navigation</span></li><li>  <span class="hljs-comment">// if Auto is used and the window width is greater than or equal to 600 vp, the Split mode is used for display</span></li><li>  curFoldStatus: display.FoldStatus | undefined = undefined;</li><li>  <span class="hljs-comment">// Folded state of the current screen (valid only for devices with folded screens)</span></li><li>  <span class="hljs-comment">// When the window width is less than 600 vp, the window is displayed in stack mode</span></li><li>  private deviceSize: number = Constants.DEFAULT_DEVICE_SIZE;</li><li>
</li><li>  <span class="hljs-comment">// ...</span></li><li>
</li><li>  <span class="hljs-keyword">@Builder</span></li><li>  defaultLogin() {</li><li>    <span class="hljs-built_in">Column</span>() {</li><li>      <span class="hljs-comment">// CheckBox to control, semi-modal, full-modal, and semi-modal confirmations in the login page</span></li><li>      <span class="hljs-built_in">CaptchaLogin</span>({</li><li>        isPresent: $isPresent,</li><li>        isPresentInLoginView: $isPresentInLoginView,</li><li>        isShowTransition: $isShowTransition</li><li>      })</li><li>    }</li><li>  }</li><li>
</li><li>  <span class="hljs-comment">// ...</span></li><li>
</li><li>  <span class="hljs-built_in">build</span>() {</li><li>    <span class="hljs-built_in">NavDestination</span>() {</li><li>      <span class="hljs-built_in">Column</span>() {</li><li>        <span class="hljs-comment">//The Text component is bound for semi-modal display</span></li><li>        <span class="hljs-comment">// ...</span></li><li>        <span class="hljs-comment">//The Text component is bound as the full-screen modal display of the mobile phone verification code component and the account and password component</span></li><li>        Text()</li><li>          <span class="hljs-selector-class">.bindContentCover</span>($$this.isPresentInLoginView, this.defaultLogin())</li><li>      }</li><li>      <span class="hljs-selector-class">.expandSafeArea</span>([SafeAreaType.SYSTEM], [SafeAreaEdge.TOP, SafeAreaEdge.BOTTOM])</li><li>      <span class="hljs-selector-class">.justifyContent</span>(FlexAlign.Center)</li><li>      <span class="hljs-selector-class">.size</span>({</li><li>        width: $r('app.string.multimodaltransion_size_full'),</li><li>        <span class="hljs-attribute">height</span>: <span class="hljs-variable">$r</span>(<span class="hljs-string">'app.string.multimodaltransion_size_full'</span>)</li><li>      })</li><li>      <span class="hljs-selector-class">.padding</span>($r('app.integer.multimodaltransion_padding_default'))</li><li>    }</li><li>  }</li><li>}</li></ol></pre><div class="screen-link-div"><a href="https://gitee.com/harmonyos_samples/transitions-collection/blob/master/entry/src/main/ets/feature/MultiModalTransition/HalfModalWindow.ets#L27-L279" target="_blank">HalfModalWindow.ets</a></div></div></div></div> <div class="tiledSection"><h2 id="section539100691">总结与回顾<i class="anchor-icon anchor-icon-link" anchorid="section539100691" tips="复制节点链接"></i></h2><p>合理使用页面间转场是提升用户体验的重要技术之一，在应用开发过程中，通过动效的运用，可以使应用界面更加生动、流畅，并且能够引导用户的注意力，提高用户的操作效率。合理使用动效需要考虑以下几点：</p> <ul><li>符合界面设计需求：动效应该与应用的整体设计风格和用户期望相匹配，不应过于炫目或过于简单。动效的设计应该与应用的功能和交互逻辑相符，能够提供有意义的反馈和引导。</li><li>提高用户体验：动效可以增强用户对界面操作的反馈感知，使用户能够更直观地理解应用的状态和变化。例如，在页面切换时使用渐变效果或位移动画，可以使用户感到界面的流畅性和连贯性，提高用户的满意度和使用体验。</li><li>控制动效的频率和时长：动效的过度使用可能会让用户感到疲劳或干扰用户的操作。因此，在设计动效时需要注意控制动效的频率和时长，避免过多的动效干扰用户的操作和阅读。</li><li>考虑性能和流畅度：在使用动效时，需要考虑应用的性能和流畅度。过多或复杂的动效可能会导致应用的性能下降，影响用户的体验。因此，在设计动效时需要合理权衡动效的效果和应用的性能，确保动效的运行流畅和稳定。</li></ul> <p>在应用开发过程中，开发者可以借助HarmonyOS中提供的导航组件和转场动效，简化开发流程，提高开发效率，实现符合规范要求的转场动效效果。</p> </div> <div class="tiledSection"><h2 id="section16424105503215">示例代码<i class="anchor-icon anchor-icon-link" anchorid="section16424105503215" tips="复制节点链接"></i></h2><ul><li><a href="https://gitee.com/harmonyos_samples/transitions-collection" target="_blank">页面间转场</a></li></ul> </div> </div> <div></div></div>